var Ax=Object.defineProperty;var Px=(t,e,n)=>e in t?Ax(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var yo=(t,e,n)=>(Px(t,typeof e!="symbol"?e+"":e,n),n);function kx(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function l_(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var c_={exports:{}},iu={},u_={exports:{}},ie={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pa=Symbol.for("react.element"),bx=Symbol.for("react.portal"),Dx=Symbol.for("react.fragment"),jx=Symbol.for("react.strict_mode"),Vx=Symbol.for("react.profiler"),Ox=Symbol.for("react.provider"),Lx=Symbol.for("react.context"),Mx=Symbol.for("react.forward_ref"),Fx=Symbol.for("react.suspense"),Ux=Symbol.for("react.memo"),Bx=Symbol.for("react.lazy"),dg=Symbol.iterator;function zx(t){return t===null||typeof t!="object"?null:(t=dg&&t[dg]||t["@@iterator"],typeof t=="function"?t:null)}var d_={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},h_=Object.assign,f_={};function Di(t,e,n){this.props=t,this.context=e,this.refs=f_,this.updater=n||d_}Di.prototype.isReactComponent={};Di.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Di.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function p_(){}p_.prototype=Di.prototype;function If(t,e,n){this.props=t,this.context=e,this.refs=f_,this.updater=n||d_}var Cf=If.prototype=new p_;Cf.constructor=If;h_(Cf,Di.prototype);Cf.isPureReactComponent=!0;var hg=Array.isArray,m_=Object.prototype.hasOwnProperty,Rf={current:null},g_={key:!0,ref:!0,__self:!0,__source:!0};function y_(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)m_.call(e,r)&&!g_.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:Pa,type:t,key:i,ref:o,props:s,_owner:Rf.current}}function $x(t,e){return{$$typeof:Pa,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Nf(t){return typeof t=="object"&&t!==null&&t.$$typeof===Pa}function Gx(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var fg=/\/+/g;function sd(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Gx(""+t.key):e.toString(36)}function Ul(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Pa:case bx:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+sd(o,0):r,hg(s)?(n="",t!=null&&(n=t.replace(fg,"$&/")+"/"),Ul(s,e,n,"",function(u){return u})):s!=null&&(Nf(s)&&(s=$x(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(fg,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",hg(t))for(var l=0;l<t.length;l++){i=t[l];var c=r+sd(i,l);o+=Ul(i,e,n,c,s)}else if(c=zx(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=r+sd(i,l++),o+=Ul(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function ml(t,e,n){if(t==null)return t;var r=[],s=0;return Ul(t,r,"","",function(i){return e.call(n,i,s++)}),r}function Hx(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Rt={current:null},Bl={transition:null},Wx={ReactCurrentDispatcher:Rt,ReactCurrentBatchConfig:Bl,ReactCurrentOwner:Rf};function v_(){throw Error("act(...) is not supported in production builds of React.")}ie.Children={map:ml,forEach:function(t,e,n){ml(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return ml(t,function(){e++}),e},toArray:function(t){return ml(t,function(e){return e})||[]},only:function(t){if(!Nf(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ie.Component=Di;ie.Fragment=Dx;ie.Profiler=Vx;ie.PureComponent=If;ie.StrictMode=jx;ie.Suspense=Fx;ie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Wx;ie.act=v_;ie.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=h_({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Rf.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)m_.call(e,c)&&!g_.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:Pa,type:t.type,key:s,ref:i,props:r,_owner:o}};ie.createContext=function(t){return t={$$typeof:Lx,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Ox,_context:t},t.Consumer=t};ie.createElement=y_;ie.createFactory=function(t){var e=y_.bind(null,t);return e.type=t,e};ie.createRef=function(){return{current:null}};ie.forwardRef=function(t){return{$$typeof:Mx,render:t}};ie.isValidElement=Nf;ie.lazy=function(t){return{$$typeof:Bx,_payload:{_status:-1,_result:t},_init:Hx}};ie.memo=function(t,e){return{$$typeof:Ux,type:t,compare:e===void 0?null:e}};ie.startTransition=function(t){var e=Bl.transition;Bl.transition={};try{t()}finally{Bl.transition=e}};ie.unstable_act=v_;ie.useCallback=function(t,e){return Rt.current.useCallback(t,e)};ie.useContext=function(t){return Rt.current.useContext(t)};ie.useDebugValue=function(){};ie.useDeferredValue=function(t){return Rt.current.useDeferredValue(t)};ie.useEffect=function(t,e){return Rt.current.useEffect(t,e)};ie.useId=function(){return Rt.current.useId()};ie.useImperativeHandle=function(t,e,n){return Rt.current.useImperativeHandle(t,e,n)};ie.useInsertionEffect=function(t,e){return Rt.current.useInsertionEffect(t,e)};ie.useLayoutEffect=function(t,e){return Rt.current.useLayoutEffect(t,e)};ie.useMemo=function(t,e){return Rt.current.useMemo(t,e)};ie.useReducer=function(t,e,n){return Rt.current.useReducer(t,e,n)};ie.useRef=function(t){return Rt.current.useRef(t)};ie.useState=function(t){return Rt.current.useState(t)};ie.useSyncExternalStore=function(t,e,n){return Rt.current.useSyncExternalStore(t,e,n)};ie.useTransition=function(){return Rt.current.useTransition()};ie.version="18.3.1";u_.exports=ie;var L=u_.exports;const xn=l_(L),qx=kx({__proto__:null,default:xn},[L]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kx=L,Qx=Symbol.for("react.element"),Yx=Symbol.for("react.fragment"),Jx=Object.prototype.hasOwnProperty,Xx=Kx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Zx={key:!0,ref:!0,__self:!0,__source:!0};function __(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)Jx.call(e,r)&&!Zx.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:Qx,type:t,key:i,ref:o,props:s,_owner:Xx.current}}iu.Fragment=Yx;iu.jsx=__;iu.jsxs=__;c_.exports=iu;var h=c_.exports,Yd={},w_={exports:{}},qt={},E_={exports:{}},x_={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(W,$){var q=W.length;W.push($);e:for(;0<q;){var re=q-1>>>1,se=W[re];if(0<s(se,$))W[re]=$,W[q]=se,q=re;else break e}}function n(W){return W.length===0?null:W[0]}function r(W){if(W.length===0)return null;var $=W[0],q=W.pop();if(q!==$){W[0]=q;e:for(var re=0,se=W.length,ce=se>>>1;re<ce;){var be=2*(re+1)-1,$e=W[be],De=be+1,je=W[De];if(0>s($e,q))De<se&&0>s(je,$e)?(W[re]=je,W[De]=q,re=De):(W[re]=$e,W[be]=q,re=be);else if(De<se&&0>s(je,q))W[re]=je,W[De]=q,re=De;else break e}}return $}function s(W,$){var q=W.sortIndex-$.sortIndex;return q!==0?q:W.id-$.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],f=1,m=null,g=3,w=!1,R=!1,N=!1,P=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(W){for(var $=n(u);$!==null;){if($.callback===null)r(u);else if($.startTime<=W)r(u),$.sortIndex=$.expirationTime,e(c,$);else break;$=n(u)}}function D(W){if(N=!1,S(W),!R)if(n(c)!==null)R=!0,Mt(F);else{var $=n(u);$!==null&&xt(D,$.startTime-W)}}function F(W,$){R=!1,N&&(N=!1,x(_),_=-1),w=!0;var q=g;try{for(S($),m=n(c);m!==null&&(!(m.expirationTime>$)||W&&!A());){var re=m.callback;if(typeof re=="function"){m.callback=null,g=m.priorityLevel;var se=re(m.expirationTime<=$);$=t.unstable_now(),typeof se=="function"?m.callback=se:m===n(c)&&r(c),S($)}else r(c);m=n(c)}if(m!==null)var ce=!0;else{var be=n(u);be!==null&&xt(D,be.startTime-$),ce=!1}return ce}finally{m=null,g=q,w=!1}}var z=!1,T=null,_=-1,I=5,E=-1;function A(){return!(t.unstable_now()-E<I)}function b(){if(T!==null){var W=t.unstable_now();E=W;var $=!0;try{$=T(!0,W)}finally{$?C():(z=!1,T=null)}}else z=!1}var C;if(typeof v=="function")C=function(){v(b)};else if(typeof MessageChannel<"u"){var qe=new MessageChannel,Ke=qe.port2;qe.port1.onmessage=b,C=function(){Ke.postMessage(null)}}else C=function(){P(b,0)};function Mt(W){T=W,z||(z=!0,C())}function xt(W,$){_=P(function(){W(t.unstable_now())},$)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(W){W.callback=null},t.unstable_continueExecution=function(){R||w||(R=!0,Mt(F))},t.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<W?Math.floor(1e3/W):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(W){switch(g){case 1:case 2:case 3:var $=3;break;default:$=g}var q=g;g=$;try{return W()}finally{g=q}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(W,$){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var q=g;g=W;try{return $()}finally{g=q}},t.unstable_scheduleCallback=function(W,$,q){var re=t.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?re+q:re):q=re,W){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=q+se,W={id:f++,callback:$,priorityLevel:W,startTime:q,expirationTime:se,sortIndex:-1},q>re?(W.sortIndex=q,e(u,W),n(c)===null&&W===n(u)&&(N?(x(_),_=-1):N=!0,xt(D,q-re))):(W.sortIndex=se,e(c,W),R||w||(R=!0,Mt(F))),W},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(W){var $=g;return function(){var q=g;g=$;try{return W.apply(this,arguments)}finally{g=q}}}})(x_);E_.exports=x_;var eT=E_.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tT=L,Wt=eT;function U(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var T_=new Set,Zo={};function Cs(t,e){yi(t,e),yi(t+"Capture",e)}function yi(t,e){for(Zo[t]=e,t=0;t<e.length;t++)T_.add(e[t])}var Hn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Jd=Object.prototype.hasOwnProperty,nT=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,pg={},mg={};function rT(t){return Jd.call(mg,t)?!0:Jd.call(pg,t)?!1:nT.test(t)?mg[t]=!0:(pg[t]=!0,!1)}function sT(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function iT(t,e,n,r){if(e===null||typeof e>"u"||sT(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Nt(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var ut={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ut[t]=new Nt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ut[e]=new Nt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ut[t]=new Nt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ut[t]=new Nt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ut[t]=new Nt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ut[t]=new Nt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ut[t]=new Nt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ut[t]=new Nt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ut[t]=new Nt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Af=/[\-:]([a-z])/g;function Pf(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Af,Pf);ut[e]=new Nt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Af,Pf);ut[e]=new Nt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Af,Pf);ut[e]=new Nt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ut[t]=new Nt(t,1,!1,t.toLowerCase(),null,!1,!1)});ut.xlinkHref=new Nt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ut[t]=new Nt(t,1,!1,t.toLowerCase(),null,!0,!0)});function kf(t,e,n,r){var s=ut.hasOwnProperty(e)?ut[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(iT(e,n,s,r)&&(n=null),r||s===null?rT(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Zn=tT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,gl=Symbol.for("react.element"),Qs=Symbol.for("react.portal"),Ys=Symbol.for("react.fragment"),bf=Symbol.for("react.strict_mode"),Xd=Symbol.for("react.profiler"),S_=Symbol.for("react.provider"),I_=Symbol.for("react.context"),Df=Symbol.for("react.forward_ref"),Zd=Symbol.for("react.suspense"),eh=Symbol.for("react.suspense_list"),jf=Symbol.for("react.memo"),lr=Symbol.for("react.lazy"),C_=Symbol.for("react.offscreen"),gg=Symbol.iterator;function vo(t){return t===null||typeof t!="object"?null:(t=gg&&t[gg]||t["@@iterator"],typeof t=="function"?t:null)}var Re=Object.assign,id;function Ao(t){if(id===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);id=e&&e[1]||""}return`
`+id+t}var od=!1;function ad(t,e){if(!t||od)return"";od=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{od=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Ao(t):""}function oT(t){switch(t.tag){case 5:return Ao(t.type);case 16:return Ao("Lazy");case 13:return Ao("Suspense");case 19:return Ao("SuspenseList");case 0:case 2:case 15:return t=ad(t.type,!1),t;case 11:return t=ad(t.type.render,!1),t;case 1:return t=ad(t.type,!0),t;default:return""}}function th(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ys:return"Fragment";case Qs:return"Portal";case Xd:return"Profiler";case bf:return"StrictMode";case Zd:return"Suspense";case eh:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case I_:return(t.displayName||"Context")+".Consumer";case S_:return(t._context.displayName||"Context")+".Provider";case Df:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case jf:return e=t.displayName||null,e!==null?e:th(t.type)||"Memo";case lr:e=t._payload,t=t._init;try{return th(t(e))}catch{}}return null}function aT(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return th(e);case 8:return e===bf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function jr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function R_(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function lT(t){var e=R_(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function yl(t){t._valueTracker||(t._valueTracker=lT(t))}function N_(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=R_(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function dc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function nh(t,e){var n=e.checked;return Re({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function yg(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=jr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function A_(t,e){e=e.checked,e!=null&&kf(t,"checked",e,!1)}function rh(t,e){A_(t,e);var n=jr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?sh(t,e.type,n):e.hasOwnProperty("defaultValue")&&sh(t,e.type,jr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function vg(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function sh(t,e,n){(e!=="number"||dc(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Po=Array.isArray;function ai(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+jr(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function ih(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(U(91));return Re({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function _g(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(U(92));if(Po(n)){if(1<n.length)throw Error(U(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:jr(n)}}function P_(t,e){var n=jr(e.value),r=jr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function wg(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function k_(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function oh(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?k_(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var vl,b_=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(vl=vl||document.createElement("div"),vl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=vl.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ea(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Lo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},cT=["Webkit","ms","Moz","O"];Object.keys(Lo).forEach(function(t){cT.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Lo[e]=Lo[t]})});function D_(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Lo.hasOwnProperty(t)&&Lo[t]?(""+e).trim():e+"px"}function j_(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=D_(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var uT=Re({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ah(t,e){if(e){if(uT[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(U(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(U(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(U(61))}if(e.style!=null&&typeof e.style!="object")throw Error(U(62))}}function lh(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ch=null;function Vf(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var uh=null,li=null,ci=null;function Eg(t){if(t=Da(t)){if(typeof uh!="function")throw Error(U(280));var e=t.stateNode;e&&(e=uu(e),uh(t.stateNode,t.type,e))}}function V_(t){li?ci?ci.push(t):ci=[t]:li=t}function O_(){if(li){var t=li,e=ci;if(ci=li=null,Eg(t),e)for(t=0;t<e.length;t++)Eg(e[t])}}function L_(t,e){return t(e)}function M_(){}var ld=!1;function F_(t,e,n){if(ld)return t(e,n);ld=!0;try{return L_(t,e,n)}finally{ld=!1,(li!==null||ci!==null)&&(M_(),O_())}}function ta(t,e){var n=t.stateNode;if(n===null)return null;var r=uu(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(U(231,e,typeof n));return n}var dh=!1;if(Hn)try{var _o={};Object.defineProperty(_o,"passive",{get:function(){dh=!0}}),window.addEventListener("test",_o,_o),window.removeEventListener("test",_o,_o)}catch{dh=!1}function dT(t,e,n,r,s,i,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(f){this.onError(f)}}var Mo=!1,hc=null,fc=!1,hh=null,hT={onError:function(t){Mo=!0,hc=t}};function fT(t,e,n,r,s,i,o,l,c){Mo=!1,hc=null,dT.apply(hT,arguments)}function pT(t,e,n,r,s,i,o,l,c){if(fT.apply(this,arguments),Mo){if(Mo){var u=hc;Mo=!1,hc=null}else throw Error(U(198));fc||(fc=!0,hh=u)}}function Rs(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function U_(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function xg(t){if(Rs(t)!==t)throw Error(U(188))}function mT(t){var e=t.alternate;if(!e){if(e=Rs(t),e===null)throw Error(U(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return xg(s),t;if(i===r)return xg(s),e;i=i.sibling}throw Error(U(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(U(189))}}if(n.alternate!==r)throw Error(U(190))}if(n.tag!==3)throw Error(U(188));return n.stateNode.current===n?t:e}function B_(t){return t=mT(t),t!==null?z_(t):null}function z_(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=z_(t);if(e!==null)return e;t=t.sibling}return null}var $_=Wt.unstable_scheduleCallback,Tg=Wt.unstable_cancelCallback,gT=Wt.unstable_shouldYield,yT=Wt.unstable_requestPaint,Le=Wt.unstable_now,vT=Wt.unstable_getCurrentPriorityLevel,Of=Wt.unstable_ImmediatePriority,G_=Wt.unstable_UserBlockingPriority,pc=Wt.unstable_NormalPriority,_T=Wt.unstable_LowPriority,H_=Wt.unstable_IdlePriority,ou=null,Tn=null;function wT(t){if(Tn&&typeof Tn.onCommitFiberRoot=="function")try{Tn.onCommitFiberRoot(ou,t,void 0,(t.current.flags&128)===128)}catch{}}var dn=Math.clz32?Math.clz32:TT,ET=Math.log,xT=Math.LN2;function TT(t){return t>>>=0,t===0?32:31-(ET(t)/xT|0)|0}var _l=64,wl=4194304;function ko(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function mc(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=ko(l):(i&=o,i!==0&&(r=ko(i)))}else o=n&~s,o!==0?r=ko(o):i!==0&&(r=ko(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-dn(e),s=1<<n,r|=t[n],e&=~s;return r}function ST(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function IT(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-dn(i),l=1<<o,c=s[o];c===-1?(!(l&n)||l&r)&&(s[o]=ST(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function fh(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function W_(){var t=_l;return _l<<=1,!(_l&4194240)&&(_l=64),t}function cd(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ka(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-dn(e),t[e]=n}function CT(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-dn(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Lf(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-dn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var me=0;function q_(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var K_,Mf,Q_,Y_,J_,ph=!1,El=[],wr=null,Er=null,xr=null,na=new Map,ra=new Map,ur=[],RT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sg(t,e){switch(t){case"focusin":case"focusout":wr=null;break;case"dragenter":case"dragleave":Er=null;break;case"mouseover":case"mouseout":xr=null;break;case"pointerover":case"pointerout":na.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ra.delete(e.pointerId)}}function wo(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Da(e),e!==null&&Mf(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function NT(t,e,n,r,s){switch(e){case"focusin":return wr=wo(wr,t,e,n,r,s),!0;case"dragenter":return Er=wo(Er,t,e,n,r,s),!0;case"mouseover":return xr=wo(xr,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return na.set(i,wo(na.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,ra.set(i,wo(ra.get(i)||null,t,e,n,r,s)),!0}return!1}function X_(t){var e=as(t.target);if(e!==null){var n=Rs(e);if(n!==null){if(e=n.tag,e===13){if(e=U_(n),e!==null){t.blockedOn=e,J_(t.priority,function(){Q_(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function zl(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=mh(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);ch=r,n.target.dispatchEvent(r),ch=null}else return e=Da(n),e!==null&&Mf(e),t.blockedOn=n,!1;e.shift()}return!0}function Ig(t,e,n){zl(t)&&n.delete(e)}function AT(){ph=!1,wr!==null&&zl(wr)&&(wr=null),Er!==null&&zl(Er)&&(Er=null),xr!==null&&zl(xr)&&(xr=null),na.forEach(Ig),ra.forEach(Ig)}function Eo(t,e){t.blockedOn===e&&(t.blockedOn=null,ph||(ph=!0,Wt.unstable_scheduleCallback(Wt.unstable_NormalPriority,AT)))}function sa(t){function e(s){return Eo(s,t)}if(0<El.length){Eo(El[0],t);for(var n=1;n<El.length;n++){var r=El[n];r.blockedOn===t&&(r.blockedOn=null)}}for(wr!==null&&Eo(wr,t),Er!==null&&Eo(Er,t),xr!==null&&Eo(xr,t),na.forEach(e),ra.forEach(e),n=0;n<ur.length;n++)r=ur[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<ur.length&&(n=ur[0],n.blockedOn===null);)X_(n),n.blockedOn===null&&ur.shift()}var ui=Zn.ReactCurrentBatchConfig,gc=!0;function PT(t,e,n,r){var s=me,i=ui.transition;ui.transition=null;try{me=1,Ff(t,e,n,r)}finally{me=s,ui.transition=i}}function kT(t,e,n,r){var s=me,i=ui.transition;ui.transition=null;try{me=4,Ff(t,e,n,r)}finally{me=s,ui.transition=i}}function Ff(t,e,n,r){if(gc){var s=mh(t,e,n,r);if(s===null)_d(t,e,r,yc,n),Sg(t,r);else if(NT(s,t,e,n,r))r.stopPropagation();else if(Sg(t,r),e&4&&-1<RT.indexOf(t)){for(;s!==null;){var i=Da(s);if(i!==null&&K_(i),i=mh(t,e,n,r),i===null&&_d(t,e,r,yc,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else _d(t,e,r,null,n)}}var yc=null;function mh(t,e,n,r){if(yc=null,t=Vf(r),t=as(t),t!==null)if(e=Rs(t),e===null)t=null;else if(n=e.tag,n===13){if(t=U_(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return yc=t,null}function Z_(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(vT()){case Of:return 1;case G_:return 4;case pc:case _T:return 16;case H_:return 536870912;default:return 16}default:return 16}}var mr=null,Uf=null,$l=null;function e1(){if($l)return $l;var t,e=Uf,n=e.length,r,s="value"in mr?mr.value:mr.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return $l=s.slice(t,1<r?1-r:void 0)}function Gl(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function xl(){return!0}function Cg(){return!1}function Kt(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?xl:Cg,this.isPropagationStopped=Cg,this}return Re(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=xl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=xl)},persist:function(){},isPersistent:xl}),e}var ji={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Bf=Kt(ji),ba=Re({},ji,{view:0,detail:0}),bT=Kt(ba),ud,dd,xo,au=Re({},ba,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zf,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==xo&&(xo&&t.type==="mousemove"?(ud=t.screenX-xo.screenX,dd=t.screenY-xo.screenY):dd=ud=0,xo=t),ud)},movementY:function(t){return"movementY"in t?t.movementY:dd}}),Rg=Kt(au),DT=Re({},au,{dataTransfer:0}),jT=Kt(DT),VT=Re({},ba,{relatedTarget:0}),hd=Kt(VT),OT=Re({},ji,{animationName:0,elapsedTime:0,pseudoElement:0}),LT=Kt(OT),MT=Re({},ji,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),FT=Kt(MT),UT=Re({},ji,{data:0}),Ng=Kt(UT),BT={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},zT={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$T={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function GT(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=$T[t])?!!e[t]:!1}function zf(){return GT}var HT=Re({},ba,{key:function(t){if(t.key){var e=BT[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Gl(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?zT[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zf,charCode:function(t){return t.type==="keypress"?Gl(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Gl(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),WT=Kt(HT),qT=Re({},au,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ag=Kt(qT),KT=Re({},ba,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zf}),QT=Kt(KT),YT=Re({},ji,{propertyName:0,elapsedTime:0,pseudoElement:0}),JT=Kt(YT),XT=Re({},au,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),ZT=Kt(XT),eS=[9,13,27,32],$f=Hn&&"CompositionEvent"in window,Fo=null;Hn&&"documentMode"in document&&(Fo=document.documentMode);var tS=Hn&&"TextEvent"in window&&!Fo,t1=Hn&&(!$f||Fo&&8<Fo&&11>=Fo),Pg=String.fromCharCode(32),kg=!1;function n1(t,e){switch(t){case"keyup":return eS.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function r1(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Js=!1;function nS(t,e){switch(t){case"compositionend":return r1(e);case"keypress":return e.which!==32?null:(kg=!0,Pg);case"textInput":return t=e.data,t===Pg&&kg?null:t;default:return null}}function rS(t,e){if(Js)return t==="compositionend"||!$f&&n1(t,e)?(t=e1(),$l=Uf=mr=null,Js=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return t1&&e.locale!=="ko"?null:e.data;default:return null}}var sS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function bg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!sS[t.type]:e==="textarea"}function s1(t,e,n,r){V_(r),e=vc(e,"onChange"),0<e.length&&(n=new Bf("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Uo=null,ia=null;function iS(t){m1(t,0)}function lu(t){var e=ei(t);if(N_(e))return t}function oS(t,e){if(t==="change")return e}var i1=!1;if(Hn){var fd;if(Hn){var pd="oninput"in document;if(!pd){var Dg=document.createElement("div");Dg.setAttribute("oninput","return;"),pd=typeof Dg.oninput=="function"}fd=pd}else fd=!1;i1=fd&&(!document.documentMode||9<document.documentMode)}function jg(){Uo&&(Uo.detachEvent("onpropertychange",o1),ia=Uo=null)}function o1(t){if(t.propertyName==="value"&&lu(ia)){var e=[];s1(e,ia,t,Vf(t)),F_(iS,e)}}function aS(t,e,n){t==="focusin"?(jg(),Uo=e,ia=n,Uo.attachEvent("onpropertychange",o1)):t==="focusout"&&jg()}function lS(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return lu(ia)}function cS(t,e){if(t==="click")return lu(e)}function uS(t,e){if(t==="input"||t==="change")return lu(e)}function dS(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var mn=typeof Object.is=="function"?Object.is:dS;function oa(t,e){if(mn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Jd.call(e,s)||!mn(t[s],e[s]))return!1}return!0}function Vg(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Og(t,e){var n=Vg(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Vg(n)}}function a1(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?a1(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function l1(){for(var t=window,e=dc();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=dc(t.document)}return e}function Gf(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function hS(t){var e=l1(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&a1(n.ownerDocument.documentElement,n)){if(r!==null&&Gf(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=Og(n,i);var o=Og(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var fS=Hn&&"documentMode"in document&&11>=document.documentMode,Xs=null,gh=null,Bo=null,yh=!1;function Lg(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;yh||Xs==null||Xs!==dc(r)||(r=Xs,"selectionStart"in r&&Gf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Bo&&oa(Bo,r)||(Bo=r,r=vc(gh,"onSelect"),0<r.length&&(e=new Bf("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Xs)))}function Tl(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Zs={animationend:Tl("Animation","AnimationEnd"),animationiteration:Tl("Animation","AnimationIteration"),animationstart:Tl("Animation","AnimationStart"),transitionend:Tl("Transition","TransitionEnd")},md={},c1={};Hn&&(c1=document.createElement("div").style,"AnimationEvent"in window||(delete Zs.animationend.animation,delete Zs.animationiteration.animation,delete Zs.animationstart.animation),"TransitionEvent"in window||delete Zs.transitionend.transition);function cu(t){if(md[t])return md[t];if(!Zs[t])return t;var e=Zs[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in c1)return md[t]=e[n];return t}var u1=cu("animationend"),d1=cu("animationiteration"),h1=cu("animationstart"),f1=cu("transitionend"),p1=new Map,Mg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function $r(t,e){p1.set(t,e),Cs(e,[t])}for(var gd=0;gd<Mg.length;gd++){var yd=Mg[gd],pS=yd.toLowerCase(),mS=yd[0].toUpperCase()+yd.slice(1);$r(pS,"on"+mS)}$r(u1,"onAnimationEnd");$r(d1,"onAnimationIteration");$r(h1,"onAnimationStart");$r("dblclick","onDoubleClick");$r("focusin","onFocus");$r("focusout","onBlur");$r(f1,"onTransitionEnd");yi("onMouseEnter",["mouseout","mouseover"]);yi("onMouseLeave",["mouseout","mouseover"]);yi("onPointerEnter",["pointerout","pointerover"]);yi("onPointerLeave",["pointerout","pointerover"]);Cs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Cs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Cs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Cs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Cs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Cs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var bo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),gS=new Set("cancel close invalid load scroll toggle".split(" ").concat(bo));function Fg(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,pT(r,e,void 0,t),t.currentTarget=null}function m1(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;Fg(s,l,u),i=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;Fg(s,l,u),i=c}}}if(fc)throw t=hh,fc=!1,hh=null,t}function Ee(t,e){var n=e[xh];n===void 0&&(n=e[xh]=new Set);var r=t+"__bubble";n.has(r)||(g1(e,t,2,!1),n.add(r))}function vd(t,e,n){var r=0;e&&(r|=4),g1(n,t,r,e)}var Sl="_reactListening"+Math.random().toString(36).slice(2);function aa(t){if(!t[Sl]){t[Sl]=!0,T_.forEach(function(n){n!=="selectionchange"&&(gS.has(n)||vd(n,!1,t),vd(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Sl]||(e[Sl]=!0,vd("selectionchange",!1,e))}}function g1(t,e,n,r){switch(Z_(e)){case 1:var s=PT;break;case 4:s=kT;break;default:s=Ff}n=s.bind(null,e,n,t),s=void 0,!dh||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function _d(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=as(l),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}l=l.parentNode}}r=r.return}F_(function(){var u=i,f=Vf(n),m=[];e:{var g=p1.get(t);if(g!==void 0){var w=Bf,R=t;switch(t){case"keypress":if(Gl(n)===0)break e;case"keydown":case"keyup":w=WT;break;case"focusin":R="focus",w=hd;break;case"focusout":R="blur",w=hd;break;case"beforeblur":case"afterblur":w=hd;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":w=Rg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":w=jT;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":w=QT;break;case u1:case d1:case h1:w=LT;break;case f1:w=JT;break;case"scroll":w=bT;break;case"wheel":w=ZT;break;case"copy":case"cut":case"paste":w=FT;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":w=Ag}var N=(e&4)!==0,P=!N&&t==="scroll",x=N?g!==null?g+"Capture":null:g;N=[];for(var v=u,S;v!==null;){S=v;var D=S.stateNode;if(S.tag===5&&D!==null&&(S=D,x!==null&&(D=ta(v,x),D!=null&&N.push(la(v,D,S)))),P)break;v=v.return}0<N.length&&(g=new w(g,R,null,n,f),m.push({event:g,listeners:N}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",w=t==="mouseout"||t==="pointerout",g&&n!==ch&&(R=n.relatedTarget||n.fromElement)&&(as(R)||R[Wn]))break e;if((w||g)&&(g=f.window===f?f:(g=f.ownerDocument)?g.defaultView||g.parentWindow:window,w?(R=n.relatedTarget||n.toElement,w=u,R=R?as(R):null,R!==null&&(P=Rs(R),R!==P||R.tag!==5&&R.tag!==6)&&(R=null)):(w=null,R=u),w!==R)){if(N=Rg,D="onMouseLeave",x="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(N=Ag,D="onPointerLeave",x="onPointerEnter",v="pointer"),P=w==null?g:ei(w),S=R==null?g:ei(R),g=new N(D,v+"leave",w,n,f),g.target=P,g.relatedTarget=S,D=null,as(f)===u&&(N=new N(x,v+"enter",R,n,f),N.target=S,N.relatedTarget=P,D=N),P=D,w&&R)t:{for(N=w,x=R,v=0,S=N;S;S=$s(S))v++;for(S=0,D=x;D;D=$s(D))S++;for(;0<v-S;)N=$s(N),v--;for(;0<S-v;)x=$s(x),S--;for(;v--;){if(N===x||x!==null&&N===x.alternate)break t;N=$s(N),x=$s(x)}N=null}else N=null;w!==null&&Ug(m,g,w,N,!1),R!==null&&P!==null&&Ug(m,P,R,N,!0)}}e:{if(g=u?ei(u):window,w=g.nodeName&&g.nodeName.toLowerCase(),w==="select"||w==="input"&&g.type==="file")var F=oS;else if(bg(g))if(i1)F=uS;else{F=lS;var z=aS}else(w=g.nodeName)&&w.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(F=cS);if(F&&(F=F(t,u))){s1(m,F,n,f);break e}z&&z(t,g,u),t==="focusout"&&(z=g._wrapperState)&&z.controlled&&g.type==="number"&&sh(g,"number",g.value)}switch(z=u?ei(u):window,t){case"focusin":(bg(z)||z.contentEditable==="true")&&(Xs=z,gh=u,Bo=null);break;case"focusout":Bo=gh=Xs=null;break;case"mousedown":yh=!0;break;case"contextmenu":case"mouseup":case"dragend":yh=!1,Lg(m,n,f);break;case"selectionchange":if(fS)break;case"keydown":case"keyup":Lg(m,n,f)}var T;if($f)e:{switch(t){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else Js?n1(t,n)&&(_="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(_="onCompositionStart");_&&(t1&&n.locale!=="ko"&&(Js||_!=="onCompositionStart"?_==="onCompositionEnd"&&Js&&(T=e1()):(mr=f,Uf="value"in mr?mr.value:mr.textContent,Js=!0)),z=vc(u,_),0<z.length&&(_=new Ng(_,t,null,n,f),m.push({event:_,listeners:z}),T?_.data=T:(T=r1(n),T!==null&&(_.data=T)))),(T=tS?nS(t,n):rS(t,n))&&(u=vc(u,"onBeforeInput"),0<u.length&&(f=new Ng("onBeforeInput","beforeinput",null,n,f),m.push({event:f,listeners:u}),f.data=T))}m1(m,e)})}function la(t,e,n){return{instance:t,listener:e,currentTarget:n}}function vc(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=ta(t,n),i!=null&&r.unshift(la(t,i,s)),i=ta(t,e),i!=null&&r.push(la(t,i,s))),t=t.return}return r}function $s(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Ug(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,s?(c=ta(n,i),c!=null&&o.unshift(la(n,c,l))):s||(c=ta(n,i),c!=null&&o.push(la(n,c,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var yS=/\r\n?/g,vS=/\u0000|\uFFFD/g;function Bg(t){return(typeof t=="string"?t:""+t).replace(yS,`
`).replace(vS,"")}function Il(t,e,n){if(e=Bg(e),Bg(t)!==e&&n)throw Error(U(425))}function _c(){}var vh=null,_h=null;function wh(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Eh=typeof setTimeout=="function"?setTimeout:void 0,_S=typeof clearTimeout=="function"?clearTimeout:void 0,zg=typeof Promise=="function"?Promise:void 0,wS=typeof queueMicrotask=="function"?queueMicrotask:typeof zg<"u"?function(t){return zg.resolve(null).then(t).catch(ES)}:Eh;function ES(t){setTimeout(function(){throw t})}function wd(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),sa(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);sa(e)}function Tr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function $g(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Vi=Math.random().toString(36).slice(2),En="__reactFiber$"+Vi,ca="__reactProps$"+Vi,Wn="__reactContainer$"+Vi,xh="__reactEvents$"+Vi,xS="__reactListeners$"+Vi,TS="__reactHandles$"+Vi;function as(t){var e=t[En];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Wn]||n[En]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=$g(t);t!==null;){if(n=t[En])return n;t=$g(t)}return e}t=n,n=t.parentNode}return null}function Da(t){return t=t[En]||t[Wn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ei(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(U(33))}function uu(t){return t[ca]||null}var Th=[],ti=-1;function Gr(t){return{current:t}}function xe(t){0>ti||(t.current=Th[ti],Th[ti]=null,ti--)}function ve(t,e){ti++,Th[ti]=t.current,t.current=e}var Vr={},wt=Gr(Vr),Vt=Gr(!1),ys=Vr;function vi(t,e){var n=t.type.contextTypes;if(!n)return Vr;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Ot(t){return t=t.childContextTypes,t!=null}function wc(){xe(Vt),xe(wt)}function Gg(t,e,n){if(wt.current!==Vr)throw Error(U(168));ve(wt,e),ve(Vt,n)}function y1(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(U(108,aT(t)||"Unknown",s));return Re({},n,r)}function Ec(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Vr,ys=wt.current,ve(wt,t),ve(Vt,Vt.current),!0}function Hg(t,e,n){var r=t.stateNode;if(!r)throw Error(U(169));n?(t=y1(t,e,ys),r.__reactInternalMemoizedMergedChildContext=t,xe(Vt),xe(wt),ve(wt,t)):xe(Vt),ve(Vt,n)}var Ln=null,du=!1,Ed=!1;function v1(t){Ln===null?Ln=[t]:Ln.push(t)}function SS(t){du=!0,v1(t)}function Hr(){if(!Ed&&Ln!==null){Ed=!0;var t=0,e=me;try{var n=Ln;for(me=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Ln=null,du=!1}catch(s){throw Ln!==null&&(Ln=Ln.slice(t+1)),$_(Of,Hr),s}finally{me=e,Ed=!1}}return null}var ni=[],ri=0,xc=null,Tc=0,Qt=[],Yt=0,vs=null,Fn=1,Un="";function rs(t,e){ni[ri++]=Tc,ni[ri++]=xc,xc=t,Tc=e}function _1(t,e,n){Qt[Yt++]=Fn,Qt[Yt++]=Un,Qt[Yt++]=vs,vs=t;var r=Fn;t=Un;var s=32-dn(r)-1;r&=~(1<<s),n+=1;var i=32-dn(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Fn=1<<32-dn(e)+s|n<<s|r,Un=i+t}else Fn=1<<i|n<<s|r,Un=t}function Hf(t){t.return!==null&&(rs(t,1),_1(t,1,0))}function Wf(t){for(;t===xc;)xc=ni[--ri],ni[ri]=null,Tc=ni[--ri],ni[ri]=null;for(;t===vs;)vs=Qt[--Yt],Qt[Yt]=null,Un=Qt[--Yt],Qt[Yt]=null,Fn=Qt[--Yt],Qt[Yt]=null}var Ht=null,$t=null,Se=!1,ln=null;function w1(t,e){var n=Xt(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Wg(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Ht=t,$t=Tr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Ht=t,$t=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=vs!==null?{id:Fn,overflow:Un}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Xt(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Ht=t,$t=null,!0):!1;default:return!1}}function Sh(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Ih(t){if(Se){var e=$t;if(e){var n=e;if(!Wg(t,e)){if(Sh(t))throw Error(U(418));e=Tr(n.nextSibling);var r=Ht;e&&Wg(t,e)?w1(r,n):(t.flags=t.flags&-4097|2,Se=!1,Ht=t)}}else{if(Sh(t))throw Error(U(418));t.flags=t.flags&-4097|2,Se=!1,Ht=t}}}function qg(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Ht=t}function Cl(t){if(t!==Ht)return!1;if(!Se)return qg(t),Se=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!wh(t.type,t.memoizedProps)),e&&(e=$t)){if(Sh(t))throw E1(),Error(U(418));for(;e;)w1(t,e),e=Tr(e.nextSibling)}if(qg(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(U(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){$t=Tr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}$t=null}}else $t=Ht?Tr(t.stateNode.nextSibling):null;return!0}function E1(){for(var t=$t;t;)t=Tr(t.nextSibling)}function _i(){$t=Ht=null,Se=!1}function qf(t){ln===null?ln=[t]:ln.push(t)}var IS=Zn.ReactCurrentBatchConfig;function To(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(U(309));var r=n.stateNode}if(!r)throw Error(U(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(U(284));if(!n._owner)throw Error(U(290,t))}return t}function Rl(t,e){throw t=Object.prototype.toString.call(e),Error(U(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Kg(t){var e=t._init;return e(t._payload)}function x1(t){function e(x,v){if(t){var S=x.deletions;S===null?(x.deletions=[v],x.flags|=16):S.push(v)}}function n(x,v){if(!t)return null;for(;v!==null;)e(x,v),v=v.sibling;return null}function r(x,v){for(x=new Map;v!==null;)v.key!==null?x.set(v.key,v):x.set(v.index,v),v=v.sibling;return x}function s(x,v){return x=Rr(x,v),x.index=0,x.sibling=null,x}function i(x,v,S){return x.index=S,t?(S=x.alternate,S!==null?(S=S.index,S<v?(x.flags|=2,v):S):(x.flags|=2,v)):(x.flags|=1048576,v)}function o(x){return t&&x.alternate===null&&(x.flags|=2),x}function l(x,v,S,D){return v===null||v.tag!==6?(v=Nd(S,x.mode,D),v.return=x,v):(v=s(v,S),v.return=x,v)}function c(x,v,S,D){var F=S.type;return F===Ys?f(x,v,S.props.children,D,S.key):v!==null&&(v.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===lr&&Kg(F)===v.type)?(D=s(v,S.props),D.ref=To(x,v,S),D.return=x,D):(D=Jl(S.type,S.key,S.props,null,x.mode,D),D.ref=To(x,v,S),D.return=x,D)}function u(x,v,S,D){return v===null||v.tag!==4||v.stateNode.containerInfo!==S.containerInfo||v.stateNode.implementation!==S.implementation?(v=Ad(S,x.mode,D),v.return=x,v):(v=s(v,S.children||[]),v.return=x,v)}function f(x,v,S,D,F){return v===null||v.tag!==7?(v=fs(S,x.mode,D,F),v.return=x,v):(v=s(v,S),v.return=x,v)}function m(x,v,S){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Nd(""+v,x.mode,S),v.return=x,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case gl:return S=Jl(v.type,v.key,v.props,null,x.mode,S),S.ref=To(x,null,v),S.return=x,S;case Qs:return v=Ad(v,x.mode,S),v.return=x,v;case lr:var D=v._init;return m(x,D(v._payload),S)}if(Po(v)||vo(v))return v=fs(v,x.mode,S,null),v.return=x,v;Rl(x,v)}return null}function g(x,v,S,D){var F=v!==null?v.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return F!==null?null:l(x,v,""+S,D);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case gl:return S.key===F?c(x,v,S,D):null;case Qs:return S.key===F?u(x,v,S,D):null;case lr:return F=S._init,g(x,v,F(S._payload),D)}if(Po(S)||vo(S))return F!==null?null:f(x,v,S,D,null);Rl(x,S)}return null}function w(x,v,S,D,F){if(typeof D=="string"&&D!==""||typeof D=="number")return x=x.get(S)||null,l(v,x,""+D,F);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case gl:return x=x.get(D.key===null?S:D.key)||null,c(v,x,D,F);case Qs:return x=x.get(D.key===null?S:D.key)||null,u(v,x,D,F);case lr:var z=D._init;return w(x,v,S,z(D._payload),F)}if(Po(D)||vo(D))return x=x.get(S)||null,f(v,x,D,F,null);Rl(v,D)}return null}function R(x,v,S,D){for(var F=null,z=null,T=v,_=v=0,I=null;T!==null&&_<S.length;_++){T.index>_?(I=T,T=null):I=T.sibling;var E=g(x,T,S[_],D);if(E===null){T===null&&(T=I);break}t&&T&&E.alternate===null&&e(x,T),v=i(E,v,_),z===null?F=E:z.sibling=E,z=E,T=I}if(_===S.length)return n(x,T),Se&&rs(x,_),F;if(T===null){for(;_<S.length;_++)T=m(x,S[_],D),T!==null&&(v=i(T,v,_),z===null?F=T:z.sibling=T,z=T);return Se&&rs(x,_),F}for(T=r(x,T);_<S.length;_++)I=w(T,x,_,S[_],D),I!==null&&(t&&I.alternate!==null&&T.delete(I.key===null?_:I.key),v=i(I,v,_),z===null?F=I:z.sibling=I,z=I);return t&&T.forEach(function(A){return e(x,A)}),Se&&rs(x,_),F}function N(x,v,S,D){var F=vo(S);if(typeof F!="function")throw Error(U(150));if(S=F.call(S),S==null)throw Error(U(151));for(var z=F=null,T=v,_=v=0,I=null,E=S.next();T!==null&&!E.done;_++,E=S.next()){T.index>_?(I=T,T=null):I=T.sibling;var A=g(x,T,E.value,D);if(A===null){T===null&&(T=I);break}t&&T&&A.alternate===null&&e(x,T),v=i(A,v,_),z===null?F=A:z.sibling=A,z=A,T=I}if(E.done)return n(x,T),Se&&rs(x,_),F;if(T===null){for(;!E.done;_++,E=S.next())E=m(x,E.value,D),E!==null&&(v=i(E,v,_),z===null?F=E:z.sibling=E,z=E);return Se&&rs(x,_),F}for(T=r(x,T);!E.done;_++,E=S.next())E=w(T,x,_,E.value,D),E!==null&&(t&&E.alternate!==null&&T.delete(E.key===null?_:E.key),v=i(E,v,_),z===null?F=E:z.sibling=E,z=E);return t&&T.forEach(function(b){return e(x,b)}),Se&&rs(x,_),F}function P(x,v,S,D){if(typeof S=="object"&&S!==null&&S.type===Ys&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case gl:e:{for(var F=S.key,z=v;z!==null;){if(z.key===F){if(F=S.type,F===Ys){if(z.tag===7){n(x,z.sibling),v=s(z,S.props.children),v.return=x,x=v;break e}}else if(z.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===lr&&Kg(F)===z.type){n(x,z.sibling),v=s(z,S.props),v.ref=To(x,z,S),v.return=x,x=v;break e}n(x,z);break}else e(x,z);z=z.sibling}S.type===Ys?(v=fs(S.props.children,x.mode,D,S.key),v.return=x,x=v):(D=Jl(S.type,S.key,S.props,null,x.mode,D),D.ref=To(x,v,S),D.return=x,x=D)}return o(x);case Qs:e:{for(z=S.key;v!==null;){if(v.key===z)if(v.tag===4&&v.stateNode.containerInfo===S.containerInfo&&v.stateNode.implementation===S.implementation){n(x,v.sibling),v=s(v,S.children||[]),v.return=x,x=v;break e}else{n(x,v);break}else e(x,v);v=v.sibling}v=Ad(S,x.mode,D),v.return=x,x=v}return o(x);case lr:return z=S._init,P(x,v,z(S._payload),D)}if(Po(S))return R(x,v,S,D);if(vo(S))return N(x,v,S,D);Rl(x,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,v!==null&&v.tag===6?(n(x,v.sibling),v=s(v,S),v.return=x,x=v):(n(x,v),v=Nd(S,x.mode,D),v.return=x,x=v),o(x)):n(x,v)}return P}var wi=x1(!0),T1=x1(!1),Sc=Gr(null),Ic=null,si=null,Kf=null;function Qf(){Kf=si=Ic=null}function Yf(t){var e=Sc.current;xe(Sc),t._currentValue=e}function Ch(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function di(t,e){Ic=t,Kf=si=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(jt=!0),t.firstContext=null)}function en(t){var e=t._currentValue;if(Kf!==t)if(t={context:t,memoizedValue:e,next:null},si===null){if(Ic===null)throw Error(U(308));si=t,Ic.dependencies={lanes:0,firstContext:t}}else si=si.next=t;return e}var ls=null;function Jf(t){ls===null?ls=[t]:ls.push(t)}function S1(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Jf(e)):(n.next=s.next,s.next=n),e.interleaved=n,qn(t,r)}function qn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var cr=!1;function Xf(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function I1(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function $n(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Sr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,he&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,qn(t,n)}return s=r.interleaved,s===null?(e.next=e,Jf(r)):(e.next=s.next,s.next=e),r.interleaved=e,qn(t,n)}function Hl(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Lf(t,n)}}function Qg(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Cc(t,e,n,r){var s=t.updateQueue;cr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?i=u:o.next=u,o=c;var f=t.alternate;f!==null&&(f=f.updateQueue,l=f.lastBaseUpdate,l!==o&&(l===null?f.firstBaseUpdate=u:l.next=u,f.lastBaseUpdate=c))}if(i!==null){var m=s.baseState;o=0,f=u=c=null,l=i;do{var g=l.lane,w=l.eventTime;if((r&g)===g){f!==null&&(f=f.next={eventTime:w,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var R=t,N=l;switch(g=e,w=n,N.tag){case 1:if(R=N.payload,typeof R=="function"){m=R.call(w,m,g);break e}m=R;break e;case 3:R.flags=R.flags&-65537|128;case 0:if(R=N.payload,g=typeof R=="function"?R.call(w,m,g):R,g==null)break e;m=Re({},m,g);break e;case 2:cr=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,g=s.effects,g===null?s.effects=[l]:g.push(l))}else w={eventTime:w,lane:g,tag:l.tag,payload:l.payload,callback:l.callback,next:null},f===null?(u=f=w,c=m):f=f.next=w,o|=g;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;g=l,l=g.next,g.next=null,s.lastBaseUpdate=g,s.shared.pending=null}}while(1);if(f===null&&(c=m),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=f,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);ws|=o,t.lanes=o,t.memoizedState=m}}function Yg(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(U(191,s));s.call(r)}}}var ja={},Sn=Gr(ja),ua=Gr(ja),da=Gr(ja);function cs(t){if(t===ja)throw Error(U(174));return t}function Zf(t,e){switch(ve(da,e),ve(ua,t),ve(Sn,ja),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:oh(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=oh(e,t)}xe(Sn),ve(Sn,e)}function Ei(){xe(Sn),xe(ua),xe(da)}function C1(t){cs(da.current);var e=cs(Sn.current),n=oh(e,t.type);e!==n&&(ve(ua,t),ve(Sn,n))}function ep(t){ua.current===t&&(xe(Sn),xe(ua))}var Ie=Gr(0);function Rc(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var xd=[];function tp(){for(var t=0;t<xd.length;t++)xd[t]._workInProgressVersionPrimary=null;xd.length=0}var Wl=Zn.ReactCurrentDispatcher,Td=Zn.ReactCurrentBatchConfig,_s=0,Ce=null,Ge=null,Xe=null,Nc=!1,zo=!1,ha=0,CS=0;function pt(){throw Error(U(321))}function np(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!mn(t[n],e[n]))return!1;return!0}function rp(t,e,n,r,s,i){if(_s=i,Ce=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Wl.current=t===null||t.memoizedState===null?PS:kS,t=n(r,s),zo){i=0;do{if(zo=!1,ha=0,25<=i)throw Error(U(301));i+=1,Xe=Ge=null,e.updateQueue=null,Wl.current=bS,t=n(r,s)}while(zo)}if(Wl.current=Ac,e=Ge!==null&&Ge.next!==null,_s=0,Xe=Ge=Ce=null,Nc=!1,e)throw Error(U(300));return t}function sp(){var t=ha!==0;return ha=0,t}function _n(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Xe===null?Ce.memoizedState=Xe=t:Xe=Xe.next=t,Xe}function tn(){if(Ge===null){var t=Ce.alternate;t=t!==null?t.memoizedState:null}else t=Ge.next;var e=Xe===null?Ce.memoizedState:Xe.next;if(e!==null)Xe=e,Ge=t;else{if(t===null)throw Error(U(310));Ge=t,t={memoizedState:Ge.memoizedState,baseState:Ge.baseState,baseQueue:Ge.baseQueue,queue:Ge.queue,next:null},Xe===null?Ce.memoizedState=Xe=t:Xe=Xe.next=t}return Xe}function fa(t,e){return typeof e=="function"?e(t):e}function Sd(t){var e=tn(),n=e.queue;if(n===null)throw Error(U(311));n.lastRenderedReducer=t;var r=Ge,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,c=null,u=i;do{var f=u.lane;if((_s&f)===f)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var m={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=m,o=r):c=c.next=m,Ce.lanes|=f,ws|=f}u=u.next}while(u!==null&&u!==i);c===null?o=r:c.next=l,mn(r,e.memoizedState)||(jt=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,Ce.lanes|=i,ws|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Id(t){var e=tn(),n=e.queue;if(n===null)throw Error(U(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);mn(i,e.memoizedState)||(jt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function R1(){}function N1(t,e){var n=Ce,r=tn(),s=e(),i=!mn(r.memoizedState,s);if(i&&(r.memoizedState=s,jt=!0),r=r.queue,ip(k1.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Xe!==null&&Xe.memoizedState.tag&1){if(n.flags|=2048,pa(9,P1.bind(null,n,r,s,e),void 0,null),et===null)throw Error(U(349));_s&30||A1(n,e,s)}return s}function A1(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Ce.updateQueue,e===null?(e={lastEffect:null,stores:null},Ce.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function P1(t,e,n,r){e.value=n,e.getSnapshot=r,b1(e)&&D1(t)}function k1(t,e,n){return n(function(){b1(e)&&D1(t)})}function b1(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!mn(t,n)}catch{return!0}}function D1(t){var e=qn(t,1);e!==null&&hn(e,t,1,-1)}function Jg(t){var e=_n();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:fa,lastRenderedState:t},e.queue=t,t=t.dispatch=AS.bind(null,Ce,t),[e.memoizedState,t]}function pa(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Ce.updateQueue,e===null?(e={lastEffect:null,stores:null},Ce.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function j1(){return tn().memoizedState}function ql(t,e,n,r){var s=_n();Ce.flags|=t,s.memoizedState=pa(1|e,n,void 0,r===void 0?null:r)}function hu(t,e,n,r){var s=tn();r=r===void 0?null:r;var i=void 0;if(Ge!==null){var o=Ge.memoizedState;if(i=o.destroy,r!==null&&np(r,o.deps)){s.memoizedState=pa(e,n,i,r);return}}Ce.flags|=t,s.memoizedState=pa(1|e,n,i,r)}function Xg(t,e){return ql(8390656,8,t,e)}function ip(t,e){return hu(2048,8,t,e)}function V1(t,e){return hu(4,2,t,e)}function O1(t,e){return hu(4,4,t,e)}function L1(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function M1(t,e,n){return n=n!=null?n.concat([t]):null,hu(4,4,L1.bind(null,e,t),n)}function op(){}function F1(t,e){var n=tn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&np(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function U1(t,e){var n=tn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&np(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function B1(t,e,n){return _s&21?(mn(n,e)||(n=W_(),Ce.lanes|=n,ws|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,jt=!0),t.memoizedState=n)}function RS(t,e){var n=me;me=n!==0&&4>n?n:4,t(!0);var r=Td.transition;Td.transition={};try{t(!1),e()}finally{me=n,Td.transition=r}}function z1(){return tn().memoizedState}function NS(t,e,n){var r=Cr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},$1(t))G1(e,n);else if(n=S1(t,e,n,r),n!==null){var s=It();hn(n,t,r,s),H1(n,e,r)}}function AS(t,e,n){var r=Cr(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if($1(t))G1(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,mn(l,o)){var c=e.interleaved;c===null?(s.next=s,Jf(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=S1(t,e,s,r),n!==null&&(s=It(),hn(n,t,r,s),H1(n,e,r))}}function $1(t){var e=t.alternate;return t===Ce||e!==null&&e===Ce}function G1(t,e){zo=Nc=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function H1(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Lf(t,n)}}var Ac={readContext:en,useCallback:pt,useContext:pt,useEffect:pt,useImperativeHandle:pt,useInsertionEffect:pt,useLayoutEffect:pt,useMemo:pt,useReducer:pt,useRef:pt,useState:pt,useDebugValue:pt,useDeferredValue:pt,useTransition:pt,useMutableSource:pt,useSyncExternalStore:pt,useId:pt,unstable_isNewReconciler:!1},PS={readContext:en,useCallback:function(t,e){return _n().memoizedState=[t,e===void 0?null:e],t},useContext:en,useEffect:Xg,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,ql(4194308,4,L1.bind(null,e,t),n)},useLayoutEffect:function(t,e){return ql(4194308,4,t,e)},useInsertionEffect:function(t,e){return ql(4,2,t,e)},useMemo:function(t,e){var n=_n();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=_n();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=NS.bind(null,Ce,t),[r.memoizedState,t]},useRef:function(t){var e=_n();return t={current:t},e.memoizedState=t},useState:Jg,useDebugValue:op,useDeferredValue:function(t){return _n().memoizedState=t},useTransition:function(){var t=Jg(!1),e=t[0];return t=RS.bind(null,t[1]),_n().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Ce,s=_n();if(Se){if(n===void 0)throw Error(U(407));n=n()}else{if(n=e(),et===null)throw Error(U(349));_s&30||A1(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,Xg(k1.bind(null,r,i,t),[t]),r.flags|=2048,pa(9,P1.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=_n(),e=et.identifierPrefix;if(Se){var n=Un,r=Fn;n=(r&~(1<<32-dn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=ha++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=CS++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},kS={readContext:en,useCallback:F1,useContext:en,useEffect:ip,useImperativeHandle:M1,useInsertionEffect:V1,useLayoutEffect:O1,useMemo:U1,useReducer:Sd,useRef:j1,useState:function(){return Sd(fa)},useDebugValue:op,useDeferredValue:function(t){var e=tn();return B1(e,Ge.memoizedState,t)},useTransition:function(){var t=Sd(fa)[0],e=tn().memoizedState;return[t,e]},useMutableSource:R1,useSyncExternalStore:N1,useId:z1,unstable_isNewReconciler:!1},bS={readContext:en,useCallback:F1,useContext:en,useEffect:ip,useImperativeHandle:M1,useInsertionEffect:V1,useLayoutEffect:O1,useMemo:U1,useReducer:Id,useRef:j1,useState:function(){return Id(fa)},useDebugValue:op,useDeferredValue:function(t){var e=tn();return Ge===null?e.memoizedState=t:B1(e,Ge.memoizedState,t)},useTransition:function(){var t=Id(fa)[0],e=tn().memoizedState;return[t,e]},useMutableSource:R1,useSyncExternalStore:N1,useId:z1,unstable_isNewReconciler:!1};function on(t,e){if(t&&t.defaultProps){e=Re({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Rh(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Re({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var fu={isMounted:function(t){return(t=t._reactInternals)?Rs(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=It(),s=Cr(t),i=$n(r,s);i.payload=e,n!=null&&(i.callback=n),e=Sr(t,i,s),e!==null&&(hn(e,t,s,r),Hl(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=It(),s=Cr(t),i=$n(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Sr(t,i,s),e!==null&&(hn(e,t,s,r),Hl(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=It(),r=Cr(t),s=$n(n,r);s.tag=2,e!=null&&(s.callback=e),e=Sr(t,s,r),e!==null&&(hn(e,t,r,n),Hl(e,t,r))}};function Zg(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!oa(n,r)||!oa(s,i):!0}function W1(t,e,n){var r=!1,s=Vr,i=e.contextType;return typeof i=="object"&&i!==null?i=en(i):(s=Ot(e)?ys:wt.current,r=e.contextTypes,i=(r=r!=null)?vi(t,s):Vr),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=fu,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function ey(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&fu.enqueueReplaceState(e,e.state,null)}function Nh(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Xf(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=en(i):(i=Ot(e)?ys:wt.current,s.context=vi(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Rh(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&fu.enqueueReplaceState(s,s.state,null),Cc(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function xi(t,e){try{var n="",r=e;do n+=oT(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Cd(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Ah(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var DS=typeof WeakMap=="function"?WeakMap:Map;function q1(t,e,n){n=$n(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){kc||(kc=!0,Fh=r),Ah(t,e)},n}function K1(t,e,n){n=$n(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Ah(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Ah(t,e),typeof r!="function"&&(Ir===null?Ir=new Set([this]):Ir.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function ty(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new DS;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=qS.bind(null,t,e,n),e.then(t,t))}function ny(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function ry(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=$n(-1,1),e.tag=2,Sr(n,e,1))),n.lanes|=1),t)}var jS=Zn.ReactCurrentOwner,jt=!1;function Tt(t,e,n,r){e.child=t===null?T1(e,null,n,r):wi(e,t.child,n,r)}function sy(t,e,n,r,s){n=n.render;var i=e.ref;return di(e,s),r=rp(t,e,n,r,i,s),n=sp(),t!==null&&!jt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Kn(t,e,s)):(Se&&n&&Hf(e),e.flags|=1,Tt(t,e,r,s),e.child)}function iy(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!pp(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,Q1(t,e,i,r,s)):(t=Jl(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:oa,n(o,r)&&t.ref===e.ref)return Kn(t,e,s)}return e.flags|=1,t=Rr(i,r),t.ref=e.ref,t.return=e,e.child=t}function Q1(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(oa(i,r)&&t.ref===e.ref)if(jt=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(jt=!0);else return e.lanes=t.lanes,Kn(t,e,s)}return Ph(t,e,n,r,s)}function Y1(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ve(oi,Ut),Ut|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ve(oi,Ut),Ut|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,ve(oi,Ut),Ut|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,ve(oi,Ut),Ut|=r;return Tt(t,e,s,n),e.child}function J1(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Ph(t,e,n,r,s){var i=Ot(n)?ys:wt.current;return i=vi(e,i),di(e,s),n=rp(t,e,n,r,i,s),r=sp(),t!==null&&!jt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Kn(t,e,s)):(Se&&r&&Hf(e),e.flags|=1,Tt(t,e,n,s),e.child)}function oy(t,e,n,r,s){if(Ot(n)){var i=!0;Ec(e)}else i=!1;if(di(e,s),e.stateNode===null)Kl(t,e),W1(e,n,r),Nh(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=en(u):(u=Ot(n)?ys:wt.current,u=vi(e,u));var f=n.getDerivedStateFromProps,m=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==u)&&ey(e,o,r,u),cr=!1;var g=e.memoizedState;o.state=g,Cc(e,r,o,s),c=e.memoizedState,l!==r||g!==c||Vt.current||cr?(typeof f=="function"&&(Rh(e,n,f,r),c=e.memoizedState),(l=cr||Zg(e,n,l,r,g,c,u))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=u,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,I1(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:on(e.type,l),o.props=u,m=e.pendingProps,g=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=en(c):(c=Ot(n)?ys:wt.current,c=vi(e,c));var w=n.getDerivedStateFromProps;(f=typeof w=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==m||g!==c)&&ey(e,o,r,c),cr=!1,g=e.memoizedState,o.state=g,Cc(e,r,o,s);var R=e.memoizedState;l!==m||g!==R||Vt.current||cr?(typeof w=="function"&&(Rh(e,n,w,r),R=e.memoizedState),(u=cr||Zg(e,n,u,r,g,R,c)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,R,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,R,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=R),o.props=r,o.state=R,o.context=c,r=u):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),r=!1)}return kh(t,e,n,r,i,s)}function kh(t,e,n,r,s,i){J1(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&Hg(e,n,!1),Kn(t,e,i);r=e.stateNode,jS.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=wi(e,t.child,null,i),e.child=wi(e,null,l,i)):Tt(t,e,l,i),e.memoizedState=r.state,s&&Hg(e,n,!0),e.child}function X1(t){var e=t.stateNode;e.pendingContext?Gg(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Gg(t,e.context,!1),Zf(t,e.containerInfo)}function ay(t,e,n,r,s){return _i(),qf(s),e.flags|=256,Tt(t,e,n,r),e.child}var bh={dehydrated:null,treeContext:null,retryLane:0};function Dh(t){return{baseLanes:t,cachePool:null,transitions:null}}function Z1(t,e,n){var r=e.pendingProps,s=Ie.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),ve(Ie,s&1),t===null)return Ih(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=gu(o,r,0,null),t=fs(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Dh(n),e.memoizedState=bh,t):ap(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return VS(t,e,o,r,l,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=Rr(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Rr(l,i):(i=fs(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?Dh(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=bh,r}return i=t.child,t=i.sibling,r=Rr(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function ap(t,e){return e=gu({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Nl(t,e,n,r){return r!==null&&qf(r),wi(e,t.child,null,n),t=ap(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function VS(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=Cd(Error(U(422))),Nl(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=gu({mode:"visible",children:r.children},s,0,null),i=fs(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&wi(e,t.child,null,o),e.child.memoizedState=Dh(o),e.memoizedState=bh,i);if(!(e.mode&1))return Nl(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(U(419)),r=Cd(i,r,void 0),Nl(t,e,o,r)}if(l=(o&t.childLanes)!==0,jt||l){if(r=et,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,qn(t,s),hn(r,t,s,-1))}return fp(),r=Cd(Error(U(421))),Nl(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=KS.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,$t=Tr(s.nextSibling),Ht=e,Se=!0,ln=null,t!==null&&(Qt[Yt++]=Fn,Qt[Yt++]=Un,Qt[Yt++]=vs,Fn=t.id,Un=t.overflow,vs=e),e=ap(e,r.children),e.flags|=4096,e)}function ly(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Ch(t.return,e,n)}function Rd(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function e0(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Tt(t,e,r.children,n),r=Ie.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&ly(t,n,e);else if(t.tag===19)ly(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ve(Ie,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Rc(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Rd(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Rc(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Rd(e,!0,n,null,i);break;case"together":Rd(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Kl(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Kn(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ws|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(U(153));if(e.child!==null){for(t=e.child,n=Rr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Rr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function OS(t,e,n){switch(e.tag){case 3:X1(e),_i();break;case 5:C1(e);break;case 1:Ot(e.type)&&Ec(e);break;case 4:Zf(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;ve(Sc,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ve(Ie,Ie.current&1),e.flags|=128,null):n&e.child.childLanes?Z1(t,e,n):(ve(Ie,Ie.current&1),t=Kn(t,e,n),t!==null?t.sibling:null);ve(Ie,Ie.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return e0(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ve(Ie,Ie.current),r)break;return null;case 22:case 23:return e.lanes=0,Y1(t,e,n)}return Kn(t,e,n)}var t0,jh,n0,r0;t0=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};jh=function(){};n0=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,cs(Sn.current);var i=null;switch(n){case"input":s=nh(t,s),r=nh(t,r),i=[];break;case"select":s=Re({},s,{value:void 0}),r=Re({},r,{value:void 0}),i=[];break;case"textarea":s=ih(t,s),r=ih(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=_c)}ah(n,r);var o;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Zo.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var c=r[u];if(l=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Zo.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Ee("scroll",t),i||l===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};r0=function(t,e,n,r){n!==r&&(e.flags|=4)};function So(t,e){if(!Se)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function mt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function LS(t,e,n){var r=e.pendingProps;switch(Wf(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return mt(e),null;case 1:return Ot(e.type)&&wc(),mt(e),null;case 3:return r=e.stateNode,Ei(),xe(Vt),xe(wt),tp(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Cl(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ln!==null&&(zh(ln),ln=null))),jh(t,e),mt(e),null;case 5:ep(e);var s=cs(da.current);if(n=e.type,t!==null&&e.stateNode!=null)n0(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(U(166));return mt(e),null}if(t=cs(Sn.current),Cl(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[En]=e,r[ca]=i,t=(e.mode&1)!==0,n){case"dialog":Ee("cancel",r),Ee("close",r);break;case"iframe":case"object":case"embed":Ee("load",r);break;case"video":case"audio":for(s=0;s<bo.length;s++)Ee(bo[s],r);break;case"source":Ee("error",r);break;case"img":case"image":case"link":Ee("error",r),Ee("load",r);break;case"details":Ee("toggle",r);break;case"input":yg(r,i),Ee("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ee("invalid",r);break;case"textarea":_g(r,i),Ee("invalid",r)}ah(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&Il(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Il(r.textContent,l,t),s=["children",""+l]):Zo.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Ee("scroll",r)}switch(n){case"input":yl(r),vg(r,i,!0);break;case"textarea":yl(r),wg(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=_c)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=k_(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[En]=e,t[ca]=r,t0(t,e,!1,!1),e.stateNode=t;e:{switch(o=lh(n,r),n){case"dialog":Ee("cancel",t),Ee("close",t),s=r;break;case"iframe":case"object":case"embed":Ee("load",t),s=r;break;case"video":case"audio":for(s=0;s<bo.length;s++)Ee(bo[s],t);s=r;break;case"source":Ee("error",t),s=r;break;case"img":case"image":case"link":Ee("error",t),Ee("load",t),s=r;break;case"details":Ee("toggle",t),s=r;break;case"input":yg(t,r),s=nh(t,r),Ee("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Re({},r,{value:void 0}),Ee("invalid",t);break;case"textarea":_g(t,r),s=ih(t,r),Ee("invalid",t);break;default:s=r}ah(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?j_(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&b_(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&ea(t,c):typeof c=="number"&&ea(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Zo.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Ee("scroll",t):c!=null&&kf(t,i,c,o))}switch(n){case"input":yl(t),vg(t,r,!1);break;case"textarea":yl(t),wg(t);break;case"option":r.value!=null&&t.setAttribute("value",""+jr(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?ai(t,!!r.multiple,i,!1):r.defaultValue!=null&&ai(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=_c)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return mt(e),null;case 6:if(t&&e.stateNode!=null)r0(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(U(166));if(n=cs(da.current),cs(Sn.current),Cl(e)){if(r=e.stateNode,n=e.memoizedProps,r[En]=e,(i=r.nodeValue!==n)&&(t=Ht,t!==null))switch(t.tag){case 3:Il(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Il(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[En]=e,e.stateNode=r}return mt(e),null;case 13:if(xe(Ie),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Se&&$t!==null&&e.mode&1&&!(e.flags&128))E1(),_i(),e.flags|=98560,i=!1;else if(i=Cl(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(U(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(U(317));i[En]=e}else _i(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;mt(e),i=!1}else ln!==null&&(zh(ln),ln=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Ie.current&1?He===0&&(He=3):fp())),e.updateQueue!==null&&(e.flags|=4),mt(e),null);case 4:return Ei(),jh(t,e),t===null&&aa(e.stateNode.containerInfo),mt(e),null;case 10:return Yf(e.type._context),mt(e),null;case 17:return Ot(e.type)&&wc(),mt(e),null;case 19:if(xe(Ie),i=e.memoizedState,i===null)return mt(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)So(i,!1);else{if(He!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Rc(t),o!==null){for(e.flags|=128,So(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ve(Ie,Ie.current&1|2),e.child}t=t.sibling}i.tail!==null&&Le()>Ti&&(e.flags|=128,r=!0,So(i,!1),e.lanes=4194304)}else{if(!r)if(t=Rc(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),So(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Se)return mt(e),null}else 2*Le()-i.renderingStartTime>Ti&&n!==1073741824&&(e.flags|=128,r=!0,So(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Le(),e.sibling=null,n=Ie.current,ve(Ie,r?n&1|2:n&1),e):(mt(e),null);case 22:case 23:return hp(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Ut&1073741824&&(mt(e),e.subtreeFlags&6&&(e.flags|=8192)):mt(e),null;case 24:return null;case 25:return null}throw Error(U(156,e.tag))}function MS(t,e){switch(Wf(e),e.tag){case 1:return Ot(e.type)&&wc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ei(),xe(Vt),xe(wt),tp(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return ep(e),null;case 13:if(xe(Ie),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(U(340));_i()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return xe(Ie),null;case 4:return Ei(),null;case 10:return Yf(e.type._context),null;case 22:case 23:return hp(),null;case 24:return null;default:return null}}var Al=!1,vt=!1,FS=typeof WeakSet=="function"?WeakSet:Set,Q=null;function ii(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Pe(t,e,r)}else n.current=null}function Vh(t,e,n){try{n()}catch(r){Pe(t,e,r)}}var cy=!1;function US(t,e){if(vh=gc,t=l1(),Gf(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,u=0,f=0,m=t,g=null;t:for(;;){for(var w;m!==n||s!==0&&m.nodeType!==3||(l=o+s),m!==i||r!==0&&m.nodeType!==3||(c=o+r),m.nodeType===3&&(o+=m.nodeValue.length),(w=m.firstChild)!==null;)g=m,m=w;for(;;){if(m===t)break t;if(g===n&&++u===s&&(l=o),g===i&&++f===r&&(c=o),(w=m.nextSibling)!==null)break;m=g,g=m.parentNode}m=w}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(_h={focusedElem:t,selectionRange:n},gc=!1,Q=e;Q!==null;)if(e=Q,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Q=t;else for(;Q!==null;){e=Q;try{var R=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(R!==null){var N=R.memoizedProps,P=R.memoizedState,x=e.stateNode,v=x.getSnapshotBeforeUpdate(e.elementType===e.type?N:on(e.type,N),P);x.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(U(163))}}catch(D){Pe(e,e.return,D)}if(t=e.sibling,t!==null){t.return=e.return,Q=t;break}Q=e.return}return R=cy,cy=!1,R}function $o(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Vh(e,n,i)}s=s.next}while(s!==r)}}function pu(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Oh(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function s0(t){var e=t.alternate;e!==null&&(t.alternate=null,s0(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[En],delete e[ca],delete e[xh],delete e[xS],delete e[TS])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function i0(t){return t.tag===5||t.tag===3||t.tag===4}function uy(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||i0(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Lh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=_c));else if(r!==4&&(t=t.child,t!==null))for(Lh(t,e,n),t=t.sibling;t!==null;)Lh(t,e,n),t=t.sibling}function Mh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Mh(t,e,n),t=t.sibling;t!==null;)Mh(t,e,n),t=t.sibling}var it=null,an=!1;function or(t,e,n){for(n=n.child;n!==null;)o0(t,e,n),n=n.sibling}function o0(t,e,n){if(Tn&&typeof Tn.onCommitFiberUnmount=="function")try{Tn.onCommitFiberUnmount(ou,n)}catch{}switch(n.tag){case 5:vt||ii(n,e);case 6:var r=it,s=an;it=null,or(t,e,n),it=r,an=s,it!==null&&(an?(t=it,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):it.removeChild(n.stateNode));break;case 18:it!==null&&(an?(t=it,n=n.stateNode,t.nodeType===8?wd(t.parentNode,n):t.nodeType===1&&wd(t,n),sa(t)):wd(it,n.stateNode));break;case 4:r=it,s=an,it=n.stateNode.containerInfo,an=!0,or(t,e,n),it=r,an=s;break;case 0:case 11:case 14:case 15:if(!vt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Vh(n,e,o),s=s.next}while(s!==r)}or(t,e,n);break;case 1:if(!vt&&(ii(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Pe(n,e,l)}or(t,e,n);break;case 21:or(t,e,n);break;case 22:n.mode&1?(vt=(r=vt)||n.memoizedState!==null,or(t,e,n),vt=r):or(t,e,n);break;default:or(t,e,n)}}function dy(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new FS),e.forEach(function(r){var s=QS.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function rn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:it=l.stateNode,an=!1;break e;case 3:it=l.stateNode.containerInfo,an=!0;break e;case 4:it=l.stateNode.containerInfo,an=!0;break e}l=l.return}if(it===null)throw Error(U(160));o0(i,o,s),it=null,an=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){Pe(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)a0(e,t),e=e.sibling}function a0(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(rn(e,t),vn(t),r&4){try{$o(3,t,t.return),pu(3,t)}catch(N){Pe(t,t.return,N)}try{$o(5,t,t.return)}catch(N){Pe(t,t.return,N)}}break;case 1:rn(e,t),vn(t),r&512&&n!==null&&ii(n,n.return);break;case 5:if(rn(e,t),vn(t),r&512&&n!==null&&ii(n,n.return),t.flags&32){var s=t.stateNode;try{ea(s,"")}catch(N){Pe(t,t.return,N)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&A_(s,i),lh(l,o);var u=lh(l,i);for(o=0;o<c.length;o+=2){var f=c[o],m=c[o+1];f==="style"?j_(s,m):f==="dangerouslySetInnerHTML"?b_(s,m):f==="children"?ea(s,m):kf(s,f,m,u)}switch(l){case"input":rh(s,i);break;case"textarea":P_(s,i);break;case"select":var g=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var w=i.value;w!=null?ai(s,!!i.multiple,w,!1):g!==!!i.multiple&&(i.defaultValue!=null?ai(s,!!i.multiple,i.defaultValue,!0):ai(s,!!i.multiple,i.multiple?[]:"",!1))}s[ca]=i}catch(N){Pe(t,t.return,N)}}break;case 6:if(rn(e,t),vn(t),r&4){if(t.stateNode===null)throw Error(U(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(N){Pe(t,t.return,N)}}break;case 3:if(rn(e,t),vn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{sa(e.containerInfo)}catch(N){Pe(t,t.return,N)}break;case 4:rn(e,t),vn(t);break;case 13:rn(e,t),vn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(up=Le())),r&4&&dy(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(vt=(u=vt)||f,rn(e,t),vt=u):rn(e,t),vn(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!f&&t.mode&1)for(Q=t,f=t.child;f!==null;){for(m=Q=f;Q!==null;){switch(g=Q,w=g.child,g.tag){case 0:case 11:case 14:case 15:$o(4,g,g.return);break;case 1:ii(g,g.return);var R=g.stateNode;if(typeof R.componentWillUnmount=="function"){r=g,n=g.return;try{e=r,R.props=e.memoizedProps,R.state=e.memoizedState,R.componentWillUnmount()}catch(N){Pe(r,n,N)}}break;case 5:ii(g,g.return);break;case 22:if(g.memoizedState!==null){fy(m);continue}}w!==null?(w.return=g,Q=w):fy(m)}f=f.sibling}e:for(f=null,m=t;;){if(m.tag===5){if(f===null){f=m;try{s=m.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=m.stateNode,c=m.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=D_("display",o))}catch(N){Pe(t,t.return,N)}}}else if(m.tag===6){if(f===null)try{m.stateNode.nodeValue=u?"":m.memoizedProps}catch(N){Pe(t,t.return,N)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;f===m&&(f=null),m=m.return}f===m&&(f=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:rn(e,t),vn(t),r&4&&dy(t);break;case 21:break;default:rn(e,t),vn(t)}}function vn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(i0(n)){var r=n;break e}n=n.return}throw Error(U(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(ea(s,""),r.flags&=-33);var i=uy(t);Mh(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=uy(t);Lh(t,l,o);break;default:throw Error(U(161))}}catch(c){Pe(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function BS(t,e,n){Q=t,l0(t)}function l0(t,e,n){for(var r=(t.mode&1)!==0;Q!==null;){var s=Q,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Al;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||vt;l=Al;var u=vt;if(Al=o,(vt=c)&&!u)for(Q=s;Q!==null;)o=Q,c=o.child,o.tag===22&&o.memoizedState!==null?py(s):c!==null?(c.return=o,Q=c):py(s);for(;i!==null;)Q=i,l0(i),i=i.sibling;Q=s,Al=l,vt=u}hy(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Q=i):hy(t)}}function hy(t){for(;Q!==null;){var e=Q;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:vt||pu(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!vt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:on(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Yg(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Yg(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var m=f.dehydrated;m!==null&&sa(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(U(163))}vt||e.flags&512&&Oh(e)}catch(g){Pe(e,e.return,g)}}if(e===t){Q=null;break}if(n=e.sibling,n!==null){n.return=e.return,Q=n;break}Q=e.return}}function fy(t){for(;Q!==null;){var e=Q;if(e===t){Q=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Q=n;break}Q=e.return}}function py(t){for(;Q!==null;){var e=Q;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{pu(4,e)}catch(c){Pe(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){Pe(e,s,c)}}var i=e.return;try{Oh(e)}catch(c){Pe(e,i,c)}break;case 5:var o=e.return;try{Oh(e)}catch(c){Pe(e,o,c)}}}catch(c){Pe(e,e.return,c)}if(e===t){Q=null;break}var l=e.sibling;if(l!==null){l.return=e.return,Q=l;break}Q=e.return}}var zS=Math.ceil,Pc=Zn.ReactCurrentDispatcher,lp=Zn.ReactCurrentOwner,Zt=Zn.ReactCurrentBatchConfig,he=0,et=null,Ue=null,ct=0,Ut=0,oi=Gr(0),He=0,ma=null,ws=0,mu=0,cp=0,Go=null,bt=null,up=0,Ti=1/0,On=null,kc=!1,Fh=null,Ir=null,Pl=!1,gr=null,bc=0,Ho=0,Uh=null,Ql=-1,Yl=0;function It(){return he&6?Le():Ql!==-1?Ql:Ql=Le()}function Cr(t){return t.mode&1?he&2&&ct!==0?ct&-ct:IS.transition!==null?(Yl===0&&(Yl=W_()),Yl):(t=me,t!==0||(t=window.event,t=t===void 0?16:Z_(t.type)),t):1}function hn(t,e,n,r){if(50<Ho)throw Ho=0,Uh=null,Error(U(185));ka(t,n,r),(!(he&2)||t!==et)&&(t===et&&(!(he&2)&&(mu|=n),He===4&&dr(t,ct)),Lt(t,r),n===1&&he===0&&!(e.mode&1)&&(Ti=Le()+500,du&&Hr()))}function Lt(t,e){var n=t.callbackNode;IT(t,e);var r=mc(t,t===et?ct:0);if(r===0)n!==null&&Tg(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Tg(n),e===1)t.tag===0?SS(my.bind(null,t)):v1(my.bind(null,t)),wS(function(){!(he&6)&&Hr()}),n=null;else{switch(q_(r)){case 1:n=Of;break;case 4:n=G_;break;case 16:n=pc;break;case 536870912:n=H_;break;default:n=pc}n=g0(n,c0.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function c0(t,e){if(Ql=-1,Yl=0,he&6)throw Error(U(327));var n=t.callbackNode;if(hi()&&t.callbackNode!==n)return null;var r=mc(t,t===et?ct:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Dc(t,r);else{e=r;var s=he;he|=2;var i=d0();(et!==t||ct!==e)&&(On=null,Ti=Le()+500,hs(t,e));do try{HS();break}catch(l){u0(t,l)}while(1);Qf(),Pc.current=i,he=s,Ue!==null?e=0:(et=null,ct=0,e=He)}if(e!==0){if(e===2&&(s=fh(t),s!==0&&(r=s,e=Bh(t,s))),e===1)throw n=ma,hs(t,0),dr(t,r),Lt(t,Le()),n;if(e===6)dr(t,r);else{if(s=t.current.alternate,!(r&30)&&!$S(s)&&(e=Dc(t,r),e===2&&(i=fh(t),i!==0&&(r=i,e=Bh(t,i))),e===1))throw n=ma,hs(t,0),dr(t,r),Lt(t,Le()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(U(345));case 2:ss(t,bt,On);break;case 3:if(dr(t,r),(r&130023424)===r&&(e=up+500-Le(),10<e)){if(mc(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){It(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Eh(ss.bind(null,t,bt,On),e);break}ss(t,bt,On);break;case 4:if(dr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-dn(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Le()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*zS(r/1960))-r,10<r){t.timeoutHandle=Eh(ss.bind(null,t,bt,On),r);break}ss(t,bt,On);break;case 5:ss(t,bt,On);break;default:throw Error(U(329))}}}return Lt(t,Le()),t.callbackNode===n?c0.bind(null,t):null}function Bh(t,e){var n=Go;return t.current.memoizedState.isDehydrated&&(hs(t,e).flags|=256),t=Dc(t,e),t!==2&&(e=bt,bt=n,e!==null&&zh(e)),t}function zh(t){bt===null?bt=t:bt.push.apply(bt,t)}function $S(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!mn(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function dr(t,e){for(e&=~cp,e&=~mu,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-dn(e),r=1<<n;t[n]=-1,e&=~r}}function my(t){if(he&6)throw Error(U(327));hi();var e=mc(t,0);if(!(e&1))return Lt(t,Le()),null;var n=Dc(t,e);if(t.tag!==0&&n===2){var r=fh(t);r!==0&&(e=r,n=Bh(t,r))}if(n===1)throw n=ma,hs(t,0),dr(t,e),Lt(t,Le()),n;if(n===6)throw Error(U(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ss(t,bt,On),Lt(t,Le()),null}function dp(t,e){var n=he;he|=1;try{return t(e)}finally{he=n,he===0&&(Ti=Le()+500,du&&Hr())}}function Es(t){gr!==null&&gr.tag===0&&!(he&6)&&hi();var e=he;he|=1;var n=Zt.transition,r=me;try{if(Zt.transition=null,me=1,t)return t()}finally{me=r,Zt.transition=n,he=e,!(he&6)&&Hr()}}function hp(){Ut=oi.current,xe(oi)}function hs(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,_S(n)),Ue!==null)for(n=Ue.return;n!==null;){var r=n;switch(Wf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&wc();break;case 3:Ei(),xe(Vt),xe(wt),tp();break;case 5:ep(r);break;case 4:Ei();break;case 13:xe(Ie);break;case 19:xe(Ie);break;case 10:Yf(r.type._context);break;case 22:case 23:hp()}n=n.return}if(et=t,Ue=t=Rr(t.current,null),ct=Ut=e,He=0,ma=null,cp=mu=ws=0,bt=Go=null,ls!==null){for(e=0;e<ls.length;e++)if(n=ls[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}ls=null}return t}function u0(t,e){do{var n=Ue;try{if(Qf(),Wl.current=Ac,Nc){for(var r=Ce.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Nc=!1}if(_s=0,Xe=Ge=Ce=null,zo=!1,ha=0,lp.current=null,n===null||n.return===null){He=1,ma=e,Ue=null;break}e:{var i=t,o=n.return,l=n,c=e;if(e=ct,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,f=l,m=f.tag;if(!(f.mode&1)&&(m===0||m===11||m===15)){var g=f.alternate;g?(f.updateQueue=g.updateQueue,f.memoizedState=g.memoizedState,f.lanes=g.lanes):(f.updateQueue=null,f.memoizedState=null)}var w=ny(o);if(w!==null){w.flags&=-257,ry(w,o,l,i,e),w.mode&1&&ty(i,u,e),e=w,c=u;var R=e.updateQueue;if(R===null){var N=new Set;N.add(c),e.updateQueue=N}else R.add(c);break e}else{if(!(e&1)){ty(i,u,e),fp();break e}c=Error(U(426))}}else if(Se&&l.mode&1){var P=ny(o);if(P!==null){!(P.flags&65536)&&(P.flags|=256),ry(P,o,l,i,e),qf(xi(c,l));break e}}i=c=xi(c,l),He!==4&&(He=2),Go===null?Go=[i]:Go.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var x=q1(i,c,e);Qg(i,x);break e;case 1:l=c;var v=i.type,S=i.stateNode;if(!(i.flags&128)&&(typeof v.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(Ir===null||!Ir.has(S)))){i.flags|=65536,e&=-e,i.lanes|=e;var D=K1(i,l,e);Qg(i,D);break e}}i=i.return}while(i!==null)}f0(n)}catch(F){e=F,Ue===n&&n!==null&&(Ue=n=n.return);continue}break}while(1)}function d0(){var t=Pc.current;return Pc.current=Ac,t===null?Ac:t}function fp(){(He===0||He===3||He===2)&&(He=4),et===null||!(ws&268435455)&&!(mu&268435455)||dr(et,ct)}function Dc(t,e){var n=he;he|=2;var r=d0();(et!==t||ct!==e)&&(On=null,hs(t,e));do try{GS();break}catch(s){u0(t,s)}while(1);if(Qf(),he=n,Pc.current=r,Ue!==null)throw Error(U(261));return et=null,ct=0,He}function GS(){for(;Ue!==null;)h0(Ue)}function HS(){for(;Ue!==null&&!gT();)h0(Ue)}function h0(t){var e=m0(t.alternate,t,Ut);t.memoizedProps=t.pendingProps,e===null?f0(t):Ue=e,lp.current=null}function f0(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=MS(n,e),n!==null){n.flags&=32767,Ue=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{He=6,Ue=null;return}}else if(n=LS(n,e,Ut),n!==null){Ue=n;return}if(e=e.sibling,e!==null){Ue=e;return}Ue=e=t}while(e!==null);He===0&&(He=5)}function ss(t,e,n){var r=me,s=Zt.transition;try{Zt.transition=null,me=1,WS(t,e,n,r)}finally{Zt.transition=s,me=r}return null}function WS(t,e,n,r){do hi();while(gr!==null);if(he&6)throw Error(U(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(U(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(CT(t,i),t===et&&(Ue=et=null,ct=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Pl||(Pl=!0,g0(pc,function(){return hi(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Zt.transition,Zt.transition=null;var o=me;me=1;var l=he;he|=4,lp.current=null,US(t,n),a0(n,t),hS(_h),gc=!!vh,_h=vh=null,t.current=n,BS(n),yT(),he=l,me=o,Zt.transition=i}else t.current=n;if(Pl&&(Pl=!1,gr=t,bc=s),i=t.pendingLanes,i===0&&(Ir=null),wT(n.stateNode),Lt(t,Le()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(kc)throw kc=!1,t=Fh,Fh=null,t;return bc&1&&t.tag!==0&&hi(),i=t.pendingLanes,i&1?t===Uh?Ho++:(Ho=0,Uh=t):Ho=0,Hr(),null}function hi(){if(gr!==null){var t=q_(bc),e=Zt.transition,n=me;try{if(Zt.transition=null,me=16>t?16:t,gr===null)var r=!1;else{if(t=gr,gr=null,bc=0,he&6)throw Error(U(331));var s=he;for(he|=4,Q=t.current;Q!==null;){var i=Q,o=i.child;if(Q.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(Q=u;Q!==null;){var f=Q;switch(f.tag){case 0:case 11:case 15:$o(8,f,i)}var m=f.child;if(m!==null)m.return=f,Q=m;else for(;Q!==null;){f=Q;var g=f.sibling,w=f.return;if(s0(f),f===u){Q=null;break}if(g!==null){g.return=w,Q=g;break}Q=w}}}var R=i.alternate;if(R!==null){var N=R.child;if(N!==null){R.child=null;do{var P=N.sibling;N.sibling=null,N=P}while(N!==null)}}Q=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Q=o;else e:for(;Q!==null;){if(i=Q,i.flags&2048)switch(i.tag){case 0:case 11:case 15:$o(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,Q=x;break e}Q=i.return}}var v=t.current;for(Q=v;Q!==null;){o=Q;var S=o.child;if(o.subtreeFlags&2064&&S!==null)S.return=o,Q=S;else e:for(o=v;Q!==null;){if(l=Q,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:pu(9,l)}}catch(F){Pe(l,l.return,F)}if(l===o){Q=null;break e}var D=l.sibling;if(D!==null){D.return=l.return,Q=D;break e}Q=l.return}}if(he=s,Hr(),Tn&&typeof Tn.onPostCommitFiberRoot=="function")try{Tn.onPostCommitFiberRoot(ou,t)}catch{}r=!0}return r}finally{me=n,Zt.transition=e}}return!1}function gy(t,e,n){e=xi(n,e),e=q1(t,e,1),t=Sr(t,e,1),e=It(),t!==null&&(ka(t,1,e),Lt(t,e))}function Pe(t,e,n){if(t.tag===3)gy(t,t,n);else for(;e!==null;){if(e.tag===3){gy(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ir===null||!Ir.has(r))){t=xi(n,t),t=K1(e,t,1),e=Sr(e,t,1),t=It(),e!==null&&(ka(e,1,t),Lt(e,t));break}}e=e.return}}function qS(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=It(),t.pingedLanes|=t.suspendedLanes&n,et===t&&(ct&n)===n&&(He===4||He===3&&(ct&130023424)===ct&&500>Le()-up?hs(t,0):cp|=n),Lt(t,e)}function p0(t,e){e===0&&(t.mode&1?(e=wl,wl<<=1,!(wl&130023424)&&(wl=4194304)):e=1);var n=It();t=qn(t,e),t!==null&&(ka(t,e,n),Lt(t,n))}function KS(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),p0(t,n)}function QS(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(U(314))}r!==null&&r.delete(e),p0(t,n)}var m0;m0=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Vt.current)jt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return jt=!1,OS(t,e,n);jt=!!(t.flags&131072)}else jt=!1,Se&&e.flags&1048576&&_1(e,Tc,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Kl(t,e),t=e.pendingProps;var s=vi(e,wt.current);di(e,n),s=rp(null,e,r,t,s,n);var i=sp();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ot(r)?(i=!0,Ec(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Xf(e),s.updater=fu,e.stateNode=s,s._reactInternals=e,Nh(e,r,t,n),e=kh(null,e,r,!0,i,n)):(e.tag=0,Se&&i&&Hf(e),Tt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Kl(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=JS(r),t=on(r,t),s){case 0:e=Ph(null,e,r,t,n);break e;case 1:e=oy(null,e,r,t,n);break e;case 11:e=sy(null,e,r,t,n);break e;case 14:e=iy(null,e,r,on(r.type,t),n);break e}throw Error(U(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:on(r,s),Ph(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:on(r,s),oy(t,e,r,s,n);case 3:e:{if(X1(e),t===null)throw Error(U(387));r=e.pendingProps,i=e.memoizedState,s=i.element,I1(t,e),Cc(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=xi(Error(U(423)),e),e=ay(t,e,r,n,s);break e}else if(r!==s){s=xi(Error(U(424)),e),e=ay(t,e,r,n,s);break e}else for($t=Tr(e.stateNode.containerInfo.firstChild),Ht=e,Se=!0,ln=null,n=T1(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(_i(),r===s){e=Kn(t,e,n);break e}Tt(t,e,r,n)}e=e.child}return e;case 5:return C1(e),t===null&&Ih(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,wh(r,s)?o=null:i!==null&&wh(r,i)&&(e.flags|=32),J1(t,e),Tt(t,e,o,n),e.child;case 6:return t===null&&Ih(e),null;case 13:return Z1(t,e,n);case 4:return Zf(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=wi(e,null,r,n):Tt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:on(r,s),sy(t,e,r,s,n);case 7:return Tt(t,e,e.pendingProps,n),e.child;case 8:return Tt(t,e,e.pendingProps.children,n),e.child;case 12:return Tt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,ve(Sc,r._currentValue),r._currentValue=o,i!==null)if(mn(i.value,o)){if(i.children===s.children&&!Vt.current){e=Kn(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=$n(-1,n&-n),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?c.next=c:(c.next=f.next,f.next=c),u.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),Ch(i.return,n,e),l.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(U(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),Ch(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Tt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,di(e,n),s=en(s),r=r(s),e.flags|=1,Tt(t,e,r,n),e.child;case 14:return r=e.type,s=on(r,e.pendingProps),s=on(r.type,s),iy(t,e,r,s,n);case 15:return Q1(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:on(r,s),Kl(t,e),e.tag=1,Ot(r)?(t=!0,Ec(e)):t=!1,di(e,n),W1(e,r,s),Nh(e,r,s,n),kh(null,e,r,!0,t,n);case 19:return e0(t,e,n);case 22:return Y1(t,e,n)}throw Error(U(156,e.tag))};function g0(t,e){return $_(t,e)}function YS(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Xt(t,e,n,r){return new YS(t,e,n,r)}function pp(t){return t=t.prototype,!(!t||!t.isReactComponent)}function JS(t){if(typeof t=="function")return pp(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Df)return 11;if(t===jf)return 14}return 2}function Rr(t,e){var n=t.alternate;return n===null?(n=Xt(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Jl(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")pp(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Ys:return fs(n.children,s,i,e);case bf:o=8,s|=8;break;case Xd:return t=Xt(12,n,e,s|2),t.elementType=Xd,t.lanes=i,t;case Zd:return t=Xt(13,n,e,s),t.elementType=Zd,t.lanes=i,t;case eh:return t=Xt(19,n,e,s),t.elementType=eh,t.lanes=i,t;case C_:return gu(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case S_:o=10;break e;case I_:o=9;break e;case Df:o=11;break e;case jf:o=14;break e;case lr:o=16,r=null;break e}throw Error(U(130,t==null?t:typeof t,""))}return e=Xt(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function fs(t,e,n,r){return t=Xt(7,t,r,e),t.lanes=n,t}function gu(t,e,n,r){return t=Xt(22,t,r,e),t.elementType=C_,t.lanes=n,t.stateNode={isHidden:!1},t}function Nd(t,e,n){return t=Xt(6,t,null,e),t.lanes=n,t}function Ad(t,e,n){return e=Xt(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function XS(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=cd(0),this.expirationTimes=cd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=cd(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function mp(t,e,n,r,s,i,o,l,c){return t=new XS(t,e,n,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Xt(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Xf(i),t}function ZS(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Qs,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function y0(t){if(!t)return Vr;t=t._reactInternals;e:{if(Rs(t)!==t||t.tag!==1)throw Error(U(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ot(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(U(171))}if(t.tag===1){var n=t.type;if(Ot(n))return y1(t,n,e)}return e}function v0(t,e,n,r,s,i,o,l,c){return t=mp(n,r,!0,t,s,i,o,l,c),t.context=y0(null),n=t.current,r=It(),s=Cr(n),i=$n(r,s),i.callback=e??null,Sr(n,i,s),t.current.lanes=s,ka(t,s,r),Lt(t,r),t}function yu(t,e,n,r){var s=e.current,i=It(),o=Cr(s);return n=y0(n),e.context===null?e.context=n:e.pendingContext=n,e=$n(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Sr(s,e,o),t!==null&&(hn(t,s,o,i),Hl(t,s,o)),o}function jc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function yy(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function gp(t,e){yy(t,e),(t=t.alternate)&&yy(t,e)}function eI(){return null}var _0=typeof reportError=="function"?reportError:function(t){console.error(t)};function yp(t){this._internalRoot=t}vu.prototype.render=yp.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(U(409));yu(t,e,null,null)};vu.prototype.unmount=yp.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Es(function(){yu(null,t,null,null)}),e[Wn]=null}};function vu(t){this._internalRoot=t}vu.prototype.unstable_scheduleHydration=function(t){if(t){var e=Y_();t={blockedOn:null,target:t,priority:e};for(var n=0;n<ur.length&&e!==0&&e<ur[n].priority;n++);ur.splice(n,0,t),n===0&&X_(t)}};function vp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function _u(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function vy(){}function tI(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var u=jc(o);i.call(u)}}var o=v0(e,r,t,0,null,!1,!1,"",vy);return t._reactRootContainer=o,t[Wn]=o.current,aa(t.nodeType===8?t.parentNode:t),Es(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var u=jc(c);l.call(u)}}var c=mp(t,0,!1,null,null,!1,!1,"",vy);return t._reactRootContainer=c,t[Wn]=c.current,aa(t.nodeType===8?t.parentNode:t),Es(function(){yu(e,c,n,r)}),c}function wu(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=jc(o);l.call(c)}}yu(e,o,t,s)}else o=tI(n,e,t,s,r);return jc(o)}K_=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ko(e.pendingLanes);n!==0&&(Lf(e,n|1),Lt(e,Le()),!(he&6)&&(Ti=Le()+500,Hr()))}break;case 13:Es(function(){var r=qn(t,1);if(r!==null){var s=It();hn(r,t,1,s)}}),gp(t,1)}};Mf=function(t){if(t.tag===13){var e=qn(t,134217728);if(e!==null){var n=It();hn(e,t,134217728,n)}gp(t,134217728)}};Q_=function(t){if(t.tag===13){var e=Cr(t),n=qn(t,e);if(n!==null){var r=It();hn(n,t,e,r)}gp(t,e)}};Y_=function(){return me};J_=function(t,e){var n=me;try{return me=t,e()}finally{me=n}};uh=function(t,e,n){switch(e){case"input":if(rh(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=uu(r);if(!s)throw Error(U(90));N_(r),rh(r,s)}}}break;case"textarea":P_(t,n);break;case"select":e=n.value,e!=null&&ai(t,!!n.multiple,e,!1)}};L_=dp;M_=Es;var nI={usingClientEntryPoint:!1,Events:[Da,ei,uu,V_,O_,dp]},Io={findFiberByHostInstance:as,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},rI={bundleType:Io.bundleType,version:Io.version,rendererPackageName:Io.rendererPackageName,rendererConfig:Io.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Zn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=B_(t),t===null?null:t.stateNode},findFiberByHostInstance:Io.findFiberByHostInstance||eI,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var kl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!kl.isDisabled&&kl.supportsFiber)try{ou=kl.inject(rI),Tn=kl}catch{}}qt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nI;qt.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!vp(e))throw Error(U(200));return ZS(t,e,null,n)};qt.createRoot=function(t,e){if(!vp(t))throw Error(U(299));var n=!1,r="",s=_0;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=mp(t,1,!1,null,null,n,!1,r,s),t[Wn]=e.current,aa(t.nodeType===8?t.parentNode:t),new yp(e)};qt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(U(188)):(t=Object.keys(t).join(","),Error(U(268,t)));return t=B_(e),t=t===null?null:t.stateNode,t};qt.flushSync=function(t){return Es(t)};qt.hydrate=function(t,e,n){if(!_u(e))throw Error(U(200));return wu(null,t,e,!0,n)};qt.hydrateRoot=function(t,e,n){if(!vp(t))throw Error(U(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=_0;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=v0(e,null,t,1,n??null,s,!1,i,o),t[Wn]=e.current,aa(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new vu(e)};qt.render=function(t,e,n){if(!_u(e))throw Error(U(200));return wu(null,t,e,!1,n)};qt.unmountComponentAtNode=function(t){if(!_u(t))throw Error(U(40));return t._reactRootContainer?(Es(function(){wu(null,null,t,!1,function(){t._reactRootContainer=null,t[Wn]=null})}),!0):!1};qt.unstable_batchedUpdates=dp;qt.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!_u(n))throw Error(U(200));if(t==null||t._reactInternals===void 0)throw Error(U(38));return wu(t,e,n,!1,r)};qt.version="18.3.1-next-f1338f8080-20240426";function w0(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(w0)}catch(t){console.error(t)}}w0(),w_.exports=qt;var sI=w_.exports,_y=sI;Yd.createRoot=_y.createRoot,Yd.hydrateRoot=_y.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ga(){return ga=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ga.apply(this,arguments)}var yr;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(yr||(yr={}));const wy="popstate";function iI(t){t===void 0&&(t={});function e(r,s){let{pathname:i,search:o,hash:l}=r.location;return $h("",{pathname:i,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:Vc(s)}return aI(e,n,null,t)}function Me(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function E0(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function oI(){return Math.random().toString(36).substr(2,8)}function Ey(t,e){return{usr:t.state,key:t.key,idx:e}}function $h(t,e,n,r){return n===void 0&&(n=null),ga({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Oi(e):e,{state:n,key:e&&e.key||r||oI()})}function Vc(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Oi(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function aI(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,l=yr.Pop,c=null,u=f();u==null&&(u=0,o.replaceState(ga({},o.state,{idx:u}),""));function f(){return(o.state||{idx:null}).idx}function m(){l=yr.Pop;let P=f(),x=P==null?null:P-u;u=P,c&&c({action:l,location:N.location,delta:x})}function g(P,x){l=yr.Push;let v=$h(N.location,P,x);n&&n(v,P),u=f()+1;let S=Ey(v,u),D=N.createHref(v);try{o.pushState(S,"",D)}catch(F){if(F instanceof DOMException&&F.name==="DataCloneError")throw F;s.location.assign(D)}i&&c&&c({action:l,location:N.location,delta:1})}function w(P,x){l=yr.Replace;let v=$h(N.location,P,x);n&&n(v,P),u=f();let S=Ey(v,u),D=N.createHref(v);o.replaceState(S,"",D),i&&c&&c({action:l,location:N.location,delta:0})}function R(P){let x=s.location.origin!=="null"?s.location.origin:s.location.href,v=typeof P=="string"?P:Vc(P);return v=v.replace(/ $/,"%20"),Me(x,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,x)}let N={get action(){return l},get location(){return t(s,o)},listen(P){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(wy,m),c=P,()=>{s.removeEventListener(wy,m),c=null}},createHref(P){return e(s,P)},createURL:R,encodeLocation(P){let x=R(P);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:g,replace:w,go(P){return o.go(P)}};return N}var xy;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(xy||(xy={}));function lI(t,e,n){return n===void 0&&(n="/"),cI(t,e,n,!1)}function cI(t,e,n,r){let s=typeof e=="string"?Oi(e):e,i=_p(s.pathname||"/",n);if(i==null)return null;let o=x0(t);uI(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=EI(i);l=_I(o[c],u,r)}return l}function x0(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};c.relativePath.startsWith("/")&&(Me(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let u=Nr([r,c.relativePath]),f=n.concat(c);i.children&&i.children.length>0&&(Me(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),x0(i.children,e,f,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:yI(u,i.index),routesMeta:f})};return t.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))s(i,o);else for(let c of T0(i.path))s(i,o,c)}),e}function T0(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=T0(r.join("/")),l=[];return l.push(...o.map(c=>c===""?i:[i,c].join("/"))),s&&l.push(...o),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function uI(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:vI(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const dI=/^:[\w-]+$/,hI=3,fI=2,pI=1,mI=10,gI=-2,Ty=t=>t==="*";function yI(t,e){let n=t.split("/"),r=n.length;return n.some(Ty)&&(r+=gI),e&&(r+=fI),n.filter(s=>!Ty(s)).reduce((s,i)=>s+(dI.test(i)?hI:i===""?pI:mI),r)}function vI(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function _I(t,e,n){n===void 0&&(n=!1);let{routesMeta:r}=t,s={},i="/",o=[];for(let l=0;l<r.length;++l){let c=r[l],u=l===r.length-1,f=i==="/"?e:e.slice(i.length)||"/",m=Sy({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},f),g=c.route;if(!m&&u&&n&&!r[r.length-1].route.index&&(m=Sy({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},f)),!m)return null;Object.assign(s,m.params),o.push({params:s,pathname:Nr([i,m.pathname]),pathnameBase:II(Nr([i,m.pathnameBase])),route:g}),m.pathnameBase!=="/"&&(i=Nr([i,m.pathnameBase]))}return o}function Sy(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=wI(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((u,f,m)=>{let{paramName:g,isOptional:w}=f;if(g==="*"){let N=l[m]||"";o=i.slice(0,i.length-N.length).replace(/(.)\/+$/,"$1")}const R=l[m];return w&&!R?u[g]=void 0:u[g]=(R||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:o,pattern:t}}function wI(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),E0(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(r.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function EI(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return E0(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function _p(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function xI(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?Oi(t):t;return{pathname:n?n.startsWith("/")?n:TI(n,e):e,search:CI(r),hash:RI(s)}}function TI(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function Pd(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function SI(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function wp(t,e){let n=SI(t);return e?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function Ep(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=Oi(t):(s=ga({},t),Me(!s.pathname||!s.pathname.includes("?"),Pd("?","pathname","search",s)),Me(!s.pathname||!s.pathname.includes("#"),Pd("#","pathname","hash",s)),Me(!s.search||!s.search.includes("#"),Pd("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,l;if(o==null)l=n;else{let m=e.length-1;if(!r&&o.startsWith("..")){let g=o.split("/");for(;g[0]==="..";)g.shift(),m-=1;s.pathname=g.join("/")}l=m>=0?e[m]:"/"}let c=xI(s,l),u=o&&o!=="/"&&o.endsWith("/"),f=(i||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||f)&&(c.pathname+="/"),c}const Nr=t=>t.join("/").replace(/\/\/+/g,"/"),II=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),CI=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,RI=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function NI(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const S0=["post","put","patch","delete"];new Set(S0);const AI=["get",...S0];new Set(AI);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ya(){return ya=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ya.apply(this,arguments)}const xp=L.createContext(null),PI=L.createContext(null),Wr=L.createContext(null),Eu=L.createContext(null),er=L.createContext({outlet:null,matches:[],isDataRoute:!1}),I0=L.createContext(null);function kI(t,e){let{relative:n}=e===void 0?{}:e;Li()||Me(!1);let{basename:r,navigator:s}=L.useContext(Wr),{hash:i,pathname:o,search:l}=R0(t,{relative:n}),c=o;return r!=="/"&&(c=o==="/"?r:Nr([r,o])),s.createHref({pathname:c,search:l,hash:i})}function Li(){return L.useContext(Eu)!=null}function Va(){return Li()||Me(!1),L.useContext(Eu).location}function C0(t){L.useContext(Wr).static||L.useLayoutEffect(t)}function Mi(){let{isDataRoute:t}=L.useContext(er);return t?GI():bI()}function bI(){Li()||Me(!1);let t=L.useContext(xp),{basename:e,future:n,navigator:r}=L.useContext(Wr),{matches:s}=L.useContext(er),{pathname:i}=Va(),o=JSON.stringify(wp(s,n.v7_relativeSplatPath)),l=L.useRef(!1);return C0(()=>{l.current=!0}),L.useCallback(function(u,f){if(f===void 0&&(f={}),!l.current)return;if(typeof u=="number"){r.go(u);return}let m=Ep(u,JSON.parse(o),i,f.relative==="path");t==null&&e!=="/"&&(m.pathname=m.pathname==="/"?e:Nr([e,m.pathname])),(f.replace?r.replace:r.push)(m,f.state,f)},[e,r,o,i,t])}function Oa(){let{matches:t}=L.useContext(er),e=t[t.length-1];return e?e.params:{}}function R0(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=L.useContext(Wr),{matches:s}=L.useContext(er),{pathname:i}=Va(),o=JSON.stringify(wp(s,r.v7_relativeSplatPath));return L.useMemo(()=>Ep(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function DI(t,e){return jI(t,e)}function jI(t,e,n,r){Li()||Me(!1);let{navigator:s}=L.useContext(Wr),{matches:i}=L.useContext(er),o=i[i.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let u=Va(),f;if(e){var m;let P=typeof e=="string"?Oi(e):e;c==="/"||(m=P.pathname)!=null&&m.startsWith(c)||Me(!1),f=P}else f=u;let g=f.pathname||"/",w=g;if(c!=="/"){let P=c.replace(/^\//,"").split("/");w="/"+g.replace(/^\//,"").split("/").slice(P.length).join("/")}let R=lI(t,{pathname:w}),N=FI(R&&R.map(P=>Object.assign({},P,{params:Object.assign({},l,P.params),pathname:Nr([c,s.encodeLocation?s.encodeLocation(P.pathname).pathname:P.pathname]),pathnameBase:P.pathnameBase==="/"?c:Nr([c,s.encodeLocation?s.encodeLocation(P.pathnameBase).pathname:P.pathnameBase])})),i,n,r);return e&&N?L.createElement(Eu.Provider,{value:{location:ya({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:yr.Pop}},N):N}function VI(){let t=$I(),e=NI(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},i=null;return L.createElement(L.Fragment,null,L.createElement("h2",null,"Unexpected Application Error!"),L.createElement("h3",{style:{fontStyle:"italic"}},e),n?L.createElement("pre",{style:s},n):null,i)}const OI=L.createElement(VI,null);class LI extends L.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?L.createElement(er.Provider,{value:this.props.routeContext},L.createElement(I0.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function MI(t){let{routeContext:e,match:n,children:r}=t,s=L.useContext(xp);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),L.createElement(er.Provider,{value:e},r)}function FI(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,l=(s=n)==null?void 0:s.errors;if(l!=null){let f=o.findIndex(m=>m.route.id&&(l==null?void 0:l[m.route.id])!==void 0);f>=0||Me(!1),o=o.slice(0,Math.min(o.length,f+1))}let c=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let f=0;f<o.length;f++){let m=o[f];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(u=f),m.route.id){let{loaderData:g,errors:w}=n,R=m.route.loader&&g[m.route.id]===void 0&&(!w||w[m.route.id]===void 0);if(m.route.lazy||R){c=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((f,m,g)=>{let w,R=!1,N=null,P=null;n&&(w=l&&m.route.id?l[m.route.id]:void 0,N=m.route.errorElement||OI,c&&(u<0&&g===0?(HI("route-fallback",!1),R=!0,P=null):u===g&&(R=!0,P=m.route.hydrateFallbackElement||null)));let x=e.concat(o.slice(0,g+1)),v=()=>{let S;return w?S=N:R?S=P:m.route.Component?S=L.createElement(m.route.Component,null):m.route.element?S=m.route.element:S=f,L.createElement(MI,{match:m,routeContext:{outlet:f,matches:x,isDataRoute:n!=null},children:S})};return n&&(m.route.ErrorBoundary||m.route.errorElement||g===0)?L.createElement(LI,{location:n.location,revalidation:n.revalidation,component:N,error:w,children:v(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):v()},null)}var N0=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(N0||{}),Oc=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Oc||{});function UI(t){let e=L.useContext(xp);return e||Me(!1),e}function BI(t){let e=L.useContext(PI);return e||Me(!1),e}function zI(t){let e=L.useContext(er);return e||Me(!1),e}function A0(t){let e=zI(),n=e.matches[e.matches.length-1];return n.route.id||Me(!1),n.route.id}function $I(){var t;let e=L.useContext(I0),n=BI(Oc.UseRouteError),r=A0(Oc.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function GI(){let{router:t}=UI(N0.UseNavigateStable),e=A0(Oc.UseNavigateStable),n=L.useRef(!1);return C0(()=>{n.current=!0}),L.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,ya({fromRouteId:e},i)))},[t,e])}const Iy={};function HI(t,e,n){!e&&!Iy[t]&&(Iy[t]=!0)}function WI(t,e){t==null||t.v7_startTransition,(t==null?void 0:t.v7_relativeSplatPath)===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function qI(t){let{to:e,replace:n,state:r,relative:s}=t;Li()||Me(!1);let{future:i,static:o}=L.useContext(Wr),{matches:l}=L.useContext(er),{pathname:c}=Va(),u=Mi(),f=Ep(e,wp(l,i.v7_relativeSplatPath),c,s==="path"),m=JSON.stringify(f);return L.useEffect(()=>u(JSON.parse(m),{replace:n,state:r,relative:s}),[u,m,s,n,r]),null}function Vn(t){Me(!1)}function KI(t){let{basename:e="/",children:n=null,location:r,navigationType:s=yr.Pop,navigator:i,static:o=!1,future:l}=t;Li()&&Me(!1);let c=e.replace(/^\/*/,"/"),u=L.useMemo(()=>({basename:c,navigator:i,static:o,future:ya({v7_relativeSplatPath:!1},l)}),[c,l,i,o]);typeof r=="string"&&(r=Oi(r));let{pathname:f="/",search:m="",hash:g="",state:w=null,key:R="default"}=r,N=L.useMemo(()=>{let P=_p(f,c);return P==null?null:{location:{pathname:P,search:m,hash:g,state:w,key:R},navigationType:s}},[c,f,m,g,w,R,s]);return N==null?null:L.createElement(Wr.Provider,{value:u},L.createElement(Eu.Provider,{children:n,value:N}))}function QI(t){let{children:e,location:n}=t;return DI(Gh(e),n)}new Promise(()=>{});function Gh(t,e){e===void 0&&(e=[]);let n=[];return L.Children.forEach(t,(r,s)=>{if(!L.isValidElement(r))return;let i=[...e,s];if(r.type===L.Fragment){n.push.apply(n,Gh(r.props.children,i));return}r.type!==Vn&&Me(!1),!r.props.index||!r.props.children||Me(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Gh(r.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Hh(){return Hh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Hh.apply(this,arguments)}function YI(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function JI(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function XI(t,e){return t.button===0&&(!e||e==="_self")&&!JI(t)}const ZI=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],eC="6";try{window.__reactRouterVersion=eC}catch{}const tC="startTransition",Cy=qx[tC];function nC(t){let{basename:e,children:n,future:r,window:s}=t,i=L.useRef();i.current==null&&(i.current=iI({window:s,v5Compat:!0}));let o=i.current,[l,c]=L.useState({action:o.action,location:o.location}),{v7_startTransition:u}=r||{},f=L.useCallback(m=>{u&&Cy?Cy(()=>c(m)):c(m)},[c,u]);return L.useLayoutEffect(()=>o.listen(f),[o,f]),L.useEffect(()=>WI(r),[r]),L.createElement(KI,{basename:e,children:n,location:l.location,navigationType:l.action,navigator:o,future:r})}const rC=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",sC=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,St=L.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:i,replace:o,state:l,target:c,to:u,preventScrollReset:f,viewTransition:m}=e,g=YI(e,ZI),{basename:w}=L.useContext(Wr),R,N=!1;if(typeof u=="string"&&sC.test(u)&&(R=u,rC))try{let S=new URL(window.location.href),D=u.startsWith("//")?new URL(S.protocol+u):new URL(u),F=_p(D.pathname,w);D.origin===S.origin&&F!=null?u=F+D.search+D.hash:N=!0}catch{}let P=kI(u,{relative:s}),x=iC(u,{replace:o,state:l,target:c,preventScrollReset:f,relative:s,viewTransition:m});function v(S){r&&r(S),S.defaultPrevented||x(S)}return L.createElement("a",Hh({},g,{href:R||P,onClick:N||i?r:v,ref:n,target:c}))});var Ry;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Ry||(Ry={}));var Ny;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Ny||(Ny={}));function iC(t,e){let{target:n,replace:r,state:s,preventScrollReset:i,relative:o,viewTransition:l}=e===void 0?{}:e,c=Mi(),u=Va(),f=R0(t,{relative:o});return L.useCallback(m=>{if(XI(m,n)){m.preventDefault();let g=r!==void 0?r:Vc(u)===Vc(f);c(t,{replace:g,state:s,preventScrollReset:i,relative:o,viewTransition:l})}},[u,c,f,r,s,n,t,i,o,l])}const Ay=t=>{let e;const n=new Set,r=(f,m)=>{const g=typeof f=="function"?f(e):f;if(!Object.is(g,e)){const w=e;e=m??(typeof g!="object"||g===null)?g:Object.assign({},e,g),n.forEach(R=>R(e,w))}},s=()=>e,c={setState:r,getState:s,getInitialState:()=>u,subscribe:f=>(n.add(f),()=>n.delete(f)),destroy:()=>{n.clear()}},u=e=t(r,s,c);return c},oC=t=>t?Ay(t):Ay;var P0={exports:{}},k0={},b0={exports:{}},D0={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Si=L;function aC(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var lC=typeof Object.is=="function"?Object.is:aC,cC=Si.useState,uC=Si.useEffect,dC=Si.useLayoutEffect,hC=Si.useDebugValue;function fC(t,e){var n=e(),r=cC({inst:{value:n,getSnapshot:e}}),s=r[0].inst,i=r[1];return dC(function(){s.value=n,s.getSnapshot=e,kd(s)&&i({inst:s})},[t,n,e]),uC(function(){return kd(s)&&i({inst:s}),t(function(){kd(s)&&i({inst:s})})},[t]),hC(n),n}function kd(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!lC(t,n)}catch{return!0}}function pC(t,e){return e()}var mC=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?pC:fC;D0.useSyncExternalStore=Si.useSyncExternalStore!==void 0?Si.useSyncExternalStore:mC;b0.exports=D0;var gC=b0.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xu=L,yC=gC;function vC(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var _C=typeof Object.is=="function"?Object.is:vC,wC=yC.useSyncExternalStore,EC=xu.useRef,xC=xu.useEffect,TC=xu.useMemo,SC=xu.useDebugValue;k0.useSyncExternalStoreWithSelector=function(t,e,n,r,s){var i=EC(null);if(i.current===null){var o={hasValue:!1,value:null};i.current=o}else o=i.current;i=TC(function(){function c(w){if(!u){if(u=!0,f=w,w=r(w),s!==void 0&&o.hasValue){var R=o.value;if(s(R,w))return m=R}return m=w}if(R=m,_C(f,w))return R;var N=r(w);return s!==void 0&&s(R,N)?(f=w,R):(f=w,m=N)}var u=!1,f,m,g=n===void 0?null:n;return[function(){return c(e())},g===null?void 0:function(){return c(g())}]},[e,n,r,s]);var l=wC(t,i[0],i[1]);return xC(function(){o.hasValue=!0,o.value=l},[l]),SC(l),l};P0.exports=k0;var IC=P0.exports;const CC=l_(IC),{useDebugValue:RC}=xn,{useSyncExternalStoreWithSelector:NC}=CC;const AC=t=>t;function PC(t,e=AC,n){const r=NC(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,n);return RC(r),r}const Py=t=>{const e=typeof t=="function"?oC(t):t,n=(r,s)=>PC(e,r,s);return Object.assign(n,e),n},j0=t=>t?Py(t):Py;function kC(t,e){let n;try{n=t()}catch{return}return{getItem:s=>{var i;const o=c=>c===null?null:JSON.parse(c,e==null?void 0:e.reviver),l=(i=n.getItem(s))!=null?i:null;return l instanceof Promise?l.then(o):o(l)},setItem:(s,i)=>n.setItem(s,JSON.stringify(i,e==null?void 0:e.replacer)),removeItem:s=>n.removeItem(s)}}const va=t=>e=>{try{const n=t(e);return n instanceof Promise?n:{then(r){return va(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return va(r)(n)}}}},bC=(t,e)=>(n,r,s)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:P=>P,version:0,merge:(P,x)=>({...x,...P}),...e},o=!1;const l=new Set,c=new Set;let u;try{u=i.getStorage()}catch{}if(!u)return t((...P)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...P)},r,s);const f=va(i.serialize),m=()=>{const P=i.partialize({...r()});let x;const v=f({state:P,version:i.version}).then(S=>u.setItem(i.name,S)).catch(S=>{x=S});if(x)throw x;return v},g=s.setState;s.setState=(P,x)=>{g(P,x),m()};const w=t((...P)=>{n(...P),m()},r,s);let R;const N=()=>{var P;if(!u)return;o=!1,l.forEach(v=>v(r()));const x=((P=i.onRehydrateStorage)==null?void 0:P.call(i,r()))||void 0;return va(u.getItem.bind(u))(i.name).then(v=>{if(v)return i.deserialize(v)}).then(v=>{if(v)if(typeof v.version=="number"&&v.version!==i.version){if(i.migrate)return i.migrate(v.state,v.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return v.state}).then(v=>{var S;return R=i.merge(v,(S=r())!=null?S:w),n(R,!0),m()}).then(()=>{x==null||x(R,void 0),o=!0,c.forEach(v=>v(R))}).catch(v=>{x==null||x(void 0,v)})};return s.persist={setOptions:P=>{i={...i,...P},P.getStorage&&(u=P.getStorage())},clearStorage:()=>{u==null||u.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>N(),hasHydrated:()=>o,onHydrate:P=>(l.add(P),()=>{l.delete(P)}),onFinishHydration:P=>(c.add(P),()=>{c.delete(P)})},N(),R||w},DC=(t,e)=>(n,r,s)=>{let i={storage:kC(()=>localStorage),partialize:N=>N,version:0,merge:(N,P)=>({...P,...N}),...e},o=!1;const l=new Set,c=new Set;let u=i.storage;if(!u)return t((...N)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...N)},r,s);const f=()=>{const N=i.partialize({...r()});return u.setItem(i.name,{state:N,version:i.version})},m=s.setState;s.setState=(N,P)=>{m(N,P),f()};const g=t((...N)=>{n(...N),f()},r,s);s.getInitialState=()=>g;let w;const R=()=>{var N,P;if(!u)return;o=!1,l.forEach(v=>{var S;return v((S=r())!=null?S:g)});const x=((P=i.onRehydrateStorage)==null?void 0:P.call(i,(N=r())!=null?N:g))||void 0;return va(u.getItem.bind(u))(i.name).then(v=>{if(v)if(typeof v.version=="number"&&v.version!==i.version){if(i.migrate)return[!0,i.migrate(v.state,v.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,v.state];return[!1,void 0]}).then(v=>{var S;const[D,F]=v;if(w=i.merge(F,(S=r())!=null?S:g),n(w,!0),D)return f()}).then(()=>{x==null||x(w,void 0),w=r(),o=!0,c.forEach(v=>v(w))}).catch(v=>{x==null||x(void 0,v)})};return s.persist={setOptions:N=>{i={...i,...N},N.storage&&(u=N.storage)},clearStorage:()=>{u==null||u.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>R(),hasHydrated:()=>o,onHydrate:N=>(l.add(N),()=>{l.delete(N)}),onFinishHydration:N=>(c.add(N),()=>{c.delete(N)})},i.skipHydration||R(),w||g},jC=(t,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?bC(t,e):DC(t,e),V0=jC;var vr=(t=>(t.SINGLE="single",t.DOUBLE="double",t.TRIPLE="triple",t.CHAIN="chain",t.SLIP="slip",t.INCREASE="increase",t.DECREASE="decrease",t.MAGIC_RING="magic_ring",t.FRONT_POST="front_post",t.BACK_POST="back_post",t))(vr||{});const Pt={single:{rawValue:"短針",symbol:"×",englishName:"Single Crochet"},double:{rawValue:"長針",symbol:"↑",englishName:"Double Crochet"},triple:{rawValue:"長長針",symbol:"↟",englishName:"Triple Crochet"},chain:{rawValue:"鎖針",symbol:"○",englishName:"Chain"},slip:{rawValue:"引拔針",symbol:"•",englishName:"Slip Stitch"},increase:{rawValue:"加針",symbol:"▲",englishName:"Increase"},decrease:{rawValue:"減針",symbol:"▼",englishName:"Decrease"},magic_ring:{rawValue:"魔術環",symbol:"◉",englishName:"Magic Ring"},front_post:{rawValue:"前柱針",symbol:"⟨",englishName:"Front Post"},back_post:{rawValue:"後柱針",symbol:"⟩",englishName:"Back Post"}};function Ze(){return crypto.randomUUID()}function VC(t){const e=Math.floor(t/3600),n=Math.floor(t%3600/60);return e>0?`${e}小時${n}分`:n>0?`${n}分鐘`:`${t}秒`}function Wh(t){let e;return t instanceof Date?e=t:e=new Date(t),isNaN(e.getTime())?"無效日期":new Intl.DateTimeFormat("zh-TW",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(e)}function OC(){return[{id:Ze(),name:"白色棉線",brand:"樣本品牌",color:{name:"白色",hex:"#FFFFFF"}},{id:Ze(),name:"粉色棉線",brand:"樣本品牌",color:{name:"粉色",hex:"#FFB3E6"}},{id:Ze(),name:"藍色棉線",brand:"樣本品牌",color:{name:"藍色",hex:"#87CEEB"}}]}function bd(){const t=OC(),e={id:Ze(),roundNumber:1,stitches:[{id:Ze(),type:vr.CHAIN,yarnId:t[0].id,count:4},{id:Ze(),type:vr.SLIP,yarnId:t[0].id,count:1}],stitchGroups:[],notes:"起始魔術環"},n={id:Ze(),roundNumber:2,stitches:[{id:Ze(),type:vr.SINGLE,yarnId:t[0].id,count:8}],stitchGroups:[],notes:"短針增加"},r={id:Ze(),roundNumber:3,stitches:[{id:Ze(),type:vr.SINGLE,yarnId:t[1].id,count:16}],stitchGroups:[],notes:"換色，繼續增加"};return{id:Ze(),name:"範例杯墊",source:"https://www.youtube.com/watch?v=example",pattern:[e,n,r],currentRound:1,currentStitch:0,yarns:t,sessions:[],createdDate:new Date,lastModified:new Date,isCompleted:!1}}function LC(t,e){const n=[],r=t.stitches.map(i=>{var f;const o=e.find(m=>m.id===i.yarnId),l=(o==null?void 0:o.name)||"未知毛線",c=i.count>1?` ×${i.count}`:"";return`${((f=Pt[i.type])==null?void 0:f.rawValue)||i.type}(${l})${c}`});n.push(...r);const s=t.stitchGroups.map(i=>MC(i,e));return n.push(...s),n.join(", ")||"無針法"}function MC(t,e){const n=t.stitches.map(i=>{var f;const o=e.find(m=>m.id===i.yarnId),l=(o==null?void 0:o.name)||"未知毛線",c=i.count>1?` ×${i.count}`:"";return`${((f=Pt[i.type])==null?void 0:f.rawValue)||i.type}(${l})${c}`}),r=t.name||"針目群組",s=t.repeatCount>1?` 重複${t.repeatCount}次`:"";return`[${r}: ${n.join(", ")}]${s}`}function O0(t){return t.stitches.reduce((e,n)=>e+n.count,0)*t.repeatCount}function zt(t){const e=t.stitches.reduce((r,s)=>r+s.count,0),n=t.stitchGroups.reduce((r,s)=>r+O0(s),0);return e+n}function Lc(t){return t.pattern.map(e=>e.roundNumber).reduce((e,n)=>Math.max(e,n),0)}function _a(t){return t.pattern.reduce((e,n)=>e+zt(n),0)}function Tp(t){if(!t.pattern||t.pattern.length===0)return 0;let e=0;for(let r=1;r<t.currentRound;r++){const s=t.pattern.find(i=>i.roundNumber===r);s&&(e+=zt(s))}const n=t.pattern.find(r=>r.roundNumber===t.currentRound);if(n){const r=zt(n),s=Math.min(Math.max(0,t.currentStitch),r);e+=s}return e}function qh(t){if(!t.pattern||t.pattern.length===0)return 0;const e=_a(t);if(e===0)return 0;const r=Tp(t)/e;return Math.min(Math.max(0,r),1)}const FC=()=>{};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L0=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},UC=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},M0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,c=s+2<t.length,u=c?t[s+2]:0,f=i>>2,m=(i&3)<<4|l>>4;let g=(l&15)<<2|u>>6,w=u&63;c||(w=64,o||(g=64)),r.push(n[f],n[m],n[g],n[w])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(L0(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):UC(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const u=s<t.length?n[t.charAt(s)]:64;++s;const m=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||u==null||m==null)throw new BC;const g=i<<2|l>>4;if(r.push(g),u!==64){const w=l<<4&240|u>>2;if(r.push(w),m!==64){const R=u<<6&192|m;r.push(R)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class BC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const zC=function(t){const e=L0(t);return M0.encodeByteArray(e,!0)},Mc=function(t){return zC(t).replace(/\./g,"")},F0=function(t){try{return M0.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $C(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GC=()=>$C().__FIREBASE_DEFAULTS__,HC=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},WC=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&F0(t[1]);return e&&JSON.parse(e)},Tu=()=>{try{return FC()||GC()||HC()||WC()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},U0=t=>{var e,n;return(n=(e=Tu())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},qC=t=>{const e=U0(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},B0=()=>{var t;return(t=Tu())==null?void 0:t.config},z0=t=>{var e;return(e=Tu())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ns(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Sp(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QC(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t},l="";return[Mc(JSON.stringify(n)),Mc(JSON.stringify(o)),l].join(".")}const Wo={};function YC(){const t={prod:[],emulator:[]};for(const e of Object.keys(Wo))Wo[e]?t.emulator.push(e):t.prod.push(e);return t}function JC(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let ky=!1;function $0(t,e){if(typeof window>"u"||typeof document>"u"||!Ns(window.location.host)||Wo[t]===e||Wo[t]||ky)return;Wo[t]=e;function n(g){return`__firebase__banner__${g}`}const r="__firebase__banner",i=YC().prod.length>0;function o(){const g=document.getElementById(r);g&&g.remove()}function l(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function c(g,w){g.setAttribute("width","24"),g.setAttribute("id",w),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function u(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{ky=!0,o()},g}function f(g,w){g.setAttribute("id",w),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function m(){const g=JC(r),w=n("text"),R=document.getElementById(w)||document.createElement("span"),N=n("learnmore"),P=document.getElementById(N)||document.createElement("a"),x=n("preprendIcon"),v=document.getElementById(x)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const S=g.element;l(S),f(P,N);const D=u();c(v,x),S.append(v,R,P,D),document.body.appendChild(S)}i?(R.innerText="Preview backend disconnected.",v.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(v.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,R.innerText="Preview backend running in this workspace."),R.setAttribute("id",w)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Et(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function XC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Et())}function ZC(){var e;const t=(e=Tu())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function e2(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function t2(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function n2(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function r2(){const t=Et();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function s2(){return!ZC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function i2(){try{return typeof indexedDB=="object"}catch{return!1}}function o2(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a2="FirebaseError";class tr extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=a2,Object.setPrototypeOf(this,tr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,La.prototype.create)}}class La{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?l2(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new tr(s,l,r)}}function l2(t,e){return t.replace(c2,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const c2=/\{\$([^}]+)}/g;function u2(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Or(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(by(i)&&by(o)){if(!Or(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function by(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ma(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function d2(t,e){const n=new h2(t,e);return n.subscribe.bind(n)}class h2{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");f2(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=Dd),s.error===void 0&&(s.error=Dd),s.complete===void 0&&(s.complete=Dd);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function f2(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Dd(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tt(t){return t&&t._delegate?t._delegate:t}class xs{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const is="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p2{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new KC;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(g2(e))try{this.getOrInitializeService({instanceIdentifier:is})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=is){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=is){return this.instances.has(e)}getOptions(e=is){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&o.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:m2(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=is){return this.component?this.component.multipleInstances?e:is:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function m2(t){return t===is?void 0:t}function g2(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y2{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new p2(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var oe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(oe||(oe={}));const v2={debug:oe.DEBUG,verbose:oe.VERBOSE,info:oe.INFO,warn:oe.WARN,error:oe.ERROR,silent:oe.SILENT},_2=oe.INFO,w2={[oe.DEBUG]:"log",[oe.VERBOSE]:"log",[oe.INFO]:"info",[oe.WARN]:"warn",[oe.ERROR]:"error"},E2=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=w2[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ip{constructor(e){this.name=e,this._logLevel=_2,this._logHandler=E2,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in oe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?v2[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,oe.DEBUG,...e),this._logHandler(this,oe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,oe.VERBOSE,...e),this._logHandler(this,oe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,oe.INFO,...e),this._logHandler(this,oe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,oe.WARN,...e),this._logHandler(this,oe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,oe.ERROR,...e),this._logHandler(this,oe.ERROR,...e)}}const x2=(t,e)=>e.some(n=>t instanceof n);let Dy,jy;function T2(){return Dy||(Dy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function S2(){return jy||(jy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const G0=new WeakMap,Kh=new WeakMap,H0=new WeakMap,jd=new WeakMap,Cp=new WeakMap;function I2(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Ar(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&G0.set(n,t)}).catch(()=>{}),Cp.set(e,t),e}function C2(t){if(Kh.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Kh.set(t,e)}let Qh={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Kh.get(t);if(e==="objectStoreNames")return t.objectStoreNames||H0.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ar(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function R2(t){Qh=t(Qh)}function N2(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Vd(this),e,...n);return H0.set(r,e.sort?e.sort():[e]),Ar(r)}:S2().includes(t)?function(...e){return t.apply(Vd(this),e),Ar(G0.get(this))}:function(...e){return Ar(t.apply(Vd(this),e))}}function A2(t){return typeof t=="function"?N2(t):(t instanceof IDBTransaction&&C2(t),x2(t,T2())?new Proxy(t,Qh):t)}function Ar(t){if(t instanceof IDBRequest)return I2(t);if(jd.has(t))return jd.get(t);const e=A2(t);return e!==t&&(jd.set(t,e),Cp.set(e,t)),e}const Vd=t=>Cp.get(t);function P2(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),l=Ar(o);return r&&o.addEventListener("upgradeneeded",c=>{r(Ar(o.result),c.oldVersion,c.newVersion,Ar(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const k2=["get","getKey","getAll","getAllKeys","count"],b2=["put","add","delete","clear"],Od=new Map;function Vy(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Od.get(e))return Od.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=b2.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||k2.includes(n)))return;const i=async function(o,...l){const c=this.transaction(o,s?"readwrite":"readonly");let u=c.store;return r&&(u=u.index(l.shift())),(await Promise.all([u[n](...l),s&&c.done]))[0]};return Od.set(e,i),i}R2(t=>({...t,get:(e,n,r)=>Vy(e,n)||t.get(e,n,r),has:(e,n)=>!!Vy(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D2{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(j2(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function j2(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Yh="@firebase/app",Oy="0.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qn=new Ip("@firebase/app"),V2="@firebase/app-compat",O2="@firebase/analytics-compat",L2="@firebase/analytics",M2="@firebase/app-check-compat",F2="@firebase/app-check",U2="@firebase/auth",B2="@firebase/auth-compat",z2="@firebase/database",$2="@firebase/data-connect",G2="@firebase/database-compat",H2="@firebase/functions",W2="@firebase/functions-compat",q2="@firebase/installations",K2="@firebase/installations-compat",Q2="@firebase/messaging",Y2="@firebase/messaging-compat",J2="@firebase/performance",X2="@firebase/performance-compat",Z2="@firebase/remote-config",eR="@firebase/remote-config-compat",tR="@firebase/storage",nR="@firebase/storage-compat",rR="@firebase/firestore",sR="@firebase/ai",iR="@firebase/firestore-compat",oR="firebase",aR="12.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jh="[DEFAULT]",lR={[Yh]:"fire-core",[V2]:"fire-core-compat",[L2]:"fire-analytics",[O2]:"fire-analytics-compat",[F2]:"fire-app-check",[M2]:"fire-app-check-compat",[U2]:"fire-auth",[B2]:"fire-auth-compat",[z2]:"fire-rtdb",[$2]:"fire-data-connect",[G2]:"fire-rtdb-compat",[H2]:"fire-fn",[W2]:"fire-fn-compat",[q2]:"fire-iid",[K2]:"fire-iid-compat",[Q2]:"fire-fcm",[Y2]:"fire-fcm-compat",[J2]:"fire-perf",[X2]:"fire-perf-compat",[Z2]:"fire-rc",[eR]:"fire-rc-compat",[tR]:"fire-gcs",[nR]:"fire-gcs-compat",[rR]:"fire-fst",[iR]:"fire-fst-compat",[sR]:"fire-vertex","fire-js":"fire-js",[oR]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fc=new Map,cR=new Map,Xh=new Map;function Ly(t,e){try{t.container.addComponent(e)}catch(n){Qn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Ii(t){const e=t.name;if(Xh.has(e))return Qn.debug(`There were multiple attempts to register component ${e}.`),!1;Xh.set(e,t);for(const n of Fc.values())Ly(n,t);for(const n of cR.values())Ly(n,t);return!0}function Su(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function cn(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uR={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Pr=new La("app","Firebase",uR);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dR{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new xs("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Pr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fi=aR;function W0(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Jh,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw Pr.create("bad-app-name",{appName:String(s)});if(n||(n=B0()),!n)throw Pr.create("no-options");const i=Fc.get(s);if(i){if(Or(n,i.options)&&Or(r,i.config))return i;throw Pr.create("duplicate-app",{appName:s})}const o=new y2(s);for(const c of Xh.values())o.addComponent(c);const l=new dR(n,r,o);return Fc.set(s,l),l}function q0(t=Jh){const e=Fc.get(t);if(!e&&t===Jh&&B0())return W0();if(!e)throw Pr.create("no-app",{appName:t});return e}function kr(t,e,n){let r=lR[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${r}" with version "${e}":`];s&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Qn.warn(o.join(" "));return}Ii(new xs(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hR="firebase-heartbeat-database",fR=1,wa="firebase-heartbeat-store";let Ld=null;function K0(){return Ld||(Ld=P2(hR,fR,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(wa)}catch(n){console.warn(n)}}}}).catch(t=>{throw Pr.create("idb-open",{originalErrorMessage:t.message})})),Ld}async function pR(t){try{const n=(await K0()).transaction(wa),r=await n.objectStore(wa).get(Q0(t));return await n.done,r}catch(e){if(e instanceof tr)Qn.warn(e.message);else{const n=Pr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Qn.warn(n.message)}}}async function My(t,e){try{const r=(await K0()).transaction(wa,"readwrite");await r.objectStore(wa).put(e,Q0(t)),await r.done}catch(n){if(n instanceof tr)Qn.warn(n.message);else{const r=Pr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Qn.warn(r.message)}}}function Q0(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mR=1024,gR=30;class yR{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new _R(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Fy();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>gR){const o=wR(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Qn.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Fy(),{heartbeatsToSend:r,unsentEntries:s}=vR(this._heartbeatsCache.heartbeats),i=Mc(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Qn.warn(n),""}}}function Fy(){return new Date().toISOString().substring(0,10)}function vR(t,e=mR){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Uy(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Uy(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class _R{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return i2()?o2().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await pR(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return My(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return My(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Uy(t){return Mc(JSON.stringify({version:2,heartbeats:t})).length}function wR(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ER(t){Ii(new xs("platform-logger",e=>new D2(e),"PRIVATE")),Ii(new xs("heartbeat",e=>new yR(e),"PRIVATE")),kr(Yh,Oy,t),kr(Yh,Oy,"esm2020"),kr("fire-js","")}ER("");function Y0(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const xR=Y0,J0=new La("auth","Firebase",Y0());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uc=new Ip("@firebase/auth");function TR(t,...e){Uc.logLevel<=oe.WARN&&Uc.warn(`Auth (${Fi}): ${t}`,...e)}function Xl(t,...e){Uc.logLevel<=oe.ERROR&&Uc.error(`Auth (${Fi}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pn(t,...e){throw Np(t,...e)}function fn(t,...e){return Np(t,...e)}function Rp(t,e,n){const r={...xR(),[e]:n};return new La("auth","Firebase",r).create(e,{appName:t.name})}function ps(t){return Rp(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function SR(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Pn(t,"argument-error"),Rp(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Np(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return J0.create(t,...e)}function X(t,e,...n){if(!t)throw Np(e,...n)}function Bn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Xl(e),new Error(e)}function Yn(t,e){t||Bn(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zh(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function IR(){return By()==="http:"||By()==="https:"}function By(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CR(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(IR()||t2()||"connection"in navigator)?navigator.onLine:!0}function RR(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fa{constructor(e,n){this.shortDelay=e,this.longDelay=n,Yn(n>e,"Short delay should be less than long delay!"),this.isMobile=XC()||n2()}get(){return CR()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ap(t,e){Yn(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X0{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Bn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Bn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Bn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NR={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AR=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],PR=new Fa(3e4,6e4);function Pp(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Ui(t,e,n,r,s={}){return Z0(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const l=Ma({key:t.config.apiKey,...o}).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u={method:e,headers:c,...i};return e2()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&Ns(t.emulatorConfig.host)&&(u.credentials="include"),X0.fetch()(await ew(t,t.config.apiHost,n,l),u)})}async function Z0(t,e,n){t._canInitEmulator=!1;const r={...NR,...e};try{const s=new bR(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw bl(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw bl(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw bl(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw bl(t,"user-disabled",o);const f=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw Rp(t,f,u);Pn(t,f)}}catch(s){if(s instanceof tr)throw s;Pn(t,"network-request-failed",{message:String(s)})}}async function kR(t,e,n,r,s={}){const i=await Ui(t,e,n,r,s);return"mfaPendingCredential"in i&&Pn(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function ew(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?Ap(t.config,s):`${t.config.apiScheme}://${s}`;return AR.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}class bR{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(fn(this.auth,"network-request-failed")),PR.get())})}}function bl(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=fn(t,e,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DR(t,e){return Ui(t,"POST","/v1/accounts:delete",e)}async function Bc(t,e){return Ui(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qo(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function jR(t,e=!1){const n=tt(t),r=await n.getIdToken(e),s=kp(r);X(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:qo(Md(s.auth_time)),issuedAtTime:qo(Md(s.iat)),expirationTime:qo(Md(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Md(t){return Number(t)*1e3}function kp(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Xl("JWT malformed, contained fewer than 3 sections"),null;try{const s=F0(n);return s?JSON.parse(s):(Xl("Failed to decode base64 JWT payload"),null)}catch(s){return Xl("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function zy(t){const e=kp(t);return X(e,"internal-error"),X(typeof e.exp<"u","internal-error"),X(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ea(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof tr&&VR(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function VR({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OR{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=qo(this.lastLoginAt),this.creationTime=qo(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zc(t){var m;const e=t.auth,n=await t.getIdToken(),r=await Ea(t,Bc(e,{idToken:n}));X(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const i=(m=s.providerUserInfo)!=null&&m.length?tw(s.providerUserInfo):[],o=MR(t.providerData,i),l=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),u=l?c:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new ef(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(t,f)}async function LR(t){const e=tt(t);await zc(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function MR(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function tw(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FR(t,e){const n=await Z0(t,{},async()=>{const r=Ma({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await ew(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:l,body:r};return t.emulatorConfig&&Ns(t.emulatorConfig.host)&&(c.credentials="include"),X0.fetch()(o,c)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function UR(t,e){return Ui(t,"POST","/v2/accounts:revokeToken",Pp(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){X(e.idToken,"internal-error"),X(typeof e.idToken<"u","internal-error"),X(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):zy(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){X(e.length!==0,"internal-error");const n=zy(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(X(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await FR(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new fi;return r&&(X(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(X(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(X(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new fi,this.toJSON())}_performRefresh(){return Bn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ar(t,e){X(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class un{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new OR(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new ef(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await Ea(this,this.stsTokenManager.getToken(this.auth,e));return X(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return jR(this,e)}reload(){return LR(this)}_assign(e){this!==e&&(X(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new un({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){X(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await zc(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(cn(this.auth.app))return Promise.reject(ps(this.auth));const e=await this.getIdToken();return await Ea(this,DR(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,i=n.phoneNumber??void 0,o=n.photoURL??void 0,l=n.tenantId??void 0,c=n._redirectEventId??void 0,u=n.createdAt??void 0,f=n.lastLoginAt??void 0,{uid:m,emailVerified:g,isAnonymous:w,providerData:R,stsTokenManager:N}=n;X(m&&N,e,"internal-error");const P=fi.fromJSON(this.name,N);X(typeof m=="string",e,"internal-error"),ar(r,e.name),ar(s,e.name),X(typeof g=="boolean",e,"internal-error"),X(typeof w=="boolean",e,"internal-error"),ar(i,e.name),ar(o,e.name),ar(l,e.name),ar(c,e.name),ar(u,e.name),ar(f,e.name);const x=new un({uid:m,auth:e,email:s,emailVerified:g,displayName:r,isAnonymous:w,photoURL:o,phoneNumber:i,tenantId:l,stsTokenManager:P,createdAt:u,lastLoginAt:f});return R&&Array.isArray(R)&&(x.providerData=R.map(v=>({...v}))),c&&(x._redirectEventId=c),x}static async _fromIdTokenResponse(e,n,r=!1){const s=new fi;s.updateFromServerResponse(n);const i=new un({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await zc(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];X(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?tw(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),l=new fi;l.updateFromIdToken(r);const c=new un({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:o}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new ef(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $y=new Map;function zn(t){Yn(t instanceof Function,"Expected a class definition");let e=$y.get(t);return e?(Yn(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,$y.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}nw.type="NONE";const Gy=nw;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zl(t,e,n){return`firebase:${t}:${e}:${n}`}class pi{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Zl(this.userKey,s.apiKey,i),this.fullPersistenceKey=Zl("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Bc(this.auth,{idToken:e}).catch(()=>{});return n?un._fromGetAccountInfoResponse(this.auth,n,e):null}return un._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new pi(zn(Gy),e,r);const s=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=s[0]||zn(Gy);const o=Zl(r,e.config.apiKey,e.name);let l=null;for(const u of n)try{const f=await u._get(o);if(f){let m;if(typeof f=="string"){const g=await Bc(e,{idToken:f}).catch(()=>{});if(!g)break;m=await un._fromGetAccountInfoResponse(e,g,f)}else m=un._fromJSON(e,f);u!==i&&(l=m),i=u;break}}catch{}const c=s.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new pi(i,e,r):(i=c[0],l&&await i._set(o,l.toJSON()),await Promise.all(n.map(async u=>{if(u!==i)try{await u._remove(o)}catch{}})),new pi(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hy(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(ow(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(rw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(lw(e))return"Blackberry";if(cw(e))return"Webos";if(sw(e))return"Safari";if((e.includes("chrome/")||iw(e))&&!e.includes("edge/"))return"Chrome";if(aw(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function rw(t=Et()){return/firefox\//i.test(t)}function sw(t=Et()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function iw(t=Et()){return/crios\//i.test(t)}function ow(t=Et()){return/iemobile/i.test(t)}function aw(t=Et()){return/android/i.test(t)}function lw(t=Et()){return/blackberry/i.test(t)}function cw(t=Et()){return/webos/i.test(t)}function bp(t=Et()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function BR(t=Et()){var e;return bp(t)&&!!((e=window.navigator)!=null&&e.standalone)}function zR(){return r2()&&document.documentMode===10}function uw(t=Et()){return bp(t)||aw(t)||cw(t)||lw(t)||/windows phone/i.test(t)||ow(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dw(t,e=[]){let n;switch(t){case"Browser":n=Hy(Et());break;case"Worker":n=`${Hy(Et())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Fi}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $R{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,l)=>{try{const c=e(i);o(c)}catch(c){l(c)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GR(t,e={}){return Ui(t,"GET","/v2/passwordPolicy",Pp(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HR=6;class WR{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??HR,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qR{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Wy(this),this.idTokenSubscription=new Wy(this),this.beforeStateQueue=new $R(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=J0,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=zn(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await pi.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Bc(this,{idToken:e}),r=await un._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(cn(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,l=r==null?void 0:r._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(r=c.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return X(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await zc(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=RR()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(cn(this.app))return Promise.reject(ps(this));const n=e?tt(e):null;return n&&X(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&X(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return cn(this.app)?Promise.reject(ps(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return cn(this.app)?Promise.reject(ps(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(zn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await GR(this),n=new WR(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new La("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await UR(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&zn(e)||this._popupRedirectResolver;X(n,this,"argument-error"),this.redirectPersistenceManager=await pi.create(this,[zn(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(X(l,this,"internal-error"),l.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,s);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return X(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=dw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(cn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&TR(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Iu(t){return tt(t)}class Wy{constructor(e){this.auth=e,this.observer=null,this.addObserver=d2(n=>this.observer=n)}get next(){return X(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Dp={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function KR(t){Dp=t}function QR(t){return Dp.loadJS(t)}function YR(){return Dp.gapiScript}function JR(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XR(t,e){const n=Su(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(Or(i,e??{}))return s;Pn(s,"already-initialized")}return n.initialize({options:e})}function ZR(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(zn);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function eN(t,e,n){const r=Iu(t);X(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!(n!=null&&n.disableWarnings),i=hw(e),{host:o,port:l}=tN(e),c=l===null?"":`:${l}`,u={url:`${i}//${o}${c}/`},f=Object.freeze({host:o,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){X(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),X(Or(u,r.config.emulator)&&Or(f,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=u,r.emulatorConfig=f,r.settings.appVerificationDisabledForTesting=!0,Ns(o)?(Sp(`${i}//${o}${c}`),$0("Auth",!0)):s||nN()}function hw(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function tN(t){const e=hw(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:qy(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:qy(o)}}}function qy(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function nN(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fw{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Bn("not implemented")}_getIdTokenResponse(e){return Bn("not implemented")}_linkToIdToken(e,n){return Bn("not implemented")}_getReauthenticationResolver(e){return Bn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mi(t,e){return kR(t,"POST","/v1/accounts:signInWithIdp",Pp(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rN="http://localhost";class Ts extends fw{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Ts(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Pn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=n;if(!r||!s)return null;const o=new Ts(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return mi(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,mi(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,mi(e,n)}buildRequest(){const e={requestUri:rN,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Ma(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jp{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua extends jp{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hr extends Ua{constructor(){super("facebook.com")}static credential(e){return Ts._fromParams({providerId:hr.PROVIDER_ID,signInMethod:hr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return hr.credentialFromTaggedObject(e)}static credentialFromError(e){return hr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return hr.credential(e.oauthAccessToken)}catch{return null}}}hr.FACEBOOK_SIGN_IN_METHOD="facebook.com";hr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mn extends Ua{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Ts._fromParams({providerId:Mn.PROVIDER_ID,signInMethod:Mn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Mn.credentialFromTaggedObject(e)}static credentialFromError(e){return Mn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Mn.credential(n,r)}catch{return null}}}Mn.GOOGLE_SIGN_IN_METHOD="google.com";Mn.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fr extends Ua{constructor(){super("github.com")}static credential(e){return Ts._fromParams({providerId:fr.PROVIDER_ID,signInMethod:fr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return fr.credentialFromTaggedObject(e)}static credentialFromError(e){return fr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return fr.credential(e.oauthAccessToken)}catch{return null}}}fr.GITHUB_SIGN_IN_METHOD="github.com";fr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pr extends Ua{constructor(){super("twitter.com")}static credential(e,n){return Ts._fromParams({providerId:pr.PROVIDER_ID,signInMethod:pr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return pr.credentialFromTaggedObject(e)}static credentialFromError(e){return pr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return pr.credential(n,r)}catch{return null}}}pr.TWITTER_SIGN_IN_METHOD="twitter.com";pr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await un._fromIdTokenResponse(e,r,s),o=Ky(r);return new Ci({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=Ky(r);return new Ci({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function Ky(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $c extends tr{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,$c.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new $c(e,n,r,s)}}function pw(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?$c._fromErrorAndOperation(t,i,e,r):i})}async function sN(t,e,n=!1){const r=await Ea(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Ci._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iN(t,e,n=!1){const{auth:r}=t;if(cn(r.app))return Promise.reject(ps(r));const s="reauthenticate";try{const i=await Ea(t,pw(r,s,e,t),n);X(i.idToken,r,"internal-error");const o=kp(i.idToken);X(o,r,"internal-error");const{sub:l}=o;return X(t.uid===l,r,"user-mismatch"),Ci._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Pn(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oN(t,e,n=!1){if(cn(t.app))return Promise.reject(ps(t));const r="signIn",s=await pw(t,r,e),i=await Ci._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}function aN(t,e,n,r){return tt(t).onIdTokenChanged(e,n,r)}function lN(t,e,n){return tt(t).beforeAuthStateChanged(e,n)}function cN(t,e,n,r){return tt(t).onAuthStateChanged(e,n,r)}function uN(t){return tt(t).signOut()}const Gc="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mw{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Gc,"1"),this.storage.removeItem(Gc),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dN=1e3,hN=10;class gw extends mw{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=uw(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);zR()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,hN):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},dN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}gw.type="LOCAL";const fN=gw;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yw extends mw{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}yw.type="SESSION";const vw=yw;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pN(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cu{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Cu(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(o).map(async u=>u(n.origin,i)),c=await pN(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Cu.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vp(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mN{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((l,c)=>{const u=Vp("",20);s.port1.start();const f=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(m){const g=m;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(f),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(g.data.response);break;default:clearTimeout(f),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function In(){return window}function gN(t){In().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _w(){return typeof In().WorkerGlobalScope<"u"&&typeof In().importScripts=="function"}async function yN(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function vN(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function _N(){return _w()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ww="firebaseLocalStorageDb",wN=1,Hc="firebaseLocalStorage",Ew="fbase_key";class Ba{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Ru(t,e){return t.transaction([Hc],e?"readwrite":"readonly").objectStore(Hc)}function EN(){const t=indexedDB.deleteDatabase(ww);return new Ba(t).toPromise()}function tf(){const t=indexedDB.open(ww,wN);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Hc,{keyPath:Ew})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Hc)?e(r):(r.close(),await EN(),e(await tf()))})})}async function Qy(t,e,n){const r=Ru(t,!0).put({[Ew]:e,value:n});return new Ba(r).toPromise()}async function xN(t,e){const n=Ru(t,!1).get(e),r=await new Ba(n).toPromise();return r===void 0?null:r.value}function Yy(t,e){const n=Ru(t,!0).delete(e);return new Ba(n).toPromise()}const TN=800,SN=3;class xw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await tf(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>SN)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return _w()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Cu._getInstance(_N()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await yN(),!this.activeServiceWorker)return;this.sender=new mN(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||vN()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await tf();return await Qy(e,Gc,"1"),await Yy(e,Gc),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>Qy(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>xN(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Yy(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Ru(s,!1).getAll();return new Ba(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),TN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}xw.type="LOCAL";const IN=xw;new Fa(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tw(t,e){return e?zn(e):(X(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Op extends fw{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return mi(e,this._buildIdpRequest())}_linkToIdToken(e,n){return mi(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return mi(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function CN(t){return oN(t.auth,new Op(t),t.bypassAuthState)}function RN(t){const{auth:e,user:n}=t;return X(n,e,"internal-error"),iN(n,new Op(t),t.bypassAuthState)}async function NN(t){const{auth:e,user:n}=t;return X(n,e,"internal-error"),sN(n,new Op(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sw{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return CN;case"linkViaPopup":case"linkViaRedirect":return NN;case"reauthViaPopup":case"reauthViaRedirect":return RN;default:Pn(this.auth,"internal-error")}}resolve(e){Yn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Yn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AN=new Fa(2e3,1e4);async function PN(t,e,n){if(cn(t.app))return Promise.reject(fn(t,"operation-not-supported-in-this-environment"));const r=Iu(t);SR(t,e,jp);const s=Tw(r,n);return new us(r,"signInViaPopup",e,s).executeNotNull()}class us extends Sw{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,us.currentPopupAction&&us.currentPopupAction.cancel(),us.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return X(e,this.auth,"internal-error"),e}async onExecution(){Yn(this.filter.length===1,"Popup operations only handle one event");const e=Vp();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(fn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(fn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,us.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(fn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,AN.get())};e()}}us.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kN="pendingRedirect",ec=new Map;class bN extends Sw{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=ec.get(this.auth._key());if(!e){try{const r=await DN(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}ec.set(this.auth._key(),e)}return this.bypassAuthState||ec.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function DN(t,e){const n=ON(e),r=VN(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function jN(t,e){ec.set(t._key(),e)}function VN(t){return zn(t._redirectPersistence)}function ON(t){return Zl(kN,t.config.apiKey,t.name)}async function LN(t,e,n=!1){if(cn(t.app))return Promise.reject(ps(t));const r=Iu(t),s=Tw(r,e),o=await new bN(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MN=10*60*1e3;class FN{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!UN(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!Iw(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(fn(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=MN&&this.cachedEventUids.clear(),this.cachedEventUids.has(Jy(e))}saveEventToCache(e){this.cachedEventUids.add(Jy(e)),this.lastProcessedEventTime=Date.now()}}function Jy(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Iw({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function UN(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Iw(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BN(t,e={}){return Ui(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zN=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,$N=/^https?/;async function GN(t){if(t.config.emulator)return;const{authorizedDomains:e}=await BN(t);for(const n of e)try{if(HN(n))return}catch{}Pn(t,"unauthorized-domain")}function HN(t){const e=Zh(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!$N.test(n))return!1;if(zN.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WN=new Fa(3e4,6e4);function Xy(){const t=In().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function qN(t){return new Promise((e,n)=>{var s,i,o;function r(){Xy(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Xy(),n(fn(t,"network-request-failed"))},timeout:WN.get()})}if((i=(s=In().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=In().gapi)!=null&&o.load)r();else{const l=JR("iframefcb");return In()[l]=()=>{gapi.load?r():n(fn(t,"network-request-failed"))},QR(`${YR()}?onload=${l}`).catch(c=>n(c))}}).catch(e=>{throw tc=null,e})}let tc=null;function KN(t){return tc=tc||qN(t),tc}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QN=new Fa(5e3,15e3),YN="__/auth/iframe",JN="emulator/auth/iframe",XN={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ZN=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function eA(t){const e=t.config;X(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Ap(e,JN):`https://${t.config.authDomain}/${YN}`,r={apiKey:e.apiKey,appName:t.name,v:Fi},s=ZN.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Ma(r).slice(1)}`}async function tA(t){const e=await KN(t),n=In().gapi;return X(n,t,"internal-error"),e.open({where:document.body,url:eA(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:XN,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=fn(t,"network-request-failed"),l=In().setTimeout(()=>{i(o)},QN.get());function c(){In().clearTimeout(l),s(r)}r.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nA={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},rA=500,sA=600,iA="_blank",oA="http://localhost";class Zy{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function aA(t,e,n,r=rA,s=sA){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const c={...nA,width:r.toString(),height:s.toString(),top:i,left:o},u=Et().toLowerCase();n&&(l=iw(u)?iA:n),rw(u)&&(e=e||oA,c.scrollbars="yes");const f=Object.entries(c).reduce((g,[w,R])=>`${g}${w}=${R},`,"");if(BR(u)&&l!=="_self")return lA(e||"",l),new Zy(null);const m=window.open(e||"",l,f);X(m,t,"popup-blocked");try{m.focus()}catch{}return new Zy(m)}function lA(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cA="__/auth/handler",uA="emulator/auth/handler",dA=encodeURIComponent("fac");async function ev(t,e,n,r,s,i){X(t.config.authDomain,t,"auth-domain-config-required"),X(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Fi,eventId:s};if(e instanceof jp){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",u2(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,m]of Object.entries(i||{}))o[f]=m}if(e instanceof Ua){const f=e.getScopes().filter(m=>m!=="");f.length>0&&(o.scopes=f.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const f of Object.keys(l))l[f]===void 0&&delete l[f];const c=await t._getAppCheckToken(),u=c?`#${dA}=${encodeURIComponent(c)}`:"";return`${hA(t)}?${Ma(l).slice(1)}${u}`}function hA({config:t}){return t.emulator?Ap(t,uA):`https://${t.authDomain}/${cA}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fd="webStorageSupport";class fA{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=vw,this._completeRedirectFn=LN,this._overrideRedirectResult=jN}async _openPopup(e,n,r,s){var o;Yn((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await ev(e,n,r,Zh(),s);return aA(e,i,Vp())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await ev(e,n,r,Zh(),s);return gN(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Yn(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await tA(e),r=new FN(e);return n.register("authEvent",s=>(X(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Fd,{type:Fd},s=>{var o;const i=(o=s==null?void 0:s[0])==null?void 0:o[Fd];i!==void 0&&n(!!i),Pn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=GN(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return uw()||sw()||bp()}}const pA=fA;var tv="@firebase/auth",nv="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mA{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){X(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gA(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function yA(t){Ii(new xs("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;X(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:dw(t)},u=new qR(r,s,i,c);return ZR(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Ii(new xs("auth-internal",e=>{const n=Iu(e.getProvider("auth").getImmediate());return(r=>new mA(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),kr(tv,nv,gA(t)),kr(tv,nv,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vA=5*60,_A=z0("authIdTokenMaxAge")||vA;let rv=null;const wA=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>_A)return;const s=n==null?void 0:n.token;rv!==s&&(rv=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function EA(t=q0()){const e=Su(t,"auth");if(e.isInitialized())return e.getImmediate();const n=XR(t,{popupRedirectResolver:pA,persistence:[IN,fN,vw]}),r=z0("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=wA(i.toString());lN(n,o,()=>o(n.currentUser)),aN(n,l=>o(l))}}const s=U0("auth");return s&&eN(n,`http://${s}`),n}function xA(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}KR({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=fn("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",xA().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});yA("Browser");var TA="firebase",SA="12.1.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */kr(TA,SA,"app");var sv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var br,Cw;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(T,_){function I(){}I.prototype=_.prototype,T.D=_.prototype,T.prototype=new I,T.prototype.constructor=T,T.C=function(E,A,b){for(var C=Array(arguments.length-2),qe=2;qe<arguments.length;qe++)C[qe-2]=arguments[qe];return _.prototype[A].apply(E,C)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(T,_,I){I||(I=0);var E=Array(16);if(typeof _=="string")for(var A=0;16>A;++A)E[A]=_.charCodeAt(I++)|_.charCodeAt(I++)<<8|_.charCodeAt(I++)<<16|_.charCodeAt(I++)<<24;else for(A=0;16>A;++A)E[A]=_[I++]|_[I++]<<8|_[I++]<<16|_[I++]<<24;_=T.g[0],I=T.g[1],A=T.g[2];var b=T.g[3],C=_+(b^I&(A^b))+E[0]+3614090360&4294967295;_=I+(C<<7&4294967295|C>>>25),C=b+(A^_&(I^A))+E[1]+3905402710&4294967295,b=_+(C<<12&4294967295|C>>>20),C=A+(I^b&(_^I))+E[2]+606105819&4294967295,A=b+(C<<17&4294967295|C>>>15),C=I+(_^A&(b^_))+E[3]+3250441966&4294967295,I=A+(C<<22&4294967295|C>>>10),C=_+(b^I&(A^b))+E[4]+4118548399&4294967295,_=I+(C<<7&4294967295|C>>>25),C=b+(A^_&(I^A))+E[5]+1200080426&4294967295,b=_+(C<<12&4294967295|C>>>20),C=A+(I^b&(_^I))+E[6]+2821735955&4294967295,A=b+(C<<17&4294967295|C>>>15),C=I+(_^A&(b^_))+E[7]+4249261313&4294967295,I=A+(C<<22&4294967295|C>>>10),C=_+(b^I&(A^b))+E[8]+1770035416&4294967295,_=I+(C<<7&4294967295|C>>>25),C=b+(A^_&(I^A))+E[9]+2336552879&4294967295,b=_+(C<<12&4294967295|C>>>20),C=A+(I^b&(_^I))+E[10]+4294925233&4294967295,A=b+(C<<17&4294967295|C>>>15),C=I+(_^A&(b^_))+E[11]+2304563134&4294967295,I=A+(C<<22&4294967295|C>>>10),C=_+(b^I&(A^b))+E[12]+1804603682&4294967295,_=I+(C<<7&4294967295|C>>>25),C=b+(A^_&(I^A))+E[13]+4254626195&4294967295,b=_+(C<<12&4294967295|C>>>20),C=A+(I^b&(_^I))+E[14]+2792965006&4294967295,A=b+(C<<17&4294967295|C>>>15),C=I+(_^A&(b^_))+E[15]+1236535329&4294967295,I=A+(C<<22&4294967295|C>>>10),C=_+(A^b&(I^A))+E[1]+4129170786&4294967295,_=I+(C<<5&4294967295|C>>>27),C=b+(I^A&(_^I))+E[6]+3225465664&4294967295,b=_+(C<<9&4294967295|C>>>23),C=A+(_^I&(b^_))+E[11]+643717713&4294967295,A=b+(C<<14&4294967295|C>>>18),C=I+(b^_&(A^b))+E[0]+3921069994&4294967295,I=A+(C<<20&4294967295|C>>>12),C=_+(A^b&(I^A))+E[5]+3593408605&4294967295,_=I+(C<<5&4294967295|C>>>27),C=b+(I^A&(_^I))+E[10]+38016083&4294967295,b=_+(C<<9&4294967295|C>>>23),C=A+(_^I&(b^_))+E[15]+3634488961&4294967295,A=b+(C<<14&4294967295|C>>>18),C=I+(b^_&(A^b))+E[4]+3889429448&4294967295,I=A+(C<<20&4294967295|C>>>12),C=_+(A^b&(I^A))+E[9]+568446438&4294967295,_=I+(C<<5&4294967295|C>>>27),C=b+(I^A&(_^I))+E[14]+3275163606&4294967295,b=_+(C<<9&4294967295|C>>>23),C=A+(_^I&(b^_))+E[3]+4107603335&4294967295,A=b+(C<<14&4294967295|C>>>18),C=I+(b^_&(A^b))+E[8]+1163531501&4294967295,I=A+(C<<20&4294967295|C>>>12),C=_+(A^b&(I^A))+E[13]+2850285829&4294967295,_=I+(C<<5&4294967295|C>>>27),C=b+(I^A&(_^I))+E[2]+4243563512&4294967295,b=_+(C<<9&4294967295|C>>>23),C=A+(_^I&(b^_))+E[7]+1735328473&4294967295,A=b+(C<<14&4294967295|C>>>18),C=I+(b^_&(A^b))+E[12]+2368359562&4294967295,I=A+(C<<20&4294967295|C>>>12),C=_+(I^A^b)+E[5]+4294588738&4294967295,_=I+(C<<4&4294967295|C>>>28),C=b+(_^I^A)+E[8]+2272392833&4294967295,b=_+(C<<11&4294967295|C>>>21),C=A+(b^_^I)+E[11]+1839030562&4294967295,A=b+(C<<16&4294967295|C>>>16),C=I+(A^b^_)+E[14]+4259657740&4294967295,I=A+(C<<23&4294967295|C>>>9),C=_+(I^A^b)+E[1]+2763975236&4294967295,_=I+(C<<4&4294967295|C>>>28),C=b+(_^I^A)+E[4]+1272893353&4294967295,b=_+(C<<11&4294967295|C>>>21),C=A+(b^_^I)+E[7]+4139469664&4294967295,A=b+(C<<16&4294967295|C>>>16),C=I+(A^b^_)+E[10]+3200236656&4294967295,I=A+(C<<23&4294967295|C>>>9),C=_+(I^A^b)+E[13]+681279174&4294967295,_=I+(C<<4&4294967295|C>>>28),C=b+(_^I^A)+E[0]+3936430074&4294967295,b=_+(C<<11&4294967295|C>>>21),C=A+(b^_^I)+E[3]+3572445317&4294967295,A=b+(C<<16&4294967295|C>>>16),C=I+(A^b^_)+E[6]+76029189&4294967295,I=A+(C<<23&4294967295|C>>>9),C=_+(I^A^b)+E[9]+3654602809&4294967295,_=I+(C<<4&4294967295|C>>>28),C=b+(_^I^A)+E[12]+3873151461&4294967295,b=_+(C<<11&4294967295|C>>>21),C=A+(b^_^I)+E[15]+530742520&4294967295,A=b+(C<<16&4294967295|C>>>16),C=I+(A^b^_)+E[2]+3299628645&4294967295,I=A+(C<<23&4294967295|C>>>9),C=_+(A^(I|~b))+E[0]+4096336452&4294967295,_=I+(C<<6&4294967295|C>>>26),C=b+(I^(_|~A))+E[7]+1126891415&4294967295,b=_+(C<<10&4294967295|C>>>22),C=A+(_^(b|~I))+E[14]+2878612391&4294967295,A=b+(C<<15&4294967295|C>>>17),C=I+(b^(A|~_))+E[5]+4237533241&4294967295,I=A+(C<<21&4294967295|C>>>11),C=_+(A^(I|~b))+E[12]+1700485571&4294967295,_=I+(C<<6&4294967295|C>>>26),C=b+(I^(_|~A))+E[3]+2399980690&4294967295,b=_+(C<<10&4294967295|C>>>22),C=A+(_^(b|~I))+E[10]+4293915773&4294967295,A=b+(C<<15&4294967295|C>>>17),C=I+(b^(A|~_))+E[1]+2240044497&4294967295,I=A+(C<<21&4294967295|C>>>11),C=_+(A^(I|~b))+E[8]+1873313359&4294967295,_=I+(C<<6&4294967295|C>>>26),C=b+(I^(_|~A))+E[15]+4264355552&4294967295,b=_+(C<<10&4294967295|C>>>22),C=A+(_^(b|~I))+E[6]+2734768916&4294967295,A=b+(C<<15&4294967295|C>>>17),C=I+(b^(A|~_))+E[13]+1309151649&4294967295,I=A+(C<<21&4294967295|C>>>11),C=_+(A^(I|~b))+E[4]+4149444226&4294967295,_=I+(C<<6&4294967295|C>>>26),C=b+(I^(_|~A))+E[11]+3174756917&4294967295,b=_+(C<<10&4294967295|C>>>22),C=A+(_^(b|~I))+E[2]+718787259&4294967295,A=b+(C<<15&4294967295|C>>>17),C=I+(b^(A|~_))+E[9]+3951481745&4294967295,T.g[0]=T.g[0]+_&4294967295,T.g[1]=T.g[1]+(A+(C<<21&4294967295|C>>>11))&4294967295,T.g[2]=T.g[2]+A&4294967295,T.g[3]=T.g[3]+b&4294967295}r.prototype.u=function(T,_){_===void 0&&(_=T.length);for(var I=_-this.blockSize,E=this.B,A=this.h,b=0;b<_;){if(A==0)for(;b<=I;)s(this,T,b),b+=this.blockSize;if(typeof T=="string"){for(;b<_;)if(E[A++]=T.charCodeAt(b++),A==this.blockSize){s(this,E),A=0;break}}else for(;b<_;)if(E[A++]=T[b++],A==this.blockSize){s(this,E),A=0;break}}this.h=A,this.o+=_},r.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var _=1;_<T.length-8;++_)T[_]=0;var I=8*this.o;for(_=T.length-8;_<T.length;++_)T[_]=I&255,I/=256;for(this.u(T),T=Array(16),_=I=0;4>_;++_)for(var E=0;32>E;E+=8)T[I++]=this.g[_]>>>E&255;return T};function i(T,_){var I=l;return Object.prototype.hasOwnProperty.call(I,T)?I[T]:I[T]=_(T)}function o(T,_){this.h=_;for(var I=[],E=!0,A=T.length-1;0<=A;A--){var b=T[A]|0;E&&b==_||(I[A]=b,E=!1)}this.g=I}var l={};function c(T){return-128<=T&&128>T?i(T,function(_){return new o([_|0],0>_?-1:0)}):new o([T|0],0>T?-1:0)}function u(T){if(isNaN(T)||!isFinite(T))return m;if(0>T)return P(u(-T));for(var _=[],I=1,E=0;T>=I;E++)_[E]=T/I|0,I*=4294967296;return new o(_,0)}function f(T,_){if(T.length==0)throw Error("number format error: empty string");if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(T.charAt(0)=="-")return P(f(T.substring(1),_));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var I=u(Math.pow(_,8)),E=m,A=0;A<T.length;A+=8){var b=Math.min(8,T.length-A),C=parseInt(T.substring(A,A+b),_);8>b?(b=u(Math.pow(_,b)),E=E.j(b).add(u(C))):(E=E.j(I),E=E.add(u(C)))}return E}var m=c(0),g=c(1),w=c(16777216);t=o.prototype,t.m=function(){if(N(this))return-P(this).m();for(var T=0,_=1,I=0;I<this.g.length;I++){var E=this.i(I);T+=(0<=E?E:4294967296+E)*_,_*=4294967296}return T},t.toString=function(T){if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(R(this))return"0";if(N(this))return"-"+P(this).toString(T);for(var _=u(Math.pow(T,6)),I=this,E="";;){var A=D(I,_).g;I=x(I,A.j(_));var b=((0<I.g.length?I.g[0]:I.h)>>>0).toString(T);if(I=A,R(I))return b+E;for(;6>b.length;)b="0"+b;E=b+E}},t.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h};function R(T){if(T.h!=0)return!1;for(var _=0;_<T.g.length;_++)if(T.g[_]!=0)return!1;return!0}function N(T){return T.h==-1}t.l=function(T){return T=x(this,T),N(T)?-1:R(T)?0:1};function P(T){for(var _=T.g.length,I=[],E=0;E<_;E++)I[E]=~T.g[E];return new o(I,~T.h).add(g)}t.abs=function(){return N(this)?P(this):this},t.add=function(T){for(var _=Math.max(this.g.length,T.g.length),I=[],E=0,A=0;A<=_;A++){var b=E+(this.i(A)&65535)+(T.i(A)&65535),C=(b>>>16)+(this.i(A)>>>16)+(T.i(A)>>>16);E=C>>>16,b&=65535,C&=65535,I[A]=C<<16|b}return new o(I,I[I.length-1]&-2147483648?-1:0)};function x(T,_){return T.add(P(_))}t.j=function(T){if(R(this)||R(T))return m;if(N(this))return N(T)?P(this).j(P(T)):P(P(this).j(T));if(N(T))return P(this.j(P(T)));if(0>this.l(w)&&0>T.l(w))return u(this.m()*T.m());for(var _=this.g.length+T.g.length,I=[],E=0;E<2*_;E++)I[E]=0;for(E=0;E<this.g.length;E++)for(var A=0;A<T.g.length;A++){var b=this.i(E)>>>16,C=this.i(E)&65535,qe=T.i(A)>>>16,Ke=T.i(A)&65535;I[2*E+2*A]+=C*Ke,v(I,2*E+2*A),I[2*E+2*A+1]+=b*Ke,v(I,2*E+2*A+1),I[2*E+2*A+1]+=C*qe,v(I,2*E+2*A+1),I[2*E+2*A+2]+=b*qe,v(I,2*E+2*A+2)}for(E=0;E<_;E++)I[E]=I[2*E+1]<<16|I[2*E];for(E=_;E<2*_;E++)I[E]=0;return new o(I,0)};function v(T,_){for(;(T[_]&65535)!=T[_];)T[_+1]+=T[_]>>>16,T[_]&=65535,_++}function S(T,_){this.g=T,this.h=_}function D(T,_){if(R(_))throw Error("division by zero");if(R(T))return new S(m,m);if(N(T))return _=D(P(T),_),new S(P(_.g),P(_.h));if(N(_))return _=D(T,P(_)),new S(P(_.g),_.h);if(30<T.g.length){if(N(T)||N(_))throw Error("slowDivide_ only works with positive integers.");for(var I=g,E=_;0>=E.l(T);)I=F(I),E=F(E);var A=z(I,1),b=z(E,1);for(E=z(E,2),I=z(I,2);!R(E);){var C=b.add(E);0>=C.l(T)&&(A=A.add(I),b=C),E=z(E,1),I=z(I,1)}return _=x(T,A.j(_)),new S(A,_)}for(A=m;0<=T.l(_);){for(I=Math.max(1,Math.floor(T.m()/_.m())),E=Math.ceil(Math.log(I)/Math.LN2),E=48>=E?1:Math.pow(2,E-48),b=u(I),C=b.j(_);N(C)||0<C.l(T);)I-=E,b=u(I),C=b.j(_);R(b)&&(b=g),A=A.add(b),T=x(T,C)}return new S(A,T)}t.A=function(T){return D(this,T).h},t.and=function(T){for(var _=Math.max(this.g.length,T.g.length),I=[],E=0;E<_;E++)I[E]=this.i(E)&T.i(E);return new o(I,this.h&T.h)},t.or=function(T){for(var _=Math.max(this.g.length,T.g.length),I=[],E=0;E<_;E++)I[E]=this.i(E)|T.i(E);return new o(I,this.h|T.h)},t.xor=function(T){for(var _=Math.max(this.g.length,T.g.length),I=[],E=0;E<_;E++)I[E]=this.i(E)^T.i(E);return new o(I,this.h^T.h)};function F(T){for(var _=T.g.length+1,I=[],E=0;E<_;E++)I[E]=T.i(E)<<1|T.i(E-1)>>>31;return new o(I,T.h)}function z(T,_){var I=_>>5;_%=32;for(var E=T.g.length-I,A=[],b=0;b<E;b++)A[b]=0<_?T.i(b+I)>>>_|T.i(b+I+1)<<32-_:T.i(b+I);return new o(A,T.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Cw=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=f,br=o}).apply(typeof sv<"u"?sv:typeof self<"u"?self:typeof window<"u"?window:{});var Dl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Rw,Do,Nw,nc,nf,Aw,Pw,kw;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,d,p){return a==Array.prototype||a==Object.prototype||(a[d]=p.value),a};function n(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof Dl=="object"&&Dl];for(var d=0;d<a.length;++d){var p=a[d];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var r=n(this);function s(a,d){if(d)e:{var p=r;a=a.split(".");for(var y=0;y<a.length-1;y++){var k=a[y];if(!(k in p))break e;p=p[k]}a=a[a.length-1],y=p[a],d=d(y),d!=y&&d!=null&&e(p,a,{configurable:!0,writable:!0,value:d})}}function i(a,d){a instanceof String&&(a+="");var p=0,y=!1,k={next:function(){if(!y&&p<a.length){var j=p++;return{value:d(j,a[j]),done:!1}}return y=!0,{done:!0,value:void 0}}};return k[Symbol.iterator]=function(){return k},k}s("Array.prototype.values",function(a){return a||function(){return i(this,function(d,p){return p})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(a){var d=typeof a;return d=d!="object"?d:a?Array.isArray(a)?"array":d:"null",d=="array"||d=="object"&&typeof a.length=="number"}function u(a){var d=typeof a;return d=="object"&&a!=null||d=="function"}function f(a,d,p){return a.call.apply(a.bind,arguments)}function m(a,d,p){if(!a)throw Error();if(2<arguments.length){var y=Array.prototype.slice.call(arguments,2);return function(){var k=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(k,y),a.apply(d,k)}}return function(){return a.apply(d,arguments)}}function g(a,d,p){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:m,g.apply(null,arguments)}function w(a,d){var p=Array.prototype.slice.call(arguments,1);return function(){var y=p.slice();return y.push.apply(y,arguments),a.apply(this,y)}}function R(a,d){function p(){}p.prototype=d.prototype,a.aa=d.prototype,a.prototype=new p,a.prototype.constructor=a,a.Qb=function(y,k,j){for(var G=Array(arguments.length-2),ge=2;ge<arguments.length;ge++)G[ge-2]=arguments[ge];return d.prototype[k].apply(y,G)}}function N(a){const d=a.length;if(0<d){const p=Array(d);for(let y=0;y<d;y++)p[y]=a[y];return p}return[]}function P(a,d){for(let p=1;p<arguments.length;p++){const y=arguments[p];if(c(y)){const k=a.length||0,j=y.length||0;a.length=k+j;for(let G=0;G<j;G++)a[k+G]=y[G]}else a.push(y)}}class x{constructor(d,p){this.i=d,this.j=p,this.h=0,this.g=null}get(){let d;return 0<this.h?(this.h--,d=this.g,this.g=d.next,d.next=null):d=this.i(),d}}function v(a){return/^[\s\xa0]*$/.test(a)}function S(){var a=l.navigator;return a&&(a=a.userAgent)?a:""}function D(a){return D[" "](a),a}D[" "]=function(){};var F=S().indexOf("Gecko")!=-1&&!(S().toLowerCase().indexOf("webkit")!=-1&&S().indexOf("Edge")==-1)&&!(S().indexOf("Trident")!=-1||S().indexOf("MSIE")!=-1)&&S().indexOf("Edge")==-1;function z(a,d,p){for(const y in a)d.call(p,a[y],y,a)}function T(a,d){for(const p in a)d.call(void 0,a[p],p,a)}function _(a){const d={};for(const p in a)d[p]=a[p];return d}const I="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function E(a,d){let p,y;for(let k=1;k<arguments.length;k++){y=arguments[k];for(p in y)a[p]=y[p];for(let j=0;j<I.length;j++)p=I[j],Object.prototype.hasOwnProperty.call(y,p)&&(a[p]=y[p])}}function A(a){var d=1;a=a.split(":");const p=[];for(;0<d&&a.length;)p.push(a.shift()),d--;return a.length&&p.push(a.join(":")),p}function b(a){l.setTimeout(()=>{throw a},0)}function C(){var a=$;let d=null;return a.g&&(d=a.g,a.g=a.g.next,a.g||(a.h=null),d.next=null),d}class qe{constructor(){this.h=this.g=null}add(d,p){const y=Ke.get();y.set(d,p),this.h?this.h.next=y:this.g=y,this.h=y}}var Ke=new x(()=>new Mt,a=>a.reset());class Mt{constructor(){this.next=this.g=this.h=null}set(d,p){this.h=d,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let xt,W=!1,$=new qe,q=()=>{const a=l.Promise.resolve(void 0);xt=()=>{a.then(re)}};var re=()=>{for(var a;a=C();){try{a.h.call(a.g)}catch(p){b(p)}var d=Ke;d.j(a),100>d.h&&(d.h++,a.next=d.g,d.g=a)}W=!1};function se(){this.s=this.s,this.C=this.C}se.prototype.s=!1,se.prototype.ma=function(){this.s||(this.s=!0,this.N())},se.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ce(a,d){this.type=a,this.g=this.target=d,this.defaultPrevented=!1}ce.prototype.h=function(){this.defaultPrevented=!0};var be=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var a=!1,d=Object.defineProperty({},"passive",{get:function(){a=!0}});try{const p=()=>{};l.addEventListener("test",p,d),l.removeEventListener("test",p,d)}catch{}return a}();function $e(a,d){if(ce.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var p=this.type=a.type,y=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=d,d=a.relatedTarget){if(F){e:{try{D(d.nodeName);var k=!0;break e}catch{}k=!1}k||(d=null)}}else p=="mouseover"?d=a.fromElement:p=="mouseout"&&(d=a.toElement);this.relatedTarget=d,y?(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:De[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&$e.aa.h.call(this)}}R($e,ce);var De={2:"touch",3:"pen",4:"mouse"};$e.prototype.h=function(){$e.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var je="closure_listenable_"+(1e6*Math.random()|0),yn=0;function Ka(a,d,p,y,k){this.listener=a,this.proxy=null,this.src=d,this.type=p,this.capture=!!y,this.ha=k,this.key=++yn,this.da=this.fa=!1}function Jr(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function Xr(a){this.src=a,this.g={},this.h=0}Xr.prototype.add=function(a,d,p,y,k){var j=a.toString();a=this.g[j],a||(a=this.g[j]=[],this.h++);var G=bs(a,d,y,k);return-1<G?(d=a[G],p||(d.fa=!1)):(d=new Ka(d,this.src,j,!!y,k),d.fa=p,a.push(d)),d};function ks(a,d){var p=d.type;if(p in a.g){var y=a.g[p],k=Array.prototype.indexOf.call(y,d,void 0),j;(j=0<=k)&&Array.prototype.splice.call(y,k,1),j&&(Jr(d),a.g[p].length==0&&(delete a.g[p],a.h--))}}function bs(a,d,p,y){for(var k=0;k<a.length;++k){var j=a[k];if(!j.da&&j.listener==d&&j.capture==!!p&&j.ha==y)return k}return-1}var Ds="closure_lm_"+(1e6*Math.random()|0),js={};function Qi(a,d,p,y,k){if(y&&y.once)return Ji(a,d,p,y,k);if(Array.isArray(d)){for(var j=0;j<d.length;j++)Qi(a,d[j],p,y,k);return null}return p=to(p),a&&a[je]?a.K(d,p,u(y)?!!y.capture:!!y,k):Yi(a,d,p,!1,y,k)}function Yi(a,d,p,y,k,j){if(!d)throw Error("Invalid event type");var G=u(k)?!!k.capture:!!k,ge=Os(a);if(ge||(a[Ds]=ge=new Xr(a)),p=ge.add(d,p,y,G,j),p.proxy)return p;if(y=Qa(),p.proxy=y,y.src=a,y.listener=p,a.addEventListener)be||(k=G),k===void 0&&(k=!1),a.addEventListener(d.toString(),y,k);else if(a.attachEvent)a.attachEvent(Zi(d.toString()),y);else if(a.addListener&&a.removeListener)a.addListener(y);else throw Error("addEventListener and attachEvent are unavailable.");return p}function Qa(){function a(p){return d.call(a.src,a.listener,p)}const d=Ya;return a}function Ji(a,d,p,y,k){if(Array.isArray(d)){for(var j=0;j<d.length;j++)Ji(a,d[j],p,y,k);return null}return p=to(p),a&&a[je]?a.L(d,p,u(y)?!!y.capture:!!y,k):Yi(a,d,p,!0,y,k)}function Xi(a,d,p,y,k){if(Array.isArray(d))for(var j=0;j<d.length;j++)Xi(a,d[j],p,y,k);else y=u(y)?!!y.capture:!!y,p=to(p),a&&a[je]?(a=a.i,d=String(d).toString(),d in a.g&&(j=a.g[d],p=bs(j,p,y,k),-1<p&&(Jr(j[p]),Array.prototype.splice.call(j,p,1),j.length==0&&(delete a.g[d],a.h--)))):a&&(a=Os(a))&&(d=a.g[d.toString()],a=-1,d&&(a=bs(d,p,y,k)),(p=-1<a?d[a]:null)&&Vs(p))}function Vs(a){if(typeof a!="number"&&a&&!a.da){var d=a.src;if(d&&d[je])ks(d.i,a);else{var p=a.type,y=a.proxy;d.removeEventListener?d.removeEventListener(p,y,a.capture):d.detachEvent?d.detachEvent(Zi(p),y):d.addListener&&d.removeListener&&d.removeListener(y),(p=Os(d))?(ks(p,a),p.h==0&&(p.src=null,d[Ds]=null)):Jr(a)}}}function Zi(a){return a in js?js[a]:js[a]="on"+a}function Ya(a,d){if(a.da)a=!0;else{d=new $e(d,this);var p=a.listener,y=a.ha||a.src;a.fa&&Vs(a),a=p.call(y,d)}return a}function Os(a){return a=a[Ds],a instanceof Xr?a:null}var eo="__closure_events_fn_"+(1e9*Math.random()>>>0);function to(a){return typeof a=="function"?a:(a[eo]||(a[eo]=function(d){return a.handleEvent(d)}),a[eo])}function Qe(){se.call(this),this.i=new Xr(this),this.M=this,this.F=null}R(Qe,se),Qe.prototype[je]=!0,Qe.prototype.removeEventListener=function(a,d,p,y){Xi(this,a,d,p,y)};function nt(a,d){var p,y=a.F;if(y)for(p=[];y;y=y.F)p.push(y);if(a=a.M,y=d.type||d,typeof d=="string")d=new ce(d,a);else if(d instanceof ce)d.target=d.target||a;else{var k=d;d=new ce(y,a),E(d,k)}if(k=!0,p)for(var j=p.length-1;0<=j;j--){var G=d.g=p[j];k=Ls(G,y,!0,d)&&k}if(G=d.g=a,k=Ls(G,y,!0,d)&&k,k=Ls(G,y,!1,d)&&k,p)for(j=0;j<p.length;j++)G=d.g=p[j],k=Ls(G,y,!1,d)&&k}Qe.prototype.N=function(){if(Qe.aa.N.call(this),this.i){var a=this.i,d;for(d in a.g){for(var p=a.g[d],y=0;y<p.length;y++)Jr(p[y]);delete a.g[d],a.h--}}this.F=null},Qe.prototype.K=function(a,d,p,y){return this.i.add(String(a),d,!1,p,y)},Qe.prototype.L=function(a,d,p,y){return this.i.add(String(a),d,!0,p,y)};function Ls(a,d,p,y){if(d=a.i.g[String(d)],!d)return!0;d=d.concat();for(var k=!0,j=0;j<d.length;++j){var G=d[j];if(G&&!G.da&&G.capture==p){var ge=G.listener,st=G.ha||G.src;G.fa&&ks(a.i,G),k=ge.call(st,y)!==!1&&k}}return k&&!y.defaultPrevented}function Ja(a,d,p){if(typeof a=="function")p&&(a=g(a,p));else if(a&&typeof a.handleEvent=="function")a=g(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(d)?-1:l.setTimeout(a,d||0)}function no(a){a.g=Ja(()=>{a.g=null,a.i&&(a.i=!1,no(a))},a.l);const d=a.h;a.h=null,a.m.apply(null,d)}class $u extends se{constructor(d,p){super(),this.m=d,this.l=p,this.h=null,this.i=!1,this.g=null}j(d){this.h=arguments,this.g?this.i=!0:no(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Zr(a){se.call(this),this.h=a,this.g={}}R(Zr,se);var Xa=[];function Za(a){z(a.g,function(d,p){this.g.hasOwnProperty(p)&&Vs(d)},a),a.g={}}Zr.prototype.N=function(){Zr.aa.N.call(this),Za(this)},Zr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ro=l.JSON.stringify,Gu=l.JSON.parse,Hu=class{stringify(a){return l.JSON.stringify(a,void 0)}parse(a){return l.JSON.parse(a,void 0)}};function so(){}so.prototype.h=null;function el(a){return a.h||(a.h=a.i())}function io(){}var nr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ms(){ce.call(this,"d")}R(Ms,ce);function B(){ce.call(this,"c")}R(B,ce);var O={},ne=null;function Z(){return ne=ne||new Qe}O.La="serverreachability";function rt(a){ce.call(this,O.La,a)}R(rt,ce);function _e(a){const d=Z();nt(d,new rt(d))}O.STAT_EVENT="statevent";function At(a,d){ce.call(this,O.STAT_EVENT,a),this.stat=d}R(At,ce);function Ye(a){const d=Z();nt(d,new At(d,a))}O.Ma="timingevent";function Im(a,d){ce.call(this,O.Ma,a),this.size=d}R(Im,ce);function oo(a,d){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){a()},d)}function ao(){this.g=!0}ao.prototype.xa=function(){this.g=!1};function ox(a,d,p,y,k,j){a.info(function(){if(a.g)if(j)for(var G="",ge=j.split("&"),st=0;st<ge.length;st++){var fe=ge[st].split("=");if(1<fe.length){var ht=fe[0];fe=fe[1];var ft=ht.split("_");G=2<=ft.length&&ft[1]=="type"?G+(ht+"="+fe+"&"):G+(ht+"=redacted&")}}else G=null;else G=j;return"XMLHTTP REQ ("+y+") [attempt "+k+"]: "+d+`
`+p+`
`+G})}function ax(a,d,p,y,k,j,G){a.info(function(){return"XMLHTTP RESP ("+y+") [ attempt "+k+"]: "+d+`
`+p+`
`+j+" "+G})}function Fs(a,d,p,y){a.info(function(){return"XMLHTTP TEXT ("+d+"): "+cx(a,p)+(y?" "+y:"")})}function lx(a,d){a.info(function(){return"TIMEOUT: "+d})}ao.prototype.info=function(){};function cx(a,d){if(!a.g)return d;if(!d)return null;try{var p=JSON.parse(d);if(p){for(a=0;a<p.length;a++)if(Array.isArray(p[a])){var y=p[a];if(!(2>y.length)){var k=y[1];if(Array.isArray(k)&&!(1>k.length)){var j=k[0];if(j!="noop"&&j!="stop"&&j!="close")for(var G=1;G<k.length;G++)k[G]=""}}}}return ro(p)}catch{return d}}var tl={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Cm={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Wu;function nl(){}R(nl,so),nl.prototype.g=function(){return new XMLHttpRequest},nl.prototype.i=function(){return{}},Wu=new nl;function rr(a,d,p,y){this.j=a,this.i=d,this.l=p,this.R=y||1,this.U=new Zr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Rm}function Rm(){this.i=null,this.g="",this.h=!1}var Nm={},qu={};function Ku(a,d,p){a.L=1,a.v=ol(Dn(d)),a.m=p,a.P=!0,Am(a,null)}function Am(a,d){a.F=Date.now(),rl(a),a.A=Dn(a.v);var p=a.A,y=a.R;Array.isArray(y)||(y=[String(y)]),$m(p.i,"t",y),a.C=0,p=a.j.J,a.h=new Rm,a.g=ag(a.j,p?d:null,!a.m),0<a.O&&(a.M=new $u(g(a.Y,a,a.g),a.O)),d=a.U,p=a.g,y=a.ca;var k="readystatechange";Array.isArray(k)||(k&&(Xa[0]=k.toString()),k=Xa);for(var j=0;j<k.length;j++){var G=Qi(p,k[j],y||d.handleEvent,!1,d.h||d);if(!G)break;d.g[G.key]=G}d=a.H?_(a.H):{},a.m?(a.u||(a.u="POST"),d["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,d)):(a.u="GET",a.g.ea(a.A,a.u,null,d)),_e(),ox(a.i,a.u,a.A,a.l,a.R,a.m)}rr.prototype.ca=function(a){a=a.target;const d=this.M;d&&jn(a)==3?d.j():this.Y(a)},rr.prototype.Y=function(a){try{if(a==this.g)e:{const ft=jn(this.g);var d=this.g.Ba();const zs=this.g.Z();if(!(3>ft)&&(ft!=3||this.g&&(this.h.h||this.g.oa()||Ym(this.g)))){this.J||ft!=4||d==7||(d==8||0>=zs?_e(3):_e(2)),Qu(this);var p=this.g.Z();this.X=p;t:if(Pm(this)){var y=Ym(this.g);a="";var k=y.length,j=jn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){es(this),lo(this);var G="";break t}this.h.i=new l.TextDecoder}for(d=0;d<k;d++)this.h.h=!0,a+=this.h.i.decode(y[d],{stream:!(j&&d==k-1)});y.length=0,this.h.g+=a,this.C=0,G=this.h.g}else G=this.g.oa();if(this.o=p==200,ax(this.i,this.u,this.A,this.l,this.R,ft,p),this.o){if(this.T&&!this.K){t:{if(this.g){var ge,st=this.g;if((ge=st.g?st.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!v(ge)){var fe=ge;break t}}fe=null}if(p=fe)Fs(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Yu(this,p);else{this.o=!1,this.s=3,Ye(12),es(this),lo(this);break e}}if(this.P){p=!0;let nn;for(;!this.J&&this.C<G.length;)if(nn=ux(this,G),nn==qu){ft==4&&(this.s=4,Ye(14),p=!1),Fs(this.i,this.l,null,"[Incomplete Response]");break}else if(nn==Nm){this.s=4,Ye(15),Fs(this.i,this.l,G,"[Invalid Chunk]"),p=!1;break}else Fs(this.i,this.l,nn,null),Yu(this,nn);if(Pm(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ft!=4||G.length!=0||this.h.h||(this.s=1,Ye(16),p=!1),this.o=this.o&&p,!p)Fs(this.i,this.l,G,"[Invalid Chunked Response]"),es(this),lo(this);else if(0<G.length&&!this.W){this.W=!0;var ht=this.j;ht.g==this&&ht.ba&&!ht.M&&(ht.j.info("Great, no buffering proxy detected. Bytes received: "+G.length),nd(ht),ht.M=!0,Ye(11))}}else Fs(this.i,this.l,G,null),Yu(this,G);ft==4&&es(this),this.o&&!this.J&&(ft==4?rg(this.j,this):(this.o=!1,rl(this)))}else Rx(this.g),p==400&&0<G.indexOf("Unknown SID")?(this.s=3,Ye(12)):(this.s=0,Ye(13)),es(this),lo(this)}}}catch{}finally{}};function Pm(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function ux(a,d){var p=a.C,y=d.indexOf(`
`,p);return y==-1?qu:(p=Number(d.substring(p,y)),isNaN(p)?Nm:(y+=1,y+p>d.length?qu:(d=d.slice(y,y+p),a.C=y+p,d)))}rr.prototype.cancel=function(){this.J=!0,es(this)};function rl(a){a.S=Date.now()+a.I,km(a,a.I)}function km(a,d){if(a.B!=null)throw Error("WatchDog timer not null");a.B=oo(g(a.ba,a),d)}function Qu(a){a.B&&(l.clearTimeout(a.B),a.B=null)}rr.prototype.ba=function(){this.B=null;const a=Date.now();0<=a-this.S?(lx(this.i,this.A),this.L!=2&&(_e(),Ye(17)),es(this),this.s=2,lo(this)):km(this,this.S-a)};function lo(a){a.j.G==0||a.J||rg(a.j,a)}function es(a){Qu(a);var d=a.M;d&&typeof d.ma=="function"&&d.ma(),a.M=null,Za(a.U),a.g&&(d=a.g,a.g=null,d.abort(),d.ma())}function Yu(a,d){try{var p=a.j;if(p.G!=0&&(p.g==a||Ju(p.h,a))){if(!a.K&&Ju(p.h,a)&&p.G==3){try{var y=p.Da.g.parse(d)}catch{y=null}if(Array.isArray(y)&&y.length==3){var k=y;if(k[0]==0){e:if(!p.u){if(p.g)if(p.g.F+3e3<a.F)hl(p),ul(p);else break e;td(p),Ye(18)}}else p.za=k[1],0<p.za-p.T&&37500>k[2]&&p.F&&p.v==0&&!p.C&&(p.C=oo(g(p.Za,p),6e3));if(1>=jm(p.h)&&p.ca){try{p.ca()}catch{}p.ca=void 0}}else ns(p,11)}else if((a.K||p.g==a)&&hl(p),!v(d))for(k=p.Da.g.parse(d),d=0;d<k.length;d++){let fe=k[d];if(p.T=fe[0],fe=fe[1],p.G==2)if(fe[0]=="c"){p.K=fe[1],p.ia=fe[2];const ht=fe[3];ht!=null&&(p.la=ht,p.j.info("VER="+p.la));const ft=fe[4];ft!=null&&(p.Aa=ft,p.j.info("SVER="+p.Aa));const zs=fe[5];zs!=null&&typeof zs=="number"&&0<zs&&(y=1.5*zs,p.L=y,p.j.info("backChannelRequestTimeoutMs_="+y)),y=p;const nn=a.g;if(nn){const pl=nn.g?nn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(pl){var j=y.h;j.g||pl.indexOf("spdy")==-1&&pl.indexOf("quic")==-1&&pl.indexOf("h2")==-1||(j.j=j.l,j.g=new Set,j.h&&(Xu(j,j.h),j.h=null))}if(y.D){const rd=nn.g?nn.g.getResponseHeader("X-HTTP-Session-Id"):null;rd&&(y.ya=rd,we(y.I,y.D,rd))}}p.G=3,p.l&&p.l.ua(),p.ba&&(p.R=Date.now()-a.F,p.j.info("Handshake RTT: "+p.R+"ms")),y=p;var G=a;if(y.qa=og(y,y.J?y.ia:null,y.W),G.K){Vm(y.h,G);var ge=G,st=y.L;st&&(ge.I=st),ge.B&&(Qu(ge),rl(ge)),y.g=G}else tg(y);0<p.i.length&&dl(p)}else fe[0]!="stop"&&fe[0]!="close"||ns(p,7);else p.G==3&&(fe[0]=="stop"||fe[0]=="close"?fe[0]=="stop"?ns(p,7):ed(p):fe[0]!="noop"&&p.l&&p.l.ta(fe),p.v=0)}}_e(4)}catch{}}var dx=class{constructor(a,d){this.g=a,this.map=d}};function bm(a){this.l=a||10,l.PerformanceNavigationTiming?(a=l.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Dm(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function jm(a){return a.h?1:a.g?a.g.size:0}function Ju(a,d){return a.h?a.h==d:a.g?a.g.has(d):!1}function Xu(a,d){a.g?a.g.add(d):a.h=d}function Vm(a,d){a.h&&a.h==d?a.h=null:a.g&&a.g.has(d)&&a.g.delete(d)}bm.prototype.cancel=function(){if(this.i=Om(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const a of this.g.values())a.cancel();this.g.clear()}};function Om(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let d=a.i;for(const p of a.g.values())d=d.concat(p.D);return d}return N(a.i)}function hx(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(c(a)){for(var d=[],p=a.length,y=0;y<p;y++)d.push(a[y]);return d}d=[],p=0;for(y in a)d[p++]=a[y];return d}function fx(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(c(a)||typeof a=="string"){var d=[];a=a.length;for(var p=0;p<a;p++)d.push(p);return d}d=[],p=0;for(const y in a)d[p++]=y;return d}}}function Lm(a,d){if(a.forEach&&typeof a.forEach=="function")a.forEach(d,void 0);else if(c(a)||typeof a=="string")Array.prototype.forEach.call(a,d,void 0);else for(var p=fx(a),y=hx(a),k=y.length,j=0;j<k;j++)d.call(void 0,y[j],p&&p[j],a)}var Mm=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function px(a,d){if(a){a=a.split("&");for(var p=0;p<a.length;p++){var y=a[p].indexOf("="),k=null;if(0<=y){var j=a[p].substring(0,y);k=a[p].substring(y+1)}else j=a[p];d(j,k?decodeURIComponent(k.replace(/\+/g," ")):"")}}}function ts(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof ts){this.h=a.h,sl(this,a.j),this.o=a.o,this.g=a.g,il(this,a.s),this.l=a.l;var d=a.i,p=new ho;p.i=d.i,d.g&&(p.g=new Map(d.g),p.h=d.h),Fm(this,p),this.m=a.m}else a&&(d=String(a).match(Mm))?(this.h=!1,sl(this,d[1]||"",!0),this.o=co(d[2]||""),this.g=co(d[3]||"",!0),il(this,d[4]),this.l=co(d[5]||"",!0),Fm(this,d[6]||"",!0),this.m=co(d[7]||"")):(this.h=!1,this.i=new ho(null,this.h))}ts.prototype.toString=function(){var a=[],d=this.j;d&&a.push(uo(d,Um,!0),":");var p=this.g;return(p||d=="file")&&(a.push("//"),(d=this.o)&&a.push(uo(d,Um,!0),"@"),a.push(encodeURIComponent(String(p)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.s,p!=null&&a.push(":",String(p))),(p=this.l)&&(this.g&&p.charAt(0)!="/"&&a.push("/"),a.push(uo(p,p.charAt(0)=="/"?yx:gx,!0))),(p=this.i.toString())&&a.push("?",p),(p=this.m)&&a.push("#",uo(p,_x)),a.join("")};function Dn(a){return new ts(a)}function sl(a,d,p){a.j=p?co(d,!0):d,a.j&&(a.j=a.j.replace(/:$/,""))}function il(a,d){if(d){if(d=Number(d),isNaN(d)||0>d)throw Error("Bad port number "+d);a.s=d}else a.s=null}function Fm(a,d,p){d instanceof ho?(a.i=d,wx(a.i,a.h)):(p||(d=uo(d,vx)),a.i=new ho(d,a.h))}function we(a,d,p){a.i.set(d,p)}function ol(a){return we(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function co(a,d){return a?d?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function uo(a,d,p){return typeof a=="string"?(a=encodeURI(a).replace(d,mx),p&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function mx(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Um=/[#\/\?@]/g,gx=/[#\?:]/g,yx=/[#\?]/g,vx=/[#\?@]/g,_x=/#/g;function ho(a,d){this.h=this.g=null,this.i=a||null,this.j=!!d}function sr(a){a.g||(a.g=new Map,a.h=0,a.i&&px(a.i,function(d,p){a.add(decodeURIComponent(d.replace(/\+/g," ")),p)}))}t=ho.prototype,t.add=function(a,d){sr(this),this.i=null,a=Us(this,a);var p=this.g.get(a);return p||this.g.set(a,p=[]),p.push(d),this.h+=1,this};function Bm(a,d){sr(a),d=Us(a,d),a.g.has(d)&&(a.i=null,a.h-=a.g.get(d).length,a.g.delete(d))}function zm(a,d){return sr(a),d=Us(a,d),a.g.has(d)}t.forEach=function(a,d){sr(this),this.g.forEach(function(p,y){p.forEach(function(k){a.call(d,k,y,this)},this)},this)},t.na=function(){sr(this);const a=Array.from(this.g.values()),d=Array.from(this.g.keys()),p=[];for(let y=0;y<d.length;y++){const k=a[y];for(let j=0;j<k.length;j++)p.push(d[y])}return p},t.V=function(a){sr(this);let d=[];if(typeof a=="string")zm(this,a)&&(d=d.concat(this.g.get(Us(this,a))));else{a=Array.from(this.g.values());for(let p=0;p<a.length;p++)d=d.concat(a[p])}return d},t.set=function(a,d){return sr(this),this.i=null,a=Us(this,a),zm(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[d]),this.h+=1,this},t.get=function(a,d){return a?(a=this.V(a),0<a.length?String(a[0]):d):d};function $m(a,d,p){Bm(a,d),0<p.length&&(a.i=null,a.g.set(Us(a,d),N(p)),a.h+=p.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const a=[],d=Array.from(this.g.keys());for(var p=0;p<d.length;p++){var y=d[p];const j=encodeURIComponent(String(y)),G=this.V(y);for(y=0;y<G.length;y++){var k=j;G[y]!==""&&(k+="="+encodeURIComponent(String(G[y]))),a.push(k)}}return this.i=a.join("&")};function Us(a,d){return d=String(d),a.j&&(d=d.toLowerCase()),d}function wx(a,d){d&&!a.j&&(sr(a),a.i=null,a.g.forEach(function(p,y){var k=y.toLowerCase();y!=k&&(Bm(this,y),$m(this,k,p))},a)),a.j=d}function Ex(a,d){const p=new ao;if(l.Image){const y=new Image;y.onload=w(ir,p,"TestLoadImage: loaded",!0,d,y),y.onerror=w(ir,p,"TestLoadImage: error",!1,d,y),y.onabort=w(ir,p,"TestLoadImage: abort",!1,d,y),y.ontimeout=w(ir,p,"TestLoadImage: timeout",!1,d,y),l.setTimeout(function(){y.ontimeout&&y.ontimeout()},1e4),y.src=a}else d(!1)}function xx(a,d){const p=new ao,y=new AbortController,k=setTimeout(()=>{y.abort(),ir(p,"TestPingServer: timeout",!1,d)},1e4);fetch(a,{signal:y.signal}).then(j=>{clearTimeout(k),j.ok?ir(p,"TestPingServer: ok",!0,d):ir(p,"TestPingServer: server error",!1,d)}).catch(()=>{clearTimeout(k),ir(p,"TestPingServer: error",!1,d)})}function ir(a,d,p,y,k){try{k&&(k.onload=null,k.onerror=null,k.onabort=null,k.ontimeout=null),y(p)}catch{}}function Tx(){this.g=new Hu}function Sx(a,d,p){const y=p||"";try{Lm(a,function(k,j){let G=k;u(k)&&(G=ro(k)),d.push(y+j+"="+encodeURIComponent(G))})}catch(k){throw d.push(y+"type="+encodeURIComponent("_badmap")),k}}function al(a){this.l=a.Ub||null,this.j=a.eb||!1}R(al,so),al.prototype.g=function(){return new ll(this.l,this.j)},al.prototype.i=function(a){return function(){return a}}({});function ll(a,d){Qe.call(this),this.D=a,this.o=d,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}R(ll,Qe),t=ll.prototype,t.open=function(a,d){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=d,this.readyState=1,po(this)},t.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const d={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(d.body=a),(this.D||l).fetch(new Request(this.A,d)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,fo(this)),this.readyState=0},t.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,po(this)),this.g&&(this.readyState=3,po(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Gm(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function Gm(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}t.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var d=a.value?a.value:new Uint8Array(0);(d=this.v.decode(d,{stream:!a.done}))&&(this.response=this.responseText+=d)}a.done?fo(this):po(this),this.readyState==3&&Gm(this)}},t.Ra=function(a){this.g&&(this.response=this.responseText=a,fo(this))},t.Qa=function(a){this.g&&(this.response=a,fo(this))},t.ga=function(){this.g&&fo(this)};function fo(a){a.readyState=4,a.l=null,a.j=null,a.v=null,po(a)}t.setRequestHeader=function(a,d){this.u.append(a,d)},t.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const a=[],d=this.h.entries();for(var p=d.next();!p.done;)p=p.value,a.push(p[0]+": "+p[1]),p=d.next();return a.join(`\r
`)};function po(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(ll.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function Hm(a){let d="";return z(a,function(p,y){d+=y,d+=":",d+=p,d+=`\r
`}),d}function Zu(a,d,p){e:{for(y in p){var y=!1;break e}y=!0}y||(p=Hm(p),typeof a=="string"?p!=null&&encodeURIComponent(String(p)):we(a,d,p))}function Ae(a){Qe.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}R(Ae,Qe);var Ix=/^https?$/i,Cx=["POST","PUT"];t=Ae.prototype,t.Ha=function(a){this.J=a},t.ea=function(a,d,p,y){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);d=d?d.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Wu.g(),this.v=this.o?el(this.o):el(Wu),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(d,String(a),!0),this.B=!1}catch(j){Wm(this,j);return}if(a=p||"",p=new Map(this.headers),y)if(Object.getPrototypeOf(y)===Object.prototype)for(var k in y)p.set(k,y[k]);else if(typeof y.keys=="function"&&typeof y.get=="function")for(const j of y.keys())p.set(j,y.get(j));else throw Error("Unknown input type for opt_headers: "+String(y));y=Array.from(p.keys()).find(j=>j.toLowerCase()=="content-type"),k=l.FormData&&a instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Cx,d,void 0))||y||k||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[j,G]of p)this.g.setRequestHeader(j,G);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Qm(this),this.u=!0,this.g.send(a),this.u=!1}catch(j){Wm(this,j)}};function Wm(a,d){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=d,a.m=5,qm(a),cl(a)}function qm(a){a.A||(a.A=!0,nt(a,"complete"),nt(a,"error"))}t.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,nt(this,"complete"),nt(this,"abort"),cl(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),cl(this,!0)),Ae.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Km(this):this.bb())},t.bb=function(){Km(this)};function Km(a){if(a.h&&typeof o<"u"&&(!a.v[1]||jn(a)!=4||a.Z()!=2)){if(a.u&&jn(a)==4)Ja(a.Ea,0,a);else if(nt(a,"readystatechange"),jn(a)==4){a.h=!1;try{const G=a.Z();e:switch(G){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var d=!0;break e;default:d=!1}var p;if(!(p=d)){var y;if(y=G===0){var k=String(a.D).match(Mm)[1]||null;!k&&l.self&&l.self.location&&(k=l.self.location.protocol.slice(0,-1)),y=!Ix.test(k?k.toLowerCase():"")}p=y}if(p)nt(a,"complete"),nt(a,"success");else{a.m=6;try{var j=2<jn(a)?a.g.statusText:""}catch{j=""}a.l=j+" ["+a.Z()+"]",qm(a)}}finally{cl(a)}}}}function cl(a,d){if(a.g){Qm(a);const p=a.g,y=a.v[0]?()=>{}:null;a.g=null,a.v=null,d||nt(a,"ready");try{p.onreadystatechange=y}catch{}}}function Qm(a){a.I&&(l.clearTimeout(a.I),a.I=null)}t.isActive=function(){return!!this.g};function jn(a){return a.g?a.g.readyState:0}t.Z=function(){try{return 2<jn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(a){if(this.g){var d=this.g.responseText;return a&&d.indexOf(a)==0&&(d=d.substring(a.length)),Gu(d)}};function Ym(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function Rx(a){const d={};a=(a.g&&2<=jn(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let y=0;y<a.length;y++){if(v(a[y]))continue;var p=A(a[y]);const k=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();const j=d[k]||[];d[k]=j,j.push(p)}T(d,function(y){return y.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function mo(a,d,p){return p&&p.internalChannelParams&&p.internalChannelParams[a]||d}function Jm(a){this.Aa=0,this.i=[],this.j=new ao,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=mo("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=mo("baseRetryDelayMs",5e3,a),this.cb=mo("retryDelaySeedMs",1e4,a),this.Wa=mo("forwardChannelMaxRetries",2,a),this.wa=mo("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new bm(a&&a.concurrentRequestLimit),this.Da=new Tx,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Jm.prototype,t.la=8,t.G=1,t.connect=function(a,d,p,y){Ye(0),this.W=a,this.H=d||{},p&&y!==void 0&&(this.H.OSID=p,this.H.OAID=y),this.F=this.X,this.I=og(this,null,this.W),dl(this)};function ed(a){if(Xm(a),a.G==3){var d=a.U++,p=Dn(a.I);if(we(p,"SID",a.K),we(p,"RID",d),we(p,"TYPE","terminate"),go(a,p),d=new rr(a,a.j,d),d.L=2,d.v=ol(Dn(p)),p=!1,l.navigator&&l.navigator.sendBeacon)try{p=l.navigator.sendBeacon(d.v.toString(),"")}catch{}!p&&l.Image&&(new Image().src=d.v,p=!0),p||(d.g=ag(d.j,null),d.g.ea(d.v)),d.F=Date.now(),rl(d)}ig(a)}function ul(a){a.g&&(nd(a),a.g.cancel(),a.g=null)}function Xm(a){ul(a),a.u&&(l.clearTimeout(a.u),a.u=null),hl(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&l.clearTimeout(a.s),a.s=null)}function dl(a){if(!Dm(a.h)&&!a.s){a.s=!0;var d=a.Ga;xt||q(),W||(xt(),W=!0),$.add(d,a),a.B=0}}function Nx(a,d){return jm(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=d.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=oo(g(a.Ga,a,d),sg(a,a.B)),a.B++,!0)}t.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;const k=new rr(this,this.j,a);let j=this.o;if(this.S&&(j?(j=_(j),E(j,this.S)):j=this.S),this.m!==null||this.O||(k.H=j,j=null),this.P)e:{for(var d=0,p=0;p<this.i.length;p++){t:{var y=this.i[p];if("__data__"in y.map&&(y=y.map.__data__,typeof y=="string")){y=y.length;break t}y=void 0}if(y===void 0)break;if(d+=y,4096<d){d=p;break e}if(d===4096||p===this.i.length-1){d=p+1;break e}}d=1e3}else d=1e3;d=eg(this,k,d),p=Dn(this.I),we(p,"RID",a),we(p,"CVER",22),this.D&&we(p,"X-HTTP-Session-Id",this.D),go(this,p),j&&(this.O?d="headers="+encodeURIComponent(String(Hm(j)))+"&"+d:this.m&&Zu(p,this.m,j)),Xu(this.h,k),this.Ua&&we(p,"TYPE","init"),this.P?(we(p,"$req",d),we(p,"SID","null"),k.T=!0,Ku(k,p,null)):Ku(k,p,d),this.G=2}}else this.G==3&&(a?Zm(this,a):this.i.length==0||Dm(this.h)||Zm(this))};function Zm(a,d){var p;d?p=d.l:p=a.U++;const y=Dn(a.I);we(y,"SID",a.K),we(y,"RID",p),we(y,"AID",a.T),go(a,y),a.m&&a.o&&Zu(y,a.m,a.o),p=new rr(a,a.j,p,a.B+1),a.m===null&&(p.H=a.o),d&&(a.i=d.D.concat(a.i)),d=eg(a,p,1e3),p.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),Xu(a.h,p),Ku(p,y,d)}function go(a,d){a.H&&z(a.H,function(p,y){we(d,y,p)}),a.l&&Lm({},function(p,y){we(d,y,p)})}function eg(a,d,p){p=Math.min(a.i.length,p);var y=a.l?g(a.l.Na,a.l,a):null;e:{var k=a.i;let j=-1;for(;;){const G=["count="+p];j==-1?0<p?(j=k[0].g,G.push("ofs="+j)):j=0:G.push("ofs="+j);let ge=!0;for(let st=0;st<p;st++){let fe=k[st].g;const ht=k[st].map;if(fe-=j,0>fe)j=Math.max(0,k[st].g-100),ge=!1;else try{Sx(ht,G,"req"+fe+"_")}catch{y&&y(ht)}}if(ge){y=G.join("&");break e}}}return a=a.i.splice(0,p),d.D=a,y}function tg(a){if(!a.g&&!a.u){a.Y=1;var d=a.Fa;xt||q(),W||(xt(),W=!0),$.add(d,a),a.v=0}}function td(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=oo(g(a.Fa,a),sg(a,a.v)),a.v++,!0)}t.Fa=function(){if(this.u=null,ng(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=oo(g(this.ab,this),a)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ye(10),ul(this),ng(this))};function nd(a){a.A!=null&&(l.clearTimeout(a.A),a.A=null)}function ng(a){a.g=new rr(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var d=Dn(a.qa);we(d,"RID","rpc"),we(d,"SID",a.K),we(d,"AID",a.T),we(d,"CI",a.F?"0":"1"),!a.F&&a.ja&&we(d,"TO",a.ja),we(d,"TYPE","xmlhttp"),go(a,d),a.m&&a.o&&Zu(d,a.m,a.o),a.L&&(a.g.I=a.L);var p=a.g;a=a.ia,p.L=1,p.v=ol(Dn(d)),p.m=null,p.P=!0,Am(p,a)}t.Za=function(){this.C!=null&&(this.C=null,ul(this),td(this),Ye(19))};function hl(a){a.C!=null&&(l.clearTimeout(a.C),a.C=null)}function rg(a,d){var p=null;if(a.g==d){hl(a),nd(a),a.g=null;var y=2}else if(Ju(a.h,d))p=d.D,Vm(a.h,d),y=1;else return;if(a.G!=0){if(d.o)if(y==1){p=d.m?d.m.length:0,d=Date.now()-d.F;var k=a.B;y=Z(),nt(y,new Im(y,p)),dl(a)}else tg(a);else if(k=d.s,k==3||k==0&&0<d.X||!(y==1&&Nx(a,d)||y==2&&td(a)))switch(p&&0<p.length&&(d=a.h,d.i=d.i.concat(p)),k){case 1:ns(a,5);break;case 4:ns(a,10);break;case 3:ns(a,6);break;default:ns(a,2)}}}function sg(a,d){let p=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(p*=2),p*d}function ns(a,d){if(a.j.info("Error code "+d),d==2){var p=g(a.fb,a),y=a.Xa;const k=!y;y=new ts(y||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||sl(y,"https"),ol(y),k?Ex(y.toString(),p):xx(y.toString(),p)}else Ye(2);a.G=0,a.l&&a.l.sa(d),ig(a),Xm(a)}t.fb=function(a){a?(this.j.info("Successfully pinged google.com"),Ye(2)):(this.j.info("Failed to ping google.com"),Ye(1))};function ig(a){if(a.G=0,a.ka=[],a.l){const d=Om(a.h);(d.length!=0||a.i.length!=0)&&(P(a.ka,d),P(a.ka,a.i),a.h.i.length=0,N(a.i),a.i.length=0),a.l.ra()}}function og(a,d,p){var y=p instanceof ts?Dn(p):new ts(p);if(y.g!="")d&&(y.g=d+"."+y.g),il(y,y.s);else{var k=l.location;y=k.protocol,d=d?d+"."+k.hostname:k.hostname,k=+k.port;var j=new ts(null);y&&sl(j,y),d&&(j.g=d),k&&il(j,k),p&&(j.l=p),y=j}return p=a.D,d=a.ya,p&&d&&we(y,p,d),we(y,"VER",a.la),go(a,y),y}function ag(a,d,p){if(d&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return d=a.Ca&&!a.pa?new Ae(new al({eb:p})):new Ae(a.pa),d.Ha(a.J),d}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function lg(){}t=lg.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function fl(){}fl.prototype.g=function(a,d){return new Ft(a,d)};function Ft(a,d){Qe.call(this),this.g=new Jm(d),this.l=a,this.h=d&&d.messageUrlParams||null,a=d&&d.messageHeaders||null,d&&d.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=d&&d.initMessageHeaders||null,d&&d.messageContentType&&(a?a["X-WebChannel-Content-Type"]=d.messageContentType:a={"X-WebChannel-Content-Type":d.messageContentType}),d&&d.va&&(a?a["X-WebChannel-Client-Profile"]=d.va:a={"X-WebChannel-Client-Profile":d.va}),this.g.S=a,(a=d&&d.Sb)&&!v(a)&&(this.g.m=a),this.v=d&&d.supportsCrossDomainXhr||!1,this.u=d&&d.sendRawJson||!1,(d=d&&d.httpSessionIdParam)&&!v(d)&&(this.g.D=d,a=this.h,a!==null&&d in a&&(a=this.h,d in a&&delete a[d])),this.j=new Bs(this)}R(Ft,Qe),Ft.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ft.prototype.close=function(){ed(this.g)},Ft.prototype.o=function(a){var d=this.g;if(typeof a=="string"){var p={};p.__data__=a,a=p}else this.u&&(p={},p.__data__=ro(a),a=p);d.i.push(new dx(d.Ya++,a)),d.G==3&&dl(d)},Ft.prototype.N=function(){this.g.l=null,delete this.j,ed(this.g),delete this.g,Ft.aa.N.call(this)};function cg(a){Ms.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var d=a.__sm__;if(d){e:{for(const p in d){a=p;break e}a=void 0}(this.i=a)&&(a=this.i,d=d!==null&&a in d?d[a]:void 0),this.data=d}else this.data=a}R(cg,Ms);function ug(){B.call(this),this.status=1}R(ug,B);function Bs(a){this.g=a}R(Bs,lg),Bs.prototype.ua=function(){nt(this.g,"a")},Bs.prototype.ta=function(a){nt(this.g,new cg(a))},Bs.prototype.sa=function(a){nt(this.g,new ug)},Bs.prototype.ra=function(){nt(this.g,"b")},fl.prototype.createWebChannel=fl.prototype.g,Ft.prototype.send=Ft.prototype.o,Ft.prototype.open=Ft.prototype.m,Ft.prototype.close=Ft.prototype.close,kw=function(){return new fl},Pw=function(){return Z()},Aw=O,nf={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},tl.NO_ERROR=0,tl.TIMEOUT=8,tl.HTTP_ERROR=6,nc=tl,Cm.COMPLETE="complete",Nw=Cm,io.EventType=nr,nr.OPEN="a",nr.CLOSE="b",nr.ERROR="c",nr.MESSAGE="d",Qe.prototype.listen=Qe.prototype.K,Do=io,Ae.prototype.listenOnce=Ae.prototype.L,Ae.prototype.getLastError=Ae.prototype.Ka,Ae.prototype.getLastErrorCode=Ae.prototype.Ba,Ae.prototype.getStatus=Ae.prototype.Z,Ae.prototype.getResponseJson=Ae.prototype.Oa,Ae.prototype.getResponseText=Ae.prototype.oa,Ae.prototype.send=Ae.prototype.ea,Ae.prototype.setWithCredentials=Ae.prototype.Ha,Rw=Ae}).apply(typeof Dl<"u"?Dl:typeof self<"u"?self:typeof window<"u"?window:{});const iv="@firebase/firestore",ov="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}yt.UNAUTHENTICATED=new yt(null),yt.GOOGLE_CREDENTIALS=new yt("google-credentials-uid"),yt.FIRST_PARTY=new yt("first-party-uid"),yt.MOCK_USER=new yt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bi="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ss=new Ip("@firebase/firestore");function Hs(){return Ss.logLevel}function K(t,...e){if(Ss.logLevel<=oe.DEBUG){const n=e.map(Lp);Ss.debug(`Firestore (${Bi}): ${t}`,...n)}}function Jn(t,...e){if(Ss.logLevel<=oe.ERROR){const n=e.map(Lp);Ss.error(`Firestore (${Bi}): ${t}`,...n)}}function Ri(t,...e){if(Ss.logLevel<=oe.WARN){const n=e.map(Lp);Ss.warn(`Firestore (${Bi}): ${t}`,...n)}}function Lp(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,bw(t,r,n)}function bw(t,e,n){let r=`FIRESTORE (${Bi}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Jn(r),new Error(r)}function pe(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||bw(e,s,r)}function ee(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class H extends tr{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dw{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class IA{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(yt.UNAUTHENTICATED))}shutdown(){}}class CA{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class RA{constructor(e){this.t=e,this.currentUser=yt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){pe(this.o===void 0,42304);let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new Gn;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Gn,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},l=c=>{K("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(K("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Gn)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(K("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(pe(typeof r.accessToken=="string",31837,{l:r}),new Dw(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return pe(e===null||typeof e=="string",2055,{h:e}),new yt(e)}}class NA{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=yt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class AA{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new NA(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(yt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class av{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class PA{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,cn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){pe(this.o===void 0,3512);const r=i=>{i.error!=null&&K("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,K("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{K("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):K("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new av(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(pe(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new av(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kA(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mp{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=kA(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function ae(t,e){return t<e?-1:t>e?1:0}function rf(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const s=t.charAt(r),i=e.charAt(r);if(s!==i)return Ud(s)===Ud(i)?ae(s,i):Ud(s)?1:-1}return ae(t.length,e.length)}const bA=55296,DA=57343;function Ud(t){const e=t.charCodeAt(0);return e>=bA&&e<=DA}function Ni(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lv="__name__";class wn{constructor(e,n,r){n===void 0?n=0:n>e.length&&J(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&J(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return wn.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof wn?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=wn.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return ae(e.length,n.length)}static compareSegments(e,n){const r=wn.isNumericId(e),s=wn.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?wn.extractNumericId(e).compare(wn.extractNumericId(n)):rf(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return br.fromString(e.substring(4,e.length-2))}}class ye extends wn{construct(e,n,r){return new ye(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new H(V.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new ye(n)}static emptyPath(){return new ye([])}}const jA=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class lt extends wn{construct(e,n,r){return new lt(e,n,r)}static isValidIdentifier(e){return jA.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),lt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===lv}static keyField(){return new lt([lv])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new H(V.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new H(V.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new H(V.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(r+=l,s++):(i(),s++)}if(i(),o)throw new H(V.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new lt(n)}static emptyPath(){return new lt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y{constructor(e){this.path=e}static fromPath(e){return new Y(ye.fromString(e))}static fromName(e){return new Y(ye.fromString(e).popFirst(5))}static empty(){return new Y(ye.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ye.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ye.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Y(new ye(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jw(t,e,n){if(!n)throw new H(V.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function VA(t,e,n,r){if(e===!0&&r===!0)throw new H(V.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function cv(t){if(!Y.isDocumentKey(t))throw new H(V.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function uv(t){if(Y.isDocumentKey(t))throw new H(V.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Vw(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Nu(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":J(12329,{type:typeof t})}function Ct(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new H(V.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Nu(t);throw new H(V.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ze(t,e){const n={typeString:t};return e&&(n.value=e),n}function za(t,e){if(!Vw(t))throw new H(V.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(s&&typeof o!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new H(V.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dv=-62135596800,hv=1e6;class de{static now(){return de.fromMillis(Date.now())}static fromDate(e){return de.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*hv);return new de(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new H(V.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new H(V.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<dv)throw new H(V.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new H(V.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/hv}_compareTo(e){return this.seconds===e.seconds?ae(this.nanoseconds,e.nanoseconds):ae(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:de._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(za(e,de._jsonSchema))return new de(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-dv;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}de._jsonSchemaVersion="firestore/timestamp/1.0",de._jsonSchema={type:ze("string",de._jsonSchemaVersion),seconds:ze("number"),nanoseconds:ze("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class te{static fromTimestamp(e){return new te(e)}static min(){return new te(new de(0,0))}static max(){return new te(new de(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xa=-1;function OA(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=te.fromTimestamp(r===1e9?new de(n+1,0):new de(n,r));return new Lr(s,Y.empty(),e)}function LA(t){return new Lr(t.readTime,t.key,xa)}class Lr{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Lr(te.min(),Y.empty(),xa)}static max(){return new Lr(te.max(),Y.empty(),xa)}}function MA(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Y.comparator(t.documentKey,e.documentKey),n!==0?n:ae(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FA="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class UA{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zi(t){if(t.code!==V.FAILED_PRECONDITION||t.message!==FA)throw t;K("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&J(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new M((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof M?n:M.resolve(n)}catch(n){return M.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):M.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):M.reject(n)}static resolve(e){return new M((n,r)=>{n(e)})}static reject(e){return new M((n,r)=>{r(e)})}static waitFor(e){return new M((n,r)=>{let s=0,i=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++i,o&&i===s&&n()},c=>r(c))}),o=!0,i===s&&n()})}static or(e){let n=M.resolve(!1);for(const r of e)n=n.next(s=>s?M.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new M((r,s)=>{const i=e.length,o=new Array(i);let l=0;for(let c=0;c<i;c++){const u=c;n(e[u]).next(f=>{o[u]=f,++l,l===i&&r(o)},f=>s(f))}})}static doWhile(e,n){return new M((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function BA(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function $i(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Au{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Au.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fp=-1;function Pu(t){return t==null}function Wc(t){return t===0&&1/t==-1/0}function zA(t){return typeof t=="number"&&Number.isInteger(t)&&!Wc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ow="";function $A(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=fv(e)),e=GA(t.get(n),e);return fv(e)}function GA(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case Ow:n+="";break;default:n+=i}}return n}function fv(t){return t+Ow+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pv(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function qr(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Lw(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ne{constructor(e,n){this.comparator=e,this.root=n||at.EMPTY}insert(e,n){return new Ne(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,at.BLACK,null,null))}remove(e){return new Ne(this.comparator,this.root.remove(e,this.comparator).copy(null,null,at.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new jl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new jl(this.root,e,this.comparator,!1)}getReverseIterator(){return new jl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new jl(this.root,e,this.comparator,!0)}}class jl{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class at{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??at.RED,this.left=s??at.EMPTY,this.right=i??at.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new at(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return at.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return at.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,at.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,at.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw J(43730,{key:this.key,value:this.value});if(this.right.isRed())throw J(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw J(27949);return e+(this.isRed()?0:1)}}at.EMPTY=null,at.RED=!0,at.BLACK=!1;at.EMPTY=new class{constructor(){this.size=0}get key(){throw J(57766)}get value(){throw J(16141)}get color(){throw J(16727)}get left(){throw J(29726)}get right(){throw J(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new at(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class We{constructor(e){this.comparator=e,this.data=new Ne(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new mv(this.data.getIterator())}getIteratorFrom(e){return new mv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof We)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new We(this.comparator);return n.data=e,n}}class mv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(e){this.fields=e,e.sort(lt.comparator)}static empty(){return new Gt([])}unionWith(e){let n=new We(lt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Gt(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Ni(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mw extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new Mw("Invalid base64 string: "+i):i}}(e);return new dt(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new dt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ae(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}dt.EMPTY_BYTE_STRING=new dt("");const HA=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Mr(t){if(pe(!!t,39018),typeof t=="string"){let e=0;const n=HA.exec(t);if(pe(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Oe(t.seconds),nanos:Oe(t.nanos)}}function Oe(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Fr(t){return typeof t=="string"?dt.fromBase64String(t):dt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fw="server_timestamp",Uw="__type__",Bw="__previous_value__",zw="__local_write_time__";function Up(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[Uw])==null?void 0:r.stringValue)===Fw}function ku(t){const e=t.mapValue.fields[Bw];return Up(e)?ku(e):e}function Ta(t){const e=Mr(t.mapValue.fields[zw].timestampValue);return new de(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WA{constructor(e,n,r,s,i,o,l,c,u,f){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u,this.isUsingEmulator=f}}const Sa="(default)";class Ia{constructor(e,n){this.projectId=e,this.database=n||Sa}static empty(){return new Ia("","")}get isDefaultDatabase(){return this.database===Sa}isEqual(e){return e instanceof Ia&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $w="__type__",Gw="__max__",Vl={mapValue:{fields:{__type__:{stringValue:Gw}}}},Hw="__vector__",qc="value";function Ur(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Up(t)?4:KA(t)?9007199254740991:qA(t)?10:11:J(28295,{value:t})}function kn(t,e){if(t===e)return!0;const n=Ur(t);if(n!==Ur(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ta(t).isEqual(Ta(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Mr(s.timestampValue),l=Mr(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Fr(s.bytesValue).isEqual(Fr(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Oe(s.geoPointValue.latitude)===Oe(i.geoPointValue.latitude)&&Oe(s.geoPointValue.longitude)===Oe(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Oe(s.integerValue)===Oe(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Oe(s.doubleValue),l=Oe(i.doubleValue);return o===l?Wc(o)===Wc(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return Ni(t.arrayValue.values||[],e.arrayValue.values||[],kn);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},l=i.mapValue.fields||{};if(pv(o)!==pv(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!kn(o[c],l[c])))return!1;return!0}(t,e);default:return J(52216,{left:t})}}function Ca(t,e){return(t.values||[]).find(n=>kn(n,e))!==void 0}function Ai(t,e){if(t===e)return 0;const n=Ur(t),r=Ur(e);if(n!==r)return ae(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ae(t.booleanValue,e.booleanValue);case 2:return function(i,o){const l=Oe(i.integerValue||i.doubleValue),c=Oe(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return gv(t.timestampValue,e.timestampValue);case 4:return gv(Ta(t),Ta(e));case 5:return rf(t.stringValue,e.stringValue);case 6:return function(i,o){const l=Fr(i),c=Fr(o);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),c=o.split("/");for(let u=0;u<l.length&&u<c.length;u++){const f=ae(l[u],c[u]);if(f!==0)return f}return ae(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const l=ae(Oe(i.latitude),Oe(o.latitude));return l!==0?l:ae(Oe(i.longitude),Oe(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return yv(t.arrayValue,e.arrayValue);case 10:return function(i,o){var g,w,R,N;const l=i.fields||{},c=o.fields||{},u=(g=l[qc])==null?void 0:g.arrayValue,f=(w=c[qc])==null?void 0:w.arrayValue,m=ae(((R=u==null?void 0:u.values)==null?void 0:R.length)||0,((N=f==null?void 0:f.values)==null?void 0:N.length)||0);return m!==0?m:yv(u,f)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===Vl.mapValue&&o===Vl.mapValue)return 0;if(i===Vl.mapValue)return 1;if(o===Vl.mapValue)return-1;const l=i.fields||{},c=Object.keys(l),u=o.fields||{},f=Object.keys(u);c.sort(),f.sort();for(let m=0;m<c.length&&m<f.length;++m){const g=rf(c[m],f[m]);if(g!==0)return g;const w=Ai(l[c[m]],u[f[m]]);if(w!==0)return w}return ae(c.length,f.length)}(t.mapValue,e.mapValue);default:throw J(23264,{he:n})}}function gv(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ae(t,e);const n=Mr(t),r=Mr(e),s=ae(n.seconds,r.seconds);return s!==0?s:ae(n.nanos,r.nanos)}function yv(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Ai(n[s],r[s]);if(i)return i}return ae(n.length,r.length)}function Pi(t){return sf(t)}function sf(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Mr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Fr(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return Y.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=sf(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${sf(n.fields[o])}`;return s+"}"}(t.mapValue):J(61005,{value:t})}function rc(t){switch(Ur(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=ku(t);return e?16+rc(e):16;case 5:return 2*t.stringValue.length;case 6:return Fr(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+rc(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return qr(r.fields,(i,o)=>{s+=i.length+rc(o)}),s}(t.mapValue);default:throw J(13486,{value:t})}}function vv(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function of(t){return!!t&&"integerValue"in t}function Bp(t){return!!t&&"arrayValue"in t}function _v(t){return!!t&&"nullValue"in t}function wv(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function sc(t){return!!t&&"mapValue"in t}function qA(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[$w])==null?void 0:r.stringValue)===Hw}function Ko(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return qr(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Ko(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Ko(t.arrayValue.values[n]);return e}return{...t}}function KA(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===Gw}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dt{constructor(e){this.value=e}static empty(){return new Dt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!sc(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ko(n)}setAll(e){let n=lt.emptyPath(),r={},s=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=l.popLast()}o?r[l.lastSegment()]=Ko(o):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());sc(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return kn(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];sc(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){qr(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Dt(Ko(this.value))}}function Ww(t){const e=[];return qr(t.fields,(n,r)=>{const s=new lt([n]);if(sc(r)){const i=Ww(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Gt(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _t{constructor(e,n,r,s,i,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new _t(e,0,te.min(),te.min(),te.min(),Dt.empty(),0)}static newFoundDocument(e,n,r,s){return new _t(e,1,n,te.min(),r,s,0)}static newNoDocument(e,n){return new _t(e,2,n,te.min(),te.min(),Dt.empty(),0)}static newUnknownDocument(e,n){return new _t(e,3,n,te.min(),te.min(),Dt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(te.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Dt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Dt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=te.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof _t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new _t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kc{constructor(e,n){this.position=e,this.inclusive=n}}function Ev(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=Y.comparator(Y.fromName(o.referenceValue),n.key):r=Ai(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function xv(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!kn(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ra{constructor(e,n="asc"){this.field=e,this.dir=n}}function QA(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qw{}class Be extends qw{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new JA(e,n,r):n==="array-contains"?new eP(e,r):n==="in"?new tP(e,r):n==="not-in"?new nP(e,r):n==="array-contains-any"?new rP(e,r):new Be(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new XA(e,r):new ZA(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Ai(n,this.value)):n!==null&&Ur(this.value)===Ur(n)&&this.matchesComparison(Ai(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return J(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class gn extends qw{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new gn(e,n)}matches(e){return Kw(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Kw(t){return t.op==="and"}function Qw(t){return YA(t)&&Kw(t)}function YA(t){for(const e of t.filters)if(e instanceof gn)return!1;return!0}function af(t){if(t instanceof Be)return t.field.canonicalString()+t.op.toString()+Pi(t.value);if(Qw(t))return t.filters.map(e=>af(e)).join(",");{const e=t.filters.map(n=>af(n)).join(",");return`${t.op}(${e})`}}function Yw(t,e){return t instanceof Be?function(r,s){return s instanceof Be&&r.op===s.op&&r.field.isEqual(s.field)&&kn(r.value,s.value)}(t,e):t instanceof gn?function(r,s){return s instanceof gn&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,l)=>i&&Yw(o,s.filters[l]),!0):!1}(t,e):void J(19439)}function Jw(t){return t instanceof Be?function(n){return`${n.field.canonicalString()} ${n.op} ${Pi(n.value)}`}(t):t instanceof gn?function(n){return n.op.toString()+" {"+n.getFilters().map(Jw).join(" ,")+"}"}(t):"Filter"}class JA extends Be{constructor(e,n,r){super(e,n,r),this.key=Y.fromName(r.referenceValue)}matches(e){const n=Y.comparator(e.key,this.key);return this.matchesComparison(n)}}class XA extends Be{constructor(e,n){super(e,"in",n),this.keys=Xw("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class ZA extends Be{constructor(e,n){super(e,"not-in",n),this.keys=Xw("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function Xw(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>Y.fromName(r.referenceValue))}class eP extends Be{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Bp(n)&&Ca(n.arrayValue,this.value)}}class tP extends Be{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Ca(this.value.arrayValue,n)}}class nP extends Be{constructor(e,n){super(e,"not-in",n)}matches(e){if(Ca(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Ca(this.value.arrayValue,n)}}class rP extends Be{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Bp(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Ca(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sP{constructor(e,n=null,r=[],s=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=l,this.Te=null}}function Tv(t,e=null,n=[],r=[],s=null,i=null,o=null){return new sP(t,e,n,r,s,i,o)}function zp(t){const e=ee(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>af(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Pu(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Pi(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Pi(r)).join(",")),e.Te=n}return e.Te}function $p(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!QA(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Yw(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!xv(t.startAt,e.startAt)&&xv(t.endAt,e.endAt)}function lf(t){return Y.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gi{constructor(e,n=null,r=[],s=[],i=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=c,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function iP(t,e,n,r,s,i,o,l){return new Gi(t,e,n,r,s,i,o,l)}function bu(t){return new Gi(t)}function Sv(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Zw(t){return t.collectionGroup!==null}function Qo(t){const e=ee(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new We(lt.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(l=l.add(u.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Ra(i,r))}),n.has(lt.keyField().canonicalString())||e.Ie.push(new Ra(lt.keyField(),r))}return e.Ie}function Cn(t){const e=ee(t);return e.Ee||(e.Ee=oP(e,Qo(t))),e.Ee}function oP(t,e){if(t.limitType==="F")return Tv(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Ra(s.field,i)});const n=t.endAt?new Kc(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Kc(t.startAt.position,t.startAt.inclusive):null;return Tv(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function cf(t,e){const n=t.filters.concat([e]);return new Gi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function uf(t,e,n){return new Gi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Du(t,e){return $p(Cn(t),Cn(e))&&t.limitType===e.limitType}function eE(t){return`${zp(Cn(t))}|lt:${t.limitType}`}function Ws(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>Jw(s)).join(", ")}]`),Pu(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>Pi(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>Pi(s)).join(",")),`Target(${r})`}(Cn(t))}; limitType=${t.limitType})`}function ju(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):Y.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of Qo(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,l,c){const u=Ev(o,l,c);return o.inclusive?u<=0:u<0}(r.startAt,Qo(r),s)||r.endAt&&!function(o,l,c){const u=Ev(o,l,c);return o.inclusive?u>=0:u>0}(r.endAt,Qo(r),s))}(t,e)}function aP(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function tE(t){return(e,n)=>{let r=!1;for(const s of Qo(t)){const i=lP(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function lP(t,e,n){const r=t.field.isKeyField()?Y.comparator(e.key,n.key):function(i,o,l){const c=o.data.field(i),u=l.data.field(i);return c!==null&&u!==null?Ai(c,u):J(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return J(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){qr(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return Lw(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cP=new Ne(Y.comparator);function Xn(){return cP}const nE=new Ne(Y.comparator);function jo(...t){let e=nE;for(const n of t)e=e.insert(n.key,n);return e}function rE(t){let e=nE;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function ds(){return Yo()}function sE(){return Yo()}function Yo(){return new As(t=>t.toString(),(t,e)=>t.isEqual(e))}const uP=new Ne(Y.comparator),dP=new We(Y.comparator);function le(...t){let e=dP;for(const n of t)e=e.add(n);return e}const hP=new We(ae);function fP(){return hP}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gp(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Wc(e)?"-0":e}}function iE(t){return{integerValue:""+t}}function pP(t,e){return zA(e)?iE(e):Gp(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vu{constructor(){this._=void 0}}function mP(t,e,n){return t instanceof Qc?function(s,i){const o={fields:{[Uw]:{stringValue:Fw},[zw]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Up(i)&&(i=ku(i)),i&&(o.fields[Bw]=i),{mapValue:o}}(n,e):t instanceof Na?aE(t,e):t instanceof Aa?lE(t,e):function(s,i){const o=oE(s,i),l=Iv(o)+Iv(s.Ae);return of(o)&&of(s.Ae)?iE(l):Gp(s.serializer,l)}(t,e)}function gP(t,e,n){return t instanceof Na?aE(t,e):t instanceof Aa?lE(t,e):n}function oE(t,e){return t instanceof Yc?function(r){return of(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Qc extends Vu{}class Na extends Vu{constructor(e){super(),this.elements=e}}function aE(t,e){const n=cE(e);for(const r of t.elements)n.some(s=>kn(s,r))||n.push(r);return{arrayValue:{values:n}}}class Aa extends Vu{constructor(e){super(),this.elements=e}}function lE(t,e){let n=cE(e);for(const r of t.elements)n=n.filter(s=>!kn(s,r));return{arrayValue:{values:n}}}class Yc extends Vu{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function Iv(t){return Oe(t.integerValue||t.doubleValue)}function cE(t){return Bp(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function yP(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof Na&&s instanceof Na||r instanceof Aa&&s instanceof Aa?Ni(r.elements,s.elements,kn):r instanceof Yc&&s instanceof Yc?kn(r.Ae,s.Ae):r instanceof Qc&&s instanceof Qc}(t.transform,e.transform)}class vP{constructor(e,n){this.version=e,this.transformResults=n}}class pn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new pn}static exists(e){return new pn(void 0,e)}static updateTime(e){return new pn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ic(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Ou{}function uE(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Hp(t.key,pn.none()):new $a(t.key,t.data,pn.none());{const n=t.data,r=Dt.empty();let s=new We(lt.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Kr(t.key,r,new Gt(s.toArray()),pn.none())}}function _P(t,e,n){t instanceof $a?function(s,i,o){const l=s.value.clone(),c=Rv(s.fieldTransforms,i,o.transformResults);l.setAll(c),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof Kr?function(s,i,o){if(!ic(s.precondition,i))return void i.convertToUnknownDocument(o.version);const l=Rv(s.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(dE(s)),c.setAll(l),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Jo(t,e,n,r){return t instanceof $a?function(i,o,l,c){if(!ic(i.precondition,o))return l;const u=i.value.clone(),f=Nv(i.fieldTransforms,c,o);return u.setAll(f),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof Kr?function(i,o,l,c){if(!ic(i.precondition,o))return l;const u=Nv(i.fieldTransforms,c,o),f=o.data;return f.setAll(dE(i)),f.setAll(u),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(m=>m.field))}(t,e,n,r):function(i,o,l){return ic(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function wP(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=oE(r.transform,s||null);i!=null&&(n===null&&(n=Dt.empty()),n.set(r.field,i))}return n||null}function Cv(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Ni(r,s,(i,o)=>yP(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class $a extends Ou{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Kr extends Ou{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function dE(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Rv(t,e,n){const r=new Map;pe(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,l=e.data.field(i.field);r.set(i.field,gP(o,l,n[s]))}return r}function Nv(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,mP(i,o,e))}return r}class Hp extends Ou{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class EP extends Ou{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xP{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&_P(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Jo(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Jo(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=sE();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=n.has(s.key)?null:l;const c=uE(o,l);c!==null&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(te.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),le())}isEqual(e){return this.batchId===e.batchId&&Ni(this.mutations,e.mutations,(n,r)=>Cv(n,r))&&Ni(this.baseMutations,e.baseMutations,(n,r)=>Cv(n,r))}}class Wp{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){pe(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=function(){return uP}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Wp(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TP{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SP{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Fe,ue;function IP(t){switch(t){case V.OK:return J(64938);case V.CANCELLED:case V.UNKNOWN:case V.DEADLINE_EXCEEDED:case V.RESOURCE_EXHAUSTED:case V.INTERNAL:case V.UNAVAILABLE:case V.UNAUTHENTICATED:return!1;case V.INVALID_ARGUMENT:case V.NOT_FOUND:case V.ALREADY_EXISTS:case V.PERMISSION_DENIED:case V.FAILED_PRECONDITION:case V.ABORTED:case V.OUT_OF_RANGE:case V.UNIMPLEMENTED:case V.DATA_LOSS:return!0;default:return J(15467,{code:t})}}function hE(t){if(t===void 0)return Jn("GRPC error has no .code"),V.UNKNOWN;switch(t){case Fe.OK:return V.OK;case Fe.CANCELLED:return V.CANCELLED;case Fe.UNKNOWN:return V.UNKNOWN;case Fe.DEADLINE_EXCEEDED:return V.DEADLINE_EXCEEDED;case Fe.RESOURCE_EXHAUSTED:return V.RESOURCE_EXHAUSTED;case Fe.INTERNAL:return V.INTERNAL;case Fe.UNAVAILABLE:return V.UNAVAILABLE;case Fe.UNAUTHENTICATED:return V.UNAUTHENTICATED;case Fe.INVALID_ARGUMENT:return V.INVALID_ARGUMENT;case Fe.NOT_FOUND:return V.NOT_FOUND;case Fe.ALREADY_EXISTS:return V.ALREADY_EXISTS;case Fe.PERMISSION_DENIED:return V.PERMISSION_DENIED;case Fe.FAILED_PRECONDITION:return V.FAILED_PRECONDITION;case Fe.ABORTED:return V.ABORTED;case Fe.OUT_OF_RANGE:return V.OUT_OF_RANGE;case Fe.UNIMPLEMENTED:return V.UNIMPLEMENTED;case Fe.DATA_LOSS:return V.DATA_LOSS;default:return J(39323,{code:t})}}(ue=Fe||(Fe={}))[ue.OK=0]="OK",ue[ue.CANCELLED=1]="CANCELLED",ue[ue.UNKNOWN=2]="UNKNOWN",ue[ue.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ue[ue.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ue[ue.NOT_FOUND=5]="NOT_FOUND",ue[ue.ALREADY_EXISTS=6]="ALREADY_EXISTS",ue[ue.PERMISSION_DENIED=7]="PERMISSION_DENIED",ue[ue.UNAUTHENTICATED=16]="UNAUTHENTICATED",ue[ue.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ue[ue.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ue[ue.ABORTED=10]="ABORTED",ue[ue.OUT_OF_RANGE=11]="OUT_OF_RANGE",ue[ue.UNIMPLEMENTED=12]="UNIMPLEMENTED",ue[ue.INTERNAL=13]="INTERNAL",ue[ue.UNAVAILABLE=14]="UNAVAILABLE",ue[ue.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CP(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RP=new br([4294967295,4294967295],0);function Av(t){const e=CP().encode(t),n=new Cw;return n.update(e),new Uint8Array(n.digest())}function Pv(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new br([n,r],0),new br([s,i],0)]}class qp{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Vo(`Invalid padding: ${n}`);if(r<0)throw new Vo(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Vo(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Vo(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=br.fromNumber(this.ge)}ye(e,n,r){let s=e.add(n.multiply(br.fromNumber(r)));return s.compare(RP)===1&&(s=new br([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=Av(e),[r,s]=Pv(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);if(!this.we(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new qp(i,s,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.ge===0)return;const n=Av(e),[r,s]=Pv(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Vo extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lu{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Ga.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Lu(te.min(),s,new Ne(ae),Xn(),le())}}class Ga{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Ga(r,n,le(),le(),le())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oc{constructor(e,n,r,s){this.be=e,this.removedTargetIds=n,this.key=r,this.De=s}}class fE{constructor(e,n){this.targetId=e,this.Ce=n}}class pE{constructor(e,n,r=dt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class kv{constructor(){this.ve=0,this.Fe=bv(),this.Me=dt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=le(),n=le(),r=le();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:J(38017,{changeType:i})}}),new Ga(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=bv()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,pe(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class NP{constructor(e){this.Ge=e,this.ze=new Map,this.je=Xn(),this.Je=Ol(),this.He=Ol(),this.Ye=new Ne(ae)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:J(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,s)=>{this.rt(s)&&n(s)})}st(e){const n=e.targetId,r=e.Ce.count,s=this.ot(n);if(s){const i=s.target;if(lf(i))if(r===0){const o=new Y(i.path);this.et(n,o,_t.newNoDocument(o,te.min()))}else pe(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const l=this.ut(e),c=l?this.ct(l,e,o):1;if(c!==0){this.it(n);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,u)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,l;try{o=Fr(r).toUint8Array()}catch(c){if(c instanceof Mw)return Ri("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new qp(o,s,i)}catch(c){return Ri(c instanceof Vo?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.ge===0?null:l}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Ge.ht(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.et(n,i,null),s++)}),s}Tt(e){const n=new Map;this.ze.forEach((i,o)=>{const l=this.ot(o);if(l){if(i.current&&lf(l.target)){const c=new Y(l.target.path);this.It(c).has(o)||this.Et(o,c)||this.et(o,c,_t.newNoDocument(c,e))}i.Be&&(n.set(o,i.ke()),i.qe())}});let r=le();this.He.forEach((i,o)=>{let l=!0;o.forEachWhile(c=>{const u=this.ot(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const s=new Lu(e,n,this.Ye,this.je,r);return this.je=Xn(),this.Je=Ol(),this.He=Ol(),this.Ye=new Ne(ae),s}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,n)?s.Qe(n,1):s.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new kv,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new We(ae),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new We(ae),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||K("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new kv),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Ol(){return new Ne(Y.comparator)}function bv(){return new Ne(Y.comparator)}const AP=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),PP=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),kP=(()=>({and:"AND",or:"OR"}))();class bP{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function df(t,e){return t.useProto3Json||Pu(e)?e:{value:e}}function Jc(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function mE(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function DP(t,e){return Jc(t,e.toTimestamp())}function Rn(t){return pe(!!t,49232),te.fromTimestamp(function(n){const r=Mr(n);return new de(r.seconds,r.nanos)}(t))}function Kp(t,e){return hf(t,e).canonicalString()}function hf(t,e){const n=function(s){return new ye(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function gE(t){const e=ye.fromString(t);return pe(EE(e),10190,{key:e.toString()}),e}function ff(t,e){return Kp(t.databaseId,e.path)}function Bd(t,e){const n=gE(e);if(n.get(1)!==t.databaseId.projectId)throw new H(V.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new H(V.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Y(vE(n))}function yE(t,e){return Kp(t.databaseId,e)}function jP(t){const e=gE(t);return e.length===4?ye.emptyPath():vE(e)}function pf(t){return new ye(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function vE(t){return pe(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Dv(t,e,n){return{name:ff(t,e),fields:n.value.mapValue.fields}}function VP(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:J(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(u,f){return u.useProto3Json?(pe(f===void 0||typeof f=="string",58123),dt.fromBase64String(f||"")):(pe(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),dt.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(u){const f=u.code===void 0?V.UNKNOWN:hE(u.code);return new H(f,u.message||"")}(o);n=new pE(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Bd(t,r.document.name),i=Rn(r.document.updateTime),o=r.document.createTime?Rn(r.document.createTime):te.min(),l=new Dt({mapValue:{fields:r.document.fields}}),c=_t.newFoundDocument(s,i,o,l),u=r.targetIds||[],f=r.removedTargetIds||[];n=new oc(u,f,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Bd(t,r.document),i=r.readTime?Rn(r.readTime):te.min(),o=_t.newNoDocument(s,i),l=r.removedTargetIds||[];n=new oc([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Bd(t,r.document),i=r.removedTargetIds||[];n=new oc([],i,s,null)}else{if(!("filter"in e))return J(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new SP(s,i),l=r.targetId;n=new fE(l,o)}}return n}function OP(t,e){let n;if(e instanceof $a)n={update:Dv(t,e.key,e.value)};else if(e instanceof Hp)n={delete:ff(t,e.key)};else if(e instanceof Kr)n={update:Dv(t,e.key,e.data),updateMask:HP(e.fieldMask)};else{if(!(e instanceof EP))return J(16599,{Vt:e.type});n={verify:ff(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const l=o.transform;if(l instanceof Qc)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Na)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Aa)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Yc)return{fieldPath:o.field.canonicalString(),increment:l.Ae};throw J(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:DP(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:J(27497)}(t,e.precondition)),n}function LP(t,e){return t&&t.length>0?(pe(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?Rn(s.updateTime):Rn(i);return o.isEqual(te.min())&&(o=Rn(i)),new vP(o,s.transformResults||[])}(n,e))):[]}function MP(t,e){return{documents:[yE(t,e.path)]}}function FP(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=yE(t,s);const i=function(u){if(u.length!==0)return wE(gn.create(u,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(u){if(u.length!==0)return u.map(f=>function(g){return{field:qs(g.field),direction:zP(g.dir)}}(f))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=df(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ft:n,parent:s}}function UP(t){let e=jP(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){pe(r===1,65062);const f=n.from[0];f.allDescendants?s=f.collectionId:e=e.child(f.collectionId)}let i=[];n.where&&(i=function(m){const g=_E(m);return g instanceof gn&&Qw(g)?g.getFilters():[g]}(n.where));let o=[];n.orderBy&&(o=function(m){return m.map(g=>function(R){return new Ra(Ks(R.field),function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(R.direction))}(g))}(n.orderBy));let l=null;n.limit&&(l=function(m){let g;return g=typeof m=="object"?m.value:m,Pu(g)?null:g}(n.limit));let c=null;n.startAt&&(c=function(m){const g=!!m.before,w=m.values||[];return new Kc(w,g)}(n.startAt));let u=null;return n.endAt&&(u=function(m){const g=!m.before,w=m.values||[];return new Kc(w,g)}(n.endAt)),iP(e,s,o,i,l,"F",c,u)}function BP(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return J(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function _E(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Ks(n.unaryFilter.field);return Be.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Ks(n.unaryFilter.field);return Be.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Ks(n.unaryFilter.field);return Be.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Ks(n.unaryFilter.field);return Be.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return J(61313);default:return J(60726)}}(t):t.fieldFilter!==void 0?function(n){return Be.create(Ks(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return J(58110);default:return J(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return gn.create(n.compositeFilter.filters.map(r=>_E(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return J(1026)}}(n.compositeFilter.op))}(t):J(30097,{filter:t})}function zP(t){return AP[t]}function $P(t){return PP[t]}function GP(t){return kP[t]}function qs(t){return{fieldPath:t.canonicalString()}}function Ks(t){return lt.fromServerFormat(t.fieldPath)}function wE(t){return t instanceof Be?function(n){if(n.op==="=="){if(wv(n.value))return{unaryFilter:{field:qs(n.field),op:"IS_NAN"}};if(_v(n.value))return{unaryFilter:{field:qs(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(wv(n.value))return{unaryFilter:{field:qs(n.field),op:"IS_NOT_NAN"}};if(_v(n.value))return{unaryFilter:{field:qs(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:qs(n.field),op:$P(n.op),value:n.value}}}(t):t instanceof gn?function(n){const r=n.getFilters().map(s=>wE(s));return r.length===1?r[0]:{compositeFilter:{op:GP(n.op),filters:r}}}(t):J(54877,{filter:t})}function HP(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function EE(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _r{constructor(e,n,r,s,i=te.min(),o=te.min(),l=dt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new _r(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new _r(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new _r(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new _r(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WP{constructor(e){this.yt=e}}function qP(t){const e=UP({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?uf(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KP{constructor(){this.Cn=new QP}addToCollectionParentIndex(e,n){return this.Cn.add(n),M.resolve()}getCollectionParents(e,n){return M.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return M.resolve()}deleteFieldIndex(e,n){return M.resolve()}deleteAllFieldIndexes(e){return M.resolve()}createTargetIndexes(e,n){return M.resolve()}getDocumentsMatchingTarget(e,n){return M.resolve(null)}getIndexType(e,n){return M.resolve(0)}getFieldIndexes(e,n){return M.resolve([])}getNextCollectionGroupToUpdate(e){return M.resolve(null)}getMinOffset(e,n){return M.resolve(Lr.min())}getMinOffsetFromCollectionGroup(e,n){return M.resolve(Lr.min())}updateCollectionGroup(e,n,r){return M.resolve()}updateIndexEntries(e,n){return M.resolve()}}class QP{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new We(ye.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new We(ye.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jv={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},xE=41943040;class kt{static withCacheSize(e){return new kt(e,kt.DEFAULT_COLLECTION_PERCENTILE,kt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */kt.DEFAULT_COLLECTION_PERCENTILE=10,kt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,kt.DEFAULT=new kt(xE,kt.DEFAULT_COLLECTION_PERCENTILE,kt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),kt.DISABLED=new kt(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ki{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new ki(0)}static cr(){return new ki(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vv="LruGarbageCollector",TE=1048576;function Ov([t,e],[n,r]){const s=ae(t,n);return s===0?ae(e,r):s}class YP{constructor(e){this.Ir=e,this.buffer=new We(Ov),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Ov(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class JP{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){K(Vv,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){$i(n)?K(Vv,"Ignoring IndexedDB error during garbage collection: ",n):await zi(n)}await this.Vr(3e5)})}}class XP{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return M.resolve(Au.ce);const r=new YP(n);return this.mr.forEachTarget(e,s=>r.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>r.Ar(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(K("LruGarbageCollector","Garbage collection skipped; disabled"),M.resolve(jv)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(K("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),jv):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,s,i,o,l,c,u;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(K("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),s=this.params.maximumSequenceNumbersToCollect):s=m,o=Date.now(),this.nthSequenceNumber(e,s))).next(m=>(r=m,l=Date.now(),this.removeTargets(e,r,n))).next(m=>(i=m,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(m=>(u=Date.now(),Hs()<=oe.DEBUG&&K("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${s} in `+(l-o)+`ms
	Removed ${i} targets in `+(c-l)+`ms
	Removed ${m} documents in `+(u-c)+`ms
Total Duration: ${u-f}ms`),M.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:m})))}}function ZP(t,e){return new XP(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ek{constructor(){this.changes=new As(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,_t.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?M.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tk{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nk{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Jo(r.mutation,s,Gt.empty(),de.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,le()).next(()=>r))}getLocalViewOfDocuments(e,n,r=le()){const s=ds();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=jo();return i.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=ds();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,le()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,s){let i=Xn();const o=Yo(),l=function(){return Yo()}();return n.forEach((c,u)=>{const f=r.get(u.key);s.has(u.key)&&(f===void 0||f.mutation instanceof Kr)?i=i.insert(u.key,u):f!==void 0?(o.set(u.key,f.mutation.getFieldMask()),Jo(f.mutation,u,f.mutation.getFieldMask(),de.now())):o.set(u.key,Gt.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((u,f)=>o.set(u,f)),n.forEach((u,f)=>l.set(u,new tk(f,o.get(u)??null))),l))}recalculateAndSaveOverlays(e,n){const r=Yo();let s=new Ne((o,l)=>o-l),i=le();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(c=>{const u=n.get(c);if(u===null)return;let f=r.get(c)||Gt.empty();f=l.applyToLocalView(u,f),r.set(c,f);const m=(s.get(l.batchId)||le()).add(c);s=s.insert(l.batchId,m)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,f=c.value,m=sE();f.forEach(g=>{if(!i.has(g)){const w=uE(n.get(g),r.get(g));w!==null&&m.set(g,w),i=i.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,m))}return M.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return Y.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Zw(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):M.resolve(ds());let l=xa,c=i;return o.next(u=>M.forEach(u,(f,m)=>(l<m.largestBatchId&&(l=m.largestBatchId),i.get(f)?M.resolve():this.remoteDocumentCache.getEntry(e,f).next(g=>{c=c.insert(f,g)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,c,u,le())).next(f=>({batchId:l,changes:rE(f)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Y(n)).next(r=>{let s=jo();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=jo();return this.indexManager.getCollectionParents(e,i).next(l=>M.forEach(l,c=>{const u=function(m,g){return new Gi(g,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(n,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,u,r,s).next(f=>{f.forEach((m,g)=>{o=o.insert(m,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((c,u)=>{const f=u.getKey();o.get(f)===null&&(o=o.insert(f,_t.newInvalidDocument(f)))});let l=jo();return o.forEach((c,u)=>{const f=i.get(c);f!==void 0&&Jo(f.mutation,u,Gt.empty(),de.now()),ju(n,u)&&(l=l.insert(c,u))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rk{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return M.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Rn(s.createTime)}}(n)),M.resolve()}getNamedQuery(e,n){return M.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(s){return{name:s.name,query:qP(s.bundledQuery),readTime:Rn(s.readTime)}}(n)),M.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sk{constructor(){this.overlays=new Ne(Y.comparator),this.qr=new Map}getOverlay(e,n){return M.resolve(this.overlays.get(n))}getOverlays(e,n){const r=ds();return M.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.St(e,n,i)}),M.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(r)),M.resolve()}getOverlaysForCollection(e,n,r){const s=ds(),i=n.length+1,o=new Y(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return M.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Ne((u,f)=>u-f);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let f=i.get(u.largestBatchId);f===null&&(f=ds(),i=i.insert(u.largestBatchId,f)),f.set(u.getKey(),u)}}const l=ds(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,f)=>l.set(u,f)),!(l.size()>=s)););return M.resolve(l)}St(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new TP(n,r));let i=this.qr.get(n);i===void 0&&(i=le(),this.qr.set(n,i)),this.qr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ik{constructor(){this.sessionToken=dt.EMPTY_BYTE_STRING}getSessionToken(e){return M.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,M.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qp{constructor(){this.Qr=new We(Je.$r),this.Ur=new We(Je.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new Je(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new Je(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new Y(new ye([])),r=new Je(n,e),s=new Je(n,e+1),i=[];return this.Ur.forEachInRange([r,s],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new Y(new ye([])),r=new Je(n,e),s=new Je(n,e+1);let i=le();return this.Ur.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new Je(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Je{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return Y.comparator(e.key,n.key)||ae(e.Yr,n.Yr)}static Kr(e,n){return ae(e.Yr,n.Yr)||Y.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ok{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new We(Je.$r)}checkEmpty(e){return M.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new xP(i,n,r,s);this.mutationQueue.push(o);for(const l of s)this.Zr=this.Zr.add(new Je(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return M.resolve(o)}lookupMutationBatch(e,n){return M.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ei(r),i=s<0?0:s;return M.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return M.resolve(this.mutationQueue.length===0?Fp:this.tr-1)}getAllMutationBatches(e){return M.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Je(n,0),s=new Je(n,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],o=>{const l=this.Xr(o.Yr);i.push(l)}),M.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new We(ae);return n.forEach(s=>{const i=new Je(s,0),o=new Je(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],l=>{r=r.add(l.Yr)})}),M.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;Y.isDocumentKey(i)||(i=i.child(""));const o=new Je(new Y(i),0);let l=new We(ae);return this.Zr.forEachWhile(c=>{const u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===s&&(l=l.add(c.Yr)),!0)},o),M.resolve(this.ti(l))}ti(e){const n=[];return e.forEach(r=>{const s=this.Xr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){pe(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return M.forEach(n.mutations,s=>{const i=new Je(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new Je(n,0),s=this.Zr.firstAfterOrEqual(r);return M.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,M.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ak{constructor(e){this.ri=e,this.docs=function(){return new Ne(Y.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return M.resolve(r?r.document.mutableCopy():_t.newInvalidDocument(n))}getEntries(e,n){let r=Xn();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():_t.newInvalidDocument(s))}),M.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=Xn();const o=n.path,l=new Y(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:f}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||MA(LA(f),r)<=0||(s.has(f.key)||ju(n,f))&&(i=i.insert(f.key,f.mutableCopy()))}return M.resolve(i)}getAllFromCollectionGroup(e,n,r,s){J(9500)}ii(e,n){return M.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new lk(this)}getSize(e){return M.resolve(this.size)}}class lk extends ek{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)}),M.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ck{constructor(e){this.persistence=e,this.si=new As(n=>zp(n),$p),this.lastRemoteSnapshotVersion=te.min(),this.highestTargetId=0,this.oi=0,this._i=new Qp,this.targetCount=0,this.ai=ki.ur()}forEachTarget(e,n){return this.si.forEach((r,s)=>n(s)),M.resolve()}getLastRemoteSnapshotVersion(e){return M.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return M.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),M.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),M.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new ki(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,M.resolve()}updateTargetData(e,n){return this.Pr(n),M.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,M.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.si.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),M.waitFor(i).next(()=>s)}getTargetCount(e){return M.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return M.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),M.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),M.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),M.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return M.resolve(r)}containsKey(e,n){return M.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SE{constructor(e,n){this.ui={},this.overlays={},this.ci=new Au(0),this.li=!1,this.li=!0,this.hi=new ik,this.referenceDelegate=e(this),this.Pi=new ck(this),this.indexManager=new KP,this.remoteDocumentCache=function(s){return new ak(s)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new WP(n),this.Ii=new rk(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new sk,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new ok(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){K("MemoryPersistence","Starting transaction:",e);const s=new uk(this.ci.next());return this.referenceDelegate.Ei(),r(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ai(e,n){return M.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class uk extends UA{constructor(e){super(),this.currentSequenceNumber=e}}class Yp{constructor(e){this.persistence=e,this.Ri=new Qp,this.Vi=null}static mi(e){return new Yp(e)}get fi(){if(this.Vi)return this.Vi;throw J(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),M.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),M.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),M.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(s=>this.fi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.fi.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return M.forEach(this.fi,r=>{const s=Y.fromPath(r);return this.gi(e,s).next(i=>{i||n.removeEntry(s,te.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return M.or([()=>M.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class Xc{constructor(e,n){this.persistence=e,this.pi=new As(r=>$A(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=ZP(this,n)}static mi(e,n){return new Xc(e,n)}Ei(){}di(e){return M.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return M.forEach(this.pi,(r,s)=>this.br(e,r,s).next(i=>i?M.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,o=>this.br(e,o,n).next(l=>{l||(r++,i.removeEntry(o,te.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),M.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),M.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),M.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),M.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=rc(e.data.value)),n}br(e,n,r){return M.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.pi.get(n);return M.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jp{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=s}static As(e,n){let r=le(),s=le();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Jp(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dk{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hk{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return s2()?8:BA(Et())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.ys(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new dk;return this.Ss(e,n,o).next(l=>{if(i.result=l,this.Vs)return this.bs(e,n,o,l.size)})}).next(()=>i.result)}bs(e,n,r,s){return r.documentReadCount<this.fs?(Hs()<=oe.DEBUG&&K("QueryEngine","SDK will not create cache indexes for query:",Ws(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),M.resolve()):(Hs()<=oe.DEBUG&&K("QueryEngine","Query:",Ws(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(Hs()<=oe.DEBUG&&K("QueryEngine","The SDK decides to create cache indexes for query:",Ws(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Cn(n))):M.resolve())}ys(e,n){if(Sv(n))return M.resolve(null);let r=Cn(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=uf(n,null,"F"),r=Cn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=le(...i);return this.ps.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(c=>{const u=this.Ds(n,l);return this.Cs(n,u,o,c.readTime)?this.ys(e,uf(n,null,"F")):this.vs(e,u,n,c)}))})))}ws(e,n,r,s){return Sv(n)||s.isEqual(te.min())?M.resolve(null):this.ps.getDocuments(e,r).next(i=>{const o=this.Ds(n,i);return this.Cs(n,o,r,s)?M.resolve(null):(Hs()<=oe.DEBUG&&K("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Ws(n)),this.vs(e,o,n,OA(s,xa)).next(l=>l))})}Ds(e,n){let r=new We(tE(e));return n.forEach((s,i)=>{ju(e,i)&&(r=r.add(i))}),r}Cs(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,n,r){return Hs()<=oe.DEBUG&&K("QueryEngine","Using full collection scan to execute query:",Ws(n)),this.ps.getDocumentsMatchingQuery(e,n,Lr.min(),r)}vs(e,n,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xp="LocalStore",fk=3e8;class pk{constructor(e,n,r,s){this.persistence=e,this.Fs=n,this.serializer=s,this.Ms=new Ne(ae),this.xs=new As(i=>zp(i),$p),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new nk(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function mk(t,e,n,r){return new pk(t,e,n,r)}async function IE(t,e){const n=ee(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],l=[];let c=le();for(const u of s){o.push(u.batchId);for(const f of u.mutations)c=c.add(f.key)}for(const u of i){l.push(u.batchId);for(const f of u.mutations)c=c.add(f.key)}return n.localDocuments.getDocuments(r,c).next(u=>({Ls:u,removedBatchIds:o,addedBatchIds:l}))})})}function gk(t,e){const n=ee(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(l,c,u,f){const m=u.batch,g=m.keys();let w=M.resolve();return g.forEach(R=>{w=w.next(()=>f.getEntry(c,R)).next(N=>{const P=u.docVersions.get(R);pe(P!==null,48541),N.version.compareTo(P)<0&&(m.applyToRemoteDocument(N,u),N.isValidDocument()&&(N.setReadTime(u.commitVersion),f.addEntry(N)))})}),w.next(()=>l.mutationQueue.removeMutationBatch(c,m))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let c=le();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function CE(t){const e=ee(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function yk(t,e){const n=ee(t),r=e.snapshotVersion;let s=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});s=n.Ms;const l=[];e.targetChanges.forEach((f,m)=>{const g=s.get(m);if(!g)return;l.push(n.Pi.removeMatchingKeys(i,f.removedDocuments,m).next(()=>n.Pi.addMatchingKeys(i,f.addedDocuments,m)));let w=g.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(m)!==null?w=w.withResumeToken(dt.EMPTY_BYTE_STRING,te.min()).withLastLimboFreeSnapshotVersion(te.min()):f.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(f.resumeToken,r)),s=s.insert(m,w),function(N,P,x){return N.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-N.snapshotVersion.toMicroseconds()>=fk?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0}(g,w,f)&&l.push(n.Pi.updateTargetData(i,w))});let c=Xn(),u=le();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,f))}),l.push(vk(i,o,e.documentUpdates).next(f=>{c=f.ks,u=f.qs})),!r.isEqual(te.min())){const f=n.Pi.getLastRemoteSnapshotVersion(i).next(m=>n.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(f)}return M.waitFor(l).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,u)).next(()=>c)}).then(i=>(n.Ms=s,i))}function vk(t,e,n){let r=le(),s=le();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=Xn();return n.forEach((l,c)=>{const u=i.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(l)),c.isNoDocument()&&c.version.isEqual(te.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):K(Xp,"Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)}),{ks:o,qs:s}})}function _k(t,e){const n=ee(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Fp),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function wk(t,e){const n=ee(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Pi.getTargetData(r,e).next(i=>i?(s=i,M.resolve(s)):n.Pi.allocateTargetId(r).next(o=>(s=new _r(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function mf(t,e,n){const r=ee(t),s=r.Ms.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!$i(o))throw o;K(Xp,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function Lv(t,e,n){const r=ee(t);let s=te.min(),i=le();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,f){const m=ee(c),g=m.xs.get(f);return g!==void 0?M.resolve(m.Ms.get(g)):m.Pi.getTargetData(u,f)}(r,o,Cn(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,l.targetId).next(c=>{i=c})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?s:te.min(),n?i:le())).next(l=>(Ek(r,aP(e),l),{documents:l,Qs:i})))}function Ek(t,e,n){let r=t.Os.get(e)||te.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Os.set(e,r)}class Mv{constructor(){this.activeTargetIds=fP()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class xk{constructor(){this.Mo=new Mv,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Mv,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tk{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fv="ConnectivityMonitor";class Uv{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){K(Fv,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){K(Fv,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ll=null;function gf(){return Ll===null?Ll=function(){return 268435456+Math.round(2147483648*Math.random())}():Ll++,"0x"+Ll.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zd="RestConnection",Sk={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Ik{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===Sa?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,n,r,s,i){const o=gf(),l=this.zo(e,n.toUriEncodedString());K(zd,`Sending RPC '${e}' ${o}:`,l,r);const c={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(c,s,i);const{host:u}=new URL(l),f=Ns(u);return this.Jo(e,l,c,r,f).then(m=>(K(zd,`Received RPC '${e}' ${o}: `,m),m),m=>{throw Ri(zd,`RPC '${e}' ${o} failed with error: `,m,"url: ",l,"request:",r),m})}Ho(e,n,r,s,i,o){return this.Go(e,n,r,s,i)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Bi}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}zo(e,n){const r=Sk[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ck{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gt="WebChannelConnection";class Rk extends Ik{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,s,i){const o=gf();return new Promise((l,c)=>{const u=new Rw;u.setWithCredentials(!0),u.listenOnce(Nw.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case nc.NO_ERROR:const m=u.getResponseJson();K(gt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(m)),l(m);break;case nc.TIMEOUT:K(gt,`RPC '${e}' ${o} timed out`),c(new H(V.DEADLINE_EXCEEDED,"Request time out"));break;case nc.HTTP_ERROR:const g=u.getStatus();if(K(gt,`RPC '${e}' ${o} failed with status:`,g,"response text:",u.getResponseText()),g>0){let w=u.getResponseJson();Array.isArray(w)&&(w=w[0]);const R=w==null?void 0:w.error;if(R&&R.status&&R.message){const N=function(x){const v=x.toLowerCase().replace(/_/g,"-");return Object.values(V).indexOf(v)>=0?v:V.UNKNOWN}(R.status);c(new H(N,R.message))}else c(new H(V.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new H(V.UNAVAILABLE,"Connection failed."));break;default:J(9055,{l_:e,streamId:o,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{K(gt,`RPC '${e}' ${o} completed.`)}});const f=JSON.stringify(s);K(gt,`RPC '${e}' ${o} sending request:`,s),u.send(n,"POST",f,r,15)})}T_(e,n,r){const s=gf(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=kw(),l=Pw(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.jo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const f=i.join("");K(gt,`Creating RPC '${e}' stream ${s}: ${f}`,c);const m=o.createWebChannel(f,c);this.I_(m);let g=!1,w=!1;const R=new Ck({Yo:P=>{w?K(gt,`Not sending because RPC '${e}' stream ${s} is closed:`,P):(g||(K(gt,`Opening RPC '${e}' stream ${s} transport.`),m.open(),g=!0),K(gt,`RPC '${e}' stream ${s} sending:`,P),m.send(P))},Zo:()=>m.close()}),N=(P,x,v)=>{P.listen(x,S=>{try{v(S)}catch(D){setTimeout(()=>{throw D},0)}})};return N(m,Do.EventType.OPEN,()=>{w||(K(gt,`RPC '${e}' stream ${s} transport opened.`),R.o_())}),N(m,Do.EventType.CLOSE,()=>{w||(w=!0,K(gt,`RPC '${e}' stream ${s} transport closed`),R.a_(),this.E_(m))}),N(m,Do.EventType.ERROR,P=>{w||(w=!0,Ri(gt,`RPC '${e}' stream ${s} transport errored. Name:`,P.name,"Message:",P.message),R.a_(new H(V.UNAVAILABLE,"The operation could not be completed")))}),N(m,Do.EventType.MESSAGE,P=>{var x;if(!w){const v=P.data[0];pe(!!v,16349);const S=v,D=(S==null?void 0:S.error)||((x=S[0])==null?void 0:x.error);if(D){K(gt,`RPC '${e}' stream ${s} received error:`,D);const F=D.status;let z=function(I){const E=Fe[I];if(E!==void 0)return hE(E)}(F),T=D.message;z===void 0&&(z=V.INTERNAL,T="Unknown error status: "+F+" with message "+D.message),w=!0,R.a_(new H(z,T)),m.close()}else K(gt,`RPC '${e}' stream ${s} received:`,v),R.u_(v)}}),N(l,Aw.STAT_EVENT,P=>{P.stat===nf.PROXY?K(gt,`RPC '${e}' stream ${s} detected buffering proxy`):P.stat===nf.NOPROXY&&K(gt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{R.__()},0),R}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}function $d(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mu(t){return new bP(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RE{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,n-r);s>0&&K("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bv="PersistentStream";class NE{constructor(e,n,r,s,i,o,l,c){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new RE(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===V.RESOURCE_EXHAUSTED?(Jn(n.toString()),Jn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===V.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.D_===n&&this.G_(r,s)},r=>{e(()=>{const s=new H(V.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{r(()=>this.z_(s))}),this.stream.onMessage(s=>{r(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return K(Bv,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(K(Bv,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Nk extends NE{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=VP(this.serializer,e),r=function(i){if(!("targetChange"in i))return te.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?te.min():o.readTime?Rn(o.readTime):te.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=pf(this.serializer),n.addTarget=function(i,o){let l;const c=o.target;if(l=lf(c)?{documents:MP(i,c)}:{query:FP(i,c).ft},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=mE(i,o.resumeToken);const u=df(i,o.expectedCount);u!==null&&(l.expectedCount=u)}else if(o.snapshotVersion.compareTo(te.min())>0){l.readTime=Jc(i,o.snapshotVersion.toTimestamp());const u=df(i,o.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const r=BP(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=pf(this.serializer),n.removeTarget=e,this.q_(n)}}class Ak extends NE{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return pe(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,pe(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){pe(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=LP(e.writeResults,e.commitTime),r=Rn(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=pf(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>OP(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pk{}class kk extends Pk{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new H(V.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,hf(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===V.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new H(V.UNKNOWN,i.toString())})}Ho(e,n,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Ho(e,hf(n,r),s,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===V.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new H(V.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class bk{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Jn(n),this.aa=!1):K("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Is="RemoteStore";class Dk{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{Ps(this)&&(K(Is,"Restarting streams for network reachability change."),await async function(c){const u=ee(c);u.Ea.add(4),await Hi(u),u.Ra.set("Unknown"),u.Ea.delete(4),await Ha(u)}(this))})}),this.Ra=new bk(r,s)}}async function Ha(t){if(Ps(t))for(const e of t.da)await e(!0)}async function Hi(t){for(const e of t.da)await e(!1)}function AE(t,e){const n=ee(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),nm(n)?tm(n):Wi(n).O_()&&em(n,e))}function Zp(t,e){const n=ee(t),r=Wi(n);n.Ia.delete(e),r.O_()&&PE(n,e),n.Ia.size===0&&(r.O_()?r.L_():Ps(n)&&n.Ra.set("Unknown"))}function em(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(te.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Wi(t).Y_(e)}function PE(t,e){t.Va.Ue(e),Wi(t).Z_(e)}function tm(t){t.Va=new NP({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Wi(t).start(),t.Ra.ua()}function nm(t){return Ps(t)&&!Wi(t).x_()&&t.Ia.size>0}function Ps(t){return ee(t).Ea.size===0}function kE(t){t.Va=void 0}async function jk(t){t.Ra.set("Online")}async function Vk(t){t.Ia.forEach((e,n)=>{em(t,e)})}async function Ok(t,e){kE(t),nm(t)?(t.Ra.ha(e),tm(t)):t.Ra.set("Unknown")}async function Lk(t,e,n){if(t.Ra.set("Online"),e instanceof pE&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const l of i.targetIds)s.Ia.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.Ia.delete(l),s.Va.removeTarget(l))}(t,e)}catch(r){K(Is,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Zc(t,r)}else if(e instanceof oc?t.Va.Ze(e):e instanceof fE?t.Va.st(e):t.Va.tt(e),!n.isEqual(te.min()))try{const r=await CE(t.localStore);n.compareTo(r)>=0&&await function(i,o){const l=i.Va.Tt(o);return l.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const f=i.Ia.get(u);f&&i.Ia.set(u,f.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,u)=>{const f=i.Ia.get(c);if(!f)return;i.Ia.set(c,f.withResumeToken(dt.EMPTY_BYTE_STRING,f.snapshotVersion)),PE(i,c);const m=new _r(f.target,c,u,f.sequenceNumber);em(i,m)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){K(Is,"Failed to raise snapshot:",r),await Zc(t,r)}}async function Zc(t,e,n){if(!$i(e))throw e;t.Ea.add(1),await Hi(t),t.Ra.set("Offline"),n||(n=()=>CE(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{K(Is,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await Ha(t)})}function bE(t,e){return e().catch(n=>Zc(t,n,e))}async function Fu(t){const e=ee(t),n=Br(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Fp;for(;Mk(e);)try{const s=await _k(e.localStore,r);if(s===null){e.Ta.length===0&&n.L_();break}r=s.batchId,Fk(e,s)}catch(s){await Zc(e,s)}DE(e)&&jE(e)}function Mk(t){return Ps(t)&&t.Ta.length<10}function Fk(t,e){t.Ta.push(e);const n=Br(t);n.O_()&&n.X_&&n.ea(e.mutations)}function DE(t){return Ps(t)&&!Br(t).x_()&&t.Ta.length>0}function jE(t){Br(t).start()}async function Uk(t){Br(t).ra()}async function Bk(t){const e=Br(t);for(const n of t.Ta)e.ea(n.mutations)}async function zk(t,e,n){const r=t.Ta.shift(),s=Wp.from(r,e,n);await bE(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Fu(t)}async function $k(t,e){e&&Br(t).X_&&await async function(r,s){if(function(o){return IP(o)&&o!==V.ABORTED}(s.code)){const i=r.Ta.shift();Br(r).B_(),await bE(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Fu(r)}}(t,e),DE(t)&&jE(t)}async function zv(t,e){const n=ee(t);n.asyncQueue.verifyOperationInProgress(),K(Is,"RemoteStore received new credentials");const r=Ps(n);n.Ea.add(3),await Hi(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await Ha(n)}async function Gk(t,e){const n=ee(t);e?(n.Ea.delete(2),await Ha(n)):e||(n.Ea.add(2),await Hi(n),n.Ra.set("Unknown"))}function Wi(t){return t.ma||(t.ma=function(n,r,s){const i=ee(n);return i.sa(),new Nk(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:jk.bind(null,t),t_:Vk.bind(null,t),r_:Ok.bind(null,t),H_:Lk.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),nm(t)?tm(t):t.Ra.set("Unknown")):(await t.ma.stop(),kE(t))})),t.ma}function Br(t){return t.fa||(t.fa=function(n,r,s){const i=ee(n);return i.sa(),new Ak(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:Uk.bind(null,t),r_:$k.bind(null,t),ta:Bk.bind(null,t),na:zk.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Fu(t)):(await t.fa.stop(),t.Ta.length>0&&(K(Is,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rm{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Gn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,l=new rm(e,n,o,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new H(V.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function sm(t,e){if(Jn("AsyncQueue",`${e}: ${t}`),$i(t))return new H(V.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi{static emptySet(e){return new gi(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||Y.comparator(n.key,r.key):(n,r)=>Y.comparator(n.key,r.key),this.keyedMap=jo(),this.sortedSet=new Ne(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof gi)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new gi;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $v{constructor(){this.ga=new Ne(Y.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):J(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class bi{constructor(e,n,r,s,i,o,l,c,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new bi(e,n,gi.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Du(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hk{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class Wk{constructor(){this.queries=Gv(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const s=ee(n),i=s.queries;s.queries=Gv(),i.forEach((o,l)=>{for(const c of l.Sa)c.onError(r)})})(this,new H(V.ABORTED,"Firestore shutting down"))}}function Gv(){return new As(t=>eE(t),Du)}async function im(t,e){const n=ee(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new Hk,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await n.onListen(s,!0);break;case 1:i.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const l=sm(o,`Initialization of query '${Ws(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.Sa.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&am(n)}async function om(t,e){const n=ee(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function qk(t,e){const n=ee(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const l of o.Sa)l.Fa(s)&&(r=!0);o.wa=s}}r&&am(n)}function Kk(t,e,n){const r=ee(t),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(n);r.queries.delete(e)}function am(t){t.Ca.forEach(e=>{e.next()})}var yf,Hv;(Hv=yf||(yf={})).Ma="default",Hv.Cache="cache";class lm{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new bi(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=bi.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==yf.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VE{constructor(e){this.key=e}}class OE{constructor(e){this.key=e}}class Qk{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=le(),this.mutatedKeys=le(),this.eu=tE(e),this.tu=new gi(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new $v,s=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,l=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((f,m)=>{const g=s.get(f),w=ju(this.query,m)?m:null,R=!!g&&this.mutatedKeys.has(g.key),N=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations);let P=!1;g&&w?g.data.isEqual(w.data)?R!==N&&(r.track({type:3,doc:w}),P=!0):this.su(g,w)||(r.track({type:2,doc:w}),P=!0,(c&&this.eu(w,c)>0||u&&this.eu(w,u)<0)&&(l=!0)):!g&&w?(r.track({type:0,doc:w}),P=!0):g&&!w&&(r.track({type:1,doc:g}),P=!0,(c||u)&&(l=!0)),P&&(w?(o=o.add(w),i=N?i.add(f):i.delete(f)):(o=o.delete(f),i=i.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),i=i.delete(f.key),r.track({type:1,doc:f})}return{tu:o,iu:r,Cs:l,mutatedKeys:i}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((f,m)=>function(w,R){const N=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return J(20277,{Rt:P})}};return N(w)-N(R)}(f.type,m.type)||this.eu(f.doc,m.doc)),this.ou(r),s=s??!1;const l=n&&!s?this._u():[],c=this.Xa.size===0&&this.current&&!s?1:0,u=c!==this.Za;return this.Za=c,o.length!==0||u?{snapshot:new bi(this.query,e.tu,i,o,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:l}:{au:l}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new $v,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=le(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new OE(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new VE(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=le();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return bi.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const cm="SyncEngine";class Yk{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class Jk{constructor(e){this.key=e,this.hu=!1}}class Xk{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new As(l=>eE(l),Du),this.Iu=new Map,this.Eu=new Set,this.du=new Ne(Y.comparator),this.Au=new Map,this.Ru=new Qp,this.Vu={},this.mu=new Map,this.fu=ki.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Zk(t,e,n=!0){const r=zE(t);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await LE(r,e,n,!0),s}async function eb(t,e){const n=zE(t);await LE(n,e,!0,!1)}async function LE(t,e,n,r){const s=await wk(t.localStore,Cn(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await tb(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&AE(t.remoteStore,s),l}async function tb(t,e,n,r,s){t.pu=(m,g,w)=>async function(N,P,x,v){let S=P.view.ru(x);S.Cs&&(S=await Lv(N.localStore,P.query,!1).then(({documents:T})=>P.view.ru(T,S)));const D=v&&v.targetChanges.get(P.targetId),F=v&&v.targetMismatches.get(P.targetId)!=null,z=P.view.applyChanges(S,N.isPrimaryClient,D,F);return qv(N,P.targetId,z.au),z.snapshot}(t,m,g,w);const i=await Lv(t.localStore,e,!0),o=new Qk(e,i.Qs),l=o.ru(i.documents),c=Ga.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),u=o.applyChanges(l,t.isPrimaryClient,c);qv(t,n,u.au);const f=new Yk(e,n,o);return t.Tu.set(e,f),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),u.snapshot}async function nb(t,e,n){const r=ee(t),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter(o=>!Du(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await mf(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Zp(r.remoteStore,s.targetId),vf(r,s.targetId)}).catch(zi)):(vf(r,s.targetId),await mf(r.localStore,s.targetId,!0))}async function rb(t,e){const n=ee(t),r=n.Tu.get(e),s=n.Iu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Zp(n.remoteStore,r.targetId))}async function sb(t,e,n){const r=db(t);try{const s=await function(o,l){const c=ee(o),u=de.now(),f=l.reduce((w,R)=>w.add(R.key),le());let m,g;return c.persistence.runTransaction("Locally write mutations","readwrite",w=>{let R=Xn(),N=le();return c.Ns.getEntries(w,f).next(P=>{R=P,R.forEach((x,v)=>{v.isValidDocument()||(N=N.add(x))})}).next(()=>c.localDocuments.getOverlayedDocuments(w,R)).next(P=>{m=P;const x=[];for(const v of l){const S=wP(v,m.get(v.key).overlayedDocument);S!=null&&x.push(new Kr(v.key,S,Ww(S.value.mapValue),pn.exists(!0)))}return c.mutationQueue.addMutationBatch(w,u,x,l)}).next(P=>{g=P;const x=P.applyToLocalDocumentSet(m,N);return c.documentOverlayCache.saveOverlays(w,P.batchId,x)})}).then(()=>({batchId:g.batchId,changes:rE(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,l,c){let u=o.Vu[o.currentUser.toKey()];u||(u=new Ne(ae)),u=u.insert(l,c),o.Vu[o.currentUser.toKey()]=u}(r,s.batchId,n),await Wa(r,s.changes),await Fu(r.remoteStore)}catch(s){const i=sm(s,"Failed to persist write");n.reject(i)}}async function ME(t,e){const n=ee(t);try{const r=await yk(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Au.get(i);o&&(pe(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?pe(o.hu,14607):s.removedDocuments.size>0&&(pe(o.hu,42227),o.hu=!1))}),await Wa(n,r,e)}catch(r){await zi(r)}}function Wv(t,e,n){const r=ee(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Tu.forEach((i,o)=>{const l=o.view.va(e);l.snapshot&&s.push(l.snapshot)}),function(o,l){const c=ee(o);c.onlineState=l;let u=!1;c.queries.forEach((f,m)=>{for(const g of m.Sa)g.va(l)&&(u=!0)}),u&&am(c)}(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function ib(t,e,n){const r=ee(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Au.get(e),i=s&&s.key;if(i){let o=new Ne(Y.comparator);o=o.insert(i,_t.newNoDocument(i,te.min()));const l=le().add(i),c=new Lu(te.min(),new Map,new Ne(ae),o,l);await ME(r,c),r.du=r.du.remove(i),r.Au.delete(e),um(r)}else await mf(r.localStore,e,!1).then(()=>vf(r,e,n)).catch(zi)}async function ob(t,e){const n=ee(t),r=e.batch.batchId;try{const s=await gk(n.localStore,e);UE(n,r,null),FE(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Wa(n,s)}catch(s){await zi(s)}}async function ab(t,e,n){const r=ee(t);try{const s=await function(o,l){const c=ee(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let f;return c.mutationQueue.lookupMutationBatch(u,l).next(m=>(pe(m!==null,37113),f=m.keys(),c.mutationQueue.removeMutationBatch(u,m))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,f,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,f)).next(()=>c.localDocuments.getDocuments(u,f))})}(r.localStore,e);UE(r,e,n),FE(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Wa(r,s)}catch(s){await zi(s)}}function FE(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function UE(t,e,n){const r=ee(t);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function vf(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||BE(t,r)})}function BE(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Zp(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),um(t))}function qv(t,e,n){for(const r of n)r instanceof VE?(t.Ru.addReference(r.key,e),lb(t,r)):r instanceof OE?(K(cm,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||BE(t,r.key)):J(19791,{wu:r})}function lb(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(K(cm,"New document in limbo: "+n),t.Eu.add(r),um(t))}function um(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new Y(ye.fromString(e)),r=t.fu.next();t.Au.set(r,new Jk(n)),t.du=t.du.insert(n,r),AE(t.remoteStore,new _r(Cn(bu(n.path)),r,"TargetPurposeLimboResolution",Au.ce))}}async function Wa(t,e,n){const r=ee(t),s=[],i=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((l,c)=>{o.push(r.pu(c,e,n).then(u=>{var f;if((u||n)&&r.isPrimaryClient){const m=u?!u.fromCache:(f=n==null?void 0:n.targetChanges.get(c.targetId))==null?void 0:f.current;r.sharedClientState.updateQueryState(c.targetId,m?"current":"not-current")}if(u){s.push(u);const m=Jp.As(c.targetId,u);i.push(m)}}))}),await Promise.all(o),r.Pu.H_(s),await async function(c,u){const f=ee(c);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>M.forEach(u,g=>M.forEach(g.Es,w=>f.persistence.referenceDelegate.addReference(m,g.targetId,w)).next(()=>M.forEach(g.ds,w=>f.persistence.referenceDelegate.removeReference(m,g.targetId,w)))))}catch(m){if(!$i(m))throw m;K(Xp,"Failed to update sequence numbers: "+m)}for(const m of u){const g=m.targetId;if(!m.fromCache){const w=f.Ms.get(g),R=w.snapshotVersion,N=w.withLastLimboFreeSnapshotVersion(R);f.Ms=f.Ms.insert(g,N)}}}(r.localStore,i))}async function cb(t,e){const n=ee(t);if(!n.currentUser.isEqual(e)){K(cm,"User change. New user:",e.toKey());const r=await IE(n.localStore,e);n.currentUser=e,function(i,o){i.mu.forEach(l=>{l.forEach(c=>{c.reject(new H(V.CANCELLED,o))})}),i.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Wa(n,r.Ls)}}function ub(t,e){const n=ee(t),r=n.Au.get(e);if(r&&r.hu)return le().add(r.key);{let s=le();const i=n.Iu.get(e);if(!i)return s;for(const o of i){const l=n.Tu.get(o);s=s.unionWith(l.view.nu)}return s}}function zE(t){const e=ee(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=ME.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=ub.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=ib.bind(null,e),e.Pu.H_=qk.bind(null,e.eventManager),e.Pu.yu=Kk.bind(null,e.eventManager),e}function db(t){const e=ee(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=ob.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=ab.bind(null,e),e}class eu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Mu(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return mk(this.persistence,new hk,e.initialUser,this.serializer)}Cu(e){return new SE(Yp.mi,this.serializer)}Du(e){return new xk}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}eu.provider={build:()=>new eu};class hb extends eu{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){pe(this.persistence.referenceDelegate instanceof Xc,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new JP(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?kt.withCacheSize(this.cacheSizeBytes):kt.DEFAULT;return new SE(r=>Xc.mi(r,n),this.serializer)}}class _f{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Wv(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=cb.bind(null,this.syncEngine),await Gk(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Wk}()}createDatastore(e){const n=Mu(e.databaseInfo.databaseId),r=function(i){return new Rk(i)}(e.databaseInfo);return function(i,o,l,c){return new kk(i,o,l,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,l){return new Dk(r,s,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>Wv(this.syncEngine,n,0),function(){return Uv.v()?new Uv:new Tk}())}createSyncEngine(e,n){return function(s,i,o,l,c,u,f){const m=new Xk(s,i,o,l,c,u);return f&&(m.gu=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=ee(s);K(Is,"RemoteStore shutting down."),i.Ea.add(5),await Hi(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}_f.provider={build:()=>new _f};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dm{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Jn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zr="FirestoreClient";class fb{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=yt.UNAUTHENTICATED,this.clientId=Mp.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{K(zr,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(K(zr,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Gn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=sm(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Gd(t,e){t.asyncQueue.verifyOperationInProgress(),K(zr,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await IE(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Kv(t,e){t.asyncQueue.verifyOperationInProgress();const n=await $E(t);K(zr,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>zv(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>zv(e.remoteStore,s)),t._onlineComponents=e}async function $E(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){K(zr,"Using user provided OfflineComponentProvider");try{await Gd(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===V.FAILED_PRECONDITION||s.code===V.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Ri("Error using user provided cache. Falling back to memory cache: "+n),await Gd(t,new eu)}}else K(zr,"Using default OfflineComponentProvider"),await Gd(t,new hb(void 0));return t._offlineComponents}async function hm(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(K(zr,"Using user provided OnlineComponentProvider"),await Kv(t,t._uninitializedComponentsProvider._online)):(K(zr,"Using default OnlineComponentProvider"),await Kv(t,new _f))),t._onlineComponents}function GE(t){return $E(t).then(e=>e.persistence)}function HE(t){return hm(t).then(e=>e.remoteStore)}function pb(t){return hm(t).then(e=>e.syncEngine)}async function tu(t){const e=await hm(t),n=e.eventManager;return n.onListen=Zk.bind(null,e.syncEngine),n.onUnlisten=nb.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=eb.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=rb.bind(null,e.syncEngine),n}function mb(t){return t.asyncQueue.enqueue(async()=>{const e=await GE(t),n=await HE(t);return e.setNetworkEnabled(!0),function(s){const i=ee(s);return i.Ea.delete(0),Ha(i)}(n)})}function gb(t){return t.asyncQueue.enqueue(async()=>{const e=await GE(t),n=await HE(t);return e.setNetworkEnabled(!1),async function(s){const i=ee(s);i.Ea.add(0),await Hi(i),i.Ra.set("Offline")}(n)})}function yb(t,e,n={}){const r=new Gn;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,u){const f=new dm({next:g=>{f.Nu(),o.enqueueAndForget(()=>om(i,m));const w=g.docs.has(l);!w&&g.fromCache?u.reject(new H(V.UNAVAILABLE,"Failed to get document because the client is offline.")):w&&g.fromCache&&c&&c.source==="server"?u.reject(new H(V.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(g)},error:g=>u.reject(g)}),m=new lm(bu(l.path),f,{includeMetadataChanges:!0,qa:!0});return im(i,m)}(await tu(t),t.asyncQueue,e,n,r)),r.promise}function vb(t,e,n={}){const r=new Gn;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,u){const f=new dm({next:g=>{f.Nu(),o.enqueueAndForget(()=>om(i,m)),g.fromCache&&c.source==="server"?u.reject(new H(V.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(g)},error:g=>u.reject(g)}),m=new lm(l,f,{includeMetadataChanges:!0,qa:!0});return im(i,m)}(await tu(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WE(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qv=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qE="firestore.googleapis.com",Yv=!0;class Jv{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new H(V.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=qE,this.ssl=Yv}else this.host=e.host,this.ssl=e.ssl??Yv;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=xE;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<TE)throw new H(V.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}VA("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=WE(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new H(V.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new H(V.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new H(V.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Uu{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Jv({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new H(V.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new H(V.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Jv(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new IA;switch(r.type){case"firstParty":return new AA(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new H(V.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Qv.get(n);r&&(K("ComponentProvider","Removing Datastore"),Qv.delete(n),r.terminate())}(this),Promise.resolve()}}function _b(t,e,n,r={}){var u;t=Ct(t,Uu);const s=Ns(e),i=t._getSettings(),o={...i,emulatorOptions:t._getEmulatorOptions()},l=`${e}:${n}`;s&&(Sp(`https://${l}`),$0("Firestore",!0)),i.host!==qE&&i.host!==l&&Ri("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...i,host:l,ssl:s,emulatorOptions:r};if(!Or(c,o)&&(t._setSettings(c),r.mockUserToken)){let f,m;if(typeof r.mockUserToken=="string")f=r.mockUserToken,m=yt.MOCK_USER;else{f=QC(r.mockUserToken,(u=t._app)==null?void 0:u.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new H(V.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new yt(g)}t._authCredentials=new CA(new Dw(f,m))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Qr(this.firestore,e,this._query)}}class ke{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Dr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ke(this.firestore,e,this._key)}toJSON(){return{type:ke._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(za(n,ke._jsonSchema))return new ke(e,r||null,new Y(ye.fromString(n.referencePath)))}}ke._jsonSchemaVersion="firestore/documentReference/1.0",ke._jsonSchema={type:ze("string",ke._jsonSchemaVersion),referencePath:ze("string")};class Dr extends Qr{constructor(e,n,r){super(e,n,bu(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ke(this.firestore,null,new Y(e))}withConverter(e){return new Dr(this.firestore,e,this._path)}}function Gs(t,e,...n){if(t=tt(t),jw("collection","path",e),t instanceof Uu){const r=ye.fromString(e,...n);return uv(r),new Dr(t,null,r)}{if(!(t instanceof ke||t instanceof Dr))throw new H(V.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ye.fromString(e,...n));return uv(r),new Dr(t.firestore,null,r)}}function sn(t,e,...n){if(t=tt(t),arguments.length===1&&(e=Mp.newId()),jw("doc","path",e),t instanceof Uu){const r=ye.fromString(e,...n);return cv(r),new ke(t,null,new Y(r))}{if(!(t instanceof ke||t instanceof Dr))throw new H(V.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ye.fromString(e,...n));return cv(r),new ke(t.firestore,t instanceof Dr?t.converter:null,new Y(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xv="AsyncQueue";class Zv{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new RE(this,"async_queue_retry"),this._c=()=>{const r=$d();r&&K(Xv,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=$d();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=$d();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new Gn;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!$i(e))throw e;K(Xv,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,Jn("INTERNAL UNHANDLED ERROR: ",e_(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const s=rm.createAndSchedule(this,e,n,r,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&J(47125,{Pc:e_(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function e_(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t_(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class bn extends Uu{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new Zv,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Zv(e),this._firestoreClient=void 0,await e}}}function wb(t,e,n){n||(n=Sa);const r=Su(t,"firestore");if(r.isInitialized(n)){const s=r.getImmediate({identifier:n}),i=r.getOptions(n);if(Or(i,e))return s;throw new H(V.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new H(V.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<TE)throw new H(V.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&Ns(e.host)&&Sp(e.host),r.initialize({options:e,instanceIdentifier:n})}function Eb(t,e){const n=typeof t=="object"?t:q0(),r=typeof t=="string"?t:e||Sa,s=Su(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=qC("firestore");i&&_b(s,...i)}return s}function qi(t){if(t._terminated)throw new H(V.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||xb(t),t._firestoreClient}function xb(t){var r,s,i;const e=t._freezeSettings(),n=function(l,c,u,f){return new WA(l,c,u,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,WE(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new fb(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}function Tb(t){return mb(qi(t=Ct(t,bn)))}function Sb(t){return gb(qi(t=Ct(t,bn)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jt{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Jt(dt.fromBase64String(e))}catch(n){throw new H(V.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Jt(dt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Jt._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(za(e,Jt._jsonSchema))return Jt.fromBase64String(e.bytes)}}Jt._jsonSchemaVersion="firestore/bytes/1.0",Jt._jsonSchema={type:ze("string",Jt._jsonSchemaVersion),bytes:ze("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bu{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new H(V.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new lt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fm{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nn{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new H(V.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new H(V.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ae(this._lat,e._lat)||ae(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Nn._jsonSchemaVersion}}static fromJSON(e){if(za(e,Nn._jsonSchema))return new Nn(e.latitude,e.longitude)}}Nn._jsonSchemaVersion="firestore/geoPoint/1.0",Nn._jsonSchema={type:ze("string",Nn._jsonSchemaVersion),latitude:ze("number"),longitude:ze("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class An{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:An._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(za(e,An._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new An(e.vectorValues);throw new H(V.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}An._jsonSchemaVersion="firestore/vectorValue/1.0",An._jsonSchema={type:ze("string",An._jsonSchemaVersion),vectorValues:ze("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ib=/^__.*__$/;class Cb{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Kr(e,this.data,this.fieldMask,n,this.fieldTransforms):new $a(e,this.data,n,this.fieldTransforms)}}class KE{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Kr(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function QE(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw J(40011,{Ac:t})}}class pm{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new pm({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return nu(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(QE(this.Ac)&&Ib.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class Rb{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Mu(e)}Cc(e,n,r,s=!1){return new pm({Ac:e,methodName:n,Dc:r,path:lt.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function mm(t){const e=t._freezeSettings(),n=Mu(t._databaseId);return new Rb(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Nb(t,e,n,r,s,i={}){const o=t.Cc(i.merge||i.mergeFields?2:0,e,n,s);gm("Data must be an object, but it was:",o,r);const l=YE(r,o);let c,u;if(i.merge)c=new Gt(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){const f=[];for(const m of i.mergeFields){const g=wf(e,m,n);if(!o.contains(g))throw new H(V.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);XE(f,g)||f.push(g)}c=new Gt(f),u=o.fieldTransforms.filter(m=>c.covers(m.field))}else c=null,u=o.fieldTransforms;return new Cb(new Dt(l),c,u)}class zu extends fm{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof zu}}function Ab(t,e,n,r){const s=t.Cc(1,e,n);gm("Data must be an object, but it was:",s,r);const i=[],o=Dt.empty();qr(r,(c,u)=>{const f=ym(e,c,n);u=tt(u);const m=s.yc(f);if(u instanceof zu)i.push(f);else{const g=qa(u,m);g!=null&&(i.push(f),o.set(f,g))}});const l=new Gt(i);return new KE(o,l,s.fieldTransforms)}function Pb(t,e,n,r,s,i){const o=t.Cc(1,e,n),l=[wf(e,r,n)],c=[s];if(i.length%2!=0)throw new H(V.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<i.length;g+=2)l.push(wf(e,i[g])),c.push(i[g+1]);const u=[],f=Dt.empty();for(let g=l.length-1;g>=0;--g)if(!XE(u,l[g])){const w=l[g];let R=c[g];R=tt(R);const N=o.yc(w);if(R instanceof zu)u.push(w);else{const P=qa(R,N);P!=null&&(u.push(w),f.set(w,P))}}const m=new Gt(u);return new KE(f,m,o.fieldTransforms)}function kb(t,e,n,r=!1){return qa(n,t.Cc(r?4:3,e))}function qa(t,e){if(JE(t=tt(t)))return gm("Unsupported field value:",e,t),YE(t,e);if(t instanceof fm)return function(r,s){if(!QE(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const l of r){let c=qa(l,s.wc(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=tt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return pP(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=de.fromDate(r);return{timestampValue:Jc(s.serializer,i)}}if(r instanceof de){const i=new de(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Jc(s.serializer,i)}}if(r instanceof Nn)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Jt)return{bytesValue:mE(s.serializer,r._byteString)};if(r instanceof ke){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Kp(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof An)return function(o,l){return{mapValue:{fields:{[$w]:{stringValue:Hw},[qc]:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw l.Sc("VectorValues must only contain numeric values.");return Gp(l.serializer,u)})}}}}}}(r,s);throw s.Sc(`Unsupported field value: ${Nu(r)}`)}(t,e)}function YE(t,e){const n={};return Lw(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):qr(t,(r,s)=>{const i=qa(s,e.mc(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function JE(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof de||t instanceof Nn||t instanceof Jt||t instanceof ke||t instanceof fm||t instanceof An)}function gm(t,e,n){if(!JE(n)||!Vw(n)){const r=Nu(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function wf(t,e,n){if((e=tt(e))instanceof Bu)return e._internalPath;if(typeof e=="string")return ym(t,e);throw nu("Field path arguments must be of type string or ",t,!1,void 0,n)}const bb=new RegExp("[~\\*/\\[\\]]");function ym(t,e,n){if(e.search(bb)>=0)throw nu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Bu(...e.split("."))._internalPath}catch{throw nu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function nu(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new H(V.INVALID_ARGUMENT,l+t+c)}function XE(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZE{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new ke(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Db(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(vm("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class Db extends ZE{data(){return super.data()}}function vm(t,e){return typeof e=="string"?ym(t,e):e instanceof Bu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ex(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new H(V.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class _m{}class tx extends _m{}function Ml(t,e,...n){let r=[];e instanceof _m&&r.push(e),r=r.concat(n),function(i){const o=i.filter(c=>c instanceof Em).length,l=i.filter(c=>c instanceof wm).length;if(o>1||o>0&&l>0)throw new H(V.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class wm extends tx{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new wm(e,n,r)}_apply(e){const n=this._parse(e);return nx(e._query,n),new Qr(e.firestore,e.converter,cf(e._query,n))}_parse(e){const n=mm(e.firestore);return function(i,o,l,c,u,f,m){let g;if(u.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new H(V.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){r_(m,f);const R=[];for(const N of m)R.push(n_(c,i,N));g={arrayValue:{values:R}}}else g=n_(c,i,m)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||r_(m,f),g=kb(l,o,m,f==="in"||f==="not-in");return Be.create(u,f,g)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}class Em extends _m{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Em(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:gn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const l=i.getFlattenedFilters();for(const c of l)nx(o,c),o=cf(o,c)}(e._query,n),new Qr(e.firestore,e.converter,cf(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class xm extends tx{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new xm(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new H(V.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new H(V.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ra(i,o)}(e._query,this._field,this._direction);return new Qr(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new Gi(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function Fl(t,e="asc"){const n=e,r=vm("orderBy",t);return xm._create(r,n)}function n_(t,e,n){if(typeof(n=tt(n))=="string"){if(n==="")throw new H(V.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Zw(e)&&n.indexOf("/")!==-1)throw new H(V.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(ye.fromString(n));if(!Y.isDocumentKey(r))throw new H(V.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return vv(t,new Y(r))}if(n instanceof ke)return vv(t,n._key);throw new H(V.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Nu(n)}.`)}function r_(t,e){if(!Array.isArray(t)||t.length===0)throw new H(V.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function nx(t,e){const n=function(s,i){for(const o of s)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new H(V.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new H(V.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class jb{convertValue(e,n="none"){switch(Ur(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Oe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Fr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw J(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return qr(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var r,s,i;const n=(i=(s=(r=e.fields)==null?void 0:r[qc].arrayValue)==null?void 0:s.values)==null?void 0:i.map(o=>Oe(o.doubleValue));return new An(n)}convertGeoPoint(e){return new Nn(Oe(e.latitude),Oe(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=ku(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Ta(e));default:return null}}convertTimestamp(e){const n=Mr(e);return new de(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=ye.fromString(e);pe(EE(r),9688,{name:e});const s=new Ia(r.get(1),r.get(3)),i=new Y(r.popFirst(5));return s.isEqual(n)||Jn(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vb(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class Oo{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ms extends ZE{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new ac(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(vm("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new H(V.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=ms._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}ms._jsonSchemaVersion="firestore/documentSnapshot/1.0",ms._jsonSchema={type:ze("string",ms._jsonSchemaVersion),bundleSource:ze("string","DocumentSnapshot"),bundleName:ze("string"),bundle:ze("string")};class ac extends ms{data(e={}){return super.data(e)}}class gs{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Oo(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new ac(this._firestore,this._userDataWriter,r.key,r,new Oo(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new H(V.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(l=>{const c=new ac(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Oo(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const c=new ac(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Oo(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,f=-1;return l.type!==0&&(u=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),f=o.indexOf(l.doc.key)),{type:Ob(l.type),doc:c,oldIndex:u,newIndex:f}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new H(V.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=gs._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Mp.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Ob(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return J(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ef(t){t=Ct(t,ke);const e=Ct(t.firestore,bn);return yb(qi(e),t._key).then(n=>rx(e,t,n))}gs._jsonSchemaVersion="firestore/querySnapshot/1.0",gs._jsonSchema={type:ze("string",gs._jsonSchemaVersion),bundleSource:ze("string","QuerySnapshot"),bundleName:ze("string"),bundle:ze("string")};class Tm extends jb{constructor(e){super(),this.firestore=e}convertBytes(e){return new Jt(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new ke(this.firestore,null,n)}}function Co(t){t=Ct(t,Qr);const e=Ct(t.firestore,bn),n=qi(e),r=new Tm(e);return ex(t._query),vb(n,t._query).then(s=>new gs(e,r,t,s))}function lc(t,e,n){t=Ct(t,ke);const r=Ct(t.firestore,bn),s=Vb(t.converter,e,n);return Sm(r,[Nb(mm(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,pn.none())])}function Hd(t,e,n,...r){t=Ct(t,ke);const s=Ct(t.firestore,bn),i=mm(s);let o;return o=typeof(e=tt(e))=="string"||e instanceof Bu?Pb(i,"updateDoc",t._key,e,n,r):Ab(i,"updateDoc",t._key,e),Sm(s,[o.toMutation(t._key,pn.exists(!0))])}function Wd(t){return Sm(Ct(t.firestore,bn),[new Hp(t._key,pn.none())])}function Lb(t,...e){var c,u,f;t=tt(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||t_(e[r])||(n=e[r++]);const s={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(t_(e[r])){const m=e[r];e[r]=(c=m.next)==null?void 0:c.bind(m),e[r+1]=(u=m.error)==null?void 0:u.bind(m),e[r+2]=(f=m.complete)==null?void 0:f.bind(m)}let i,o,l;if(t instanceof ke)o=Ct(t.firestore,bn),l=bu(t._key.path),i={next:m=>{e[r]&&e[r](rx(o,t,m))},error:e[r+1],complete:e[r+2]};else{const m=Ct(t,Qr);o=Ct(m.firestore,bn),l=m._query;const g=new Tm(o);i={next:w=>{e[r]&&e[r](new gs(o,g,m,w))},error:e[r+1],complete:e[r+2]},ex(t._query)}return function(g,w,R,N){const P=new dm(N),x=new lm(w,P,R);return g.asyncQueue.enqueueAndForget(async()=>im(await tu(g),x)),()=>{P.Nu(),g.asyncQueue.enqueueAndForget(async()=>om(await tu(g),x))}}(qi(o),l,s,i)}function Sm(t,e){return function(r,s){const i=new Gn;return r.asyncQueue.enqueueAndForget(async()=>sb(await pb(r),s,i)),i.promise}(qi(t),e)}function rx(t,e,n){const r=n.docs.get(e._key),s=new Tm(t);return new ms(t,s,e._key,r,new Oo(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(s){Bi=s})(Fi),Ii(new xs("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),l=new bn(new RA(r.getProvider("auth-internal")),new PA(o,r.getProvider("app-check-internal")),function(u,f){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new H(V.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ia(u.options.projectId,f)}(o,s),o);return i={useFetchStreams:n,...i},l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),kr(iv,ov,e),kr(iv,ov,"esm2020")})();const Mb={apiKey:"AIzaSyBBJxbUabZm4ZKhDhIgbN4L3RzSHTB9HRs",authDomain:"knitting-counter-web.firebaseapp.com",projectId:"knitting-counter-web",storageBucket:"knitting-counter-web.firebasestorage.app",messagingSenderId:"991773187813",appId:"1:991773187813:web:97c6cd3d3e0add31213e0c",measurementId:"G-4T4J8NYV3D"},xf=W0(Mb),cc=EA(xf),Fb=()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);let Ve;try{const t={ignoreUndefinedProperties:!0,cacheSizeBytes:41943040,localCache:{kind:"persistent"}};Fb()?(console.log("[FIREBASE] Mobile device detected, using optimized settings"),Object.assign(t,{experimentalForceLongPolling:!0,experimentalAutoDetectLongPolling:!1})):(console.log("[FIREBASE] Desktop device detected, using standard settings"),Object.assign(t,{experimentalForceLongPolling:!1,experimentalAutoDetectLongPolling:!0})),Ve=wb(xf,t)}catch{console.log("[FIREBASE] Firestore already initialized, using existing instance"),Ve=Eb(xf)}const Ub=new Mn,ot=j0()(V0((t,e)=>({user:null,isLoading:!1,error:null,setUser:n=>t({user:n}),setLoading:n=>t({isLoading:n}),setError:n=>t({error:n}),signInWithGoogle:async()=>{try{t({isLoading:!0,error:null});const n=await PN(cc,Ub);t({user:n.user,isLoading:!1})}catch(n){console.error("Google 登入失敗:",n),t({error:n.message||"登入失敗",isLoading:!1})}},signOut:async()=>{try{t({isLoading:!0,error:null}),await uN(cc),t({user:null,isLoading:!1})}catch(n){console.error("登出失敗:",n),t({error:n.message||"登出失敗",isLoading:!1})}},initialize:()=>cN(cc,n=>{t({user:n,isLoading:!1})})}),{name:"auth-storage",partialize:t=>({user:t.user})}));class Bb{async getUserProfile(e){try{const n=sn(Ve,"users",e,"profile","info"),r=await Ef(n);if(r.exists()){const s=r.data();return{uid:s.uid,displayName:s.displayName,email:s.email,createdAt:s.createdAt.toDate(),lastLogin:s.lastLogin.toDate()}}return null}catch(n){throw console.error("Error getting user profile:",n),n}}async createUserProfile(e){try{const n=sn(Ve,"users",e.uid,"profile","info");await lc(n,{uid:e.uid,displayName:e.displayName,email:e.email,createdAt:de.fromDate(e.createdAt),lastLogin:de.fromDate(e.lastLogin)})}catch(n){throw console.error("Error creating user profile:",n),n}}async updateUserLastLogin(e){try{const n=sn(Ve,"users",e,"profile","info");await Hd(n,{lastLogin:de.fromDate(new Date)})}catch(n){throw console.error("Error updating last login:",n),n}}async getUserProjects(e){try{const n=Gs(Ve,"users",e,"projects"),r=Ml(n,Fl("lastModified","desc")),s=await Co(r),i=[];for(const o of s.docs){const l=o.data(),c=Gs(Ve,"users",e,"projects",o.id,"rounds"),u=Ml(c,Fl("roundNumber")),m=(await Co(u)).docs.map(g=>{const w=g.data();return{id:w.id,roundNumber:w.roundNumber,stitches:w.stitches,stitchGroups:w.stitchGroups,notes:w.notes}});i.push({id:l.id,name:l.name,source:l.source,pattern:m,currentRound:l.currentRound,currentStitch:l.currentStitch,yarns:l.yarns,sessions:l.sessions.map(g=>({...g,startTime:g.startTime instanceof Date?g.startTime:g.startTime.toDate()})),createdDate:l.createdDate instanceof Date?l.createdDate:l.createdDate.toDate(),lastModified:l.lastModified instanceof Date?l.lastModified:l.lastModified.toDate(),isCompleted:l.isCompleted})}return i}catch(n){throw console.error("Error getting user projects:",n),n}}async createProject(e,n){var r;try{const s=sn(Ve,"users",e,"projects",n.id),i={id:n.id,name:n.name,source:n.source||"",currentRound:n.currentRound,currentStitch:n.currentStitch,yarns:n.yarns||[],sessions:((r=n.sessions)==null?void 0:r.map(o=>({...o,startTime:o.startTime})))||[],createdDate:n.createdDate,lastModified:n.lastModified,isCompleted:n.isCompleted??!1};await lc(s,{...i,createdDate:de.fromDate(i.createdDate),lastModified:de.fromDate(i.lastModified),sessions:i.sessions.map(o=>({...o,startTime:de.fromDate(o.startTime)}))});for(const o of n.pattern)await this.createRound(e,n.id,o)}catch(s){throw console.error("Error creating project:",s),s}}async updateProject(e,n){var r;try{console.log("[FIRESTORE] Updating project:",n.id,{currentRound:n.currentRound,currentStitch:n.currentStitch,isCompleted:n.isCompleted});const s=sn(Ve,"users",e,"projects",n.id),i={name:n.name,source:n.source||"",currentRound:n.currentRound,currentStitch:n.currentStitch,yarns:n.yarns||[],sessions:((r=n.sessions)==null?void 0:r.map(o=>({...o,startTime:o.startTime})))||[],lastModified:n.lastModified,isCompleted:n.isCompleted??!1};await Hd(s,{...i,lastModified:de.fromDate(i.lastModified),sessions:i.sessions.map(o=>({...o,startTime:de.fromDate(o.startTime)}))}),console.log("[FIRESTORE] Project document updated successfully"),await this.syncRounds(e,n.id,n.pattern),console.log("[FIRESTORE] Project sync completed successfully")}catch(s){if(console.error("[FIRESTORE] Error updating project:",s),s instanceof Error&&(s.message.includes("offline")||s.message.includes("network")||s.message.includes("fetch")||s.message.includes("unavailable")||s.message.includes("timeout")||s.name==="AbortError")&&(console.error("[FIRESTORE] Network connectivity issue detected:",s.message),s.message.includes("failed to connect")||s.message.includes("network-request-failed"))){console.log("[FIRESTORE] Attempting to restart Firestore connection...");try{await this.enableOfflineSupport(),setTimeout(async()=>{await this.disableOfflineSupport()},1e3)}catch(i){console.error("[FIRESTORE] Failed to restart connection:",i)}}throw s}}async deleteProject(e,n){try{const r=Gs(Ve,"users",e,"projects",n,"rounds"),s=await Co(r);for(const o of s.docs)await Wd(o.ref);const i=sn(Ve,"users",e,"projects",n);await Wd(i)}catch(r){throw console.error("Error deleting project:",r),r}}async createRound(e,n,r){try{const s=sn(Ve,"users",e,"projects",n,"rounds",r.id);await lc(s,{id:r.id,roundNumber:r.roundNumber,stitches:r.stitches,stitchGroups:r.stitchGroups,notes:r.notes})}catch(s){throw console.error("Error creating round:",s),s}}async updateRound(e,n,r){try{const s=sn(Ve,"users",e,"projects",n,"rounds",r.id);await Hd(s,{roundNumber:r.roundNumber,stitches:r.stitches,stitchGroups:r.stitchGroups,notes:r.notes})}catch(s){throw console.error("Error updating round:",s),s}}async deleteRound(e,n,r){try{const s=sn(Ve,"users",e,"projects",n,"rounds",r);await Wd(s)}catch(s){throw console.error("Error deleting round:",s),s}}async syncRounds(e,n,r){try{const s=Gs(Ve,"users",e,"projects",n,"rounds"),i=await Co(s),o=new Set(i.docs.map(c=>c.id)),l=new Set(r.map(c=>c.id));for(const c of o)l.has(c)||await this.deleteRound(e,n,c);for(const c of r)o.has(c.id)?await this.updateRound(e,n,c):await this.createRound(e,n,c)}catch(s){throw console.error("Error syncing rounds:",s),s}}subscribeToUserProjects(e,n){const r=Gs(Ve,"users",e,"projects"),s=Ml(r,Fl("lastModified","desc"));return Lb(s,async i=>{try{const o=[];for(const l of i.docs){const c=l.data(),u=Gs(Ve,"users",e,"projects",l.id,"rounds"),f=Ml(u,Fl("roundNumber")),g=(await Co(f)).docs.map(w=>{const R=w.data();return{id:R.id,roundNumber:R.roundNumber,stitches:R.stitches,stitchGroups:R.stitchGroups,notes:R.notes}});o.push({id:c.id,name:c.name,source:c.source,pattern:g,currentRound:c.currentRound,currentStitch:c.currentStitch,yarns:c.yarns,sessions:c.sessions.map(w=>({...w,startTime:w.startTime instanceof Date?w.startTime:w.startTime.toDate()})),createdDate:c.createdDate instanceof Date?c.createdDate:c.createdDate.toDate(),lastModified:c.lastModified instanceof Date?c.lastModified:c.lastModified.toDate(),isCompleted:c.isCompleted})}n(o)}catch(o){console.error("Error in projects subscription:",o)}})}async enableOfflineSupport(){try{await Tb(Ve),console.log("[FIRESTORE] Network enabled successfully")}catch(e){console.error("[FIRESTORE] Error enabling network:",e)}}async disableOfflineSupport(){try{await Sb(Ve),console.log("[FIRESTORE] Network disabled successfully")}catch(e){console.error("[FIRESTORE] Error disabling network:",e)}}async testConnection(){try{return await Ef(sn(Ve,"_test","connection")),console.log("[FIRESTORE] Connection test completed successfully"),!0}catch(e){return console.error("[FIRESTORE] Connection test failed:",e),!1}}}const Te=new Bb,os=class os{constructor(){yo(this,"isOnline",navigator.onLine);yo(this,"listeners",[]);this.setupEventListeners()}static getInstance(){return os.instance||(os.instance=new os),os.instance}setupEventListeners(){window.addEventListener("online",()=>{console.log("[NETWORK] Connection restored"),this.isOnline=!0,this.notifyListeners()}),window.addEventListener("offline",()=>{console.log("[NETWORK] Connection lost"),this.isOnline=!1,this.notifyListeners()}),document.addEventListener("visibilitychange",()=>{document.hidden||this.checkConnectionStatus()})}async checkConnectionStatus(){try{const e=new AbortController,n=setTimeout(()=>e.abort(),5e3),r=await fetch("https://dns.google/resolve?name=google.com&type=A",{method:"GET",cache:"no-cache",signal:e.signal});clearTimeout(n);const s=!this.isOnline;this.isOnline=r.ok,s&&this.isOnline&&(console.log("[NETWORK] Connection status verified: online"),this.notifyListeners())}catch(e){const n=this.isOnline;this.isOnline=!1,n&&(console.log("[NETWORK] Connection status verified: offline",e),this.notifyListeners())}}notifyListeners(){this.listeners.forEach(e=>{try{e(this.isOnline)}catch(n){console.error("[NETWORK] Error in network status listener:",n)}})}getIsOnline(){return this.isOnline}addListener(e){return this.listeners.push(e),()=>{const n=this.listeners.indexOf(e);n>-1&&this.listeners.splice(n,1)}}async waitForConnection(e=1e4){return this.isOnline?!0:new Promise(n=>{const r=setTimeout(()=>{s(),n(!1)},e),s=this.addListener(i=>{i&&(clearTimeout(r),s(),n(!0))})})}};yo(os,"instance");let Tf=os;const Xo=Tf.getInstance(),Bt=j0()(V0((t,e)=>({projects:[],currentProject:null,isLoading:!1,error:null,isSyncing:!1,lastSyncTime:null,isLocallyUpdating:!1,networkStatusListener:null,setLoading:n=>t({isLoading:n}),setError:n=>t({error:n}),setSyncing:n=>t({isSyncing:n}),clearUserData:()=>{t({projects:[],currentProject:null,error:null,lastSyncTime:null})},clearUserDataSilently:()=>{const n=e();Object.assign(n,{projects:[],currentProject:null,error:null,lastSyncTime:null})},loadUserProjects:async()=>{const{user:n}=ot.getState();if(!n){e().clearUserDataSilently();return}try{t({isLoading:!0,error:null});const r=await Te.getUserProjects(n.uid);if(r.length>0){console.log("Loaded projects from Firestore:",r.length),t({projects:r,currentProject:r[0]||null,lastSyncTime:new Date});return}const s=`user_${n.uid}_knitting-counter-storage`,i=localStorage.getItem(s);if(i)try{const l=JSON.parse(i),c=l.state||l;if(c.projects&&c.projects.length>0){const u=c.projects.map(f=>{var m;return{...f,createdDate:new Date(f.createdDate),lastModified:new Date(f.lastModified),sessions:((m=f.sessions)==null?void 0:m.map(g=>({...g,startTime:new Date(g.startTime)})))||[]}});console.log("Migrating local projects to Firestore:",u.length);for(const f of u)await Te.createProject(n.uid,f);t({projects:u,currentProject:u[0]||null,lastSyncTime:new Date});return}}catch(l){console.error("Error parsing saved data:",l)}console.log("No data found, creating sample project");const o=bd();await Te.createProject(n.uid,o),t({projects:[o],currentProject:o,lastSyncTime:new Date})}catch(r){console.error("Error loading user projects:",r),t({error:"載入專案時發生錯誤"});const s=`user_${n.uid}_knitting-counter-storage`,i=localStorage.getItem(s);if(i)try{const o=JSON.parse(i),l=o.state||o;if(l.projects){const c=l.projects.map(u=>{var f;return{...u,createdDate:new Date(u.createdDate),lastModified:new Date(u.lastModified),sessions:((f=u.sessions)==null?void 0:f.map(m=>({...m,startTime:new Date(m.startTime)})))||[]}});t({projects:c,currentProject:c[0]||null})}}catch(o){console.error("Error loading from localStorage:",o);const l=bd();t({projects:[l],currentProject:l})}}finally{t({isLoading:!1})}},syncWithFirestore:async()=>{const{user:n}=ot.getState();if(n)try{t({isSyncing:!0,error:null});const r=await Te.getUserProjects(n.uid);t({projects:r,currentProject:r.find(s=>{var i;return s.id===((i=e().currentProject)==null?void 0:i.id)})||r[0]||null,lastSyncTime:new Date})}catch(r){console.error("Error syncing with Firestore:",r),t({error:"同步失敗"})}finally{t({isSyncing:!1})}},initializeUserProfile:async n=>{try{if(await Te.getUserProfile(n.uid))await Te.updateUserLastLogin(n.uid);else{const s={uid:n.uid,displayName:n.displayName,email:n.email,createdAt:new Date,lastLogin:new Date};await Te.createUserProfile(s)}}catch(r){console.error("Error initializing user profile:",r)}},subscribeToFirestoreChanges:()=>{const{user:n}=ot.getState();return n?Te.subscribeToUserProjects(n.uid,r=>{const s=e();!s.isSyncing&&!s.isLocallyUpdating&&t({projects:r,currentProject:r.find(i=>{var o;return i.id===((o=s.currentProject)==null?void 0:o.id)})||r[0]||null,lastSyncTime:new Date})}):null},createProject:async(n,r)=>{const{user:s}=ot.getState(),i={id:Ze(),name:n,source:r||"",pattern:[],currentRound:1,currentStitch:0,yarns:[],sessions:[],createdDate:new Date,lastModified:new Date,isCompleted:!1};if(t(o=>({projects:[...o.projects,i],currentProject:i})),s)try{await Te.createProject(s.uid,i),t({lastSyncTime:new Date})}catch(o){console.error("Error syncing new project to Firestore:",o)}},updateProject:async n=>{const{user:r}=ot.getState(),s={...n,lastModified:new Date};if(t(i=>{var o;return{projects:i.projects.map(l=>l.id===n.id?s:l),currentProject:((o=i.currentProject)==null?void 0:o.id)===n.id?s:i.currentProject}}),r)try{await Te.updateProject(r.uid,s),t({lastSyncTime:new Date})}catch(i){console.error("Error syncing project update to Firestore:",i)}},deleteProject:async n=>{const{user:r}=ot.getState();if(t(s=>{var i;return{projects:s.projects.filter(o=>o.id!==n),currentProject:((i=s.currentProject)==null?void 0:i.id)===n?null:s.currentProject}}),r)try{await Te.deleteProject(r.uid,n),t({lastSyncTime:new Date})}catch(s){console.error("Error syncing project deletion to Firestore:",s)}},setCurrentProject:n=>{const r=e().projects.find(s=>s.id===n);r&&t({currentProject:r})},loadProjects:async()=>{const{projects:n}=e();if(n.length===0){const r=bd();t({projects:[r],currentProject:r})}},nextStitch:async()=>{const{currentProject:n}=e();if(!n||n.isCompleted){console.log("[DEBUG] nextStitch: No current project or already completed");return}if(!n.pattern||n.pattern.length===0){console.log("[DEBUG] nextStitch: No pattern available");return}const r=n.pattern.find(u=>u.roundNumber===n.currentRound);if(!r){console.log("[DEBUG] nextStitch: Current round not found",n.currentRound);const u=Math.min(...n.pattern.map(m=>m.roundNumber)),f={...n,currentRound:u,currentStitch:0,lastModified:new Date};await e().updateProjectLocally(f);return}const s=zt(r);let i=n.currentStitch+1,o=n.currentRound,l=!1;if(i>=s){const u=Math.max(...n.pattern.map(f=>f.roundNumber));if(n.currentRound>=u)l=!0,i=s,o=n.currentRound;else{const f=n.currentRound+1;n.pattern.find(g=>g.roundNumber===f)?(i=0,o=f):(i=s,o=n.currentRound,l=!0)}}const c={...n,currentRound:o,currentStitch:i,isCompleted:l,lastModified:new Date};await e().updateProjectLocally(c)},previousStitch:async()=>{const{currentProject:n}=e();if(!n)return;if(!n.pattern||n.pattern.length===0){console.log("[DEBUG] previousStitch: No pattern available");return}let r=n.currentStitch-1,s=n.currentRound;if(r<0&&s>1){for(let l=n.currentRound-1;l>=1;l--){const c=n.pattern.find(u=>u.roundNumber===l);if(c){s=l,r=zt(c)-1;break}}r<0&&(r=0,s=n.currentRound)}else r<0&&(r=0);n.pattern.find(l=>l.roundNumber===s)||(console.log("[DEBUG] previousStitch: Target round not found",s),s=Math.min(...n.pattern.map(c=>c.roundNumber)),r=0);const o={...n,currentRound:s,currentStitch:r,isCompleted:!1,lastModified:new Date};await e().updateProjectLocally(o)},setCurrentRound:async n=>{const{currentProject:r}=e();if(!r){console.log("[DEBUG] setCurrentRound: No current project");return}if(!r.pattern.find(o=>o.roundNumber===n)){console.error("[DEBUG] setCurrentRound: Invalid round number",n);return}console.log("[DEBUG] setCurrentRound: Updating from round",r.currentRound,"to",n);const i={...r,currentRound:n,currentStitch:0,isCompleted:!1,lastModified:new Date};await e().updateProjectLocally(i)},setCurrentStitch:async n=>{const{currentProject:r}=e();if(!r)return;const s={...r,currentStitch:n,lastModified:new Date};await e().updateProjectLocally(s)},startSession:async()=>{const{currentProject:n}=e();if(!n)return;const r={id:Ze(),startTime:new Date,duration:0,roundsCompleted:0,stitchesCompleted:0},s={...n,sessions:[...n.sessions,r],lastModified:new Date};await e().updateProjectLocally(s)},endSession:async()=>{const{currentProject:n}=e();if(!n||n.sessions.length===0)return;const r=n.sessions[n.sessions.length-1];if(r.duration>0)return;const i=Math.floor((new Date().getTime()-r.startTime.getTime())/1e3),o={...r,duration:i},l={...n,sessions:[...n.sessions.slice(0,-1),o],lastModified:new Date};await e().updateProjectLocally(l)},updateProjectLocally:async n=>{t(s=>{var i;return{isLocallyUpdating:!0,projects:s.projects.map(o=>o.id===n.id?n:o),currentProject:((i=s.currentProject)==null?void 0:i.id)===n.id?n:s.currentProject}});const{user:r}=ot.getState();if(r){let s=0;const i=3,o=async()=>{if(!Xo.getIsOnline()&&(console.log("[SYNC] Device is offline, waiting for connection..."),!await Xo.waitForConnection(5e3)))if(console.log("[SYNC] Still offline after waiting, will retry later"),s<i){s++;const c=Math.pow(2,s-1)*1e3;setTimeout(o,c);return}else{t({isLocallyUpdating:!1,error:"設備離線，無法同步數據"}),setTimeout(()=>t({error:null}),3e3);return}try{!await Te.testConnection()&&s===0&&(console.log("[SYNC] Firestore connection test failed, attempting to restart connection..."),await Te.enableOfflineSupport(),await new Promise(c=>setTimeout(c,1e3)),await Te.disableOfflineSupport(),await new Promise(c=>setTimeout(c,1e3))),await Te.updateProject(r.uid,n),t({lastSyncTime:new Date,isLocallyUpdating:!1}),console.log("[SYNC] Project synced successfully to Firestore:",n.id)}catch(l){console.error(`[SYNC] Error syncing project update to Firestore (attempt ${s+1}):`,l);const c=l instanceof Error&&(l.message.includes("offline")||l.message.includes("network")||l.message.includes("unavailable")||l.message.includes("timeout")||l.message.includes("failed to connect")||l.message.includes("network-request-failed"));if(s<i){s++;const u=c?2e3:1e3,f=Math.pow(2,s-1)*u;console.log(`[SYNC] Retrying sync in ${f}ms... (Network error: ${c})`),setTimeout(o,f)}else console.error("[SYNC] Max retries reached, sync failed for project:",n.id),t({isLocallyUpdating:!1,error:c?"網路連接不穩定，同步失敗":"同步失敗，請檢查網絡連接"}),setTimeout(()=>{t({error:null})},3e3)}};o()}else t({isLocallyUpdating:!1})},addRound:async n=>{const{currentProject:r}=e();if(!r)return;const s={...r,pattern:[...r.pattern,n],lastModified:new Date};await e().updateProjectLocally(s)},updateRound:async n=>{const{currentProject:r}=e();if(!r)return;const s={...r,pattern:r.pattern.map(i=>i.id===n.id?n:i),lastModified:new Date};await e().updateProjectLocally(s)},deleteRound:async n=>{const{currentProject:r}=e();if(!r)return;const i=r.pattern.filter(f=>f.roundNumber!==n).map(f=>f.roundNumber>n?{...f,roundNumber:f.roundNumber-1}:f);let o=r.currentRound,l=r.currentStitch;if(r.currentRound===n)if(n>1&&i.find(f=>f.roundNumber===n-1)){const f=i.find(m=>m.roundNumber===n-1);f&&(o=n-1,l=zt(f))}else i.find(f=>f.roundNumber===n)?(o=n,l=0):(o=1,l=0);else r.currentRound>n&&(o=Math.max(1,r.currentRound-1));const c=Math.max(1,...i.map(f=>f.roundNumber));if(o>c){o=c;const f=i.find(m=>m.roundNumber===c);l=f?zt(f):0}else{const f=i.find(m=>m.roundNumber===o);if(f){const m=zt(f);l=Math.min(l,m)}}const u={...r,pattern:i,currentRound:o,currentStitch:l,lastModified:new Date};await e().updateProjectLocally(u)},addStitchToRound:async(n,r)=>{const{currentProject:s}=e();if(!s)return;const i=s.pattern.map(l=>l.roundNumber===n?{...l,stitches:[...l.stitches,r]}:l),o={...s,pattern:i,lastModified:new Date};await e().updateProjectLocally(o)},addStitchGroupToRound:async(n,r)=>{const{currentProject:s}=e();if(!s)return;const i=s.pattern.map(l=>l.roundNumber===n?{...l,stitchGroups:[...l.stitchGroups,r]}:l),o={...s,pattern:i,lastModified:new Date};await e().updateProjectLocally(o)},updateStitchInRound:async(n,r,s)=>{const{currentProject:i}=e();if(!i)return;const o=i.pattern.map(c=>c.roundNumber===n?{...c,stitches:c.stitches.map(u=>u.id===r?s:u)}:c),l={...i,pattern:o,lastModified:new Date};await e().updateProjectLocally(l)},deleteStitchFromRound:async(n,r)=>{const{currentProject:s}=e();if(!s)return;const i=s.pattern.map(l=>l.roundNumber===n?{...l,stitches:l.stitches.filter(c=>c.id!==r)}:l),o={...s,pattern:i,lastModified:new Date};await e().updateProjectLocally(o)},reorderStitchesInRound:async(n,r,s)=>{const{currentProject:i}=e();if(!i)return;const o=i.pattern.map(c=>{if(c.roundNumber===n){const u=[...c.stitches],[f]=u.splice(r,1);return u.splice(s,0,f),{...c,stitches:u}}return c}),l={...i,pattern:o,lastModified:new Date};await e().updateProjectLocally(l)},updateStitchGroupInRound:async(n,r,s)=>{const{currentProject:i}=e();if(!i)return;const o=i.pattern.map(c=>c.roundNumber===n?{...c,stitchGroups:c.stitchGroups.map(u=>u.id===r?s:u)}:c),l={...i,pattern:o,lastModified:new Date};await e().updateProjectLocally(l)},updateStitchInGroup:async(n,r,s,i)=>{const{currentProject:o}=e();if(!o)return;const l=o.pattern.map(u=>u.roundNumber===n?{...u,stitchGroups:u.stitchGroups.map(f=>f.id===r?{...f,stitches:f.stitches.map(m=>m.id===s?i:m)}:f)}:u),c={...o,pattern:l,lastModified:new Date};await e().updateProjectLocally(c)},deleteStitchGroupFromRound:async(n,r)=>{const{currentProject:s}=e();if(!s)return;const i=s.pattern.map(l=>l.roundNumber===n?{...l,stitchGroups:l.stitchGroups.filter(c=>c.id!==r)}:l),o={...s,pattern:i,lastModified:new Date};await e().updateProjectLocally(o)},reorderStitchGroupsInRound:async(n,r,s)=>{const{currentProject:i}=e();if(!i)return;const o=i.pattern.map(c=>{if(c.roundNumber===n){const u=[...c.stitchGroups],[f]=u.splice(r,1);return u.splice(s,0,f),{...c,stitchGroups:u}}return c}),l={...i,pattern:o,lastModified:new Date};await e().updateProjectLocally(l)},addYarn:async n=>{const{currentProject:r}=e();if(!r)return;const s={...r,yarns:[...r.yarns,n],lastModified:new Date};await e().updateProjectLocally(s)},updateYarn:async n=>{const{currentProject:r}=e();if(!r)return;const s={...r,yarns:r.yarns.map(i=>i.id===n.id?n:i),lastModified:new Date};await e().updateProjectLocally(s)},deleteYarn:async n=>{const{currentProject:r}=e();if(!r)return;const s={...r,yarns:r.yarns.filter(i=>i.id!==n),lastModified:new Date};await e().updateProjectLocally(s)},initializeNetworkListener:()=>{const{networkStatusListener:n}=e();n&&n();const r=Xo.addListener(s=>{if(console.log("[SYNC] Network status changed:",s?"online":"offline"),s){const{currentProject:i}=e();i&&(console.log("[SYNC] Network restored, attempting to sync current project..."),e().updateProjectLocally(i))}});t({networkStatusListener:r})},cleanupNetworkListener:()=>{const{networkStatusListener:n}=e();n&&(n(),t({networkStatusListener:null}))}}),{name:"synced-knitting-counter-storage",version:1,partialize:t=>({projects:t.projects,currentProject:t.currentProject,lastSyncTime:t.lastSyncTime}),storage:{getItem:t=>{var s;const{user:e}=ot.getState();if(console.log("getItem called:",{name:t,user:e==null?void 0:e.uid}),!e)return console.log("No user - returning empty state"),JSON.stringify({state:{projects:[],currentProject:null,lastSyncTime:null},version:1});const n=`user_${e.uid}_${t}`,r=localStorage.getItem(n);if(console.log("Loading from storage:",{userStorageKey:n,hasData:!!r}),!r)return console.log("No data found - returning empty state"),JSON.stringify({state:{projects:[],currentProject:null,lastSyncTime:null},version:1});try{const i=JSON.parse(r);return i.state&&(i.state.projects&&(i.state.projects=i.state.projects.map(o=>{var l;return{...o,createdDate:new Date(o.createdDate),lastModified:new Date(o.lastModified),sessions:((l=o.sessions)==null?void 0:l.map(c=>({...c,startTime:new Date(c.startTime)})))||[]}})),i.state.currentProject&&(i.state.currentProject={...i.state.currentProject,createdDate:new Date(i.state.currentProject.createdDate),lastModified:new Date(i.state.currentProject.lastModified),sessions:((s=i.state.currentProject.sessions)==null?void 0:s.map(o=>({...o,startTime:new Date(o.startTime)})))||[]}),i.state.lastSyncTime&&(i.state.lastSyncTime=new Date(i.state.lastSyncTime))),i}catch{return null}},setItem:(t,e)=>{var s,i,o,l,c;const{user:n}=ot.getState();if(!n){console.log("No user - skipping save to localStorage");return}const r=`user_${n.uid}_${t}`;console.log(`Saving to ${r}`,{projects:((i=(s=e==null?void 0:e.state)==null?void 0:s.projects)==null?void 0:i.length)||0,currentProject:((l=(o=e==null?void 0:e.state)==null?void 0:o.currentProject)==null?void 0:l.name)||"none",lastSyncTime:(c=e==null?void 0:e.state)==null?void 0:c.lastSyncTime}),localStorage.setItem(r,JSON.stringify(e))},removeItem:t=>{const{user:e}=ot.getState();if(!e)return;const n=`user_${e.uid}_${t}`;localStorage.removeItem(n)}}}));class zb{async mergeLocalAndRemoteData(e,n,r={strategy:"newest_wins",autoResolve:!0}){try{const s=await Te.getUserProjects(e);console.log("Merging data:",{localCount:n.length,remoteCount:s.length,strategy:r.strategy});const i={success:!0,merged:[],conflicts:[],errors:[]},o=new Map(n.map(u=>[u.id,u])),l=new Map(s.map(u=>[u.id,u])),c=new Set([...o.keys(),...l.keys()]);for(const u of c){const f=o.get(u),m=l.get(u);if(f&&!m){console.log(`Uploading local-only project: ${f.name}`);try{await Te.createProject(e,f),i.merged.push(f)}catch(g){console.error("Error uploading local project:",g),i.errors.push(`Failed to upload project ${f.name}`),i.merged.push(f)}}else if(!f&&m)console.log(`Adding remote-only project: ${m.name}`),i.merged.push(m);else if(f&&m){const g=await this.mergeProjects(e,f,m,r);g.conflict&&!r.autoResolve&&i.conflicts.push(g.conflict),i.merged.push(g.merged)}}return i.conflicts.length>0&&!r.autoResolve&&(i.success=!1),console.log("Merge completed:",{merged:i.merged.length,conflicts:i.conflicts.length,errors:i.errors.length}),i}catch(s){return console.error("Error in merge operation:",s),{success:!1,merged:n,conflicts:[],errors:[s instanceof Error?s.message:"Unknown error during merge"]}}}async mergeProjects(e,n,r,s){const i=n.lastModified.getTime(),o=r.lastModified.getTime();console.log(`Merging project ${n.name}:`,{localTime:new Date(i).toISOString(),remoteTime:new Date(o).toISOString(),timeDiff:i-o});let l,c;switch(Math.abs(i-o)<1e3?c={projectId:n.id,projectName:n.name,localVersion:n,remoteVersion:r,conflictType:"both_modified"}:i>o?c={projectId:n.id,projectName:n.name,localVersion:n,remoteVersion:r,conflictType:"local_newer"}:c={projectId:n.id,projectName:n.name,localVersion:n,remoteVersion:r,conflictType:"remote_newer"},s.strategy){case"local_wins":l=n;break;case"remote_wins":l=r;break;case"newest_wins":default:l=i>=o?n:r;break}if(s.autoResolve)try{await Te.updateProject(e,l),console.log(`Auto-resolved conflict for ${l.name}, chose ${i>=o?"local":"remote"} version`),c=void 0}catch(u){console.error("Error auto-resolving conflict:",u),l=n}return{merged:l,conflict:c}}async resolveConflict(e,n,r,s){try{let i;switch(r){case"use_local":i=n.localVersion;break;case"use_remote":i=n.remoteVersion;break;case"custom":if(!s)throw new Error("Custom project required for custom resolution");i=s;break;default:throw new Error(`Unknown resolution type: ${r}`)}return await Te.updateProject(e,i),console.log(`Conflict resolved for project ${n.projectName} using ${r}`),!0}catch(i){return console.error("Error resolving conflict:",i),!1}}async syncProjectChanges(e,n){try{const s=(await Te.getUserProjects(e)).find(i=>i.id===n.id);return s?s.lastModified.getTime()>n.lastModified.getTime()?(console.log(`Remote version is newer for ${n.name}, skipping sync`),!1):(await Te.updateProject(e,n),console.log(`Synced project changes: ${n.name}`),!0):(await Te.createProject(e,n),console.log(`Created new project in cloud: ${n.name}`),!0)}catch(r){return console.error("Error syncing project changes:",r),!1}}async performIncrementalSync(e,n,r){try{const s={updated:[],conflicts:[],errors:[]},i=await Te.getUserProjects(e),o=n?i.filter(l=>l.lastModified.getTime()>n.getTime()):i;console.log(`Incremental sync: ${o.length} changed remote projects`);for(const l of o){const c=r.find(u=>u.id===l.id);if(!c)s.updated.push(l);else{const u=c.lastModified.getTime(),f=l.lastModified.getTime();if(Math.abs(u-f)>1e3)if(f>u)s.updated.push(l);else try{await Te.updateProject(e,c),s.updated.push(c)}catch(m){s.errors.push(`Failed to sync ${c.name}: ${m}`)}}}return s}catch(s){return console.error("Error in incremental sync:",s),{updated:[],conflicts:[],errors:[s instanceof Error?s.message:"Unknown error"]}}}}const s_=new zb;class $b{constructor(){yo(this,"unsubscribeFirestore",null)}async handleUserLogin(e){console.log("User logged in:",e.uid);try{const n=Bt.getState();await n.initializeUserProfile(e),await n.loadUserProjects(),this.unsubscribeFirestore=n.subscribeToFirestoreChanges(),console.log("User login handling completed")}catch(n){console.error("Error handling user login:",n),Bt.getState().setError("登入時載入數據失敗，請檢查網絡連接並重新整理頁面")}}async handleUserLogout(){console.log("User logged out");try{this.unsubscribeFirestore&&(this.unsubscribeFirestore(),this.unsubscribeFirestore=null),Bt.getState().clearUserData(),console.log("User logout handling completed")}catch(e){console.error("Error handling user logout:",e)}}async handleUserSwitch(e,n){console.log("User switched:",{from:(n==null?void 0:n.uid)||"none",to:e.uid});try{n&&await this.handleUserLogout(),await this.handleUserLogin(e),console.log("User switch handling completed")}catch(r){console.error("Error handling user switch:",r)}}async performCrossDeviceSync(e){console.log("Performing cross-device sync for user:",e.uid);try{const n=Bt.getState();n.setSyncing(!0);const r=n.projects,s=await s_.mergeLocalAndRemoteData(e.uid,r,{strategy:"newest_wins",autoResolve:!0});s.success?(n.projects=s.merged,n.currentProject=s.merged.find(i=>{var o;return i.id===((o=n.currentProject)==null?void 0:o.id)})||s.merged[0]||null,n.lastSyncTime=new Date,console.log("Cross-device sync completed successfully:",{merged:s.merged.length,conflicts:s.conflicts.length,errors:s.errors.length})):(console.warn("Cross-device sync completed with issues:",s.errors),n.setError("同步過程中發生問題"))}catch(n){console.error("Error in cross-device sync:",n),Bt.getState().setError("跨裝置同步失敗")}finally{Bt.getState().setSyncing(!1)}}setupAuthStateListener(){let e=null;const n=ot.getState().initialize(),r=setInterval(()=>{const s=ot.getState().user;(e==null?void 0:e.uid)!==(s==null?void 0:s.uid)&&(console.log("Auth state changed:",{previousUser:(e==null?void 0:e.uid)||"none",currentUser:(s==null?void 0:s.uid)||"none"}),!e&&s?this.handleUserLogin(s):e&&!s?this.handleUserLogout():e&&s&&e.uid!==s.uid?this.handleUserSwitch(s,e):s&&this.performCrossDeviceSync(s),e=s)},1e3);return()=>{n(),clearInterval(r)}}async forceSync(){const{user:e}=ot.getState();e&&await this.performCrossDeviceSync(e)}async resolveConflicts(e,n){const{user:r}=ot.getState();if(!r)return!1;try{for(const s of e){const i=n[s.projectId];i&&await s_.resolveConflict(r.uid,s,i==="local"?"use_local":"use_remote")}return await this.performCrossDeviceSync(r),!0}catch(s){return console.error("Error resolving conflicts:",s),!1}}}const uc=new $b;async function Gb(){try{console.log("Testing Firebase connection...");const t=sn(Ve,"test","connection");await lc(t,{timestamp:new Date,test:"connection test"}),console.log("✅ Firebase write test successful");const e=await Ef(t);return e.exists()?console.log("✅ Firebase read test successful:",e.data()):console.log("❌ Firebase read test failed: document does not exist"),!0}catch(t){return console.error("❌ Firebase connection test failed:",t),!1}}async function Hb(){var t;try{return console.log("Testing Auth connection..."),console.log("Current user:",((t=cc.currentUser)==null?void 0:t.uid)||"Not logged in"),!0}catch(e){return console.error("❌ Auth connection test failed:",e),!1}}function Wb(){const{user:t,signOut:e,isLoading:n}=ot(),r=async()=>{try{await e()}catch(s){console.error("登出失敗:",s)}};return t?h.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[t.photoURL&&h.jsx("img",{src:t.photoURL,alt:t.displayName||"使用者",className:"w-6 h-6 sm:w-8 sm:h-8 rounded-full"}),h.jsxs("div",{className:"hidden md:block",children:[h.jsx("p",{className:"text-xs sm:text-sm font-medium text-text-primary",children:t.displayName||"使用者"}),h.jsx("p",{className:"text-xs text-text-secondary",children:t.email})]})]}),h.jsx("button",{onClick:r,disabled:n,className:"text-xs sm:text-sm text-text-secondary hover:text-text-primary transition-colors disabled:opacity-50",title:"登出並清除當前用戶數據",children:n?"登出中...":"登出"})]}):null}function Ki(){const{isSyncing:t,lastSyncTime:e,error:n,setError:r,isLocallyUpdating:s}=Bt(),[i,o]=L.useState(!1),[l,c]=L.useState(Xo.getIsOnline());L.useEffect(()=>Xo.addListener(m=>{c(m)}),[]);const u=async()=>{try{await uc.forceSync()}catch(f){console.error("Manual sync failed:",f),r("手動同步失敗")}};return h.jsxs("div",{className:"relative",children:[h.jsx("button",{onClick:()=>o(!i),className:"w-2 h-2 rounded-full hover:scale-125 transition-transform",title:l?t||s?"同步中...":n?"同步錯誤":"已同步":"離線模式",children:h.jsx("div",{className:`w-2 h-2 rounded-full ${l?t||s?"bg-yellow-500 animate-pulse":n?"bg-red-500":"bg-green-500":"bg-gray-500"}`})}),i&&h.jsxs("div",{className:"absolute top-6 right-0 bg-white rounded-lg shadow-lg border p-3 w-56 z-50",children:[h.jsxs("div",{className:"flex items-center justify-between mb-2",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("div",{className:`w-2 h-2 rounded-full ${l?t||s?"bg-yellow-500 animate-pulse":n?"bg-red-500":"bg-green-500":"bg-gray-500"}`}),h.jsx("span",{className:"text-sm font-medium",children:l?t||s?"同步中...":n?"同步錯誤":"已同步":"離線模式"})]}),h.jsx("button",{onClick:()=>o(!1),className:"text-text-tertiary hover:text-text-secondary text-sm",children:"✕"})]}),h.jsxs("div",{className:"text-xs text-text-secondary mb-2",children:["網絡狀態: ",l?"已連接":"離線"]}),e&&h.jsxs("div",{className:"text-xs text-text-secondary mb-2",children:["最後同步: ",e.toLocaleTimeString()]}),s&&h.jsx("div",{className:"text-xs text-yellow-600 mb-2",children:"正在同步本地更改..."}),n&&h.jsx("div",{className:"text-xs text-red-600 mb-2 break-words",children:n}),h.jsx("button",{onClick:u,disabled:t||s||!l,className:`w-full text-xs px-2 py-1 rounded ${t||s||!l?"bg-background-tertiary text-text-tertiary cursor-not-allowed":"bg-primary text-white hover:bg-primary-dark"}`,children:l?t||s?"同步中...":"手動同步":"離線中"})]})]})}function qb(){const{projects:t,createProject:e,deleteProject:n}=Bt(),[r,s]=L.useState(!1),[i,o]=L.useState(""),[l,c]=L.useState("");console.log("ProjectListView 渲染，專案數量:",t.length);const u=m=>{m.preventDefault(),i.trim()&&(e(i.trim(),l.trim()||void 0),o(""),c(""),s(!1))},f=(m,g)=>{confirm(`確定要刪除專案「${g}」嗎？此操作無法復原。`)&&n(m)};return h.jsxs("div",{className:"min-h-screen bg-background-primary safe-top safe-bottom",children:[h.jsx("div",{className:"bg-background-secondary border-b border-border",children:h.jsx("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-4 sm:py-6",children:h.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[h.jsx("h1",{className:"text-xl sm:text-2xl lg:text-3xl font-bold text-text-primary",children:"編織專案"}),h.jsxs("div",{className:"flex items-center gap-2 sm:gap-4 w-full sm:w-auto justify-between sm:justify-end",children:[h.jsx(Wb,{}),h.jsx("button",{onClick:()=>s(!0),className:"btn btn-primary text-xs sm:text-sm",children:"新增專案"}),h.jsx(Ki,{})]})]})})}),h.jsx("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-4 sm:py-6",children:t.length===0?h.jsxs("div",{className:"text-center py-8 sm:py-12",children:[h.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-text-primary mb-2",children:"還沒有編織專案"}),h.jsx("p",{className:"text-sm sm:text-base text-text-secondary mb-6",children:"建立你的第一個編織專案開始記錄進度"}),h.jsx("button",{onClick:()=>s(!0),className:"btn btn-primary text-sm sm:text-base",children:"建立新專案"})]}):h.jsx("div",{className:"grid gap-3 sm:gap-4 md:gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:t.map(m=>h.jsxs("div",{className:"card hover:shadow-md transition-shadow",children:[h.jsxs("div",{className:"flex items-start justify-between mb-3",children:[h.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[h.jsx("h3",{className:"text-base sm:text-lg font-semibold text-text-primary truncate",children:m.name}),m.isCompleted&&h.jsx("span",{className:"text-text-secondary text-sm font-medium",children:"完成"})]}),h.jsx("button",{onClick:()=>f(m.id,m.name),className:"text-text-tertiary hover:text-red-500 transition-colors text-sm sm:text-base ml-2",children:"刪除"})]}),h.jsxs("div",{className:"space-y-2 mb-4",children:[h.jsxs("div",{className:"flex justify-between text-xs sm:text-sm",children:[h.jsx("span",{className:"text-text-secondary",children:"進度"}),h.jsxs("span",{className:"text-text-primary",children:[m.isCompleted?"100":Math.round(qh(m)*100),"%"]})]}),h.jsx("div",{className:"w-full bg-background-tertiary rounded-full h-1.5 sm:h-2",children:h.jsx("div",{className:"h-1.5 sm:h-2 rounded-full transition-all duration-300 bg-primary",style:{width:`${m.isCompleted?100:qh(m)*100}%`}})})]}),h.jsxs("div",{className:"space-y-1 mb-4 text-xs sm:text-sm text-text-secondary",children:[h.jsxs("div",{children:["圈數: ",m.currentRound,"/",Lc(m)]}),h.jsxs("div",{children:["針數: ",Tp(m),"/",_a(m)]}),h.jsxs("div",{children:["更新: ",Wh(m.lastModified)]})]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx(St,{to:`/project/${m.id}/progress`,className:"btn btn-primary flex-1",children:"開始編織"}),h.jsx(St,{to:`/project/${m.id}`,className:"btn btn-secondary",children:"詳情"})]})]},m.id))})}),r&&h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:h.jsxs("div",{className:"bg-background-secondary rounded-xl p-6 w-full max-w-md",children:[h.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-4",children:"建立新專案"}),h.jsxs("form",{onSubmit:u,className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"專案名稱 *"}),h.jsx("input",{type:"text",value:i,onChange:m=>o(m.target.value),className:"input",placeholder:"輸入專案名稱",required:!0,autoFocus:!0})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"來源網址（選填）"}),h.jsx("input",{type:"url",value:l,onChange:m=>c(m.target.value),className:"input",placeholder:"https://..."})]}),h.jsxs("div",{className:"flex gap-3 pt-4",children:[h.jsx("button",{type:"button",onClick:()=>s(!1),className:"btn btn-secondary flex-1",children:"取消"}),h.jsx("button",{type:"submit",className:"btn btn-primary flex-1",children:"建立"})]})]})]})})]})}var sx={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},i_=xn.createContext&&xn.createContext(sx),Kb=["attr","size","title"];function Qb(t,e){if(t==null)return{};var n=Yb(t,e),r,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function Yb(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function ru(){return ru=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ru.apply(this,arguments)}function o_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function su(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?o_(Object(n),!0).forEach(function(r){Jb(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o_(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Jb(t,e,n){return e=Xb(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xb(t){var e=Zb(t,"string");return typeof e=="symbol"?e:e+""}function Zb(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ix(t){return t&&t.map((e,n)=>xn.createElement(e.tag,su({key:n},e.attr),ix(e.child)))}function Yr(t){return e=>xn.createElement(e4,ru({attr:su({},t.attr)},e),ix(t.child))}function e4(t){var e=n=>{var{attr:r,size:s,title:i}=t,o=Qb(t,Kb),l=s||n.size||"1em",c;return n.className&&(c=n.className),t.className&&(c=(c?c+" ":"")+t.className),xn.createElement("svg",ru({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,o,{className:c,style:su(su({color:t.color||n.color},n.style),t.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),i&&xn.createElement("title",null,i),t.children)};return i_!==void 0?xn.createElement(i_.Consumer,null,n=>e(n)):e(sx)}function t4(t){return Yr({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",strokeMiterlimit:"10",strokeWidth:"32",d:"M448 256c0-106-86-192-192-192S64 150 64 256s86 192 192 192 192-86 192-192z"},child:[]},{tag:"path",attr:{d:"m216.32 334.44 114.45-69.14a10.89 10.89 0 0 0 0-18.6l-114.45-69.14a10.78 10.78 0 0 0-16.32 9.31v138.26a10.78 10.78 0 0 0 16.32 9.31z"},child:[]}]})(t)}function Sf(t){return Yr({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M402.3 344.9l32-32c5-5 13.7-1.5 13.7 5.7V464c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h273.5c7.1 0 10.7 8.6 5.7 13.7l-32 32c-1.5 1.5-3.5 2.3-5.7 2.3H48v352h352V350.5c0-2.1.8-4.1 2.3-5.6zm156.6-201.8L296.3 405.7l-90.4 10c-26.2 2.9-48.5-19.2-45.6-45.6l10-90.4L432.9 17.1c22.9-22.9 59.9-22.9 82.7 0l43.2 43.2c22.9 22.9 22.9 60 .1 82.8zM460.1 174L402 115.9 216.2 301.8l-7.3 65.3 65.3-7.3L460.1 174zm64.8-79.7l-43.2-43.2c-4.1-4.1-10.8-4.1-14.8 0L436 82l58.1 58.1 30.9-30.9c4-4.2 4-10.8-.1-14.9z"},child:[]}]})(t)}function a_(t){return Yr({tag:"svg",attr:{viewBox:"0 0 32 32"},child:[{tag:"path",attr:{d:"M 16 3 C 8.855469 3 3 8.855469 3 16 C 3 23.144531 8.855469 29 16 29 C 23.144531 29 29 23.144531 29 16 C 29 8.855469 23.144531 3 16 3 Z M 16 5 C 18.355469 5 20.550781 5.757813 22.34375 7.03125 C 20.171875 6.496094 18.125 6.410156 16.40625 6.53125 C 15.101563 6.625 13.976563 6.820313 13.125 7.03125 C 12.851563 7.097656 12.675781 7.15625 12.46875 7.21875 C 12.347656 6.539063 12.3125 5.980469 12.3125 5.65625 C 13.46875 5.242188 14.703125 5 16 5 Z M 10.375 6.59375 C 10.429688 7.132813 10.542969 7.777344 10.71875 8.5 C 10.714844 8.699219 10.769531 8.894531 10.875 9.0625 C 11.203125 10.222656 11.703125 11.535156 12.5 12.90625 C 12.519531 12.9375 12.539063 12.96875 12.5625 13 C 13.175781 14.039063 13.933594 15.109375 14.90625 16.15625 C 14.652344 17.019531 14.339844 17.816406 14 18.53125 C 13.421875 18.003906 12.691406 17.226563 11.90625 16.09375 C 10.578125 14.179688 9.3125 11.421875 9.25 7.71875 C 9.25 7.601563 9.226563 7.484375 9.1875 7.375 C 9.554688 7.085938 9.972656 6.835938 10.375 6.59375 Z M 17.4375 8.46875 C 19.625 8.421875 22.261719 8.761719 24.90625 10.03125 C 25.027344 10.113281 25.167969 10.164063 25.3125 10.1875 C 25.632813 10.695313 25.921875 11.21875 26.15625 11.78125 C 23.042969 10.386719 20.15625 10.117188 17.875 10.28125 C 16.050781 10.410156 14.6875 10.808594 13.8125 11.125 C 13.46875 10.4375 13.207031 9.773438 13 9.15625 C 13.195313 9.097656 13.375 9.03125 13.625 8.96875 C 14.375 8.78125 15.359375 8.582031 16.53125 8.5 C 16.824219 8.480469 17.125 8.476563 17.4375 8.46875 Z M 7.34375 9.25 C 7.683594 12.660156 8.933594 15.320313 10.25 17.21875 C 11.277344 18.703125 12.328125 19.730469 13 20.3125 C 12.546875 21 12.058594 21.578125 11.59375 22.09375 C 10.976563 21.480469 10.101563 20.503906 9.25 19.1875 C 7.894531 17.089844 6.660156 14.195313 6.78125 10.71875 C 6.800781 10.535156 6.765625 10.351563 6.6875 10.1875 C 6.890625 9.867188 7.109375 9.546875 7.34375 9.25 Z M 18.9375 12.25 C 21.113281 12.222656 23.78125 12.652344 26.65625 14.25 C 26.714844 14.289063 26.777344 14.320313 26.84375 14.34375 C 26.917969 14.835938 26.992188 15.335938 27 15.84375 C 25.691406 15.257813 23.589844 14.554688 20.84375 14.5 C 20.65625 14.417969 20.449219 14.398438 20.25 14.4375 C 20.1875 14.453125 20.121094 14.472656 20.0625 14.5 C 20.042969 14.5 20.019531 14.5 20 14.5 C 18.921875 14.53125 17.753906 14.6875 16.53125 14.96875 C 15.871094 14.277344 15.316406 13.574219 14.84375 12.875 C 15.589844 12.640625 16.675781 12.378906 18.03125 12.28125 C 18.320313 12.261719 18.625 12.253906 18.9375 12.25 Z M 5.125 14.40625 C 5.617188 16.714844 6.5625 18.699219 7.5625 20.25 C 8.527344 21.746094 9.480469 22.808594 10.1875 23.5 C 9.699219 23.914063 9.289063 24.210938 8.96875 24.4375 C 6.542969 22.417969 5 19.390625 5 16 C 5 15.460938 5.050781 14.925781 5.125 14.40625 Z M 21.34375 16.53125 C 22.128906 16.574219 22.851563 16.648438 23.5 16.78125 C 23.476563 16.984375 23.453125 17.171875 23.40625 17.4375 C 23.269531 18.195313 23.023438 19.195313 22.59375 20.28125 C 21.734375 22.449219 20.171875 24.957031 17.25 26.6875 C 17.152344 26.753906 17.066406 26.839844 17 26.9375 C 16.671875 26.96875 16.335938 27 16 27 C 15.523438 27 15.054688 26.964844 14.59375 26.90625 C 17.382813 24.933594 19.066406 22.519531 20.0625 20.4375 C 20.636719 19.238281 20.980469 18.148438 21.1875 17.28125 C 21.257813 16.984375 21.300781 16.765625 21.34375 16.53125 Z M 19.1875 16.5625 C 19.230469 16.558594 19.273438 16.566406 19.3125 16.5625 C 19.292969 16.65625 19.273438 16.710938 19.25 16.8125 C 19.074219 17.554688 18.753906 18.507813 18.25 19.5625 C 17.242188 21.667969 15.46875 24.148438 12.25 26.03125 C 12.144531 26.078125 12.050781 26.140625 11.96875 26.21875 C 11.519531 26.039063 11.105469 25.828125 10.6875 25.59375 C 11.011719 25.34375 11.40625 25.023438 11.8125 24.65625 C 12.082031 24.664063 12.34375 24.5625 12.539063 24.375 C 12.734375 24.1875 12.84375 23.925781 12.84375 23.65625 C 13.578125 22.871094 14.332031 21.925781 15.03125 20.75 C 15.117188 20.648438 15.179688 20.53125 15.21875 20.40625 C 15.785156 19.40625 16.285156 18.261719 16.6875 16.96875 C 17.566406 16.75 18.390625 16.632813 19.1875 16.5625 Z M 25.4375 17.34375 C 26.03125 17.558594 26.488281 17.769531 26.8125 17.9375 C 26.269531 20.960938 24.507813 23.554688 22.03125 25.1875 C 23.160156 23.816406 23.945313 22.355469 24.46875 21.03125 C 24.957031 19.800781 25.21875 18.679688 25.375 17.8125 C 25.410156 17.621094 25.414063 17.503906 25.4375 17.34375 Z"},child:[]}]})(t)}function n4(t){return Yr({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"16 16 12 12 8 16"},child:[]},{tag:"line",attr:{x1:"12",y1:"12",x2:"12",y2:"21"},child:[]},{tag:"path",attr:{d:"M20.39 18.39A5 5 0 0 0 18 9h-1.26A8 8 0 1 0 3 16.3"},child:[]},{tag:"polyline",attr:{points:"16 16 12 12 8 16"},child:[]}]})(t)}function r4(){const{projectId:t}=Oa(),e=Mi(),{currentProject:n,setCurrentProject:r,projects:s}=Bt();return L.useEffect(()=>{t&&(s.find(o=>o.id===t)?r(t):e("/404"))},[t,r,s,e]),n?h.jsxs("div",{className:"min-h-screen bg-background-primary safe-top safe-bottom",children:[h.jsx("div",{className:"bg-background-secondary border-b border-border",children:h.jsx("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-3 sm:py-4",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-3 sm:gap-4",children:[h.jsx(St,{to:"/",className:"text-text-secondary hover:text-text-primary transition-colors text-sm sm:text-base",children:"← 返回"}),h.jsx("h1",{className:"text-lg sm:text-xl font-semibold text-text-primary truncate",children:n.name})]}),h.jsx(Ki,{})]})})}),h.jsxs("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-4 sm:py-6 space-y-4 sm:space-y-6",children:[h.jsxs("div",{className:"card",children:[h.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-4",children:"專案資訊"}),h.jsxs("div",{className:"space-y-4",children:[n.source&&h.jsxs("div",{children:[h.jsx("div",{className:"text-sm text-text-secondary mb-1",children:"來源"}),h.jsx("a",{href:n.source,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline break-all text-sm",children:n.source})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("div",{className:"text-sm text-text-secondary mb-1",children:"建立日期"}),h.jsx("div",{className:"text-text-primary text-sm",children:Wh(n.createdDate)})]}),h.jsxs("div",{children:[h.jsx("div",{className:"text-sm text-text-secondary mb-1",children:"最後修改"}),h.jsx("div",{className:"text-text-primary text-sm",children:Wh(n.lastModified)})]})]}),h.jsxs("div",{className:"grid grid-cols-3 gap-4 pt-2 border-t border-border",children:[h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-sm text-text-secondary",children:"使用毛線"}),h.jsx("div",{className:"text-lg font-semibold text-text-primary",children:n.yarns.length})]}),h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-sm text-text-secondary",children:"織圖圈數"}),h.jsx("div",{className:"text-lg font-semibold text-text-primary",children:n.pattern.length})]}),h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-sm text-text-secondary",children:"總針數"}),h.jsx("div",{className:"text-lg font-semibold text-text-primary",children:_a(n)})]})]})]})]}),h.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:[h.jsx(St,{to:`/project/${n.id}/progress`,className:"card hover:shadow-md transition-shadow cursor-pointer",children:h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"w-12 h-12 flex items-center justify-center",children:h.jsx(t4,{className:"w-8 h-8 text-text-secondary"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"font-semibold text-text-primary",children:"開始編織"}),h.jsx("p",{className:"text-sm text-text-secondary",children:"追蹤編織進度"})]})]})}),h.jsx(St,{to:`/project/${n.id}/pattern`,className:"card hover:shadow-md transition-shadow cursor-pointer",children:h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"w-12 h-12 flex items-center justify-center",children:h.jsx(Sf,{className:"w-8 h-8 text-text-secondary"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"font-semibold text-text-primary",children:"編輯織圖"}),h.jsx("p",{className:"text-sm text-text-secondary",children:"管理圈數和針法"})]})]})}),h.jsx(St,{to:`/project/${n.id}/yarns`,className:"card hover:shadow-md transition-shadow cursor-pointer",children:h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"w-12 h-12 flex items-center justify-center",children:h.jsx(a_,{className:"w-8 h-8 text-text-secondary"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"font-semibold text-text-primary",children:"毛線管理"}),h.jsx("p",{className:"text-sm text-text-secondary",children:"管理專案毛線"})]})]})}),h.jsx(St,{to:`/project/${n.id}/import-export`,className:"card hover:shadow-md transition-shadow cursor-pointer",children:h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"w-12 h-12 flex items-center justify-center",children:h.jsx(n4,{className:"w-8 h-8 text-text-secondary"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"font-semibold text-text-primary",children:"匯入匯出"}),h.jsx("p",{className:"text-sm text-text-secondary",children:"備份和分享"})]})]})})]}),h.jsxs("div",{className:"card",children:[h.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-4",children:"使用的毛線"}),n.yarns.length===0?h.jsxs("div",{className:"text-center py-8",children:[h.jsx("div",{className:"mb-3 flex justify-center",children:h.jsx(a_,{className:"w-8 h-8 text-text-tertiary"})}),h.jsx("p",{className:"text-text-tertiary mb-3",children:"尚未添加毛線"}),h.jsx(St,{to:`/project/${n.id}/yarns`,className:"text-primary hover:underline text-sm",children:"點擊這裡管理毛線"})]}):h.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:n.yarns.map(i=>h.jsxs("div",{className:"flex items-center gap-3 p-3 bg-background-secondary rounded-lg",children:[h.jsx("div",{className:"w-8 h-8 rounded-full border-2 border-white shadow-sm flex-shrink-0",style:{backgroundColor:i.color.hex}}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("h3",{className:"font-medium text-text-primary truncate",children:i.name}),i.brand&&h.jsx("p",{className:"text-sm text-text-secondary truncate",children:i.brand}),h.jsx("p",{className:"text-xs text-text-tertiary",children:i.color.name})]})]},i.id))})]}),h.jsxs("div",{className:"card",children:[h.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-4",children:"織圖"}),n.pattern.length===0?h.jsxs("div",{className:"text-center py-8",children:[h.jsx("div",{className:"mb-3 flex justify-center",children:h.jsx(Sf,{className:"w-8 h-8 text-text-tertiary"})}),h.jsx("p",{className:"text-text-tertiary mb-3",children:"尚未建立織圖"}),h.jsx(St,{to:`/project/${n.id}/pattern`,className:"text-primary hover:underline text-sm",children:"點擊這裡開始編輯織圖"})]}):h.jsxs("div",{className:"space-y-4",children:[h.jsx("div",{className:"space-y-3",children:n.pattern.slice(0,5).map(i=>{const o=zt(i),l=LC(i,n.yarns);return h.jsxs("div",{className:"flex gap-3 p-3 bg-background-secondary rounded-lg",children:[h.jsxs("div",{className:"text-sm font-semibold flex-shrink-0 leading-relaxed",style:{color:"#d96699"},children:["R",i.roundNumber]}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("p",{className:"text-text-primary font-medium text-sm leading-relaxed m-0",children:l}),i.notes&&h.jsx("p",{className:"text-xs text-text-tertiary mt-1",children:i.notes})]}),h.jsx("div",{className:"text-right flex-shrink-0",children:h.jsxs("p",{className:"text-sm font-semibold text-text-primary leading-relaxed m-0",children:[o," 針"]})})]},i.id)})}),h.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-border",children:[h.jsxs("div",{className:"text-sm font-medium text-text-secondary",children:["總圈數: ",Lc(n)]}),h.jsxs("div",{className:"text-sm font-medium text-text-secondary",children:["總針數: ",_a(n)]})]}),n.pattern.length>5&&h.jsx("div",{className:"text-center pt-2",children:h.jsxs(St,{to:`/project/${n.id}/pattern`,className:"text-primary hover:underline text-sm",children:["查看全部 ",n.pattern.length," 圈織圖"]})})]})]})]})]}):h.jsx("div",{className:"min-h-screen bg-background-primary flex items-center justify-center",children:h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),h.jsx("p",{className:"text-text-secondary",children:"載入中..."})]})})}function qd(t){return Yr({tag:"svg",attr:{viewBox:"0 0 16 16",fill:"currentColor"},child:[{tag:"path",attr:{d:"M13.23 1h-1.46L3.52 9.25l-.16.22L1 13.59 2.41 15l4.12-2.36.22-.16L15 4.23V2.77L13.23 1zM2.41 13.59l1.51-3 1.45 1.45-2.96 1.55zm3.83-2.06L4.47 9.76l8-8 1.77 1.77-8 8z"},child:[]}]})(t)}function Ro(t){return Yr({tag:"svg",attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z"},child:[]},{tag:"path",attr:{d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z"},child:[]}]})(t)}function Kd(t){return Yr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"g",attr:{id:"Circle_Check"},child:[{tag:"g",attr:{},child:[{tag:"path",attr:{d:"M15.81,10.4a.5.5,0,0,0-.71-.71l-3.56,3.56L9.81,11.52a.5.5,0,0,0-.71.71l2.08,2.08a.513.513,0,0,0,.71,0Z"},child:[]},{tag:"path",attr:{d:"M12,21.934A9.934,9.934,0,1,1,21.933,12,9.945,9.945,0,0,1,12,21.934ZM12,3.067A8.934,8.934,0,1,0,20.933,12,8.944,8.944,0,0,0,12,3.067Z"},child:[]}]}]}]})(t)}function Qd(t){return Yr({tag:"svg",attr:{viewBox:"0 0 15 15",fill:"none"},child:[{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M0.877075 7.49988C0.877075 3.84219 3.84222 0.877045 7.49991 0.877045C11.1576 0.877045 14.1227 3.84219 14.1227 7.49988C14.1227 11.1575 11.1576 14.1227 7.49991 14.1227C3.84222 14.1227 0.877075 11.1575 0.877075 7.49988ZM7.49991 1.82704C4.36689 1.82704 1.82708 4.36686 1.82708 7.49988C1.82708 10.6329 4.36689 13.1727 7.49991 13.1727C10.6329 13.1727 13.1727 10.6329 13.1727 7.49988C13.1727 4.36686 10.6329 1.82704 7.49991 1.82704ZM9.85358 5.14644C10.0488 5.3417 10.0488 5.65829 9.85358 5.85355L8.20713 7.49999L9.85358 9.14644C10.0488 9.3417 10.0488 9.65829 9.85358 9.85355C9.65832 10.0488 9.34173 10.0488 9.14647 9.85355L7.50002 8.2071L5.85358 9.85355C5.65832 10.0488 5.34173 10.0488 5.14647 9.85355C4.95121 9.65829 4.95121 9.3417 5.14647 9.14644L6.79292 7.49999L5.14647 5.85355C4.95121 5.65829 4.95121 5.3417 5.14647 5.14644C5.34173 4.95118 5.65832 4.95118 5.85358 5.14644L7.50002 6.79289L9.14647 5.14644C9.34173 4.95118 9.65832 4.95118 9.85358 5.14644Z",fill:"currentColor"},child:[]}]})(t)}function s4(){const{projectId:t}=Oa(),e=Mi(),{currentProject:n,setCurrentProject:r,projects:s,addRound:i,updateRound:o,deleteRound:l,addStitchToRound:c,addStitchGroupToRound:u,updateStitchInRound:f,deleteStitchFromRound:m,reorderStitchesInRound:g,updateStitchGroupInRound:w,updateStitchInGroup:R,deleteStitchGroupFromRound:N,reorderStitchGroupsInRound:P}=Bt(),[x,v]=L.useState(!1),[S,D]=L.useState(null),[F,z]=L.useState(null),[T,_]=L.useState(null),[I,E]=L.useState(null),[A,b]=L.useState(null),[C,qe]=L.useState(null),[Ke,Mt]=L.useState(!1),[xt,W]=L.useState(""),[$,q]=L.useState(vr.SINGLE),[re,se]=L.useState(1),[ce,be]=L.useState(""),[$e,De]=L.useState(1),[je,yn]=L.useState([]),[Ka,Jr]=L.useState(vr.SINGLE),[Xr,ks]=L.useState(1),[bs,Ds]=L.useState(""),[js,Qi]=L.useState(1),[Yi,Qa]=L.useState(vr.SINGLE),[Ji,Xi]=L.useState(1),[Vs,Zi]=L.useState(null),[Ya,Os]=L.useState(null);if(L.useEffect(()=>{t&&(s.find(O=>O.id===t)?r(t):e("/404"))},[t,s,e]),!n)return h.jsx("div",{className:"min-h-screen bg-background-primary flex items-center justify-center",children:h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),h.jsx("p",{className:"text-text-secondary",children:"載入中..."})]})});const eo=async()=>{var B;if(!Ke){Mt(!0);try{if(!n){console.error("No current project");return}const O=((B=n.pattern)==null?void 0:B.map(rt=>rt.roundNumber))||[],ne=Math.max(0,...O)+1,Z={id:Ze(),roundNumber:ne,stitches:[],stitchGroups:[],notes:xt.trim()||void 0};await i(Z),W(""),v(!1)}catch(O){console.error("Error adding round:",O),alert("新增圈數時發生錯誤，請查看控制台了解詳情")}finally{Mt(!1)}}},to=async B=>{confirm(`確定要刪除第 ${B} 圈嗎？`)&&await l(B)},Qe=async B=>{var O;if(!Ke){Mt(!0);try{if(!n){console.error("No current project");return}const ne={id:Ze(),type:$,yarnId:((O=n.yarns[0])==null?void 0:O.id)||"",count:re};await c(B,ne),se(1),D(null)}catch(ne){console.error("Error adding stitch:",ne),alert("新增針法時發生錯誤，請查看控制台了解詳情")}finally{Mt(!1)}}},nt=async B=>{if(je.length===0){alert("請先新增群組中的針法");return}const O={id:Ze(),name:ce.trim()||"針目群組",stitches:[...je],repeatCount:$e};await u(B,O),be(""),De(1),yn([]),z(null)},Ls=()=>{var O;const B={id:Ze(),type:$,yarnId:((O=n.yarns[0])==null?void 0:O.id)||"",count:re};yn([...je,B]),se(1)},Ja=B=>{yn(je.filter(O=>O.id!==B))},no=async(B,O)=>{const ne={...B,notes:O.trim()||void 0};await o(ne),_(null)},$u=(B,O)=>{E({roundNumber:B,stitchId:O.id}),Jr(O.type),ks(O.count)},Zr=async(B,O)=>{var Z;const ne={id:O,type:Ka,yarnId:((Z=n.yarns[0])==null?void 0:Z.id)||"",count:Xr};await f(B,O,ne),E(null)},Xa=async(B,O)=>{confirm("確定要刪除這個針法嗎？")&&await m(B,O)},Za=(B,O)=>{b({roundNumber:B,groupId:O.id}),Ds(O.name),Qi(O.repeatCount)},ro=async(B,O,ne)=>{const Z={...ne,name:bs.trim()||"針目群組",repeatCount:js};await w(B,O,Z),b(null)},Gu=async(B,O)=>{confirm("確定要刪除這個針目群組嗎？")&&await N(B,O)},Hu=(B,O,ne)=>{qe({roundNumber:B,groupId:O,stitchId:ne.id}),Qa(ne.type),Xi(ne.count)},so=async(B,O,ne)=>{var rt;const Z={id:ne,type:Yi,yarnId:((rt=n.yarns[0])==null?void 0:rt.id)||"",count:Ji};await R(B,O,ne,Z),qe(null)},el=async(B,O,ne)=>{if(confirm("確定要刪除這個針法嗎？")){const Z=n==null?void 0:n.pattern.find(_e=>_e.roundNumber===B),rt=Z==null?void 0:Z.stitchGroups.find(_e=>_e.id===O);if(rt){const _e={...rt,stitches:rt.stitches.filter(At=>At.id!==ne)};await w(B,O,_e)}}},io=(B,O,ne,Z)=>{Z==="stitch"?Zi({index:ne,stitch:O}):Os({index:ne,group:O})},nr=B=>{B.preventDefault()},Ms=async(B,O,ne,Z)=>{B.preventDefault(),Z==="stitch"&&Vs?(await g(ne,Vs.index,O),Zi(null)):Z==="group"&&Ya&&(await P(ne,Ya.index,O),Os(null))};return h.jsxs("div",{className:"min-h-screen bg-background-primary safe-top safe-bottom",children:[h.jsx("div",{className:"bg-background-secondary border-b border-border sticky top-0 z-10",children:h.jsx("div",{className:"w-full px-3 sm:px-4 lg:px-6 py-3 sm:py-4",children:h.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[h.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[h.jsx(St,{to:`/project/${t}`,className:"text-text-secondary hover:text-text-primary transition-colors text-sm sm:text-base",children:"← 返回"}),h.jsx("h1",{className:"text-base sm:text-xl font-semibold text-text-primary",children:"織圖編輯"})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("button",{onClick:()=>v(!0),className:"btn btn-primary w-full sm:w-auto",disabled:Ke,children:Ke?"處理中...":"新增圈數"}),h.jsx(Ki,{})]})]})})}),h.jsxs("div",{className:"w-full px-3 sm:px-4 lg:px-6 py-4 sm:py-6 space-y-4 sm:space-y-6",children:[h.jsxs("div",{className:"card",children:[h.jsx("h2",{className:"text-lg font-semibold text-text-primary mb-4",children:"織圖總覽"}),h.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-4 gap-4 text-sm",children:[h.jsxs("div",{children:[h.jsx("span",{className:"text-text-secondary",children:"總圈數："}),h.jsx("span",{className:"font-medium text-text-primary",children:n.pattern.length})]}),h.jsxs("div",{children:[h.jsx("span",{className:"text-text-secondary",children:"總針數："}),h.jsx("span",{className:"font-medium text-text-primary",children:n.pattern.reduce((B,O)=>B+zt(O),0)})]}),h.jsxs("div",{children:[h.jsx("span",{className:"text-text-secondary",children:"使用毛線："}),h.jsxs("span",{className:"font-medium text-text-primary",children:[n.yarns.length," 種"]})]}),h.jsxs("div",{children:[h.jsx("span",{className:"text-text-secondary",children:"當前圈數："}),h.jsxs("span",{className:"font-medium text-text-primary",children:["R",n.currentRound]})]})]})]}),n.pattern.length===0?h.jsxs("div",{className:"card text-center py-12",children:[h.jsx("div",{className:"mb-4 flex justify-center",children:h.jsx(Sf,{className:"w-8 h-8 text-text-tertiary"})}),h.jsx("h3",{className:"text-xl font-semibold text-text-primary mb-2",children:"還沒有織圖圈數"}),h.jsx("p",{className:"text-text-secondary mb-6",children:"開始建立你的第一個圈數"}),h.jsx("button",{onClick:()=>v(!0),className:"btn btn-primary",children:"新增第一圈"})]}):h.jsx("div",{className:"space-y-4",children:n.pattern.sort((B,O)=>B.roundNumber-O.roundNumber).map(B=>h.jsxs("div",{className:"card",children:[h.jsxs("div",{className:"flex items-center justify-between mb-4",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsxs("h3",{className:"text-lg font-semibold text-text-primary",children:["第 ",B.roundNumber," 圈"]}),h.jsxs("div",{className:"text-sm text-text-secondary",children:[zt(B)," 針"]}),B.roundNumber===n.currentRound&&h.jsx("div",{className:"px-2 py-1 bg-primary text-white text-xs rounded-full",children:"目前"})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("button",{onClick:()=>D(B.roundNumber),className:"btn btn-ghost text-sm",children:"新增針法"}),h.jsx("button",{onClick:()=>z(B.roundNumber),className:"btn btn-ghost text-sm",children:"新增群組"}),h.jsx("button",{onClick:()=>to(B.roundNumber),className:"text-text-tertiary hover:text-red-500 transition-colors p-2",children:h.jsx(Ro,{className:"w-5 h-5"})})]})]}),(T==null?void 0:T.id)===B.id?h.jsx("div",{className:"mb-4",children:h.jsx("input",{type:"text",defaultValue:B.notes||"",className:"input text-sm",placeholder:"輸入備註...",onBlur:O=>no(B,O.target.value),onKeyDown:O=>{O.key==="Enter"&&no(B,O.currentTarget.value),O.key==="Escape"&&_(null)},autoFocus:!0})}):h.jsx("div",{className:"mb-4",children:B.notes?h.jsxs("div",{className:"text-sm text-text-secondary cursor-pointer hover:text-text-primary",onClick:()=>_(B),children:["備註: ",B.notes]}):h.jsx("div",{className:"text-sm text-text-tertiary cursor-pointer hover:text-text-secondary",onClick:()=>_(B),children:"點擊新增備註..."})}),B.stitches.length>0&&h.jsx("div",{className:"mb-4",children:h.jsx("div",{className:"space-y-2",children:B.stitches.map((O,ne)=>{var Z,rt;return h.jsxs("div",{className:"flex items-center gap-3 p-2 bg-background-tertiary rounded cursor-move",draggable:!0,onDragStart:_e=>io(_e,O,ne,"stitch"),onDragOver:nr,onDrop:_e=>Ms(_e,ne,B.roundNumber,"stitch"),children:[h.jsx("div",{className:"text-lg",children:((Z=Pt[O.type])==null?void 0:Z.symbol)||"○"}),h.jsx("div",{className:"flex-1",children:(I==null?void 0:I.stitchId)===O.id?h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("select",{value:Ka,onChange:_e=>Jr(_e.target.value),className:"input text-sm",children:Object.entries(Pt).map(([_e,At])=>h.jsxs("option",{value:_e,children:[At.symbol," ",At.rawValue]},_e))}),h.jsx("input",{type:"number",min:"1",value:Xr,onChange:_e=>ks(parseInt(_e.target.value)||1),className:"input text-sm w-16"}),h.jsx("button",{onClick:()=>Zr(B.roundNumber,O.id),className:"text-green-500 hover:text-green-600 p-2",children:h.jsx(Kd,{className:"w-5 h-5"})}),h.jsx("button",{onClick:()=>E(null),className:"text-text-tertiary hover:text-text-secondary p-2",children:h.jsx(Qd,{className:"w-5 h-5"})})]}):h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"font-medium text-text-primary",children:((rt=Pt[O.type])==null?void 0:rt.rawValue)||O.type}),h.jsxs("span",{className:"text-sm text-text-secondary",children:["×",O.count]}),h.jsxs("div",{className:"flex items-center gap-1 ml-auto",children:[h.jsx("button",{onClick:()=>$u(B.roundNumber,O),className:"text-text-tertiary hover:text-primary p-2",children:h.jsx(qd,{className:"w-5 h-5"})}),h.jsx("button",{onClick:()=>Xa(B.roundNumber,O.id),className:"text-text-tertiary hover:text-red-500 p-2",children:h.jsx(Ro,{className:"w-5 h-5"})})]})]})})]},O.id)})})}),B.stitchGroups.length>0&&h.jsx("div",{className:"mb-4",children:h.jsx("div",{className:"space-y-3",children:B.stitchGroups.map((O,ne)=>h.jsxs("div",{className:"border border-border rounded-lg p-3 cursor-move",draggable:!0,onDragStart:Z=>io(Z,O,ne,"group"),onDragOver:nr,onDrop:Z=>Ms(Z,ne,B.roundNumber,"group"),children:[h.jsx("div",{className:"flex items-center justify-between mb-2",children:(A==null?void 0:A.groupId)===O.id?h.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[h.jsx("input",{type:"text",value:bs,onChange:Z=>Ds(Z.target.value),className:"input text-sm flex-1",placeholder:"群組名稱"}),h.jsx("input",{type:"number",min:"1",value:js,onChange:Z=>Qi(parseInt(Z.target.value)||1),className:"input text-sm w-20"}),h.jsx("span",{className:"text-sm text-text-secondary",children:"次"}),h.jsx("button",{onClick:()=>ro(B.roundNumber,O.id,O),className:"text-green-500 hover:text-green-600 p-2",children:h.jsx(Kd,{className:"w-5 h-5"})}),h.jsx("button",{onClick:()=>b(null),className:"text-text-tertiary hover:text-text-secondary p-2",children:h.jsx(Qd,{className:"w-5 h-5"})})]}):h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"font-medium text-text-primary",children:O.name}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs("div",{className:"text-sm text-text-secondary",children:["重複 ",O.repeatCount," 次 (共 ",O0(O)," 針)"]}),h.jsx("button",{onClick:()=>Za(B.roundNumber,O),className:"text-text-tertiary hover:text-primary p-2",children:h.jsx(qd,{className:"w-5 h-5"})}),h.jsx("button",{onClick:()=>Gu(B.roundNumber,O.id),className:"text-text-tertiary hover:text-red-500 p-2",children:h.jsx(Ro,{className:"w-5 h-5"})})]})]})}),h.jsx("div",{className:"space-y-2",children:O.stitches.map(Z=>{var rt,_e;return h.jsxs("div",{className:"flex items-center gap-3 p-2 bg-background-tertiary rounded ml-4",children:[h.jsx("div",{className:"text-lg",children:((rt=Pt[Z.type])==null?void 0:rt.symbol)||"○"}),h.jsx("div",{className:"flex-1",children:(C==null?void 0:C.stitchId)===Z.id&&(C==null?void 0:C.groupId)===O.id?h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("select",{value:Yi,onChange:At=>Qa(At.target.value),className:"input text-sm",children:Object.entries(Pt).map(([At,Ye])=>h.jsxs("option",{value:At,children:[Ye.symbol," ",Ye.rawValue]},At))}),h.jsx("input",{type:"number",min:"1",value:Ji,onChange:At=>Xi(parseInt(At.target.value)||1),className:"input text-sm w-16"}),h.jsx("button",{onClick:()=>so(B.roundNumber,O.id,Z.id),className:"text-green-500 hover:text-green-600 p-2",children:h.jsx(Kd,{className:"w-5 h-5"})}),h.jsx("button",{onClick:()=>qe(null),className:"text-text-tertiary hover:text-text-secondary p-2",children:h.jsx(Qd,{className:"w-5 h-5"})})]}):h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"font-medium text-text-primary",children:((_e=Pt[Z.type])==null?void 0:_e.rawValue)||Z.type}),h.jsxs("span",{className:"text-sm text-text-secondary",children:["×",Z.count]}),h.jsxs("div",{className:"flex items-center gap-1 ml-auto",children:[h.jsx("button",{onClick:()=>Hu(B.roundNumber,O.id,Z),className:"text-text-tertiary hover:text-primary p-2",children:h.jsx(qd,{className:"w-5 h-5"})}),h.jsx("button",{onClick:()=>el(B.roundNumber,O.id,Z.id),className:"text-text-tertiary hover:text-red-500 p-2",children:h.jsx(Ro,{className:"w-5 h-5"})})]})]})})]},Z.id)})})]},O.id))})}),S===B.roundNumber&&h.jsxs("div",{className:"bg-background-tertiary rounded-lg p-4 mb-4",children:[h.jsx("h4",{className:"font-medium text-text-primary mb-3",children:"新增針法"}),h.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"針法類型"}),h.jsx("select",{value:$,onChange:O=>q(O.target.value),className:"input",children:Object.entries(Pt).map(([O,ne])=>h.jsxs("option",{value:O,children:[ne.symbol," ",ne.rawValue]},O))})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"數量"}),h.jsx("input",{type:"number",min:"1",value:re,onChange:O=>se(parseInt(O.target.value)||1),className:"input"})]})]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{onClick:()=>Qe(B.roundNumber),className:"btn btn-primary",disabled:Ke,children:Ke?"新增中...":"新增"}),h.jsx("button",{onClick:()=>D(null),className:"btn btn-secondary",children:"取消"})]})]}),F===B.roundNumber&&h.jsxs("div",{className:"bg-background-tertiary rounded-lg p-4 mb-4",children:[h.jsx("h4",{className:"font-medium text-text-primary mb-3",children:"新增針目群組"}),h.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"群組名稱"}),h.jsx("input",{type:"text",value:ce,onChange:O=>be(O.target.value),className:"input",placeholder:"針目群組"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"重複次數"}),h.jsx("input",{type:"number",min:"1",value:$e,onChange:O=>De(parseInt(O.target.value)||1),className:"input"})]})]}),h.jsxs("div",{className:"mb-4",children:[h.jsxs("div",{className:"flex items-center justify-between mb-2",children:[h.jsx("label",{className:"block text-sm font-medium text-text-secondary",children:"群組針法"}),h.jsx("button",{onClick:Ls,className:"btn btn-ghost text-sm",children:"新增針法"})]}),h.jsx("div",{className:"space-y-2 mb-4",children:je.map(O=>{var ne,Z;return h.jsxs("div",{className:"flex items-center gap-3 p-2 bg-background-secondary rounded",children:[h.jsx("div",{className:"text-lg",children:((ne=Pt[O.type])==null?void 0:ne.symbol)||"○"}),h.jsxs("div",{className:"flex-1",children:[h.jsx("span",{className:"font-medium text-text-primary",children:((Z=Pt[O.type])==null?void 0:Z.rawValue)||O.type}),h.jsxs("span",{className:"text-sm text-text-secondary ml-2",children:["×",O.count]})]}),h.jsx("button",{onClick:()=>Ja(O.id),className:"text-text-tertiary hover:text-red-500 transition-colors p-2",children:h.jsx(Ro,{className:"w-5 h-5"})})]},O.id)})}),h.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4",children:[h.jsx("select",{value:$,onChange:O=>q(O.target.value),className:"input",children:Object.entries(Pt).map(([O,ne])=>h.jsxs("option",{value:O,children:[ne.symbol," ",ne.rawValue]},O))}),h.jsx("input",{type:"number",min:"1",value:re,onChange:O=>se(parseInt(O.target.value)||1),className:"input",placeholder:"數量"})]})]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{onClick:()=>nt(B.roundNumber),className:"btn btn-primary",disabled:je.length===0,children:"新增群組"}),h.jsx("button",{onClick:()=>{z(null),yn([]),be(""),De(1)},className:"btn btn-secondary",children:"取消"})]})]})]},B.id))})]}),x&&h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:h.jsxs("div",{className:"bg-background-secondary rounded-xl p-6 w-full max-w-md",children:[h.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-4",children:"新增圈數"}),h.jsxs("div",{className:"mb-4",children:[h.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"備註（選填）"}),h.jsx("input",{type:"text",value:xt,onChange:B=>W(B.target.value),className:"input",placeholder:"輸入備註..."})]}),h.jsxs("div",{className:"flex gap-3",children:[h.jsx("button",{onClick:()=>v(!1),className:"btn btn-secondary flex-1",children:"取消"}),h.jsx("button",{onClick:eo,className:"btn btn-primary flex-1",disabled:Ke,children:Ke?"新增中...":"新增"})]})]})})]})}function i4(){const{projectId:t}=Oa(),e=Mi(),{currentProject:n,setCurrentProject:r,projects:s,nextStitch:i,previousStitch:o,setCurrentRound:l,startSession:c,endSession:u,updateProject:f}=Bt(),[m,g]=L.useState(!1),[w,R]=L.useState(null),[N,P]=L.useState(0),[x,v]=L.useState(null);if(L.useEffect(()=>{t&&(s.find(q=>q.id===t)?r(t):e("/404"))},[t,r,s,e]),L.useEffect(()=>{let $;return m&&w&&($=setInterval(()=>{P(Math.floor((Date.now()-w.getTime())/1e3))},1e3)),()=>clearInterval($)},[m,w]),!n)return h.jsx("div",{className:"min-h-screen bg-background-primary flex items-center justify-center",children:h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),h.jsx("p",{className:"text-text-secondary",children:"載入中..."})]})});const S=x!==null&&x!==n.currentRound,D=x??n.currentRound,F=n.pattern.find($=>$.roundNumber===D),z=qh(n),T=S?0:n.currentStitch,_=F?zt(F):0,I=()=>{c(),g(!0),R(new Date),P(0)},E=()=>{u(),g(!1),R(null),P(0)},A=()=>{i()},b=()=>{o()},C=$=>{$===n.currentRound?v(null):v($)},qe=async()=>{if(!F)return;console.log("[DEBUG] handleCompleteRound: Completing round",D);const $=Math.max(...n.pattern.map(q=>q.roundNumber));if(D>=$){const q={...n,isCompleted:!0,currentStitch:zt(F),lastModified:new Date};console.log("[DEBUG] handleCompleteRound: Marking project as completed"),await f(q)}else{const q=D+1;console.log("[DEBUG] handleCompleteRound: Moving to next round",q),await l(q)}v(null)},Ke=()=>{v(null)},Mt=$=>{const q=n.yarns.find(re=>re.id===$);return(q==null?void 0:q.color.hex)||"#000000"},xt=$=>{const q=$.replace("#",""),re=parseInt(q.substring(0,2),16),se=parseInt(q.substring(2,4),16),ce=parseInt(q.substring(4,6),16);return(re*299+se*587+ce*114)/1e3>200},W=()=>{if(!F||_===0)return h.jsx("div",{className:"text-center py-8",children:h.jsx("p",{className:"text-text-tertiary",children:"當前圈數沒有針法資料"})});const $=[];let q=0;return F.stitches.forEach(re=>{var ce;const se=Mt(re.yarnId);for(let be=0;be<re.count;be++){const $e=q<T,De=q===T;$.push(h.jsxs("div",{className:"flex flex-col items-center justify-center w-16 h-16 transition-all duration-300",children:[h.jsx("div",{className:`text-2xl font-bold transition-colors duration-300 ${$e?"text-text-primary":De?"text-primary":"text-text-tertiary/50"}`,children:((ce=Pt[re.type])==null?void 0:ce.symbol)||"○"}),h.jsx("div",{className:`w-2.5 h-2.5 rounded-full transition-all duration-300 ${($e||De)&&xt(se)?"border border-gray-400":""}`,style:{backgroundColor:$e||De?se:"#f3f4f6"}})]},`${re.id}-${be}`)),q++}}),F.stitchGroups.forEach(re=>{for(let se=0;se<re.repeatCount;se++)re.stitches.forEach(ce=>{var $e;const be=Mt(ce.yarnId);for(let De=0;De<ce.count;De++){const je=q<T,yn=q===T;$.push(h.jsxs("div",{className:"flex flex-col items-center justify-center w-16 h-16 transition-all duration-300",children:[h.jsx("div",{className:`text-2xl font-bold transition-colors duration-300 ${je?"text-text-primary":yn?"text-primary":"text-text-tertiary/50"}`,children:(($e=Pt[ce.type])==null?void 0:$e.symbol)||"○"}),h.jsx("div",{className:`w-2.5 h-2.5 rounded-full transition-all duration-300 ${(je||yn)&&xt(be)?"border border-gray-400":""}`,style:{backgroundColor:je||yn?be:"#f3f4f6"}})]},`${re.id}-${se}-${ce.id}-${De}`)),q++}})}),h.jsx("div",{className:"grid grid-cols-6 sm:grid-cols-8 md:grid-cols-10 lg:grid-cols-12 gap-2",children:$})};return h.jsxs("div",{className:"min-h-screen bg-background-primary safe-top safe-bottom",children:[h.jsx("div",{className:"bg-background-secondary border-b border-border sticky top-0 z-10",children:h.jsx("div",{className:"w-full px-3 sm:px-4 lg:px-6 py-3 sm:py-4",children:h.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[h.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[h.jsx(St,{to:`/project/${t}`,className:"text-text-secondary hover:text-text-primary transition-colors text-sm sm:text-base",children:"← 返回"}),h.jsx("h1",{className:"text-base sm:text-xl font-semibold text-text-primary truncate",children:n.name})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[m?h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"text-sm text-text-secondary hidden sm:block",children:VC(N)}),h.jsx("button",{onClick:E,className:"btn btn-secondary text-sm",children:"結束"})]}):h.jsxs("button",{onClick:I,className:"btn btn-primary text-sm",children:[h.jsx("span",{className:"hidden sm:inline",children:"開始計時"}),h.jsx("span",{className:"sm:hidden",children:"計時"})]}),h.jsx(Ki,{})]})]})})}),h.jsxs("div",{className:"w-full px-3 sm:px-4 lg:px-6 py-4 sm:py-6 space-y-4 sm:space-y-6",children:[h.jsxs("div",{className:"card",children:[h.jsxs("div",{className:"flex items-center justify-between mb-3",children:[h.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:"總體進度"}),h.jsxs("span",{className:"text-sm text-text-secondary font-medium",children:[Math.round(z*100),"%"]})]}),h.jsx("div",{className:"w-full bg-background-tertiary rounded-full h-3 mb-4",children:h.jsx("div",{className:"bg-primary h-3 rounded-full transition-all duration-500",style:{width:`${z*100}%`}})}),h.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[h.jsxs("div",{children:[h.jsx("div",{className:"text-text-secondary",children:"圈數進度"}),h.jsxs("div",{className:"font-semibold text-text-primary",children:[Math.max(0,n.currentRound-1)," / ",Lc(n)," 圈"]})]}),h.jsxs("div",{children:[h.jsx("div",{className:"text-text-secondary",children:"針數進度"}),h.jsxs("div",{className:"font-semibold text-text-primary",children:[Tp(n)," / ",_a(n)," 針"]})]})]})]}),h.jsxs("div",{className:"card",children:[h.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-3",children:"快速跳轉"}),h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("label",{className:"text-sm text-text-secondary",children:"跳轉到第"}),h.jsx("select",{value:D,onChange:$=>C(parseInt($.target.value)),className:"input w-auto min-w-0 flex-shrink-0",children:Array.from({length:Lc(n)},($,q)=>q+1).map($=>h.jsx("option",{value:$,children:$},$))}),h.jsx("label",{className:"text-sm text-text-secondary",children:"圈"}),S&&h.jsx("span",{className:"text-sm",style:{color:"rgb(217, 115, 152)"},children:"查看模式"})]})]}),h.jsxs("div",{className:"card",children:[h.jsxs("div",{className:"mb-6",children:[h.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-3",children:"本圈織圖"}),h.jsx("div",{className:"mb-3",children:h.jsxs("span",{className:"text-base text-text-primary",children:["第 ",D," 圈",S&&h.jsx("span",{className:"text-sm ml-2",style:{color:"rgb(217, 115, 152)"},children:"（查看中）"})]})}),(F==null?void 0:F.notes)&&h.jsxs("div",{className:"text-text-primary mb-4",children:[h.jsx("span",{className:"text-text-secondary",children:"備註："}),F.notes]})]}),h.jsx("div",{className:"mb-6",children:W()}),S?h.jsxs("div",{className:"text-center py-4",children:[h.jsx("p",{className:"mb-4",style:{color:"rgb(217, 115, 152)"},children:"此為查看模式，無法編輯進度"}),h.jsx("button",{onClick:Ke,className:"btn btn-primary",children:"返回編織進度"})]}):n.isCompleted?h.jsxs("div",{className:"text-center py-8",children:[h.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:"編織完成！"}),h.jsxs("p",{className:"text-text-secondary mb-6",children:["恭喜您完成了「",n.name,"」的編織！"]}),h.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[h.jsx("button",{onClick:()=>{const $={...n,isCompleted:!1,currentRound:1,currentStitch:0,lastModified:new Date};f($)},className:"btn btn-secondary",children:"重新編織"}),h.jsx("button",{onClick:()=>{var $;($=navigator.share)==null||$.call(navigator,{title:`我完成了編織作品：${n.name}`,text:`使用編織計數器完成了「${n.name}」的編織！`}).catch(()=>{alert("編織完成！")})},className:"btn btn-primary",children:"分享成果"})]})]}):h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"flex items-center justify-between gap-4",children:[h.jsxs("button",{onClick:b,disabled:n.currentRound===1&&n.currentStitch===0,className:"btn btn-secondary disabled:opacity-50 disabled:cursor-not-allowed text-lg py-4 flex items-center justify-center gap-2 flex-1",children:[h.jsx("span",{children:"←"}),"上一針"]}),h.jsxs("div",{className:"flex items-baseline px-6",children:[h.jsx("span",{className:"text-4xl font-bold text-primary",children:T}),h.jsxs("span",{className:"text-xl text-text-secondary",children:["/",_]})]}),h.jsxs("button",{onClick:A,className:"btn btn-primary text-lg py-4 flex items-center justify-center gap-2 flex-1",children:["下一針",h.jsx("span",{children:"→"})]})]}),D===n.currentRound&&h.jsxs("button",{onClick:qe,className:"w-full bg-gray-500 hover:bg-gray-600 text-white font-medium py-3 px-4 rounded-lg transition-colors",children:["完成第 ",D," 圈"]})]})]})]})]})}const No=[{name:"白色",hex:"#FFFFFF"},{name:"黑色",hex:"#000000"},{name:"紅色",hex:"#FF0000"},{name:"藍色",hex:"#0066CC"},{name:"綠色",hex:"#00AA00"},{name:"黃色",hex:"#FFD700"},{name:"紫色",hex:"#8A2BE2"},{name:"橙色",hex:"#FF8C00"},{name:"粉紅色",hex:"#FF69B4"},{name:"棕色",hex:"#A0522D"},{name:"灰色",hex:"#808080"},{name:"米色",hex:"#F5F5DC"}];function o4(){const{projectId:t}=Oa(),e=Mi(),{currentProject:n,setCurrentProject:r,projects:s,addYarn:i,updateYarn:o,deleteYarn:l}=Bt(),[c,u]=L.useState(!1),[f,m]=L.useState(null),[g,w]=L.useState(""),[R,N]=L.useState(""),[P,x]=L.useState(No[0]),[v,S]=L.useState("");if(L.useEffect(()=>{t&&(s.find(A=>A.id===t)?r(t):e("/404"))},[t,r,s,e]),!n)return h.jsx("div",{className:"min-h-screen bg-background-primary flex items-center justify-center",children:h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),h.jsx("p",{className:"text-text-secondary",children:"載入中..."})]})});const D=()=>{m(null),w(No[0].name+"毛線"),N(""),x(No[0]),S(""),u(!0)},F=E=>{m(E),w(E.name),N(E.brand||""),x(E.color),S(E.color.hex),u(!0)},z=()=>{if(!g.trim())return;const E=v?{name:"自定義",hex:v}:P,A={id:(f==null?void 0:f.id)||Ze(),name:g.trim(),brand:R.trim()||void 0,color:E};f?o(A):i(A),u(!1),_()},T=E=>{confirm("確定要刪除這個毛線嗎？")&&l(E)},_=()=>{w(""),N(""),x(No[0]),S(""),m(null)},I=()=>{u(!1),_()};return h.jsxs("div",{className:"min-h-screen bg-background-primary safe-top safe-bottom",children:[h.jsx("div",{className:"bg-background-secondary border-b border-border",children:h.jsx("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-3 sm:py-4",children:h.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[h.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[h.jsx(St,{to:`/project/${t}`,className:"text-text-secondary hover:text-text-primary transition-colors text-sm sm:text-base",children:"← 返回"}),h.jsx("h1",{className:"text-base sm:text-xl font-semibold text-text-primary",children:"毛線管理"})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("button",{onClick:D,className:"btn btn-primary w-full sm:w-auto",children:"+ 新增毛線"}),h.jsx(Ki,{})]})]})})}),h.jsxs("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-4 sm:py-6 space-y-4 sm:space-y-6",children:[n.yarns.length===0?h.jsxs("div",{className:"text-center py-12",children:[h.jsx("div",{className:"text-6xl mb-4",children:"🧶"}),h.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-2",children:"還沒有毛線"}),h.jsx("p",{className:"text-text-secondary mb-4",children:"點擊上方「新增毛線」按鈕來添加第一個毛線"}),h.jsx("button",{onClick:D,className:"btn btn-primary",children:"新增毛線"})]}):h.jsx("div",{className:"grid gap-4",children:n.yarns.map(E=>h.jsx("div",{className:"card",children:h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"w-12 h-12 rounded-full border-2 border-border flex-shrink-0",style:{backgroundColor:E.color.hex}}),h.jsxs("div",{className:"flex-1",children:[h.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:E.name}),E.brand&&h.jsx("p",{className:"text-text-secondary",children:E.brand}),h.jsxs("p",{className:"text-sm text-text-tertiary",children:[E.color.name," (",E.color.hex,")"]})]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{onClick:()=>F(E),className:"btn btn-secondary text-sm",children:"編輯"}),h.jsx("button",{onClick:()=>T(E.id),className:"btn bg-red-500 hover:bg-red-600 text-white text-sm",children:"刪除"})]})]})},E.id))}),c&&h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:h.jsx("div",{className:"bg-background-primary rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:h.jsxs("div",{className:"p-6",children:[h.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-4",children:f?"編輯毛線":"新增毛線"}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"毛線名稱 *"}),h.jsx("input",{type:"text",value:g,onChange:E=>w(E.target.value),className:"w-full p-3 border border-border rounded-lg bg-background-secondary text-text-primary",placeholder:"例如：4號線"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"品牌（選填）"}),h.jsx("input",{type:"text",value:R,onChange:E=>N(E.target.value),className:"w-full p-3 border border-border rounded-lg bg-background-secondary text-text-primary",placeholder:"例如：台灣製"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"顏色"}),h.jsx("div",{className:"grid grid-cols-6 gap-2 mb-3",children:No.map(E=>h.jsx("button",{onClick:()=>{x(E),S(""),!f&&(g===""||g.endsWith("毛線"))&&w(E.name+"毛線")},className:`w-10 h-10 rounded-full border-2 ${P.hex===E.hex&&!v?"border-primary ring-2 ring-primary/20":"border-border"}`,style:{backgroundColor:E.hex},title:E.name},E.hex))}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs text-text-secondary mb-1",children:"或輸入自定義顏色"}),h.jsx("input",{type:"color",value:v||P.hex,onChange:E=>{S(E.target.value),!f&&(g===""||g.endsWith("毛線"))&&w("自定義毛線")},className:"w-full h-10 border border-border rounded cursor-pointer"})]})]}),h.jsxs("div",{className:"border border-border rounded-lg p-3",children:[h.jsx("p",{className:"text-sm text-text-secondary mb-2",children:"預覽"}),h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"w-8 h-8 rounded-full border border-border",style:{backgroundColor:v||P.hex}}),h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-text-primary",children:g||"毛線名稱"}),R&&h.jsx("p",{className:"text-sm text-text-secondary",children:R})]})]})]})]}),h.jsxs("div",{className:"flex gap-3 mt-6",children:[h.jsx("button",{onClick:I,className:"flex-1 btn btn-secondary",children:"取消"}),h.jsx("button",{onClick:z,disabled:!g.trim(),className:"flex-1 btn btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:f?"更新":"新增"})]})]})})})]})]})}function a4(){const{projectId:t}=Oa();return h.jsxs("div",{className:"min-h-screen bg-background-primary safe-top safe-bottom",children:[h.jsx("div",{className:"bg-background-secondary border-b border-border",children:h.jsx("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-3 sm:py-4",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-3 sm:gap-4",children:[h.jsx(St,{to:`/project/${t}`,className:"text-text-secondary hover:text-text-primary transition-colors text-sm sm:text-base",children:"← 返回"}),h.jsx("h1",{className:"text-lg sm:text-xl font-semibold text-text-primary",children:"匯入匯出"})]}),h.jsx(Ki,{})]})})}),h.jsx("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-4 sm:py-6",children:h.jsxs("div",{className:"text-center py-12",children:[h.jsx("div",{className:"text-6xl mb-4",children:"🚧"}),h.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-2",children:"匯入匯出"}),h.jsx("p",{className:"text-text-secondary",children:"此功能正在開發中..."})]})})]})}function l4(){return h.jsx("div",{className:"min-h-screen bg-background-primary flex items-center justify-center px-4",children:h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-6xl mb-6",children:"🧶"}),h.jsx("h1",{className:"text-4xl font-bold text-text-primary mb-4",children:"404"}),h.jsx("h2",{className:"text-xl font-semibold text-text-secondary mb-6",children:"找不到頁面"}),h.jsx("p",{className:"text-text-tertiary mb-8",children:"您要查找的頁面不存在或已被移動"}),h.jsx(St,{to:"/",className:"btn btn-primary",children:"回到首頁"})]})})}function c4(){const{signInWithGoogle:t,isLoading:e,error:n}=ot();return h.jsx("div",{className:"min-h-screen bg-background-primary flex items-center justify-center px-4",children:h.jsxs("div",{className:"card max-w-sm sm:max-w-md w-full",children:[h.jsxs("div",{className:"text-center mb-6",children:[h.jsx("div",{className:"text-3xl sm:text-4xl mb-3",children:"🧶"}),h.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-text-primary mb-2",children:"編織計數器"}),h.jsx("p",{className:"text-sm sm:text-base text-text-secondary",children:"使用 Google 帳戶登入以同步您的編織專案"})]}),n&&h.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:n}),h.jsx("button",{onClick:t,disabled:e,className:"w-full flex items-center justify-center gap-3 px-4 py-3 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:e?h.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-gray-600"}):h.jsxs(h.Fragment,{children:[h.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[h.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),h.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),h.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),h.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"使用 Google 登入"]})}),h.jsx("div",{className:"mt-4 text-center",children:h.jsx("p",{className:"text-xs text-text-tertiary",children:"登入即表示您同意我們的服務條款和隱私政策"})})]})})}function u4(){const{setError:t,error:e,isSyncing:n,isLoading:r}=Bt(),{user:s,isLoading:i,initialize:o}=ot();return L.useEffect(()=>{const l=o(),c=uc.setupAuthStateListener();return console.log("[NETWORK] Initializing network status monitoring"),s&&(Gb(),Hb()),()=>{l(),c&&c()}},[o]),L.useEffect(()=>{s?(console.log(`使用者已登入 (${s.uid})，開始同步...`),uc.handleUserLogin(s).catch(l=>{console.error("處理用戶登入錯誤:",l),t("登入處理失敗")})):(console.log("使用者已登出，清空數據..."),uc.handleUserLogout())},[s,t]),i||r?h.jsx("div",{className:"min-h-screen bg-background-primary flex items-center justify-center",children:h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),h.jsx("p",{className:"text-text-secondary",children:i?"驗證中...":"載入數據中..."}),n&&h.jsx("p",{className:"text-text-secondary text-sm mt-2",children:"正在同步跨裝置數據..."})]})}):s?h.jsxs("div",{className:"min-h-screen bg-background-primary",children:[e&&h.jsx("div",{className:"fixed top-4 left-4 right-4 z-50 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("span",{children:e}),h.jsx("button",{onClick:()=>t(null),className:"text-red-500 hover:text-red-700 ml-4",children:"✕"})]})}),h.jsxs(QI,{children:[h.jsx(Vn,{path:"/",element:h.jsx(qb,{})}),h.jsx(Vn,{path:"/project/:projectId",element:h.jsx(r4,{})}),h.jsx(Vn,{path:"/project/:projectId/pattern",element:h.jsx(s4,{})}),h.jsx(Vn,{path:"/project/:projectId/progress",element:h.jsx(i4,{})}),h.jsx(Vn,{path:"/project/:projectId/yarns",element:h.jsx(o4,{})}),h.jsx(Vn,{path:"/project/:projectId/import-export",element:h.jsx(a4,{})}),h.jsx(Vn,{path:"/404",element:h.jsx(l4,{})}),h.jsx(Vn,{path:"*",element:h.jsx(qI,{to:"/404",replace:!0})})]})]}):h.jsx(c4,{})}Yd.createRoot(document.getElementById("root")).render(h.jsx(xn.StrictMode,{children:h.jsx(nC,{children:h.jsx(u4,{})})}));
