var cx=Object.defineProperty;var hx=(t,e,n)=>e in t?cx(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Qm=(t,e,n)=>(hx(t,typeof e!="symbol"?e+"":e,n),n);function dx(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function Hv(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Gv={exports:{}},Bu={},Wv={exports:{}},re={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ma=Symbol.for("react.element"),fx=Symbol.for("react.portal"),px=Symbol.for("react.fragment"),mx=Symbol.for("react.strict_mode"),gx=Symbol.for("react.profiler"),yx=Symbol.for("react.provider"),vx=Symbol.for("react.context"),_x=Symbol.for("react.forward_ref"),wx=Symbol.for("react.suspense"),Ex=Symbol.for("react.memo"),xx=Symbol.for("react.lazy"),Ym=Symbol.iterator;function Tx(t){return t===null||typeof t!="object"?null:(t=Ym&&t[Ym]||t["@@iterator"],typeof t=="function"?t:null)}var qv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Kv=Object.assign,Qv={};function Ii(t,e,n){this.props=t,this.context=e,this.refs=Qv,this.updater=n||qv}Ii.prototype.isReactComponent={};Ii.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ii.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Yv(){}Yv.prototype=Ii.prototype;function nf(t,e,n){this.props=t,this.context=e,this.refs=Qv,this.updater=n||qv}var rf=nf.prototype=new Yv;rf.constructor=nf;Kv(rf,Ii.prototype);rf.isPureReactComponent=!0;var Jm=Array.isArray,Jv=Object.prototype.hasOwnProperty,sf={current:null},Xv={key:!0,ref:!0,__self:!0,__source:!0};function Zv(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)Jv.call(e,r)&&!Xv.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];s.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:ma,type:t,key:i,ref:o,props:s,_owner:sf.current}}function Ix(t,e){return{$$typeof:ma,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function of(t){return typeof t=="object"&&t!==null&&t.$$typeof===ma}function Sx(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Xm=/\/+/g;function Bc(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Sx(""+t.key):e.toString(36)}function Sl(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case ma:case fx:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+Bc(o,0):r,Jm(s)?(n="",t!=null&&(n=t.replace(Xm,"$&/")+"/"),Sl(s,e,n,"",function(c){return c})):s!=null&&(of(s)&&(s=Ix(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Xm,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",Jm(t))for(var l=0;l<t.length;l++){i=t[l];var u=r+Bc(i,l);o+=Sl(i,e,n,u,s)}else if(u=Tx(t),typeof u=="function")for(t=u.call(t),l=0;!(i=t.next()).done;)i=i.value,u=r+Bc(i,l++),o+=Sl(i,e,n,u,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function el(t,e,n){if(t==null)return t;var r=[],s=0;return Sl(t,r,"","",function(i){return e.call(n,i,s++)}),r}function Rx(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var St={current:null},Rl={transition:null},Ax={ReactCurrentDispatcher:St,ReactCurrentBatchConfig:Rl,ReactCurrentOwner:sf};function e_(){throw Error("act(...) is not supported in production builds of React.")}re.Children={map:el,forEach:function(t,e,n){el(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return el(t,function(){e++}),e},toArray:function(t){return el(t,function(e){return e})||[]},only:function(t){if(!of(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};re.Component=Ii;re.Fragment=px;re.Profiler=gx;re.PureComponent=nf;re.StrictMode=mx;re.Suspense=wx;re.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ax;re.act=e_;re.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Kv({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=sf.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)Jv.call(e,u)&&!Xv.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&l!==void 0?l[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var c=0;c<u;c++)l[c]=arguments[c+2];r.children=l}return{$$typeof:ma,type:t.type,key:s,ref:i,props:r,_owner:o}};re.createContext=function(t){return t={$$typeof:vx,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:yx,_context:t},t.Consumer=t};re.createElement=Zv;re.createFactory=function(t){var e=Zv.bind(null,t);return e.type=t,e};re.createRef=function(){return{current:null}};re.forwardRef=function(t){return{$$typeof:_x,render:t}};re.isValidElement=of;re.lazy=function(t){return{$$typeof:xx,_payload:{_status:-1,_result:t},_init:Rx}};re.memo=function(t,e){return{$$typeof:Ex,type:t,compare:e===void 0?null:e}};re.startTransition=function(t){var e=Rl.transition;Rl.transition={};try{t()}finally{Rl.transition=e}};re.unstable_act=e_;re.useCallback=function(t,e){return St.current.useCallback(t,e)};re.useContext=function(t){return St.current.useContext(t)};re.useDebugValue=function(){};re.useDeferredValue=function(t){return St.current.useDeferredValue(t)};re.useEffect=function(t,e){return St.current.useEffect(t,e)};re.useId=function(){return St.current.useId()};re.useImperativeHandle=function(t,e,n){return St.current.useImperativeHandle(t,e,n)};re.useInsertionEffect=function(t,e){return St.current.useInsertionEffect(t,e)};re.useLayoutEffect=function(t,e){return St.current.useLayoutEffect(t,e)};re.useMemo=function(t,e){return St.current.useMemo(t,e)};re.useReducer=function(t,e,n){return St.current.useReducer(t,e,n)};re.useRef=function(t){return St.current.useRef(t)};re.useState=function(t){return St.current.useState(t)};re.useSyncExternalStore=function(t,e,n){return St.current.useSyncExternalStore(t,e,n)};re.useTransition=function(){return St.current.useTransition()};re.version="18.3.1";Wv.exports=re;var M=Wv.exports;const af=Hv(M),Cx=dx({__proto__:null,default:af},[M]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Px=M,Nx=Symbol.for("react.element"),kx=Symbol.for("react.fragment"),bx=Object.prototype.hasOwnProperty,Dx=Px.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,jx={key:!0,ref:!0,__self:!0,__source:!0};function t_(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)bx.call(e,r)&&!jx.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:Nx,type:t,key:i,ref:o,props:s,_owner:Dx.current}}Bu.Fragment=kx;Bu.jsx=t_;Bu.jsxs=t_;Gv.exports=Bu;var f=Gv.exports,bh={},n_={exports:{}},$t={},r_={exports:{}},s_={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(H,$){var q=H.length;H.push($);e:for(;0<q;){var ne=q-1>>>1,te=H[ne];if(0<s(te,$))H[ne]=$,H[q]=te,q=ne;else break e}}function n(H){return H.length===0?null:H[0]}function r(H){if(H.length===0)return null;var $=H[0],q=H.pop();if(q!==$){H[0]=q;e:for(var ne=0,te=H.length,se=te>>>1;ne<se;){var De=2*(ne+1)-1,Be=H[De],je=De+1,Xe=H[je];if(0>s(Be,q))je<te&&0>s(Xe,Be)?(H[ne]=Xe,H[je]=q,ne=je):(H[ne]=Be,H[De]=q,ne=De);else if(je<te&&0>s(Xe,q))H[ne]=Xe,H[je]=q,ne=je;else break e}}return $}function s(H,$){var q=H.sortIndex-$.sortIndex;return q!==0?q:H.id-$.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var u=[],c=[],d=1,m=null,g=3,E=!1,A=!1,C=!1,N=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(H){for(var $=n(c);$!==null;){if($.callback===null)r(c);else if($.startTime<=H)r(c),$.sortIndex=$.expirationTime,e(u,$);else break;$=n(c)}}function D(H){if(C=!1,T(H),!A)if(n(u)!==null)A=!0,jt(L);else{var $=n(c);$!==null&&Je(D,$.startTime-H)}}function L(H,$){A=!1,C&&(C=!1,x(_),_=-1),E=!0;var q=g;try{for(T($),m=n(u);m!==null&&(!(m.expirationTime>$)||H&&!P());){var ne=m.callback;if(typeof ne=="function"){m.callback=null,g=m.priorityLevel;var te=ne(m.expirationTime<=$);$=t.unstable_now(),typeof te=="function"?m.callback=te:m===n(u)&&r(u),T($)}else r(u);m=n(u)}if(m!==null)var se=!0;else{var De=n(c);De!==null&&Je(D,De.startTime-$),se=!1}return se}finally{m=null,g=q,E=!1}}var B=!1,I=null,_=-1,S=5,w=-1;function P(){return!(t.unstable_now()-w<S)}function b(){if(I!==null){var H=t.unstable_now();w=H;var $=!0;try{$=I(!0,H)}finally{$?R():(B=!1,I=null)}}else B=!1}var R;if(typeof v=="function")R=function(){v(b)};else if(typeof MessageChannel<"u"){var Ue=new MessageChannel,Gt=Ue.port2;Ue.port1.onmessage=b,R=function(){Gt.postMessage(null)}}else R=function(){N(b,0)};function jt(H){I=H,B||(B=!0,R())}function Je(H,$){_=N(function(){H(t.unstable_now())},$)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(H){H.callback=null},t.unstable_continueExecution=function(){A||E||(A=!0,jt(L))},t.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<H?Math.floor(1e3/H):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(H){switch(g){case 1:case 2:case 3:var $=3;break;default:$=g}var q=g;g=$;try{return H()}finally{g=q}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(H,$){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var q=g;g=H;try{return $()}finally{g=q}},t.unstable_scheduleCallback=function(H,$,q){var ne=t.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?ne+q:ne):q=ne,H){case 1:var te=-1;break;case 2:te=250;break;case 5:te=1073741823;break;case 4:te=1e4;break;default:te=5e3}return te=q+te,H={id:d++,callback:$,priorityLevel:H,startTime:q,expirationTime:te,sortIndex:-1},q>ne?(H.sortIndex=q,e(c,H),n(u)===null&&H===n(c)&&(C?(x(_),_=-1):C=!0,Je(D,q-ne))):(H.sortIndex=te,e(u,H),A||E||(A=!0,jt(L))),H},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(H){var $=g;return function(){var q=g;g=$;try{return H.apply(this,arguments)}finally{g=q}}}})(s_);r_.exports=s_;var Vx=r_.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ox=M,zt=Vx;function U(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i_=new Set,Fo={};function xs(t,e){li(t,e),li(t+"Capture",e)}function li(t,e){for(Fo[t]=e,t=0;t<e.length;t++)i_.add(e[t])}var Bn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Dh=Object.prototype.hasOwnProperty,Mx=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Zm={},eg={};function Lx(t){return Dh.call(eg,t)?!0:Dh.call(Zm,t)?!1:Mx.test(t)?eg[t]=!0:(Zm[t]=!0,!1)}function Fx(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Ux(t,e,n,r){if(e===null||typeof e>"u"||Fx(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Rt(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var ot={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ot[t]=new Rt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ot[e]=new Rt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ot[t]=new Rt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ot[t]=new Rt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ot[t]=new Rt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ot[t]=new Rt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ot[t]=new Rt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ot[t]=new Rt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ot[t]=new Rt(t,5,!1,t.toLowerCase(),null,!1,!1)});var lf=/[\-:]([a-z])/g;function uf(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(lf,uf);ot[e]=new Rt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(lf,uf);ot[e]=new Rt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(lf,uf);ot[e]=new Rt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ot[t]=new Rt(t,1,!1,t.toLowerCase(),null,!1,!1)});ot.xlinkHref=new Rt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ot[t]=new Rt(t,1,!1,t.toLowerCase(),null,!0,!0)});function cf(t,e,n,r){var s=ot.hasOwnProperty(e)?ot[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Ux(e,n,s,r)&&(n=null),r||s===null?Lx(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Yn=Ox.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,tl=Symbol.for("react.element"),Us=Symbol.for("react.portal"),Bs=Symbol.for("react.fragment"),hf=Symbol.for("react.strict_mode"),jh=Symbol.for("react.profiler"),o_=Symbol.for("react.provider"),a_=Symbol.for("react.context"),df=Symbol.for("react.forward_ref"),Vh=Symbol.for("react.suspense"),Oh=Symbol.for("react.suspense_list"),ff=Symbol.for("react.memo"),ir=Symbol.for("react.lazy"),l_=Symbol.for("react.offscreen"),tg=Symbol.iterator;function io(t){return t===null||typeof t!="object"?null:(t=tg&&t[tg]||t["@@iterator"],typeof t=="function"?t:null)}var Se=Object.assign,zc;function go(t){if(zc===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);zc=e&&e[1]||""}return`
`+zc+t}var $c=!1;function Hc(t,e){if(!t||$c)return"";$c=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var u=`
`+s[o].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=o&&0<=l);break}}}finally{$c=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?go(t):""}function Bx(t){switch(t.tag){case 5:return go(t.type);case 16:return go("Lazy");case 13:return go("Suspense");case 19:return go("SuspenseList");case 0:case 2:case 15:return t=Hc(t.type,!1),t;case 11:return t=Hc(t.type.render,!1),t;case 1:return t=Hc(t.type,!0),t;default:return""}}function Mh(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Bs:return"Fragment";case Us:return"Portal";case jh:return"Profiler";case hf:return"StrictMode";case Vh:return"Suspense";case Oh:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case a_:return(t.displayName||"Context")+".Consumer";case o_:return(t._context.displayName||"Context")+".Provider";case df:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case ff:return e=t.displayName||null,e!==null?e:Mh(t.type)||"Memo";case ir:e=t._payload,t=t._init;try{return Mh(t(e))}catch{}}return null}function zx(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Mh(e);case 8:return e===hf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Nr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function u_(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function $x(t){var e=u_(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function nl(t){t._valueTracker||(t._valueTracker=$x(t))}function c_(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=u_(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Kl(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Lh(t,e){var n=e.checked;return Se({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function ng(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Nr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function h_(t,e){e=e.checked,e!=null&&cf(t,"checked",e,!1)}function Fh(t,e){h_(t,e);var n=Nr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Uh(t,e.type,n):e.hasOwnProperty("defaultValue")&&Uh(t,e.type,Nr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function rg(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Uh(t,e,n){(e!=="number"||Kl(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var yo=Array.isArray;function Xs(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Nr(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Bh(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(U(91));return Se({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function sg(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(U(92));if(yo(n)){if(1<n.length)throw Error(U(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Nr(n)}}function d_(t,e){var n=Nr(e.value),r=Nr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function ig(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function f_(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function zh(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?f_(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var rl,p_=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(rl=rl||document.createElement("div"),rl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=rl.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Uo(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Io={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Hx=["Webkit","ms","Moz","O"];Object.keys(Io).forEach(function(t){Hx.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Io[e]=Io[t]})});function m_(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Io.hasOwnProperty(t)&&Io[t]?(""+e).trim():e+"px"}function g_(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=m_(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var Gx=Se({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function $h(t,e){if(e){if(Gx[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(U(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(U(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(U(61))}if(e.style!=null&&typeof e.style!="object")throw Error(U(62))}}function Hh(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Gh=null;function pf(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Wh=null,Zs=null,ei=null;function og(t){if(t=va(t)){if(typeof Wh!="function")throw Error(U(280));var e=t.stateNode;e&&(e=Wu(e),Wh(t.stateNode,t.type,e))}}function y_(t){Zs?ei?ei.push(t):ei=[t]:Zs=t}function v_(){if(Zs){var t=Zs,e=ei;if(ei=Zs=null,og(t),e)for(t=0;t<e.length;t++)og(e[t])}}function __(t,e){return t(e)}function w_(){}var Gc=!1;function E_(t,e,n){if(Gc)return t(e,n);Gc=!0;try{return __(t,e,n)}finally{Gc=!1,(Zs!==null||ei!==null)&&(w_(),v_())}}function Bo(t,e){var n=t.stateNode;if(n===null)return null;var r=Wu(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(U(231,e,typeof n));return n}var qh=!1;if(Bn)try{var oo={};Object.defineProperty(oo,"passive",{get:function(){qh=!0}}),window.addEventListener("test",oo,oo),window.removeEventListener("test",oo,oo)}catch{qh=!1}function Wx(t,e,n,r,s,i,o,l,u){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(d){this.onError(d)}}var So=!1,Ql=null,Yl=!1,Kh=null,qx={onError:function(t){So=!0,Ql=t}};function Kx(t,e,n,r,s,i,o,l,u){So=!1,Ql=null,Wx.apply(qx,arguments)}function Qx(t,e,n,r,s,i,o,l,u){if(Kx.apply(this,arguments),So){if(So){var c=Ql;So=!1,Ql=null}else throw Error(U(198));Yl||(Yl=!0,Kh=c)}}function Ts(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function x_(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function ag(t){if(Ts(t)!==t)throw Error(U(188))}function Yx(t){var e=t.alternate;if(!e){if(e=Ts(t),e===null)throw Error(U(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return ag(s),t;if(i===r)return ag(s),e;i=i.sibling}throw Error(U(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(U(189))}}if(n.alternate!==r)throw Error(U(190))}if(n.tag!==3)throw Error(U(188));return n.stateNode.current===n?t:e}function T_(t){return t=Yx(t),t!==null?I_(t):null}function I_(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=I_(t);if(e!==null)return e;t=t.sibling}return null}var S_=zt.unstable_scheduleCallback,lg=zt.unstable_cancelCallback,Jx=zt.unstable_shouldYield,Xx=zt.unstable_requestPaint,ke=zt.unstable_now,Zx=zt.unstable_getCurrentPriorityLevel,mf=zt.unstable_ImmediatePriority,R_=zt.unstable_UserBlockingPriority,Jl=zt.unstable_NormalPriority,eT=zt.unstable_LowPriority,A_=zt.unstable_IdlePriority,zu=null,yn=null;function tT(t){if(yn&&typeof yn.onCommitFiberRoot=="function")try{yn.onCommitFiberRoot(zu,t,void 0,(t.current.flags&128)===128)}catch{}}var an=Math.clz32?Math.clz32:sT,nT=Math.log,rT=Math.LN2;function sT(t){return t>>>=0,t===0?32:31-(nT(t)/rT|0)|0}var sl=64,il=4194304;function vo(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Xl(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=vo(l):(i&=o,i!==0&&(r=vo(i)))}else o=n&~s,o!==0?r=vo(o):i!==0&&(r=vo(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-an(e),s=1<<n,r|=t[n],e&=~s;return r}function iT(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function oT(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-an(i),l=1<<o,u=s[o];u===-1?(!(l&n)||l&r)&&(s[o]=iT(l,e)):u<=e&&(t.expiredLanes|=l),i&=~l}}function Qh(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function C_(){var t=sl;return sl<<=1,!(sl&4194240)&&(sl=64),t}function Wc(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ga(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-an(e),t[e]=n}function aT(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-an(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function gf(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-an(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var me=0;function P_(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var N_,yf,k_,b_,D_,Yh=!1,ol=[],gr=null,yr=null,vr=null,zo=new Map,$o=new Map,ar=[],lT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ug(t,e){switch(t){case"focusin":case"focusout":gr=null;break;case"dragenter":case"dragleave":yr=null;break;case"mouseover":case"mouseout":vr=null;break;case"pointerover":case"pointerout":zo.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":$o.delete(e.pointerId)}}function ao(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=va(e),e!==null&&yf(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function uT(t,e,n,r,s){switch(e){case"focusin":return gr=ao(gr,t,e,n,r,s),!0;case"dragenter":return yr=ao(yr,t,e,n,r,s),!0;case"mouseover":return vr=ao(vr,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return zo.set(i,ao(zo.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,$o.set(i,ao($o.get(i)||null,t,e,n,r,s)),!0}return!1}function j_(t){var e=ts(t.target);if(e!==null){var n=Ts(e);if(n!==null){if(e=n.tag,e===13){if(e=x_(n),e!==null){t.blockedOn=e,D_(t.priority,function(){k_(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Al(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Jh(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Gh=r,n.target.dispatchEvent(r),Gh=null}else return e=va(n),e!==null&&yf(e),t.blockedOn=n,!1;e.shift()}return!0}function cg(t,e,n){Al(t)&&n.delete(e)}function cT(){Yh=!1,gr!==null&&Al(gr)&&(gr=null),yr!==null&&Al(yr)&&(yr=null),vr!==null&&Al(vr)&&(vr=null),zo.forEach(cg),$o.forEach(cg)}function lo(t,e){t.blockedOn===e&&(t.blockedOn=null,Yh||(Yh=!0,zt.unstable_scheduleCallback(zt.unstable_NormalPriority,cT)))}function Ho(t){function e(s){return lo(s,t)}if(0<ol.length){lo(ol[0],t);for(var n=1;n<ol.length;n++){var r=ol[n];r.blockedOn===t&&(r.blockedOn=null)}}for(gr!==null&&lo(gr,t),yr!==null&&lo(yr,t),vr!==null&&lo(vr,t),zo.forEach(e),$o.forEach(e),n=0;n<ar.length;n++)r=ar[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<ar.length&&(n=ar[0],n.blockedOn===null);)j_(n),n.blockedOn===null&&ar.shift()}var ti=Yn.ReactCurrentBatchConfig,Zl=!0;function hT(t,e,n,r){var s=me,i=ti.transition;ti.transition=null;try{me=1,vf(t,e,n,r)}finally{me=s,ti.transition=i}}function dT(t,e,n,r){var s=me,i=ti.transition;ti.transition=null;try{me=4,vf(t,e,n,r)}finally{me=s,ti.transition=i}}function vf(t,e,n,r){if(Zl){var s=Jh(t,e,n,r);if(s===null)nh(t,e,r,eu,n),ug(t,r);else if(uT(s,t,e,n,r))r.stopPropagation();else if(ug(t,r),e&4&&-1<lT.indexOf(t)){for(;s!==null;){var i=va(s);if(i!==null&&N_(i),i=Jh(t,e,n,r),i===null&&nh(t,e,r,eu,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else nh(t,e,r,null,n)}}var eu=null;function Jh(t,e,n,r){if(eu=null,t=pf(r),t=ts(t),t!==null)if(e=Ts(t),e===null)t=null;else if(n=e.tag,n===13){if(t=x_(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return eu=t,null}function V_(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Zx()){case mf:return 1;case R_:return 4;case Jl:case eT:return 16;case A_:return 536870912;default:return 16}default:return 16}}var dr=null,_f=null,Cl=null;function O_(){if(Cl)return Cl;var t,e=_f,n=e.length,r,s="value"in dr?dr.value:dr.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Cl=s.slice(t,1<r?1-r:void 0)}function Pl(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function al(){return!0}function hg(){return!1}function Ht(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?al:hg,this.isPropagationStopped=hg,this}return Se(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=al)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=al)},persist:function(){},isPersistent:al}),e}var Si={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},wf=Ht(Si),ya=Se({},Si,{view:0,detail:0}),fT=Ht(ya),qc,Kc,uo,$u=Se({},ya,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ef,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==uo&&(uo&&t.type==="mousemove"?(qc=t.screenX-uo.screenX,Kc=t.screenY-uo.screenY):Kc=qc=0,uo=t),qc)},movementY:function(t){return"movementY"in t?t.movementY:Kc}}),dg=Ht($u),pT=Se({},$u,{dataTransfer:0}),mT=Ht(pT),gT=Se({},ya,{relatedTarget:0}),Qc=Ht(gT),yT=Se({},Si,{animationName:0,elapsedTime:0,pseudoElement:0}),vT=Ht(yT),_T=Se({},Si,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),wT=Ht(_T),ET=Se({},Si,{data:0}),fg=Ht(ET),xT={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},TT={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},IT={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ST(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=IT[t])?!!e[t]:!1}function Ef(){return ST}var RT=Se({},ya,{key:function(t){if(t.key){var e=xT[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Pl(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?TT[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ef,charCode:function(t){return t.type==="keypress"?Pl(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Pl(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),AT=Ht(RT),CT=Se({},$u,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),pg=Ht(CT),PT=Se({},ya,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ef}),NT=Ht(PT),kT=Se({},Si,{propertyName:0,elapsedTime:0,pseudoElement:0}),bT=Ht(kT),DT=Se({},$u,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),jT=Ht(DT),VT=[9,13,27,32],xf=Bn&&"CompositionEvent"in window,Ro=null;Bn&&"documentMode"in document&&(Ro=document.documentMode);var OT=Bn&&"TextEvent"in window&&!Ro,M_=Bn&&(!xf||Ro&&8<Ro&&11>=Ro),mg=String.fromCharCode(32),gg=!1;function L_(t,e){switch(t){case"keyup":return VT.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function F_(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var zs=!1;function MT(t,e){switch(t){case"compositionend":return F_(e);case"keypress":return e.which!==32?null:(gg=!0,mg);case"textInput":return t=e.data,t===mg&&gg?null:t;default:return null}}function LT(t,e){if(zs)return t==="compositionend"||!xf&&L_(t,e)?(t=O_(),Cl=_f=dr=null,zs=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return M_&&e.locale!=="ko"?null:e.data;default:return null}}var FT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function yg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!FT[t.type]:e==="textarea"}function U_(t,e,n,r){y_(r),e=tu(e,"onChange"),0<e.length&&(n=new wf("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Ao=null,Go=null;function UT(t){J_(t,0)}function Hu(t){var e=Gs(t);if(c_(e))return t}function BT(t,e){if(t==="change")return e}var B_=!1;if(Bn){var Yc;if(Bn){var Jc="oninput"in document;if(!Jc){var vg=document.createElement("div");vg.setAttribute("oninput","return;"),Jc=typeof vg.oninput=="function"}Yc=Jc}else Yc=!1;B_=Yc&&(!document.documentMode||9<document.documentMode)}function _g(){Ao&&(Ao.detachEvent("onpropertychange",z_),Go=Ao=null)}function z_(t){if(t.propertyName==="value"&&Hu(Go)){var e=[];U_(e,Go,t,pf(t)),E_(UT,e)}}function zT(t,e,n){t==="focusin"?(_g(),Ao=e,Go=n,Ao.attachEvent("onpropertychange",z_)):t==="focusout"&&_g()}function $T(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Hu(Go)}function HT(t,e){if(t==="click")return Hu(e)}function GT(t,e){if(t==="input"||t==="change")return Hu(e)}function WT(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var hn=typeof Object.is=="function"?Object.is:WT;function Wo(t,e){if(hn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Dh.call(e,s)||!hn(t[s],e[s]))return!1}return!0}function wg(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Eg(t,e){var n=wg(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=wg(n)}}function $_(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?$_(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function H_(){for(var t=window,e=Kl();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Kl(t.document)}return e}function Tf(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function qT(t){var e=H_(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&$_(n.ownerDocument.documentElement,n)){if(r!==null&&Tf(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=Eg(n,i);var o=Eg(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var KT=Bn&&"documentMode"in document&&11>=document.documentMode,$s=null,Xh=null,Co=null,Zh=!1;function xg(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Zh||$s==null||$s!==Kl(r)||(r=$s,"selectionStart"in r&&Tf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Co&&Wo(Co,r)||(Co=r,r=tu(Xh,"onSelect"),0<r.length&&(e=new wf("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=$s)))}function ll(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Hs={animationend:ll("Animation","AnimationEnd"),animationiteration:ll("Animation","AnimationIteration"),animationstart:ll("Animation","AnimationStart"),transitionend:ll("Transition","TransitionEnd")},Xc={},G_={};Bn&&(G_=document.createElement("div").style,"AnimationEvent"in window||(delete Hs.animationend.animation,delete Hs.animationiteration.animation,delete Hs.animationstart.animation),"TransitionEvent"in window||delete Hs.transitionend.transition);function Gu(t){if(Xc[t])return Xc[t];if(!Hs[t])return t;var e=Hs[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in G_)return Xc[t]=e[n];return t}var W_=Gu("animationend"),q_=Gu("animationiteration"),K_=Gu("animationstart"),Q_=Gu("transitionend"),Y_=new Map,Tg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Lr(t,e){Y_.set(t,e),xs(e,[t])}for(var Zc=0;Zc<Tg.length;Zc++){var eh=Tg[Zc],QT=eh.toLowerCase(),YT=eh[0].toUpperCase()+eh.slice(1);Lr(QT,"on"+YT)}Lr(W_,"onAnimationEnd");Lr(q_,"onAnimationIteration");Lr(K_,"onAnimationStart");Lr("dblclick","onDoubleClick");Lr("focusin","onFocus");Lr("focusout","onBlur");Lr(Q_,"onTransitionEnd");li("onMouseEnter",["mouseout","mouseover"]);li("onMouseLeave",["mouseout","mouseover"]);li("onPointerEnter",["pointerout","pointerover"]);li("onPointerLeave",["pointerout","pointerover"]);xs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));xs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));xs("onBeforeInput",["compositionend","keypress","textInput","paste"]);xs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));xs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));xs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var _o="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),JT=new Set("cancel close invalid load scroll toggle".split(" ").concat(_o));function Ig(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Qx(r,e,void 0,t),t.currentTarget=null}function J_(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],u=l.instance,c=l.currentTarget;if(l=l.listener,u!==i&&s.isPropagationStopped())break e;Ig(s,l,c),i=u}else for(o=0;o<r.length;o++){if(l=r[o],u=l.instance,c=l.currentTarget,l=l.listener,u!==i&&s.isPropagationStopped())break e;Ig(s,l,c),i=u}}}if(Yl)throw t=Kh,Yl=!1,Kh=null,t}function we(t,e){var n=e[sd];n===void 0&&(n=e[sd]=new Set);var r=t+"__bubble";n.has(r)||(X_(e,t,2,!1),n.add(r))}function th(t,e,n){var r=0;e&&(r|=4),X_(n,t,r,e)}var ul="_reactListening"+Math.random().toString(36).slice(2);function qo(t){if(!t[ul]){t[ul]=!0,i_.forEach(function(n){n!=="selectionchange"&&(JT.has(n)||th(n,!1,t),th(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ul]||(e[ul]=!0,th("selectionchange",!1,e))}}function X_(t,e,n,r){switch(V_(e)){case 1:var s=hT;break;case 4:s=dT;break;default:s=vf}n=s.bind(null,e,n,t),s=void 0,!qh||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function nh(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;o=o.return}for(;l!==null;){if(o=ts(l),o===null)return;if(u=o.tag,u===5||u===6){r=i=o;continue e}l=l.parentNode}}r=r.return}E_(function(){var c=i,d=pf(n),m=[];e:{var g=Y_.get(t);if(g!==void 0){var E=wf,A=t;switch(t){case"keypress":if(Pl(n)===0)break e;case"keydown":case"keyup":E=AT;break;case"focusin":A="focus",E=Qc;break;case"focusout":A="blur",E=Qc;break;case"beforeblur":case"afterblur":E=Qc;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":E=dg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":E=mT;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":E=NT;break;case W_:case q_:case K_:E=vT;break;case Q_:E=bT;break;case"scroll":E=fT;break;case"wheel":E=jT;break;case"copy":case"cut":case"paste":E=wT;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":E=pg}var C=(e&4)!==0,N=!C&&t==="scroll",x=C?g!==null?g+"Capture":null:g;C=[];for(var v=c,T;v!==null;){T=v;var D=T.stateNode;if(T.tag===5&&D!==null&&(T=D,x!==null&&(D=Bo(v,x),D!=null&&C.push(Ko(v,D,T)))),N)break;v=v.return}0<C.length&&(g=new E(g,A,null,n,d),m.push({event:g,listeners:C}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",E=t==="mouseout"||t==="pointerout",g&&n!==Gh&&(A=n.relatedTarget||n.fromElement)&&(ts(A)||A[zn]))break e;if((E||g)&&(g=d.window===d?d:(g=d.ownerDocument)?g.defaultView||g.parentWindow:window,E?(A=n.relatedTarget||n.toElement,E=c,A=A?ts(A):null,A!==null&&(N=Ts(A),A!==N||A.tag!==5&&A.tag!==6)&&(A=null)):(E=null,A=c),E!==A)){if(C=dg,D="onMouseLeave",x="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(C=pg,D="onPointerLeave",x="onPointerEnter",v="pointer"),N=E==null?g:Gs(E),T=A==null?g:Gs(A),g=new C(D,v+"leave",E,n,d),g.target=N,g.relatedTarget=T,D=null,ts(d)===c&&(C=new C(x,v+"enter",A,n,d),C.target=T,C.relatedTarget=N,D=C),N=D,E&&A)t:{for(C=E,x=A,v=0,T=C;T;T=js(T))v++;for(T=0,D=x;D;D=js(D))T++;for(;0<v-T;)C=js(C),v--;for(;0<T-v;)x=js(x),T--;for(;v--;){if(C===x||x!==null&&C===x.alternate)break t;C=js(C),x=js(x)}C=null}else C=null;E!==null&&Sg(m,g,E,C,!1),A!==null&&N!==null&&Sg(m,N,A,C,!0)}}e:{if(g=c?Gs(c):window,E=g.nodeName&&g.nodeName.toLowerCase(),E==="select"||E==="input"&&g.type==="file")var L=BT;else if(yg(g))if(B_)L=GT;else{L=$T;var B=zT}else(E=g.nodeName)&&E.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(L=HT);if(L&&(L=L(t,c))){U_(m,L,n,d);break e}B&&B(t,g,c),t==="focusout"&&(B=g._wrapperState)&&B.controlled&&g.type==="number"&&Uh(g,"number",g.value)}switch(B=c?Gs(c):window,t){case"focusin":(yg(B)||B.contentEditable==="true")&&($s=B,Xh=c,Co=null);break;case"focusout":Co=Xh=$s=null;break;case"mousedown":Zh=!0;break;case"contextmenu":case"mouseup":case"dragend":Zh=!1,xg(m,n,d);break;case"selectionchange":if(KT)break;case"keydown":case"keyup":xg(m,n,d)}var I;if(xf)e:{switch(t){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else zs?L_(t,n)&&(_="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(_="onCompositionStart");_&&(M_&&n.locale!=="ko"&&(zs||_!=="onCompositionStart"?_==="onCompositionEnd"&&zs&&(I=O_()):(dr=d,_f="value"in dr?dr.value:dr.textContent,zs=!0)),B=tu(c,_),0<B.length&&(_=new fg(_,t,null,n,d),m.push({event:_,listeners:B}),I?_.data=I:(I=F_(n),I!==null&&(_.data=I)))),(I=OT?MT(t,n):LT(t,n))&&(c=tu(c,"onBeforeInput"),0<c.length&&(d=new fg("onBeforeInput","beforeinput",null,n,d),m.push({event:d,listeners:c}),d.data=I))}J_(m,e)})}function Ko(t,e,n){return{instance:t,listener:e,currentTarget:n}}function tu(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Bo(t,n),i!=null&&r.unshift(Ko(t,i,s)),i=Bo(t,e),i!=null&&r.push(Ko(t,i,s))),t=t.return}return r}function js(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Sg(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var l=n,u=l.alternate,c=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&c!==null&&(l=c,s?(u=Bo(n,i),u!=null&&o.unshift(Ko(n,u,l))):s||(u=Bo(n,i),u!=null&&o.push(Ko(n,u,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var XT=/\r\n?/g,ZT=/\u0000|\uFFFD/g;function Rg(t){return(typeof t=="string"?t:""+t).replace(XT,`
`).replace(ZT,"")}function cl(t,e,n){if(e=Rg(e),Rg(t)!==e&&n)throw Error(U(425))}function nu(){}var ed=null,td=null;function nd(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var rd=typeof setTimeout=="function"?setTimeout:void 0,eI=typeof clearTimeout=="function"?clearTimeout:void 0,Ag=typeof Promise=="function"?Promise:void 0,tI=typeof queueMicrotask=="function"?queueMicrotask:typeof Ag<"u"?function(t){return Ag.resolve(null).then(t).catch(nI)}:rd;function nI(t){setTimeout(function(){throw t})}function rh(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Ho(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Ho(e)}function _r(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Cg(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Ri=Math.random().toString(36).slice(2),gn="__reactFiber$"+Ri,Qo="__reactProps$"+Ri,zn="__reactContainer$"+Ri,sd="__reactEvents$"+Ri,rI="__reactListeners$"+Ri,sI="__reactHandles$"+Ri;function ts(t){var e=t[gn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[zn]||n[gn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Cg(t);t!==null;){if(n=t[gn])return n;t=Cg(t)}return e}t=n,n=t.parentNode}return null}function va(t){return t=t[gn]||t[zn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Gs(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(U(33))}function Wu(t){return t[Qo]||null}var id=[],Ws=-1;function Fr(t){return{current:t}}function Ee(t){0>Ws||(t.current=id[Ws],id[Ws]=null,Ws--)}function ve(t,e){Ws++,id[Ws]=t.current,t.current=e}var kr={},yt=Fr(kr),kt=Fr(!1),ds=kr;function ui(t,e){var n=t.type.contextTypes;if(!n)return kr;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function bt(t){return t=t.childContextTypes,t!=null}function ru(){Ee(kt),Ee(yt)}function Pg(t,e,n){if(yt.current!==kr)throw Error(U(168));ve(yt,e),ve(kt,n)}function Z_(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(U(108,zx(t)||"Unknown",s));return Se({},n,r)}function su(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||kr,ds=yt.current,ve(yt,t),ve(kt,kt.current),!0}function Ng(t,e,n){var r=t.stateNode;if(!r)throw Error(U(169));n?(t=Z_(t,e,ds),r.__reactInternalMemoizedMergedChildContext=t,Ee(kt),Ee(yt),ve(yt,t)):Ee(kt),ve(kt,n)}var Dn=null,qu=!1,sh=!1;function e0(t){Dn===null?Dn=[t]:Dn.push(t)}function iI(t){qu=!0,e0(t)}function Ur(){if(!sh&&Dn!==null){sh=!0;var t=0,e=me;try{var n=Dn;for(me=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Dn=null,qu=!1}catch(s){throw Dn!==null&&(Dn=Dn.slice(t+1)),S_(mf,Ur),s}finally{me=e,sh=!1}}return null}var qs=[],Ks=0,iu=null,ou=0,Wt=[],qt=0,fs=null,Vn=1,On="";function Xr(t,e){qs[Ks++]=ou,qs[Ks++]=iu,iu=t,ou=e}function t0(t,e,n){Wt[qt++]=Vn,Wt[qt++]=On,Wt[qt++]=fs,fs=t;var r=Vn;t=On;var s=32-an(r)-1;r&=~(1<<s),n+=1;var i=32-an(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Vn=1<<32-an(e)+s|n<<s|r,On=i+t}else Vn=1<<i|n<<s|r,On=t}function If(t){t.return!==null&&(Xr(t,1),t0(t,1,0))}function Sf(t){for(;t===iu;)iu=qs[--Ks],qs[Ks]=null,ou=qs[--Ks],qs[Ks]=null;for(;t===fs;)fs=Wt[--qt],Wt[qt]=null,On=Wt[--qt],Wt[qt]=null,Vn=Wt[--qt],Wt[qt]=null}var Bt=null,Ft=null,xe=!1,rn=null;function n0(t,e){var n=Qt(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function kg(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Bt=t,Ft=_r(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Bt=t,Ft=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=fs!==null?{id:Vn,overflow:On}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Qt(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Bt=t,Ft=null,!0):!1;default:return!1}}function od(t){return(t.mode&1)!==0&&(t.flags&128)===0}function ad(t){if(xe){var e=Ft;if(e){var n=e;if(!kg(t,e)){if(od(t))throw Error(U(418));e=_r(n.nextSibling);var r=Bt;e&&kg(t,e)?n0(r,n):(t.flags=t.flags&-4097|2,xe=!1,Bt=t)}}else{if(od(t))throw Error(U(418));t.flags=t.flags&-4097|2,xe=!1,Bt=t}}}function bg(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Bt=t}function hl(t){if(t!==Bt)return!1;if(!xe)return bg(t),xe=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!nd(t.type,t.memoizedProps)),e&&(e=Ft)){if(od(t))throw r0(),Error(U(418));for(;e;)n0(t,e),e=_r(e.nextSibling)}if(bg(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(U(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Ft=_r(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Ft=null}}else Ft=Bt?_r(t.stateNode.nextSibling):null;return!0}function r0(){for(var t=Ft;t;)t=_r(t.nextSibling)}function ci(){Ft=Bt=null,xe=!1}function Rf(t){rn===null?rn=[t]:rn.push(t)}var oI=Yn.ReactCurrentBatchConfig;function co(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(U(309));var r=n.stateNode}if(!r)throw Error(U(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(U(284));if(!n._owner)throw Error(U(290,t))}return t}function dl(t,e){throw t=Object.prototype.toString.call(e),Error(U(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Dg(t){var e=t._init;return e(t._payload)}function s0(t){function e(x,v){if(t){var T=x.deletions;T===null?(x.deletions=[v],x.flags|=16):T.push(v)}}function n(x,v){if(!t)return null;for(;v!==null;)e(x,v),v=v.sibling;return null}function r(x,v){for(x=new Map;v!==null;)v.key!==null?x.set(v.key,v):x.set(v.index,v),v=v.sibling;return x}function s(x,v){return x=Tr(x,v),x.index=0,x.sibling=null,x}function i(x,v,T){return x.index=T,t?(T=x.alternate,T!==null?(T=T.index,T<v?(x.flags|=2,v):T):(x.flags|=2,v)):(x.flags|=1048576,v)}function o(x){return t&&x.alternate===null&&(x.flags|=2),x}function l(x,v,T,D){return v===null||v.tag!==6?(v=hh(T,x.mode,D),v.return=x,v):(v=s(v,T),v.return=x,v)}function u(x,v,T,D){var L=T.type;return L===Bs?d(x,v,T.props.children,D,T.key):v!==null&&(v.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===ir&&Dg(L)===v.type)?(D=s(v,T.props),D.ref=co(x,v,T),D.return=x,D):(D=Ol(T.type,T.key,T.props,null,x.mode,D),D.ref=co(x,v,T),D.return=x,D)}function c(x,v,T,D){return v===null||v.tag!==4||v.stateNode.containerInfo!==T.containerInfo||v.stateNode.implementation!==T.implementation?(v=dh(T,x.mode,D),v.return=x,v):(v=s(v,T.children||[]),v.return=x,v)}function d(x,v,T,D,L){return v===null||v.tag!==7?(v=ls(T,x.mode,D,L),v.return=x,v):(v=s(v,T),v.return=x,v)}function m(x,v,T){if(typeof v=="string"&&v!==""||typeof v=="number")return v=hh(""+v,x.mode,T),v.return=x,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case tl:return T=Ol(v.type,v.key,v.props,null,x.mode,T),T.ref=co(x,null,v),T.return=x,T;case Us:return v=dh(v,x.mode,T),v.return=x,v;case ir:var D=v._init;return m(x,D(v._payload),T)}if(yo(v)||io(v))return v=ls(v,x.mode,T,null),v.return=x,v;dl(x,v)}return null}function g(x,v,T,D){var L=v!==null?v.key:null;if(typeof T=="string"&&T!==""||typeof T=="number")return L!==null?null:l(x,v,""+T,D);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case tl:return T.key===L?u(x,v,T,D):null;case Us:return T.key===L?c(x,v,T,D):null;case ir:return L=T._init,g(x,v,L(T._payload),D)}if(yo(T)||io(T))return L!==null?null:d(x,v,T,D,null);dl(x,T)}return null}function E(x,v,T,D,L){if(typeof D=="string"&&D!==""||typeof D=="number")return x=x.get(T)||null,l(v,x,""+D,L);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case tl:return x=x.get(D.key===null?T:D.key)||null,u(v,x,D,L);case Us:return x=x.get(D.key===null?T:D.key)||null,c(v,x,D,L);case ir:var B=D._init;return E(x,v,T,B(D._payload),L)}if(yo(D)||io(D))return x=x.get(T)||null,d(v,x,D,L,null);dl(v,D)}return null}function A(x,v,T,D){for(var L=null,B=null,I=v,_=v=0,S=null;I!==null&&_<T.length;_++){I.index>_?(S=I,I=null):S=I.sibling;var w=g(x,I,T[_],D);if(w===null){I===null&&(I=S);break}t&&I&&w.alternate===null&&e(x,I),v=i(w,v,_),B===null?L=w:B.sibling=w,B=w,I=S}if(_===T.length)return n(x,I),xe&&Xr(x,_),L;if(I===null){for(;_<T.length;_++)I=m(x,T[_],D),I!==null&&(v=i(I,v,_),B===null?L=I:B.sibling=I,B=I);return xe&&Xr(x,_),L}for(I=r(x,I);_<T.length;_++)S=E(I,x,_,T[_],D),S!==null&&(t&&S.alternate!==null&&I.delete(S.key===null?_:S.key),v=i(S,v,_),B===null?L=S:B.sibling=S,B=S);return t&&I.forEach(function(P){return e(x,P)}),xe&&Xr(x,_),L}function C(x,v,T,D){var L=io(T);if(typeof L!="function")throw Error(U(150));if(T=L.call(T),T==null)throw Error(U(151));for(var B=L=null,I=v,_=v=0,S=null,w=T.next();I!==null&&!w.done;_++,w=T.next()){I.index>_?(S=I,I=null):S=I.sibling;var P=g(x,I,w.value,D);if(P===null){I===null&&(I=S);break}t&&I&&P.alternate===null&&e(x,I),v=i(P,v,_),B===null?L=P:B.sibling=P,B=P,I=S}if(w.done)return n(x,I),xe&&Xr(x,_),L;if(I===null){for(;!w.done;_++,w=T.next())w=m(x,w.value,D),w!==null&&(v=i(w,v,_),B===null?L=w:B.sibling=w,B=w);return xe&&Xr(x,_),L}for(I=r(x,I);!w.done;_++,w=T.next())w=E(I,x,_,w.value,D),w!==null&&(t&&w.alternate!==null&&I.delete(w.key===null?_:w.key),v=i(w,v,_),B===null?L=w:B.sibling=w,B=w);return t&&I.forEach(function(b){return e(x,b)}),xe&&Xr(x,_),L}function N(x,v,T,D){if(typeof T=="object"&&T!==null&&T.type===Bs&&T.key===null&&(T=T.props.children),typeof T=="object"&&T!==null){switch(T.$$typeof){case tl:e:{for(var L=T.key,B=v;B!==null;){if(B.key===L){if(L=T.type,L===Bs){if(B.tag===7){n(x,B.sibling),v=s(B,T.props.children),v.return=x,x=v;break e}}else if(B.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===ir&&Dg(L)===B.type){n(x,B.sibling),v=s(B,T.props),v.ref=co(x,B,T),v.return=x,x=v;break e}n(x,B);break}else e(x,B);B=B.sibling}T.type===Bs?(v=ls(T.props.children,x.mode,D,T.key),v.return=x,x=v):(D=Ol(T.type,T.key,T.props,null,x.mode,D),D.ref=co(x,v,T),D.return=x,x=D)}return o(x);case Us:e:{for(B=T.key;v!==null;){if(v.key===B)if(v.tag===4&&v.stateNode.containerInfo===T.containerInfo&&v.stateNode.implementation===T.implementation){n(x,v.sibling),v=s(v,T.children||[]),v.return=x,x=v;break e}else{n(x,v);break}else e(x,v);v=v.sibling}v=dh(T,x.mode,D),v.return=x,x=v}return o(x);case ir:return B=T._init,N(x,v,B(T._payload),D)}if(yo(T))return A(x,v,T,D);if(io(T))return C(x,v,T,D);dl(x,T)}return typeof T=="string"&&T!==""||typeof T=="number"?(T=""+T,v!==null&&v.tag===6?(n(x,v.sibling),v=s(v,T),v.return=x,x=v):(n(x,v),v=hh(T,x.mode,D),v.return=x,x=v),o(x)):n(x,v)}return N}var hi=s0(!0),i0=s0(!1),au=Fr(null),lu=null,Qs=null,Af=null;function Cf(){Af=Qs=lu=null}function Pf(t){var e=au.current;Ee(au),t._currentValue=e}function ld(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ni(t,e){lu=t,Af=Qs=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Nt=!0),t.firstContext=null)}function Jt(t){var e=t._currentValue;if(Af!==t)if(t={context:t,memoizedValue:e,next:null},Qs===null){if(lu===null)throw Error(U(308));Qs=t,lu.dependencies={lanes:0,firstContext:t}}else Qs=Qs.next=t;return e}var ns=null;function Nf(t){ns===null?ns=[t]:ns.push(t)}function o0(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Nf(e)):(n.next=s.next,s.next=n),e.interleaved=n,$n(t,r)}function $n(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var or=!1;function kf(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function a0(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Fn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function wr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,he&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,$n(t,n)}return s=r.interleaved,s===null?(e.next=e,Nf(r)):(e.next=s.next,s.next=e),r.interleaved=e,$n(t,n)}function Nl(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,gf(t,n)}}function jg(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function uu(t,e,n,r){var s=t.updateQueue;or=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var u=l,c=u.next;u.next=null,o===null?i=c:o.next=c,o=u;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=c:l.next=c,d.lastBaseUpdate=u))}if(i!==null){var m=s.baseState;o=0,d=c=u=null,l=i;do{var g=l.lane,E=l.eventTime;if((r&g)===g){d!==null&&(d=d.next={eventTime:E,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var A=t,C=l;switch(g=e,E=n,C.tag){case 1:if(A=C.payload,typeof A=="function"){m=A.call(E,m,g);break e}m=A;break e;case 3:A.flags=A.flags&-65537|128;case 0:if(A=C.payload,g=typeof A=="function"?A.call(E,m,g):A,g==null)break e;m=Se({},m,g);break e;case 2:or=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,g=s.effects,g===null?s.effects=[l]:g.push(l))}else E={eventTime:E,lane:g,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(c=d=E,u=m):d=d.next=E,o|=g;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;g=l,l=g.next,g.next=null,s.lastBaseUpdate=g,s.shared.pending=null}}while(1);if(d===null&&(u=m),s.baseState=u,s.firstBaseUpdate=c,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);ms|=o,t.lanes=o,t.memoizedState=m}}function Vg(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(U(191,s));s.call(r)}}}var _a={},vn=Fr(_a),Yo=Fr(_a),Jo=Fr(_a);function rs(t){if(t===_a)throw Error(U(174));return t}function bf(t,e){switch(ve(Jo,e),ve(Yo,t),ve(vn,_a),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:zh(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=zh(e,t)}Ee(vn),ve(vn,e)}function di(){Ee(vn),Ee(Yo),Ee(Jo)}function l0(t){rs(Jo.current);var e=rs(vn.current),n=zh(e,t.type);e!==n&&(ve(Yo,t),ve(vn,n))}function Df(t){Yo.current===t&&(Ee(vn),Ee(Yo))}var Te=Fr(0);function cu(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ih=[];function jf(){for(var t=0;t<ih.length;t++)ih[t]._workInProgressVersionPrimary=null;ih.length=0}var kl=Yn.ReactCurrentDispatcher,oh=Yn.ReactCurrentBatchConfig,ps=0,Ie=null,ze=null,qe=null,hu=!1,Po=!1,Xo=0,aI=0;function ct(){throw Error(U(321))}function Vf(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!hn(t[n],e[n]))return!1;return!0}function Of(t,e,n,r,s,i){if(ps=i,Ie=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,kl.current=t===null||t.memoizedState===null?hI:dI,t=n(r,s),Po){i=0;do{if(Po=!1,Xo=0,25<=i)throw Error(U(301));i+=1,qe=ze=null,e.updateQueue=null,kl.current=fI,t=n(r,s)}while(Po)}if(kl.current=du,e=ze!==null&&ze.next!==null,ps=0,qe=ze=Ie=null,hu=!1,e)throw Error(U(300));return t}function Mf(){var t=Xo!==0;return Xo=0,t}function pn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qe===null?Ie.memoizedState=qe=t:qe=qe.next=t,qe}function Xt(){if(ze===null){var t=Ie.alternate;t=t!==null?t.memoizedState:null}else t=ze.next;var e=qe===null?Ie.memoizedState:qe.next;if(e!==null)qe=e,ze=t;else{if(t===null)throw Error(U(310));ze=t,t={memoizedState:ze.memoizedState,baseState:ze.baseState,baseQueue:ze.baseQueue,queue:ze.queue,next:null},qe===null?Ie.memoizedState=qe=t:qe=qe.next=t}return qe}function Zo(t,e){return typeof e=="function"?e(t):e}function ah(t){var e=Xt(),n=e.queue;if(n===null)throw Error(U(311));n.lastRenderedReducer=t;var r=ze,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,u=null,c=i;do{var d=c.lane;if((ps&d)===d)u!==null&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var m={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};u===null?(l=u=m,o=r):u=u.next=m,Ie.lanes|=d,ms|=d}c=c.next}while(c!==null&&c!==i);u===null?o=r:u.next=l,hn(r,e.memoizedState)||(Nt=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,Ie.lanes|=i,ms|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function lh(t){var e=Xt(),n=e.queue;if(n===null)throw Error(U(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);hn(i,e.memoizedState)||(Nt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function u0(){}function c0(t,e){var n=Ie,r=Xt(),s=e(),i=!hn(r.memoizedState,s);if(i&&(r.memoizedState=s,Nt=!0),r=r.queue,Lf(f0.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||qe!==null&&qe.memoizedState.tag&1){if(n.flags|=2048,ea(9,d0.bind(null,n,r,s,e),void 0,null),Qe===null)throw Error(U(349));ps&30||h0(n,e,s)}return s}function h0(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Ie.updateQueue,e===null?(e={lastEffect:null,stores:null},Ie.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function d0(t,e,n,r){e.value=n,e.getSnapshot=r,p0(e)&&m0(t)}function f0(t,e,n){return n(function(){p0(e)&&m0(t)})}function p0(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!hn(t,n)}catch{return!0}}function m0(t){var e=$n(t,1);e!==null&&ln(e,t,1,-1)}function Og(t){var e=pn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Zo,lastRenderedState:t},e.queue=t,t=t.dispatch=cI.bind(null,Ie,t),[e.memoizedState,t]}function ea(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Ie.updateQueue,e===null?(e={lastEffect:null,stores:null},Ie.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function g0(){return Xt().memoizedState}function bl(t,e,n,r){var s=pn();Ie.flags|=t,s.memoizedState=ea(1|e,n,void 0,r===void 0?null:r)}function Ku(t,e,n,r){var s=Xt();r=r===void 0?null:r;var i=void 0;if(ze!==null){var o=ze.memoizedState;if(i=o.destroy,r!==null&&Vf(r,o.deps)){s.memoizedState=ea(e,n,i,r);return}}Ie.flags|=t,s.memoizedState=ea(1|e,n,i,r)}function Mg(t,e){return bl(8390656,8,t,e)}function Lf(t,e){return Ku(2048,8,t,e)}function y0(t,e){return Ku(4,2,t,e)}function v0(t,e){return Ku(4,4,t,e)}function _0(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function w0(t,e,n){return n=n!=null?n.concat([t]):null,Ku(4,4,_0.bind(null,e,t),n)}function Ff(){}function E0(t,e){var n=Xt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Vf(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function x0(t,e){var n=Xt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Vf(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function T0(t,e,n){return ps&21?(hn(n,e)||(n=C_(),Ie.lanes|=n,ms|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Nt=!0),t.memoizedState=n)}function lI(t,e){var n=me;me=n!==0&&4>n?n:4,t(!0);var r=oh.transition;oh.transition={};try{t(!1),e()}finally{me=n,oh.transition=r}}function I0(){return Xt().memoizedState}function uI(t,e,n){var r=xr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},S0(t))R0(e,n);else if(n=o0(t,e,n,r),n!==null){var s=Tt();ln(n,t,r,s),A0(n,e,r)}}function cI(t,e,n){var r=xr(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(S0(t))R0(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,hn(l,o)){var u=e.interleaved;u===null?(s.next=s,Nf(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=o0(t,e,s,r),n!==null&&(s=Tt(),ln(n,t,r,s),A0(n,e,r))}}function S0(t){var e=t.alternate;return t===Ie||e!==null&&e===Ie}function R0(t,e){Po=hu=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function A0(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,gf(t,n)}}var du={readContext:Jt,useCallback:ct,useContext:ct,useEffect:ct,useImperativeHandle:ct,useInsertionEffect:ct,useLayoutEffect:ct,useMemo:ct,useReducer:ct,useRef:ct,useState:ct,useDebugValue:ct,useDeferredValue:ct,useTransition:ct,useMutableSource:ct,useSyncExternalStore:ct,useId:ct,unstable_isNewReconciler:!1},hI={readContext:Jt,useCallback:function(t,e){return pn().memoizedState=[t,e===void 0?null:e],t},useContext:Jt,useEffect:Mg,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,bl(4194308,4,_0.bind(null,e,t),n)},useLayoutEffect:function(t,e){return bl(4194308,4,t,e)},useInsertionEffect:function(t,e){return bl(4,2,t,e)},useMemo:function(t,e){var n=pn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=pn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=uI.bind(null,Ie,t),[r.memoizedState,t]},useRef:function(t){var e=pn();return t={current:t},e.memoizedState=t},useState:Og,useDebugValue:Ff,useDeferredValue:function(t){return pn().memoizedState=t},useTransition:function(){var t=Og(!1),e=t[0];return t=lI.bind(null,t[1]),pn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Ie,s=pn();if(xe){if(n===void 0)throw Error(U(407));n=n()}else{if(n=e(),Qe===null)throw Error(U(349));ps&30||h0(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,Mg(f0.bind(null,r,i,t),[t]),r.flags|=2048,ea(9,d0.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=pn(),e=Qe.identifierPrefix;if(xe){var n=On,r=Vn;n=(r&~(1<<32-an(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Xo++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=aI++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},dI={readContext:Jt,useCallback:E0,useContext:Jt,useEffect:Lf,useImperativeHandle:w0,useInsertionEffect:y0,useLayoutEffect:v0,useMemo:x0,useReducer:ah,useRef:g0,useState:function(){return ah(Zo)},useDebugValue:Ff,useDeferredValue:function(t){var e=Xt();return T0(e,ze.memoizedState,t)},useTransition:function(){var t=ah(Zo)[0],e=Xt().memoizedState;return[t,e]},useMutableSource:u0,useSyncExternalStore:c0,useId:I0,unstable_isNewReconciler:!1},fI={readContext:Jt,useCallback:E0,useContext:Jt,useEffect:Lf,useImperativeHandle:w0,useInsertionEffect:y0,useLayoutEffect:v0,useMemo:x0,useReducer:lh,useRef:g0,useState:function(){return lh(Zo)},useDebugValue:Ff,useDeferredValue:function(t){var e=Xt();return ze===null?e.memoizedState=t:T0(e,ze.memoizedState,t)},useTransition:function(){var t=lh(Zo)[0],e=Xt().memoizedState;return[t,e]},useMutableSource:u0,useSyncExternalStore:c0,useId:I0,unstable_isNewReconciler:!1};function tn(t,e){if(t&&t.defaultProps){e=Se({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function ud(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Se({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Qu={isMounted:function(t){return(t=t._reactInternals)?Ts(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Tt(),s=xr(t),i=Fn(r,s);i.payload=e,n!=null&&(i.callback=n),e=wr(t,i,s),e!==null&&(ln(e,t,s,r),Nl(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Tt(),s=xr(t),i=Fn(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=wr(t,i,s),e!==null&&(ln(e,t,s,r),Nl(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Tt(),r=xr(t),s=Fn(n,r);s.tag=2,e!=null&&(s.callback=e),e=wr(t,s,r),e!==null&&(ln(e,t,r,n),Nl(e,t,r))}};function Lg(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Wo(n,r)||!Wo(s,i):!0}function C0(t,e,n){var r=!1,s=kr,i=e.contextType;return typeof i=="object"&&i!==null?i=Jt(i):(s=bt(e)?ds:yt.current,r=e.contextTypes,i=(r=r!=null)?ui(t,s):kr),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Qu,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function Fg(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Qu.enqueueReplaceState(e,e.state,null)}function cd(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},kf(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Jt(i):(i=bt(e)?ds:yt.current,s.context=ui(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(ud(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Qu.enqueueReplaceState(s,s.state,null),uu(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function fi(t,e){try{var n="",r=e;do n+=Bx(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function uh(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function hd(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var pI=typeof WeakMap=="function"?WeakMap:Map;function P0(t,e,n){n=Fn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){pu||(pu=!0,Ed=r),hd(t,e)},n}function N0(t,e,n){n=Fn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){hd(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){hd(t,e),typeof r!="function"&&(Er===null?Er=new Set([this]):Er.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function Ug(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new pI;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=CI.bind(null,t,e,n),e.then(t,t))}function Bg(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function zg(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Fn(-1,1),e.tag=2,wr(n,e,1))),n.lanes|=1),t)}var mI=Yn.ReactCurrentOwner,Nt=!1;function Et(t,e,n,r){e.child=t===null?i0(e,null,n,r):hi(e,t.child,n,r)}function $g(t,e,n,r,s){n=n.render;var i=e.ref;return ni(e,s),r=Of(t,e,n,r,i,s),n=Mf(),t!==null&&!Nt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Hn(t,e,s)):(xe&&n&&If(e),e.flags|=1,Et(t,e,r,s),e.child)}function Hg(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!qf(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,k0(t,e,i,r,s)):(t=Ol(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Wo,n(o,r)&&t.ref===e.ref)return Hn(t,e,s)}return e.flags|=1,t=Tr(i,r),t.ref=e.ref,t.return=e,e.child=t}function k0(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Wo(i,r)&&t.ref===e.ref)if(Nt=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Nt=!0);else return e.lanes=t.lanes,Hn(t,e,s)}return dd(t,e,n,r,s)}function b0(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ve(Js,Mt),Mt|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ve(Js,Mt),Mt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,ve(Js,Mt),Mt|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,ve(Js,Mt),Mt|=r;return Et(t,e,s,n),e.child}function D0(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function dd(t,e,n,r,s){var i=bt(n)?ds:yt.current;return i=ui(e,i),ni(e,s),n=Of(t,e,n,r,i,s),r=Mf(),t!==null&&!Nt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Hn(t,e,s)):(xe&&r&&If(e),e.flags|=1,Et(t,e,n,s),e.child)}function Gg(t,e,n,r,s){if(bt(n)){var i=!0;su(e)}else i=!1;if(ni(e,s),e.stateNode===null)Dl(t,e),C0(e,n,r),cd(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var u=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=Jt(c):(c=bt(n)?ds:yt.current,c=ui(e,c));var d=n.getDerivedStateFromProps,m=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||u!==c)&&Fg(e,o,r,c),or=!1;var g=e.memoizedState;o.state=g,uu(e,r,o,s),u=e.memoizedState,l!==r||g!==u||kt.current||or?(typeof d=="function"&&(ud(e,n,d,r),u=e.memoizedState),(l=or||Lg(e,n,l,r,g,u,c))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=c,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,a0(t,e),l=e.memoizedProps,c=e.type===e.elementType?l:tn(e.type,l),o.props=c,m=e.pendingProps,g=o.context,u=n.contextType,typeof u=="object"&&u!==null?u=Jt(u):(u=bt(n)?ds:yt.current,u=ui(e,u));var E=n.getDerivedStateFromProps;(d=typeof E=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==m||g!==u)&&Fg(e,o,r,u),or=!1,g=e.memoizedState,o.state=g,uu(e,r,o,s);var A=e.memoizedState;l!==m||g!==A||kt.current||or?(typeof E=="function"&&(ud(e,n,E,r),A=e.memoizedState),(c=or||Lg(e,n,c,r,g,A,u)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,A,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,A,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=A),o.props=r,o.state=A,o.context=u,r=c):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),r=!1)}return fd(t,e,n,r,i,s)}function fd(t,e,n,r,s,i){D0(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&Ng(e,n,!1),Hn(t,e,i);r=e.stateNode,mI.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=hi(e,t.child,null,i),e.child=hi(e,null,l,i)):Et(t,e,l,i),e.memoizedState=r.state,s&&Ng(e,n,!0),e.child}function j0(t){var e=t.stateNode;e.pendingContext?Pg(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Pg(t,e.context,!1),bf(t,e.containerInfo)}function Wg(t,e,n,r,s){return ci(),Rf(s),e.flags|=256,Et(t,e,n,r),e.child}var pd={dehydrated:null,treeContext:null,retryLane:0};function md(t){return{baseLanes:t,cachePool:null,transitions:null}}function V0(t,e,n){var r=e.pendingProps,s=Te.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),ve(Te,s&1),t===null)return ad(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Xu(o,r,0,null),t=ls(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=md(n),e.memoizedState=pd,t):Uf(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return gI(t,e,o,r,l,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,l=s.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Tr(s,u),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Tr(l,i):(i=ls(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?md(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=pd,r}return i=t.child,t=i.sibling,r=Tr(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Uf(t,e){return e=Xu({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function fl(t,e,n,r){return r!==null&&Rf(r),hi(e,t.child,null,n),t=Uf(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function gI(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=uh(Error(U(422))),fl(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Xu({mode:"visible",children:r.children},s,0,null),i=ls(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&hi(e,t.child,null,o),e.child.memoizedState=md(o),e.memoizedState=pd,i);if(!(e.mode&1))return fl(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(U(419)),r=uh(i,r,void 0),fl(t,e,o,r)}if(l=(o&t.childLanes)!==0,Nt||l){if(r=Qe,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,$n(t,s),ln(r,t,s,-1))}return Wf(),r=uh(Error(U(421))),fl(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=PI.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Ft=_r(s.nextSibling),Bt=e,xe=!0,rn=null,t!==null&&(Wt[qt++]=Vn,Wt[qt++]=On,Wt[qt++]=fs,Vn=t.id,On=t.overflow,fs=e),e=Uf(e,r.children),e.flags|=4096,e)}function qg(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),ld(t.return,e,n)}function ch(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function O0(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Et(t,e,r.children,n),r=Te.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&qg(t,n,e);else if(t.tag===19)qg(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ve(Te,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&cu(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),ch(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&cu(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}ch(e,!0,n,null,i);break;case"together":ch(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Dl(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Hn(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ms|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(U(153));if(e.child!==null){for(t=e.child,n=Tr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Tr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function yI(t,e,n){switch(e.tag){case 3:j0(e),ci();break;case 5:l0(e);break;case 1:bt(e.type)&&su(e);break;case 4:bf(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;ve(au,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ve(Te,Te.current&1),e.flags|=128,null):n&e.child.childLanes?V0(t,e,n):(ve(Te,Te.current&1),t=Hn(t,e,n),t!==null?t.sibling:null);ve(Te,Te.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return O0(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ve(Te,Te.current),r)break;return null;case 22:case 23:return e.lanes=0,b0(t,e,n)}return Hn(t,e,n)}var M0,gd,L0,F0;M0=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};gd=function(){};L0=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,rs(vn.current);var i=null;switch(n){case"input":s=Lh(t,s),r=Lh(t,r),i=[];break;case"select":s=Se({},s,{value:void 0}),r=Se({},r,{value:void 0}),i=[];break;case"textarea":s=Bh(t,s),r=Bh(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=nu)}$h(n,r);var o;n=null;for(c in s)if(!r.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var l=s[c];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Fo.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in r){var u=r[c];if(l=s!=null?s[c]:void 0,r.hasOwnProperty(c)&&u!==l&&(u!=null||l!=null))if(c==="style")if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(i||(i=[]),i.push(c,n)),n=u;else c==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(i=i||[]).push(c,u)):c==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(c,""+u):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Fo.hasOwnProperty(c)?(u!=null&&c==="onScroll"&&we("scroll",t),i||l===u||(i=[])):(i=i||[]).push(c,u))}n&&(i=i||[]).push("style",n);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};F0=function(t,e,n,r){n!==r&&(e.flags|=4)};function ho(t,e){if(!xe)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function ht(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function vI(t,e,n){var r=e.pendingProps;switch(Sf(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ht(e),null;case 1:return bt(e.type)&&ru(),ht(e),null;case 3:return r=e.stateNode,di(),Ee(kt),Ee(yt),jf(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(hl(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,rn!==null&&(Id(rn),rn=null))),gd(t,e),ht(e),null;case 5:Df(e);var s=rs(Jo.current);if(n=e.type,t!==null&&e.stateNode!=null)L0(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(U(166));return ht(e),null}if(t=rs(vn.current),hl(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[gn]=e,r[Qo]=i,t=(e.mode&1)!==0,n){case"dialog":we("cancel",r),we("close",r);break;case"iframe":case"object":case"embed":we("load",r);break;case"video":case"audio":for(s=0;s<_o.length;s++)we(_o[s],r);break;case"source":we("error",r);break;case"img":case"image":case"link":we("error",r),we("load",r);break;case"details":we("toggle",r);break;case"input":ng(r,i),we("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},we("invalid",r);break;case"textarea":sg(r,i),we("invalid",r)}$h(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&cl(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&cl(r.textContent,l,t),s=["children",""+l]):Fo.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&we("scroll",r)}switch(n){case"input":nl(r),rg(r,i,!0);break;case"textarea":nl(r),ig(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=nu)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=f_(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[gn]=e,t[Qo]=r,M0(t,e,!1,!1),e.stateNode=t;e:{switch(o=Hh(n,r),n){case"dialog":we("cancel",t),we("close",t),s=r;break;case"iframe":case"object":case"embed":we("load",t),s=r;break;case"video":case"audio":for(s=0;s<_o.length;s++)we(_o[s],t);s=r;break;case"source":we("error",t),s=r;break;case"img":case"image":case"link":we("error",t),we("load",t),s=r;break;case"details":we("toggle",t),s=r;break;case"input":ng(t,r),s=Lh(t,r),we("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Se({},r,{value:void 0}),we("invalid",t);break;case"textarea":sg(t,r),s=Bh(t,r),we("invalid",t);break;default:s=r}$h(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var u=l[i];i==="style"?g_(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&p_(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Uo(t,u):typeof u=="number"&&Uo(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Fo.hasOwnProperty(i)?u!=null&&i==="onScroll"&&we("scroll",t):u!=null&&cf(t,i,u,o))}switch(n){case"input":nl(t),rg(t,r,!1);break;case"textarea":nl(t),ig(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Nr(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Xs(t,!!r.multiple,i,!1):r.defaultValue!=null&&Xs(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=nu)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ht(e),null;case 6:if(t&&e.stateNode!=null)F0(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(U(166));if(n=rs(Jo.current),rs(vn.current),hl(e)){if(r=e.stateNode,n=e.memoizedProps,r[gn]=e,(i=r.nodeValue!==n)&&(t=Bt,t!==null))switch(t.tag){case 3:cl(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&cl(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[gn]=e,e.stateNode=r}return ht(e),null;case 13:if(Ee(Te),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(xe&&Ft!==null&&e.mode&1&&!(e.flags&128))r0(),ci(),e.flags|=98560,i=!1;else if(i=hl(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(U(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(U(317));i[gn]=e}else ci(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ht(e),i=!1}else rn!==null&&(Id(rn),rn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Te.current&1?$e===0&&($e=3):Wf())),e.updateQueue!==null&&(e.flags|=4),ht(e),null);case 4:return di(),gd(t,e),t===null&&qo(e.stateNode.containerInfo),ht(e),null;case 10:return Pf(e.type._context),ht(e),null;case 17:return bt(e.type)&&ru(),ht(e),null;case 19:if(Ee(Te),i=e.memoizedState,i===null)return ht(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)ho(i,!1);else{if($e!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=cu(t),o!==null){for(e.flags|=128,ho(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ve(Te,Te.current&1|2),e.child}t=t.sibling}i.tail!==null&&ke()>pi&&(e.flags|=128,r=!0,ho(i,!1),e.lanes=4194304)}else{if(!r)if(t=cu(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),ho(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!xe)return ht(e),null}else 2*ke()-i.renderingStartTime>pi&&n!==1073741824&&(e.flags|=128,r=!0,ho(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=ke(),e.sibling=null,n=Te.current,ve(Te,r?n&1|2:n&1),e):(ht(e),null);case 22:case 23:return Gf(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Mt&1073741824&&(ht(e),e.subtreeFlags&6&&(e.flags|=8192)):ht(e),null;case 24:return null;case 25:return null}throw Error(U(156,e.tag))}function _I(t,e){switch(Sf(e),e.tag){case 1:return bt(e.type)&&ru(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return di(),Ee(kt),Ee(yt),jf(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Df(e),null;case 13:if(Ee(Te),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(U(340));ci()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ee(Te),null;case 4:return di(),null;case 10:return Pf(e.type._context),null;case 22:case 23:return Gf(),null;case 24:return null;default:return null}}var pl=!1,mt=!1,wI=typeof WeakSet=="function"?WeakSet:Set,Q=null;function Ys(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ce(t,e,r)}else n.current=null}function yd(t,e,n){try{n()}catch(r){Ce(t,e,r)}}var Kg=!1;function EI(t,e){if(ed=Zl,t=H_(),Tf(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,u=-1,c=0,d=0,m=t,g=null;t:for(;;){for(var E;m!==n||s!==0&&m.nodeType!==3||(l=o+s),m!==i||r!==0&&m.nodeType!==3||(u=o+r),m.nodeType===3&&(o+=m.nodeValue.length),(E=m.firstChild)!==null;)g=m,m=E;for(;;){if(m===t)break t;if(g===n&&++c===s&&(l=o),g===i&&++d===r&&(u=o),(E=m.nextSibling)!==null)break;m=g,g=m.parentNode}m=E}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(td={focusedElem:t,selectionRange:n},Zl=!1,Q=e;Q!==null;)if(e=Q,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Q=t;else for(;Q!==null;){e=Q;try{var A=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(A!==null){var C=A.memoizedProps,N=A.memoizedState,x=e.stateNode,v=x.getSnapshotBeforeUpdate(e.elementType===e.type?C:tn(e.type,C),N);x.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var T=e.stateNode.containerInfo;T.nodeType===1?T.textContent="":T.nodeType===9&&T.documentElement&&T.removeChild(T.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(U(163))}}catch(D){Ce(e,e.return,D)}if(t=e.sibling,t!==null){t.return=e.return,Q=t;break}Q=e.return}return A=Kg,Kg=!1,A}function No(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&yd(e,n,i)}s=s.next}while(s!==r)}}function Yu(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function vd(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function U0(t){var e=t.alternate;e!==null&&(t.alternate=null,U0(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[gn],delete e[Qo],delete e[sd],delete e[rI],delete e[sI])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function B0(t){return t.tag===5||t.tag===3||t.tag===4}function Qg(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||B0(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function _d(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=nu));else if(r!==4&&(t=t.child,t!==null))for(_d(t,e,n),t=t.sibling;t!==null;)_d(t,e,n),t=t.sibling}function wd(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(wd(t,e,n),t=t.sibling;t!==null;)wd(t,e,n),t=t.sibling}var nt=null,nn=!1;function rr(t,e,n){for(n=n.child;n!==null;)z0(t,e,n),n=n.sibling}function z0(t,e,n){if(yn&&typeof yn.onCommitFiberUnmount=="function")try{yn.onCommitFiberUnmount(zu,n)}catch{}switch(n.tag){case 5:mt||Ys(n,e);case 6:var r=nt,s=nn;nt=null,rr(t,e,n),nt=r,nn=s,nt!==null&&(nn?(t=nt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):nt.removeChild(n.stateNode));break;case 18:nt!==null&&(nn?(t=nt,n=n.stateNode,t.nodeType===8?rh(t.parentNode,n):t.nodeType===1&&rh(t,n),Ho(t)):rh(nt,n.stateNode));break;case 4:r=nt,s=nn,nt=n.stateNode.containerInfo,nn=!0,rr(t,e,n),nt=r,nn=s;break;case 0:case 11:case 14:case 15:if(!mt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&yd(n,e,o),s=s.next}while(s!==r)}rr(t,e,n);break;case 1:if(!mt&&(Ys(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Ce(n,e,l)}rr(t,e,n);break;case 21:rr(t,e,n);break;case 22:n.mode&1?(mt=(r=mt)||n.memoizedState!==null,rr(t,e,n),mt=r):rr(t,e,n);break;default:rr(t,e,n)}}function Yg(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new wI),e.forEach(function(r){var s=NI.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function en(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:nt=l.stateNode,nn=!1;break e;case 3:nt=l.stateNode.containerInfo,nn=!0;break e;case 4:nt=l.stateNode.containerInfo,nn=!0;break e}l=l.return}if(nt===null)throw Error(U(160));z0(i,o,s),nt=null,nn=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(c){Ce(s,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)$0(e,t),e=e.sibling}function $0(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(en(e,t),fn(t),r&4){try{No(3,t,t.return),Yu(3,t)}catch(C){Ce(t,t.return,C)}try{No(5,t,t.return)}catch(C){Ce(t,t.return,C)}}break;case 1:en(e,t),fn(t),r&512&&n!==null&&Ys(n,n.return);break;case 5:if(en(e,t),fn(t),r&512&&n!==null&&Ys(n,n.return),t.flags&32){var s=t.stateNode;try{Uo(s,"")}catch(C){Ce(t,t.return,C)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,l=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&h_(s,i),Hh(l,o);var c=Hh(l,i);for(o=0;o<u.length;o+=2){var d=u[o],m=u[o+1];d==="style"?g_(s,m):d==="dangerouslySetInnerHTML"?p_(s,m):d==="children"?Uo(s,m):cf(s,d,m,c)}switch(l){case"input":Fh(s,i);break;case"textarea":d_(s,i);break;case"select":var g=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var E=i.value;E!=null?Xs(s,!!i.multiple,E,!1):g!==!!i.multiple&&(i.defaultValue!=null?Xs(s,!!i.multiple,i.defaultValue,!0):Xs(s,!!i.multiple,i.multiple?[]:"",!1))}s[Qo]=i}catch(C){Ce(t,t.return,C)}}break;case 6:if(en(e,t),fn(t),r&4){if(t.stateNode===null)throw Error(U(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(C){Ce(t,t.return,C)}}break;case 3:if(en(e,t),fn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ho(e.containerInfo)}catch(C){Ce(t,t.return,C)}break;case 4:en(e,t),fn(t);break;case 13:en(e,t),fn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||($f=ke())),r&4&&Yg(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(mt=(c=mt)||d,en(e,t),mt=c):en(e,t),fn(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!d&&t.mode&1)for(Q=t,d=t.child;d!==null;){for(m=Q=d;Q!==null;){switch(g=Q,E=g.child,g.tag){case 0:case 11:case 14:case 15:No(4,g,g.return);break;case 1:Ys(g,g.return);var A=g.stateNode;if(typeof A.componentWillUnmount=="function"){r=g,n=g.return;try{e=r,A.props=e.memoizedProps,A.state=e.memoizedState,A.componentWillUnmount()}catch(C){Ce(r,n,C)}}break;case 5:Ys(g,g.return);break;case 22:if(g.memoizedState!==null){Xg(m);continue}}E!==null?(E.return=g,Q=E):Xg(m)}d=d.sibling}e:for(d=null,m=t;;){if(m.tag===5){if(d===null){d=m;try{s=m.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=m.stateNode,u=m.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=m_("display",o))}catch(C){Ce(t,t.return,C)}}}else if(m.tag===6){if(d===null)try{m.stateNode.nodeValue=c?"":m.memoizedProps}catch(C){Ce(t,t.return,C)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;d===m&&(d=null),m=m.return}d===m&&(d=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:en(e,t),fn(t),r&4&&Yg(t);break;case 21:break;default:en(e,t),fn(t)}}function fn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(B0(n)){var r=n;break e}n=n.return}throw Error(U(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Uo(s,""),r.flags&=-33);var i=Qg(t);wd(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=Qg(t);_d(t,l,o);break;default:throw Error(U(161))}}catch(u){Ce(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function xI(t,e,n){Q=t,H0(t)}function H0(t,e,n){for(var r=(t.mode&1)!==0;Q!==null;){var s=Q,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||pl;if(!o){var l=s.alternate,u=l!==null&&l.memoizedState!==null||mt;l=pl;var c=mt;if(pl=o,(mt=u)&&!c)for(Q=s;Q!==null;)o=Q,u=o.child,o.tag===22&&o.memoizedState!==null?Zg(s):u!==null?(u.return=o,Q=u):Zg(s);for(;i!==null;)Q=i,H0(i),i=i.sibling;Q=s,pl=l,mt=c}Jg(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Q=i):Jg(t)}}function Jg(t){for(;Q!==null;){var e=Q;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:mt||Yu(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!mt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:tn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Vg(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Vg(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var m=d.dehydrated;m!==null&&Ho(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(U(163))}mt||e.flags&512&&vd(e)}catch(g){Ce(e,e.return,g)}}if(e===t){Q=null;break}if(n=e.sibling,n!==null){n.return=e.return,Q=n;break}Q=e.return}}function Xg(t){for(;Q!==null;){var e=Q;if(e===t){Q=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Q=n;break}Q=e.return}}function Zg(t){for(;Q!==null;){var e=Q;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Yu(4,e)}catch(u){Ce(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){Ce(e,s,u)}}var i=e.return;try{vd(e)}catch(u){Ce(e,i,u)}break;case 5:var o=e.return;try{vd(e)}catch(u){Ce(e,o,u)}}}catch(u){Ce(e,e.return,u)}if(e===t){Q=null;break}var l=e.sibling;if(l!==null){l.return=e.return,Q=l;break}Q=e.return}}var TI=Math.ceil,fu=Yn.ReactCurrentDispatcher,Bf=Yn.ReactCurrentOwner,Yt=Yn.ReactCurrentBatchConfig,he=0,Qe=null,Me=null,it=0,Mt=0,Js=Fr(0),$e=0,ta=null,ms=0,Ju=0,zf=0,ko=null,Ct=null,$f=0,pi=1/0,bn=null,pu=!1,Ed=null,Er=null,ml=!1,fr=null,mu=0,bo=0,xd=null,jl=-1,Vl=0;function Tt(){return he&6?ke():jl!==-1?jl:jl=ke()}function xr(t){return t.mode&1?he&2&&it!==0?it&-it:oI.transition!==null?(Vl===0&&(Vl=C_()),Vl):(t=me,t!==0||(t=window.event,t=t===void 0?16:V_(t.type)),t):1}function ln(t,e,n,r){if(50<bo)throw bo=0,xd=null,Error(U(185));ga(t,n,r),(!(he&2)||t!==Qe)&&(t===Qe&&(!(he&2)&&(Ju|=n),$e===4&&lr(t,it)),Dt(t,r),n===1&&he===0&&!(e.mode&1)&&(pi=ke()+500,qu&&Ur()))}function Dt(t,e){var n=t.callbackNode;oT(t,e);var r=Xl(t,t===Qe?it:0);if(r===0)n!==null&&lg(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&lg(n),e===1)t.tag===0?iI(ey.bind(null,t)):e0(ey.bind(null,t)),tI(function(){!(he&6)&&Ur()}),n=null;else{switch(P_(r)){case 1:n=mf;break;case 4:n=R_;break;case 16:n=Jl;break;case 536870912:n=A_;break;default:n=Jl}n=X0(n,G0.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function G0(t,e){if(jl=-1,Vl=0,he&6)throw Error(U(327));var n=t.callbackNode;if(ri()&&t.callbackNode!==n)return null;var r=Xl(t,t===Qe?it:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=gu(t,r);else{e=r;var s=he;he|=2;var i=q0();(Qe!==t||it!==e)&&(bn=null,pi=ke()+500,as(t,e));do try{RI();break}catch(l){W0(t,l)}while(1);Cf(),fu.current=i,he=s,Me!==null?e=0:(Qe=null,it=0,e=$e)}if(e!==0){if(e===2&&(s=Qh(t),s!==0&&(r=s,e=Td(t,s))),e===1)throw n=ta,as(t,0),lr(t,r),Dt(t,ke()),n;if(e===6)lr(t,r);else{if(s=t.current.alternate,!(r&30)&&!II(s)&&(e=gu(t,r),e===2&&(i=Qh(t),i!==0&&(r=i,e=Td(t,i))),e===1))throw n=ta,as(t,0),lr(t,r),Dt(t,ke()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(U(345));case 2:Zr(t,Ct,bn);break;case 3:if(lr(t,r),(r&130023424)===r&&(e=$f+500-ke(),10<e)){if(Xl(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Tt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=rd(Zr.bind(null,t,Ct,bn),e);break}Zr(t,Ct,bn);break;case 4:if(lr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-an(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=ke()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*TI(r/1960))-r,10<r){t.timeoutHandle=rd(Zr.bind(null,t,Ct,bn),r);break}Zr(t,Ct,bn);break;case 5:Zr(t,Ct,bn);break;default:throw Error(U(329))}}}return Dt(t,ke()),t.callbackNode===n?G0.bind(null,t):null}function Td(t,e){var n=ko;return t.current.memoizedState.isDehydrated&&(as(t,e).flags|=256),t=gu(t,e),t!==2&&(e=Ct,Ct=n,e!==null&&Id(e)),t}function Id(t){Ct===null?Ct=t:Ct.push.apply(Ct,t)}function II(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!hn(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function lr(t,e){for(e&=~zf,e&=~Ju,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-an(e),r=1<<n;t[n]=-1,e&=~r}}function ey(t){if(he&6)throw Error(U(327));ri();var e=Xl(t,0);if(!(e&1))return Dt(t,ke()),null;var n=gu(t,e);if(t.tag!==0&&n===2){var r=Qh(t);r!==0&&(e=r,n=Td(t,r))}if(n===1)throw n=ta,as(t,0),lr(t,e),Dt(t,ke()),n;if(n===6)throw Error(U(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Zr(t,Ct,bn),Dt(t,ke()),null}function Hf(t,e){var n=he;he|=1;try{return t(e)}finally{he=n,he===0&&(pi=ke()+500,qu&&Ur())}}function gs(t){fr!==null&&fr.tag===0&&!(he&6)&&ri();var e=he;he|=1;var n=Yt.transition,r=me;try{if(Yt.transition=null,me=1,t)return t()}finally{me=r,Yt.transition=n,he=e,!(he&6)&&Ur()}}function Gf(){Mt=Js.current,Ee(Js)}function as(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,eI(n)),Me!==null)for(n=Me.return;n!==null;){var r=n;switch(Sf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&ru();break;case 3:di(),Ee(kt),Ee(yt),jf();break;case 5:Df(r);break;case 4:di();break;case 13:Ee(Te);break;case 19:Ee(Te);break;case 10:Pf(r.type._context);break;case 22:case 23:Gf()}n=n.return}if(Qe=t,Me=t=Tr(t.current,null),it=Mt=e,$e=0,ta=null,zf=Ju=ms=0,Ct=ko=null,ns!==null){for(e=0;e<ns.length;e++)if(n=ns[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}ns=null}return t}function W0(t,e){do{var n=Me;try{if(Cf(),kl.current=du,hu){for(var r=Ie.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}hu=!1}if(ps=0,qe=ze=Ie=null,Po=!1,Xo=0,Bf.current=null,n===null||n.return===null){$e=1,ta=e,Me=null;break}e:{var i=t,o=n.return,l=n,u=e;if(e=it,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var c=u,d=l,m=d.tag;if(!(d.mode&1)&&(m===0||m===11||m===15)){var g=d.alternate;g?(d.updateQueue=g.updateQueue,d.memoizedState=g.memoizedState,d.lanes=g.lanes):(d.updateQueue=null,d.memoizedState=null)}var E=Bg(o);if(E!==null){E.flags&=-257,zg(E,o,l,i,e),E.mode&1&&Ug(i,c,e),e=E,u=c;var A=e.updateQueue;if(A===null){var C=new Set;C.add(u),e.updateQueue=C}else A.add(u);break e}else{if(!(e&1)){Ug(i,c,e),Wf();break e}u=Error(U(426))}}else if(xe&&l.mode&1){var N=Bg(o);if(N!==null){!(N.flags&65536)&&(N.flags|=256),zg(N,o,l,i,e),Rf(fi(u,l));break e}}i=u=fi(u,l),$e!==4&&($e=2),ko===null?ko=[i]:ko.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var x=P0(i,u,e);jg(i,x);break e;case 1:l=u;var v=i.type,T=i.stateNode;if(!(i.flags&128)&&(typeof v.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(Er===null||!Er.has(T)))){i.flags|=65536,e&=-e,i.lanes|=e;var D=N0(i,l,e);jg(i,D);break e}}i=i.return}while(i!==null)}Q0(n)}catch(L){e=L,Me===n&&n!==null&&(Me=n=n.return);continue}break}while(1)}function q0(){var t=fu.current;return fu.current=du,t===null?du:t}function Wf(){($e===0||$e===3||$e===2)&&($e=4),Qe===null||!(ms&268435455)&&!(Ju&268435455)||lr(Qe,it)}function gu(t,e){var n=he;he|=2;var r=q0();(Qe!==t||it!==e)&&(bn=null,as(t,e));do try{SI();break}catch(s){W0(t,s)}while(1);if(Cf(),he=n,fu.current=r,Me!==null)throw Error(U(261));return Qe=null,it=0,$e}function SI(){for(;Me!==null;)K0(Me)}function RI(){for(;Me!==null&&!Jx();)K0(Me)}function K0(t){var e=J0(t.alternate,t,Mt);t.memoizedProps=t.pendingProps,e===null?Q0(t):Me=e,Bf.current=null}function Q0(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=_I(n,e),n!==null){n.flags&=32767,Me=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{$e=6,Me=null;return}}else if(n=vI(n,e,Mt),n!==null){Me=n;return}if(e=e.sibling,e!==null){Me=e;return}Me=e=t}while(e!==null);$e===0&&($e=5)}function Zr(t,e,n){var r=me,s=Yt.transition;try{Yt.transition=null,me=1,AI(t,e,n,r)}finally{Yt.transition=s,me=r}return null}function AI(t,e,n,r){do ri();while(fr!==null);if(he&6)throw Error(U(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(U(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(aT(t,i),t===Qe&&(Me=Qe=null,it=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ml||(ml=!0,X0(Jl,function(){return ri(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Yt.transition,Yt.transition=null;var o=me;me=1;var l=he;he|=4,Bf.current=null,EI(t,n),$0(n,t),qT(td),Zl=!!ed,td=ed=null,t.current=n,xI(n),Xx(),he=l,me=o,Yt.transition=i}else t.current=n;if(ml&&(ml=!1,fr=t,mu=s),i=t.pendingLanes,i===0&&(Er=null),tT(n.stateNode),Dt(t,ke()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(pu)throw pu=!1,t=Ed,Ed=null,t;return mu&1&&t.tag!==0&&ri(),i=t.pendingLanes,i&1?t===xd?bo++:(bo=0,xd=t):bo=0,Ur(),null}function ri(){if(fr!==null){var t=P_(mu),e=Yt.transition,n=me;try{if(Yt.transition=null,me=16>t?16:t,fr===null)var r=!1;else{if(t=fr,fr=null,mu=0,he&6)throw Error(U(331));var s=he;for(he|=4,Q=t.current;Q!==null;){var i=Q,o=i.child;if(Q.flags&16){var l=i.deletions;if(l!==null){for(var u=0;u<l.length;u++){var c=l[u];for(Q=c;Q!==null;){var d=Q;switch(d.tag){case 0:case 11:case 15:No(8,d,i)}var m=d.child;if(m!==null)m.return=d,Q=m;else for(;Q!==null;){d=Q;var g=d.sibling,E=d.return;if(U0(d),d===c){Q=null;break}if(g!==null){g.return=E,Q=g;break}Q=E}}}var A=i.alternate;if(A!==null){var C=A.child;if(C!==null){A.child=null;do{var N=C.sibling;C.sibling=null,C=N}while(C!==null)}}Q=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Q=o;else e:for(;Q!==null;){if(i=Q,i.flags&2048)switch(i.tag){case 0:case 11:case 15:No(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,Q=x;break e}Q=i.return}}var v=t.current;for(Q=v;Q!==null;){o=Q;var T=o.child;if(o.subtreeFlags&2064&&T!==null)T.return=o,Q=T;else e:for(o=v;Q!==null;){if(l=Q,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Yu(9,l)}}catch(L){Ce(l,l.return,L)}if(l===o){Q=null;break e}var D=l.sibling;if(D!==null){D.return=l.return,Q=D;break e}Q=l.return}}if(he=s,Ur(),yn&&typeof yn.onPostCommitFiberRoot=="function")try{yn.onPostCommitFiberRoot(zu,t)}catch{}r=!0}return r}finally{me=n,Yt.transition=e}}return!1}function ty(t,e,n){e=fi(n,e),e=P0(t,e,1),t=wr(t,e,1),e=Tt(),t!==null&&(ga(t,1,e),Dt(t,e))}function Ce(t,e,n){if(t.tag===3)ty(t,t,n);else for(;e!==null;){if(e.tag===3){ty(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Er===null||!Er.has(r))){t=fi(n,t),t=N0(e,t,1),e=wr(e,t,1),t=Tt(),e!==null&&(ga(e,1,t),Dt(e,t));break}}e=e.return}}function CI(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Tt(),t.pingedLanes|=t.suspendedLanes&n,Qe===t&&(it&n)===n&&($e===4||$e===3&&(it&130023424)===it&&500>ke()-$f?as(t,0):zf|=n),Dt(t,e)}function Y0(t,e){e===0&&(t.mode&1?(e=il,il<<=1,!(il&130023424)&&(il=4194304)):e=1);var n=Tt();t=$n(t,e),t!==null&&(ga(t,e,n),Dt(t,n))}function PI(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Y0(t,n)}function NI(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(U(314))}r!==null&&r.delete(e),Y0(t,n)}var J0;J0=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||kt.current)Nt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Nt=!1,yI(t,e,n);Nt=!!(t.flags&131072)}else Nt=!1,xe&&e.flags&1048576&&t0(e,ou,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Dl(t,e),t=e.pendingProps;var s=ui(e,yt.current);ni(e,n),s=Of(null,e,r,t,s,n);var i=Mf();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,bt(r)?(i=!0,su(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,kf(e),s.updater=Qu,e.stateNode=s,s._reactInternals=e,cd(e,r,t,n),e=fd(null,e,r,!0,i,n)):(e.tag=0,xe&&i&&If(e),Et(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Dl(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=bI(r),t=tn(r,t),s){case 0:e=dd(null,e,r,t,n);break e;case 1:e=Gg(null,e,r,t,n);break e;case 11:e=$g(null,e,r,t,n);break e;case 14:e=Hg(null,e,r,tn(r.type,t),n);break e}throw Error(U(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:tn(r,s),dd(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:tn(r,s),Gg(t,e,r,s,n);case 3:e:{if(j0(e),t===null)throw Error(U(387));r=e.pendingProps,i=e.memoizedState,s=i.element,a0(t,e),uu(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=fi(Error(U(423)),e),e=Wg(t,e,r,n,s);break e}else if(r!==s){s=fi(Error(U(424)),e),e=Wg(t,e,r,n,s);break e}else for(Ft=_r(e.stateNode.containerInfo.firstChild),Bt=e,xe=!0,rn=null,n=i0(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ci(),r===s){e=Hn(t,e,n);break e}Et(t,e,r,n)}e=e.child}return e;case 5:return l0(e),t===null&&ad(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,nd(r,s)?o=null:i!==null&&nd(r,i)&&(e.flags|=32),D0(t,e),Et(t,e,o,n),e.child;case 6:return t===null&&ad(e),null;case 13:return V0(t,e,n);case 4:return bf(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=hi(e,null,r,n):Et(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:tn(r,s),$g(t,e,r,s,n);case 7:return Et(t,e,e.pendingProps,n),e.child;case 8:return Et(t,e,e.pendingProps.children,n),e.child;case 12:return Et(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,ve(au,r._currentValue),r._currentValue=o,i!==null)if(hn(i.value,o)){if(i.children===s.children&&!kt.current){e=Hn(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=Fn(-1,n&-n),u.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?u.next=u:(u.next=d.next,d.next=u),c.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),ld(i.return,n,e),l.lanes|=n;break}u=u.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(U(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),ld(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Et(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,ni(e,n),s=Jt(s),r=r(s),e.flags|=1,Et(t,e,r,n),e.child;case 14:return r=e.type,s=tn(r,e.pendingProps),s=tn(r.type,s),Hg(t,e,r,s,n);case 15:return k0(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:tn(r,s),Dl(t,e),e.tag=1,bt(r)?(t=!0,su(e)):t=!1,ni(e,n),C0(e,r,s),cd(e,r,s,n),fd(null,e,r,!0,t,n);case 19:return O0(t,e,n);case 22:return b0(t,e,n)}throw Error(U(156,e.tag))};function X0(t,e){return S_(t,e)}function kI(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qt(t,e,n,r){return new kI(t,e,n,r)}function qf(t){return t=t.prototype,!(!t||!t.isReactComponent)}function bI(t){if(typeof t=="function")return qf(t)?1:0;if(t!=null){if(t=t.$$typeof,t===df)return 11;if(t===ff)return 14}return 2}function Tr(t,e){var n=t.alternate;return n===null?(n=Qt(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ol(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")qf(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Bs:return ls(n.children,s,i,e);case hf:o=8,s|=8;break;case jh:return t=Qt(12,n,e,s|2),t.elementType=jh,t.lanes=i,t;case Vh:return t=Qt(13,n,e,s),t.elementType=Vh,t.lanes=i,t;case Oh:return t=Qt(19,n,e,s),t.elementType=Oh,t.lanes=i,t;case l_:return Xu(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case o_:o=10;break e;case a_:o=9;break e;case df:o=11;break e;case ff:o=14;break e;case ir:o=16,r=null;break e}throw Error(U(130,t==null?t:typeof t,""))}return e=Qt(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function ls(t,e,n,r){return t=Qt(7,t,r,e),t.lanes=n,t}function Xu(t,e,n,r){return t=Qt(22,t,r,e),t.elementType=l_,t.lanes=n,t.stateNode={isHidden:!1},t}function hh(t,e,n){return t=Qt(6,t,null,e),t.lanes=n,t}function dh(t,e,n){return e=Qt(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function DI(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Wc(0),this.expirationTimes=Wc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Wc(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Kf(t,e,n,r,s,i,o,l,u){return t=new DI(t,e,n,l,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Qt(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},kf(i),t}function jI(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Us,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Z0(t){if(!t)return kr;t=t._reactInternals;e:{if(Ts(t)!==t||t.tag!==1)throw Error(U(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(bt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(U(171))}if(t.tag===1){var n=t.type;if(bt(n))return Z_(t,n,e)}return e}function ew(t,e,n,r,s,i,o,l,u){return t=Kf(n,r,!0,t,s,i,o,l,u),t.context=Z0(null),n=t.current,r=Tt(),s=xr(n),i=Fn(r,s),i.callback=e??null,wr(n,i,s),t.current.lanes=s,ga(t,s,r),Dt(t,r),t}function Zu(t,e,n,r){var s=e.current,i=Tt(),o=xr(s);return n=Z0(n),e.context===null?e.context=n:e.pendingContext=n,e=Fn(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=wr(s,e,o),t!==null&&(ln(t,s,o,i),Nl(t,s,o)),o}function yu(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function ny(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Qf(t,e){ny(t,e),(t=t.alternate)&&ny(t,e)}function VI(){return null}var tw=typeof reportError=="function"?reportError:function(t){console.error(t)};function Yf(t){this._internalRoot=t}ec.prototype.render=Yf.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(U(409));Zu(t,e,null,null)};ec.prototype.unmount=Yf.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;gs(function(){Zu(null,t,null,null)}),e[zn]=null}};function ec(t){this._internalRoot=t}ec.prototype.unstable_scheduleHydration=function(t){if(t){var e=b_();t={blockedOn:null,target:t,priority:e};for(var n=0;n<ar.length&&e!==0&&e<ar[n].priority;n++);ar.splice(n,0,t),n===0&&j_(t)}};function Jf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function tc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function ry(){}function OI(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var c=yu(o);i.call(c)}}var o=ew(e,r,t,0,null,!1,!1,"",ry);return t._reactRootContainer=o,t[zn]=o.current,qo(t.nodeType===8?t.parentNode:t),gs(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var c=yu(u);l.call(c)}}var u=Kf(t,0,!1,null,null,!1,!1,"",ry);return t._reactRootContainer=u,t[zn]=u.current,qo(t.nodeType===8?t.parentNode:t),gs(function(){Zu(e,u,n,r)}),u}function nc(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var u=yu(o);l.call(u)}}Zu(e,o,t,s)}else o=OI(n,e,t,s,r);return yu(o)}N_=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=vo(e.pendingLanes);n!==0&&(gf(e,n|1),Dt(e,ke()),!(he&6)&&(pi=ke()+500,Ur()))}break;case 13:gs(function(){var r=$n(t,1);if(r!==null){var s=Tt();ln(r,t,1,s)}}),Qf(t,1)}};yf=function(t){if(t.tag===13){var e=$n(t,134217728);if(e!==null){var n=Tt();ln(e,t,134217728,n)}Qf(t,134217728)}};k_=function(t){if(t.tag===13){var e=xr(t),n=$n(t,e);if(n!==null){var r=Tt();ln(n,t,e,r)}Qf(t,e)}};b_=function(){return me};D_=function(t,e){var n=me;try{return me=t,e()}finally{me=n}};Wh=function(t,e,n){switch(e){case"input":if(Fh(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Wu(r);if(!s)throw Error(U(90));c_(r),Fh(r,s)}}}break;case"textarea":d_(t,n);break;case"select":e=n.value,e!=null&&Xs(t,!!n.multiple,e,!1)}};__=Hf;w_=gs;var MI={usingClientEntryPoint:!1,Events:[va,Gs,Wu,y_,v_,Hf]},fo={findFiberByHostInstance:ts,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},LI={bundleType:fo.bundleType,version:fo.version,rendererPackageName:fo.rendererPackageName,rendererConfig:fo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Yn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=T_(t),t===null?null:t.stateNode},findFiberByHostInstance:fo.findFiberByHostInstance||VI,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var gl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!gl.isDisabled&&gl.supportsFiber)try{zu=gl.inject(LI),yn=gl}catch{}}$t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=MI;$t.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Jf(e))throw Error(U(200));return jI(t,e,null,n)};$t.createRoot=function(t,e){if(!Jf(t))throw Error(U(299));var n=!1,r="",s=tw;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Kf(t,1,!1,null,null,n,!1,r,s),t[zn]=e.current,qo(t.nodeType===8?t.parentNode:t),new Yf(e)};$t.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(U(188)):(t=Object.keys(t).join(","),Error(U(268,t)));return t=T_(e),t=t===null?null:t.stateNode,t};$t.flushSync=function(t){return gs(t)};$t.hydrate=function(t,e,n){if(!tc(e))throw Error(U(200));return nc(null,t,e,!0,n)};$t.hydrateRoot=function(t,e,n){if(!Jf(t))throw Error(U(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=tw;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=ew(e,null,t,1,n??null,s,!1,i,o),t[zn]=e.current,qo(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new ec(e)};$t.render=function(t,e,n){if(!tc(e))throw Error(U(200));return nc(null,t,e,!1,n)};$t.unmountComponentAtNode=function(t){if(!tc(t))throw Error(U(40));return t._reactRootContainer?(gs(function(){nc(null,null,t,!1,function(){t._reactRootContainer=null,t[zn]=null})}),!0):!1};$t.unstable_batchedUpdates=Hf;$t.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!tc(n))throw Error(U(200));if(t==null||t._reactInternals===void 0)throw Error(U(38));return nc(t,e,n,!1,r)};$t.version="18.3.1-next-f1338f8080-20240426";function nw(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(nw)}catch(t){console.error(t)}}nw(),n_.exports=$t;var FI=n_.exports,sy=FI;bh.createRoot=sy.createRoot,bh.hydrateRoot=sy.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function na(){return na=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},na.apply(this,arguments)}var pr;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(pr||(pr={}));const iy="popstate";function UI(t){t===void 0&&(t={});function e(r,s){let{pathname:i,search:o,hash:l}=r.location;return Sd("",{pathname:i,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:vu(s)}return zI(e,n,null,t)}function be(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function rw(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function BI(){return Math.random().toString(36).substr(2,8)}function oy(t,e){return{usr:t.state,key:t.key,idx:e}}function Sd(t,e,n,r){return n===void 0&&(n=null),na({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Ai(e):e,{state:n,key:e&&e.key||r||BI()})}function vu(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Ai(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function zI(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,l=pr.Pop,u=null,c=d();c==null&&(c=0,o.replaceState(na({},o.state,{idx:c}),""));function d(){return(o.state||{idx:null}).idx}function m(){l=pr.Pop;let N=d(),x=N==null?null:N-c;c=N,u&&u({action:l,location:C.location,delta:x})}function g(N,x){l=pr.Push;let v=Sd(C.location,N,x);n&&n(v,N),c=d()+1;let T=oy(v,c),D=C.createHref(v);try{o.pushState(T,"",D)}catch(L){if(L instanceof DOMException&&L.name==="DataCloneError")throw L;s.location.assign(D)}i&&u&&u({action:l,location:C.location,delta:1})}function E(N,x){l=pr.Replace;let v=Sd(C.location,N,x);n&&n(v,N),c=d();let T=oy(v,c),D=C.createHref(v);o.replaceState(T,"",D),i&&u&&u({action:l,location:C.location,delta:0})}function A(N){let x=s.location.origin!=="null"?s.location.origin:s.location.href,v=typeof N=="string"?N:vu(N);return v=v.replace(/ $/,"%20"),be(x,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,x)}let C={get action(){return l},get location(){return t(s,o)},listen(N){if(u)throw new Error("A history only accepts one active listener");return s.addEventListener(iy,m),u=N,()=>{s.removeEventListener(iy,m),u=null}},createHref(N){return e(s,N)},createURL:A,encodeLocation(N){let x=A(N);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:g,replace:E,go(N){return o.go(N)}};return C}var ay;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(ay||(ay={}));function $I(t,e,n){return n===void 0&&(n="/"),HI(t,e,n,!1)}function HI(t,e,n,r){let s=typeof e=="string"?Ai(e):e,i=Xf(s.pathname||"/",n);if(i==null)return null;let o=sw(t);GI(o);let l=null;for(let u=0;l==null&&u<o.length;++u){let c=nS(i);l=eS(o[u],c,r)}return l}function sw(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,l)=>{let u={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};u.relativePath.startsWith("/")&&(be(u.relativePath.startsWith(r),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(r.length));let c=Ir([r,u.relativePath]),d=n.concat(u);i.children&&i.children.length>0&&(be(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),sw(i.children,e,d,c)),!(i.path==null&&!i.index)&&e.push({path:c,score:XI(c,i.index),routesMeta:d})};return t.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))s(i,o);else for(let u of iw(i.path))s(i,o,u)}),e}function iw(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=iw(r.join("/")),l=[];return l.push(...o.map(u=>u===""?i:[i,u].join("/"))),s&&l.push(...o),l.map(u=>t.startsWith("/")&&u===""?"/":u)}function GI(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:ZI(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const WI=/^:[\w-]+$/,qI=3,KI=2,QI=1,YI=10,JI=-2,ly=t=>t==="*";function XI(t,e){let n=t.split("/"),r=n.length;return n.some(ly)&&(r+=JI),e&&(r+=KI),n.filter(s=>!ly(s)).reduce((s,i)=>s+(WI.test(i)?qI:i===""?QI:YI),r)}function ZI(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function eS(t,e,n){n===void 0&&(n=!1);let{routesMeta:r}=t,s={},i="/",o=[];for(let l=0;l<r.length;++l){let u=r[l],c=l===r.length-1,d=i==="/"?e:e.slice(i.length)||"/",m=uy({path:u.relativePath,caseSensitive:u.caseSensitive,end:c},d),g=u.route;if(!m&&c&&n&&!r[r.length-1].route.index&&(m=uy({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},d)),!m)return null;Object.assign(s,m.params),o.push({params:s,pathname:Ir([i,m.pathname]),pathnameBase:oS(Ir([i,m.pathnameBase])),route:g}),m.pathnameBase!=="/"&&(i=Ir([i,m.pathnameBase]))}return o}function uy(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=tS(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((c,d,m)=>{let{paramName:g,isOptional:E}=d;if(g==="*"){let C=l[m]||"";o=i.slice(0,i.length-C.length).replace(/(.)\/+$/,"$1")}const A=l[m];return E&&!A?c[g]=void 0:c[g]=(A||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:o,pattern:t}}function tS(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),rw(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,u)=>(r.push({paramName:l,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function nS(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return rw(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Xf(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function rS(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?Ai(t):t;return{pathname:n?n.startsWith("/")?n:sS(n,e):e,search:aS(r),hash:lS(s)}}function sS(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function fh(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function iS(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Zf(t,e){let n=iS(t);return e?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function ep(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=Ai(t):(s=na({},t),be(!s.pathname||!s.pathname.includes("?"),fh("?","pathname","search",s)),be(!s.pathname||!s.pathname.includes("#"),fh("#","pathname","hash",s)),be(!s.search||!s.search.includes("#"),fh("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,l;if(o==null)l=n;else{let m=e.length-1;if(!r&&o.startsWith("..")){let g=o.split("/");for(;g[0]==="..";)g.shift(),m-=1;s.pathname=g.join("/")}l=m>=0?e[m]:"/"}let u=rS(s,l),c=o&&o!=="/"&&o.endsWith("/"),d=(i||o===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(c||d)&&(u.pathname+="/"),u}const Ir=t=>t.join("/").replace(/\/\/+/g,"/"),oS=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),aS=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,lS=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function uS(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const ow=["post","put","patch","delete"];new Set(ow);const cS=["get",...ow];new Set(cS);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ra(){return ra=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ra.apply(this,arguments)}const tp=M.createContext(null),hS=M.createContext(null),Br=M.createContext(null),rc=M.createContext(null),Jn=M.createContext({outlet:null,matches:[],isDataRoute:!1}),aw=M.createContext(null);function dS(t,e){let{relative:n}=e===void 0?{}:e;Ci()||be(!1);let{basename:r,navigator:s}=M.useContext(Br),{hash:i,pathname:o,search:l}=uw(t,{relative:n}),u=o;return r!=="/"&&(u=o==="/"?r:Ir([r,o])),s.createHref({pathname:u,search:l,hash:i})}function Ci(){return M.useContext(rc)!=null}function wa(){return Ci()||be(!1),M.useContext(rc).location}function lw(t){M.useContext(Br).static||M.useLayoutEffect(t)}function Pi(){let{isDataRoute:t}=M.useContext(Jn);return t?SS():fS()}function fS(){Ci()||be(!1);let t=M.useContext(tp),{basename:e,future:n,navigator:r}=M.useContext(Br),{matches:s}=M.useContext(Jn),{pathname:i}=wa(),o=JSON.stringify(Zf(s,n.v7_relativeSplatPath)),l=M.useRef(!1);return lw(()=>{l.current=!0}),M.useCallback(function(c,d){if(d===void 0&&(d={}),!l.current)return;if(typeof c=="number"){r.go(c);return}let m=ep(c,JSON.parse(o),i,d.relative==="path");t==null&&e!=="/"&&(m.pathname=m.pathname==="/"?e:Ir([e,m.pathname])),(d.replace?r.replace:r.push)(m,d.state,d)},[e,r,o,i,t])}function Ea(){let{matches:t}=M.useContext(Jn),e=t[t.length-1];return e?e.params:{}}function uw(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=M.useContext(Br),{matches:s}=M.useContext(Jn),{pathname:i}=wa(),o=JSON.stringify(Zf(s,r.v7_relativeSplatPath));return M.useMemo(()=>ep(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function pS(t,e){return mS(t,e)}function mS(t,e,n,r){Ci()||be(!1);let{navigator:s}=M.useContext(Br),{matches:i}=M.useContext(Jn),o=i[i.length-1],l=o?o.params:{};o&&o.pathname;let u=o?o.pathnameBase:"/";o&&o.route;let c=wa(),d;if(e){var m;let N=typeof e=="string"?Ai(e):e;u==="/"||(m=N.pathname)!=null&&m.startsWith(u)||be(!1),d=N}else d=c;let g=d.pathname||"/",E=g;if(u!=="/"){let N=u.replace(/^\//,"").split("/");E="/"+g.replace(/^\//,"").split("/").slice(N.length).join("/")}let A=$I(t,{pathname:E}),C=wS(A&&A.map(N=>Object.assign({},N,{params:Object.assign({},l,N.params),pathname:Ir([u,s.encodeLocation?s.encodeLocation(N.pathname).pathname:N.pathname]),pathnameBase:N.pathnameBase==="/"?u:Ir([u,s.encodeLocation?s.encodeLocation(N.pathnameBase).pathname:N.pathnameBase])})),i,n,r);return e&&C?M.createElement(rc.Provider,{value:{location:ra({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:pr.Pop}},C):C}function gS(){let t=IS(),e=uS(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},i=null;return M.createElement(M.Fragment,null,M.createElement("h2",null,"Unexpected Application Error!"),M.createElement("h3",{style:{fontStyle:"italic"}},e),n?M.createElement("pre",{style:s},n):null,i)}const yS=M.createElement(gS,null);class vS extends M.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?M.createElement(Jn.Provider,{value:this.props.routeContext},M.createElement(aw.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function _S(t){let{routeContext:e,match:n,children:r}=t,s=M.useContext(tp);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),M.createElement(Jn.Provider,{value:e},r)}function wS(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,l=(s=n)==null?void 0:s.errors;if(l!=null){let d=o.findIndex(m=>m.route.id&&(l==null?void 0:l[m.route.id])!==void 0);d>=0||be(!1),o=o.slice(0,Math.min(o.length,d+1))}let u=!1,c=-1;if(n&&r&&r.v7_partialHydration)for(let d=0;d<o.length;d++){let m=o[d];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(c=d),m.route.id){let{loaderData:g,errors:E}=n,A=m.route.loader&&g[m.route.id]===void 0&&(!E||E[m.route.id]===void 0);if(m.route.lazy||A){u=!0,c>=0?o=o.slice(0,c+1):o=[o[0]];break}}}return o.reduceRight((d,m,g)=>{let E,A=!1,C=null,N=null;n&&(E=l&&m.route.id?l[m.route.id]:void 0,C=m.route.errorElement||yS,u&&(c<0&&g===0?(RS("route-fallback",!1),A=!0,N=null):c===g&&(A=!0,N=m.route.hydrateFallbackElement||null)));let x=e.concat(o.slice(0,g+1)),v=()=>{let T;return E?T=C:A?T=N:m.route.Component?T=M.createElement(m.route.Component,null):m.route.element?T=m.route.element:T=d,M.createElement(_S,{match:m,routeContext:{outlet:d,matches:x,isDataRoute:n!=null},children:T})};return n&&(m.route.ErrorBoundary||m.route.errorElement||g===0)?M.createElement(vS,{location:n.location,revalidation:n.revalidation,component:C,error:E,children:v(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):v()},null)}var cw=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(cw||{}),_u=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(_u||{});function ES(t){let e=M.useContext(tp);return e||be(!1),e}function xS(t){let e=M.useContext(hS);return e||be(!1),e}function TS(t){let e=M.useContext(Jn);return e||be(!1),e}function hw(t){let e=TS(),n=e.matches[e.matches.length-1];return n.route.id||be(!1),n.route.id}function IS(){var t;let e=M.useContext(aw),n=xS(_u.UseRouteError),r=hw(_u.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function SS(){let{router:t}=ES(cw.UseNavigateStable),e=hw(_u.UseNavigateStable),n=M.useRef(!1);return lw(()=>{n.current=!0}),M.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,ra({fromRouteId:e},i)))},[t,e])}const cy={};function RS(t,e,n){!e&&!cy[t]&&(cy[t]=!0)}function AS(t,e){t==null||t.v7_startTransition,(t==null?void 0:t.v7_relativeSplatPath)===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function CS(t){let{to:e,replace:n,state:r,relative:s}=t;Ci()||be(!1);let{future:i,static:o}=M.useContext(Br),{matches:l}=M.useContext(Jn),{pathname:u}=wa(),c=Pi(),d=ep(e,Zf(l,i.v7_relativeSplatPath),u,s==="path"),m=JSON.stringify(d);return M.useEffect(()=>c(JSON.parse(m),{replace:n,state:r,relative:s}),[c,m,s,n,r]),null}function kn(t){be(!1)}function PS(t){let{basename:e="/",children:n=null,location:r,navigationType:s=pr.Pop,navigator:i,static:o=!1,future:l}=t;Ci()&&be(!1);let u=e.replace(/^\/*/,"/"),c=M.useMemo(()=>({basename:u,navigator:i,static:o,future:ra({v7_relativeSplatPath:!1},l)}),[u,l,i,o]);typeof r=="string"&&(r=Ai(r));let{pathname:d="/",search:m="",hash:g="",state:E=null,key:A="default"}=r,C=M.useMemo(()=>{let N=Xf(d,u);return N==null?null:{location:{pathname:N,search:m,hash:g,state:E,key:A},navigationType:s}},[u,d,m,g,E,A,s]);return C==null?null:M.createElement(Br.Provider,{value:c},M.createElement(rc.Provider,{children:n,value:C}))}function NS(t){let{children:e,location:n}=t;return pS(Rd(e),n)}new Promise(()=>{});function Rd(t,e){e===void 0&&(e=[]);let n=[];return M.Children.forEach(t,(r,s)=>{if(!M.isValidElement(r))return;let i=[...e,s];if(r.type===M.Fragment){n.push.apply(n,Rd(r.props.children,i));return}r.type!==kn&&be(!1),!r.props.index||!r.props.children||be(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Rd(r.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ad(){return Ad=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ad.apply(this,arguments)}function kS(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function bS(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function DS(t,e){return t.button===0&&(!e||e==="_self")&&!bS(t)}const jS=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],VS="6";try{window.__reactRouterVersion=VS}catch{}const OS="startTransition",hy=Cx[OS];function MS(t){let{basename:e,children:n,future:r,window:s}=t,i=M.useRef();i.current==null&&(i.current=UI({window:s,v5Compat:!0}));let o=i.current,[l,u]=M.useState({action:o.action,location:o.location}),{v7_startTransition:c}=r||{},d=M.useCallback(m=>{c&&hy?hy(()=>u(m)):u(m)},[u,c]);return M.useLayoutEffect(()=>o.listen(d),[o,d]),M.useEffect(()=>AS(r),[r]),M.createElement(PS,{basename:e,children:n,location:l.location,navigationType:l.action,navigator:o,future:r})}const LS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",FS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,xt=M.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:i,replace:o,state:l,target:u,to:c,preventScrollReset:d,viewTransition:m}=e,g=kS(e,jS),{basename:E}=M.useContext(Br),A,C=!1;if(typeof c=="string"&&FS.test(c)&&(A=c,LS))try{let T=new URL(window.location.href),D=c.startsWith("//")?new URL(T.protocol+c):new URL(c),L=Xf(D.pathname,E);D.origin===T.origin&&L!=null?c=L+D.search+D.hash:C=!0}catch{}let N=dS(c,{relative:s}),x=US(c,{replace:o,state:l,target:u,preventScrollReset:d,relative:s,viewTransition:m});function v(T){r&&r(T),T.defaultPrevented||x(T)}return M.createElement("a",Ad({},g,{href:A||N,onClick:C||i?r:v,ref:n,target:u}))});var dy;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(dy||(dy={}));var fy;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(fy||(fy={}));function US(t,e){let{target:n,replace:r,state:s,preventScrollReset:i,relative:o,viewTransition:l}=e===void 0?{}:e,u=Pi(),c=wa(),d=uw(t,{relative:o});return M.useCallback(m=>{if(DS(m,n)){m.preventDefault();let g=r!==void 0?r:vu(c)===vu(d);u(t,{replace:g,state:s,preventScrollReset:i,relative:o,viewTransition:l})}},[c,u,d,r,s,n,t,i,o,l])}const py=t=>{let e;const n=new Set,r=(d,m)=>{const g=typeof d=="function"?d(e):d;if(!Object.is(g,e)){const E=e;e=m??(typeof g!="object"||g===null)?g:Object.assign({},e,g),n.forEach(A=>A(e,E))}},s=()=>e,u={setState:r,getState:s,getInitialState:()=>c,subscribe:d=>(n.add(d),()=>n.delete(d)),destroy:()=>{n.clear()}},c=e=t(r,s,u);return u},BS=t=>t?py(t):py;var dw={exports:{}},fw={},pw={exports:{}},mw={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mi=M;function zS(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var $S=typeof Object.is=="function"?Object.is:zS,HS=mi.useState,GS=mi.useEffect,WS=mi.useLayoutEffect,qS=mi.useDebugValue;function KS(t,e){var n=e(),r=HS({inst:{value:n,getSnapshot:e}}),s=r[0].inst,i=r[1];return WS(function(){s.value=n,s.getSnapshot=e,ph(s)&&i({inst:s})},[t,n,e]),GS(function(){return ph(s)&&i({inst:s}),t(function(){ph(s)&&i({inst:s})})},[t]),qS(n),n}function ph(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!$S(t,n)}catch{return!0}}function QS(t,e){return e()}var YS=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?QS:KS;mw.useSyncExternalStore=mi.useSyncExternalStore!==void 0?mi.useSyncExternalStore:YS;pw.exports=mw;var JS=pw.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sc=M,XS=JS;function ZS(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var eR=typeof Object.is=="function"?Object.is:ZS,tR=XS.useSyncExternalStore,nR=sc.useRef,rR=sc.useEffect,sR=sc.useMemo,iR=sc.useDebugValue;fw.useSyncExternalStoreWithSelector=function(t,e,n,r,s){var i=nR(null);if(i.current===null){var o={hasValue:!1,value:null};i.current=o}else o=i.current;i=sR(function(){function u(E){if(!c){if(c=!0,d=E,E=r(E),s!==void 0&&o.hasValue){var A=o.value;if(s(A,E))return m=A}return m=E}if(A=m,eR(d,E))return A;var C=r(E);return s!==void 0&&s(A,C)?(d=E,A):(d=E,m=C)}var c=!1,d,m,g=n===void 0?null:n;return[function(){return u(e())},g===null?void 0:function(){return u(g())}]},[e,n,r,s]);var l=tR(t,i[0],i[1]);return rR(function(){o.hasValue=!0,o.value=l},[l]),iR(l),l};dw.exports=fw;var oR=dw.exports;const aR=Hv(oR),{useDebugValue:lR}=af,{useSyncExternalStoreWithSelector:uR}=aR;const cR=t=>t;function hR(t,e=cR,n){const r=uR(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,n);return lR(r),r}const my=t=>{const e=typeof t=="function"?BS(t):t,n=(r,s)=>hR(e,r,s);return Object.assign(n,e),n},gw=t=>t?my(t):my;function dR(t,e){let n;try{n=t()}catch{return}return{getItem:s=>{var i;const o=u=>u===null?null:JSON.parse(u,e==null?void 0:e.reviver),l=(i=n.getItem(s))!=null?i:null;return l instanceof Promise?l.then(o):o(l)},setItem:(s,i)=>n.setItem(s,JSON.stringify(i,e==null?void 0:e.replacer)),removeItem:s=>n.removeItem(s)}}const sa=t=>e=>{try{const n=t(e);return n instanceof Promise?n:{then(r){return sa(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return sa(r)(n)}}}},fR=(t,e)=>(n,r,s)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:N=>N,version:0,merge:(N,x)=>({...x,...N}),...e},o=!1;const l=new Set,u=new Set;let c;try{c=i.getStorage()}catch{}if(!c)return t((...N)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...N)},r,s);const d=sa(i.serialize),m=()=>{const N=i.partialize({...r()});let x;const v=d({state:N,version:i.version}).then(T=>c.setItem(i.name,T)).catch(T=>{x=T});if(x)throw x;return v},g=s.setState;s.setState=(N,x)=>{g(N,x),m()};const E=t((...N)=>{n(...N),m()},r,s);let A;const C=()=>{var N;if(!c)return;o=!1,l.forEach(v=>v(r()));const x=((N=i.onRehydrateStorage)==null?void 0:N.call(i,r()))||void 0;return sa(c.getItem.bind(c))(i.name).then(v=>{if(v)return i.deserialize(v)}).then(v=>{if(v)if(typeof v.version=="number"&&v.version!==i.version){if(i.migrate)return i.migrate(v.state,v.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return v.state}).then(v=>{var T;return A=i.merge(v,(T=r())!=null?T:E),n(A,!0),m()}).then(()=>{x==null||x(A,void 0),o=!0,u.forEach(v=>v(A))}).catch(v=>{x==null||x(void 0,v)})};return s.persist={setOptions:N=>{i={...i,...N},N.getStorage&&(c=N.getStorage())},clearStorage:()=>{c==null||c.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>C(),hasHydrated:()=>o,onHydrate:N=>(l.add(N),()=>{l.delete(N)}),onFinishHydration:N=>(u.add(N),()=>{u.delete(N)})},C(),A||E},pR=(t,e)=>(n,r,s)=>{let i={storage:dR(()=>localStorage),partialize:C=>C,version:0,merge:(C,N)=>({...N,...C}),...e},o=!1;const l=new Set,u=new Set;let c=i.storage;if(!c)return t((...C)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...C)},r,s);const d=()=>{const C=i.partialize({...r()});return c.setItem(i.name,{state:C,version:i.version})},m=s.setState;s.setState=(C,N)=>{m(C,N),d()};const g=t((...C)=>{n(...C),d()},r,s);s.getInitialState=()=>g;let E;const A=()=>{var C,N;if(!c)return;o=!1,l.forEach(v=>{var T;return v((T=r())!=null?T:g)});const x=((N=i.onRehydrateStorage)==null?void 0:N.call(i,(C=r())!=null?C:g))||void 0;return sa(c.getItem.bind(c))(i.name).then(v=>{if(v)if(typeof v.version=="number"&&v.version!==i.version){if(i.migrate)return[!0,i.migrate(v.state,v.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,v.state];return[!1,void 0]}).then(v=>{var T;const[D,L]=v;if(E=i.merge(L,(T=r())!=null?T:g),n(E,!0),D)return d()}).then(()=>{x==null||x(E,void 0),E=r(),o=!0,u.forEach(v=>v(E))}).catch(v=>{x==null||x(void 0,v)})};return s.persist={setOptions:C=>{i={...i,...C},C.storage&&(c=C.storage)},clearStorage:()=>{c==null||c.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>A(),hasHydrated:()=>o,onHydrate:C=>(l.add(C),()=>{l.delete(C)}),onFinishHydration:C=>(u.add(C),()=>{u.delete(C)})},i.skipHydration||A(),E||g},mR=(t,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?fR(t,e):pR(t,e),yw=mR;var ss=(t=>(t.SINGLE="single",t.DOUBLE="double",t.TRIPLE="triple",t.CHAIN="chain",t.SLIP="slip",t.INCREASE="increase",t.DECREASE="decrease",t.MAGIC_RING="magic_ring",t.FRONT_POST="front_post",t.BACK_POST="back_post",t))(ss||{});const Ot={single:{rawValue:"短針",symbol:"×",englishName:"Single Crochet"},double:{rawValue:"長針",symbol:"↑",englishName:"Double Crochet"},triple:{rawValue:"長長針",symbol:"↟",englishName:"Triple Crochet"},chain:{rawValue:"鎖針",symbol:"○",englishName:"Chain"},slip:{rawValue:"引拔針",symbol:"•",englishName:"Slip Stitch"},increase:{rawValue:"加針",symbol:"▲",englishName:"Increase"},decrease:{rawValue:"減針",symbol:"▼",englishName:"Decrease"},magic_ring:{rawValue:"魔術環",symbol:"◉",englishName:"Magic Ring"},front_post:{rawValue:"前柱針",symbol:"⟨",englishName:"Front Post"},back_post:{rawValue:"後柱針",symbol:"⟩",englishName:"Back Post"}};function Ke(){return crypto.randomUUID()}function gR(t){const e=Math.floor(t/3600),n=Math.floor(t%3600/60);return e>0?`${e}小時${n}分`:n>0?`${n}分鐘`:`${t}秒`}function Cd(t){let e;return t instanceof Date?e=t:e=new Date(t),isNaN(e.getTime())?"無效日期":new Intl.DateTimeFormat("zh-TW",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(e)}function yR(){return[{id:Ke(),name:"白色棉線",brand:"樣本品牌",color:{name:"白色",hex:"#FFFFFF"}},{id:Ke(),name:"粉色棉線",brand:"樣本品牌",color:{name:"粉色",hex:"#FFB3E6"}},{id:Ke(),name:"藍色棉線",brand:"樣本品牌",color:{name:"藍色",hex:"#87CEEB"}}]}function mh(){const t=yR(),e={id:Ke(),roundNumber:1,stitches:[{id:Ke(),type:ss.CHAIN,yarnId:t[0].id,count:4},{id:Ke(),type:ss.SLIP,yarnId:t[0].id,count:1}],stitchGroups:[],notes:"起始魔術環"},n={id:Ke(),roundNumber:2,stitches:[{id:Ke(),type:ss.SINGLE,yarnId:t[0].id,count:8}],stitchGroups:[],notes:"短針增加"},r={id:Ke(),roundNumber:3,stitches:[{id:Ke(),type:ss.SINGLE,yarnId:t[1].id,count:16}],stitchGroups:[],notes:"換色，繼續增加"};return{id:Ke(),name:"範例杯墊",source:"https://www.youtube.com/watch?v=example",pattern:[e,n,r],currentRound:1,currentStitch:0,yarns:t,sessions:[],createdDate:new Date,lastModified:new Date}}function vR(t,e){const n=[],r=t.stitches.map(i=>{var d;const o=e.find(m=>m.id===i.yarnId),l=(o==null?void 0:o.name)||"未知毛線",u=i.count>1?` ×${i.count}`:"";return`${((d=Ot[i.type])==null?void 0:d.rawValue)||i.type}(${l})${u}`});n.push(...r);const s=t.stitchGroups.map(i=>_R(i,e));return n.push(...s),n.join(", ")||"無針法"}function _R(t,e){const n=t.stitches.map(i=>{var d;const o=e.find(m=>m.id===i.yarnId),l=(o==null?void 0:o.name)||"未知毛線",u=i.count>1?` ×${i.count}`:"";return`${((d=Ot[i.type])==null?void 0:d.rawValue)||i.type}(${l})${u}`}),r=t.name||"針目群組",s=t.repeatCount>1?` 重複${t.repeatCount}次`:"";return`[${r}: ${n.join(", ")}]${s}`}function vw(t){return t.stitches.reduce((e,n)=>e+n.count,0)*t.repeatCount}function Gn(t){const e=t.stitches.reduce((r,s)=>r+s.count,0),n=t.stitchGroups.reduce((r,s)=>r+vw(s),0);return e+n}function wu(t){return t.pattern.map(e=>e.roundNumber).reduce((e,n)=>Math.max(e,n),0)}function ia(t){return t.pattern.reduce((e,n)=>e+Gn(n),0)}function np(t){let e=0;for(let n=1;n<t.currentRound;n++){const r=t.pattern.find(s=>s.roundNumber===n);r&&(e+=Gn(r))}return e+=t.currentStitch,e}function Pd(t){const e=ia(t);return e===0?0:np(t)/e}const wR=()=>{};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _w=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},ER=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},ww={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,u=s+2<t.length,c=u?t[s+2]:0,d=i>>2,m=(i&3)<<4|l>>4;let g=(l&15)<<2|c>>6,E=c&63;u||(E=64,o||(g=64)),r.push(n[d],n[m],n[g],n[E])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(_w(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):ER(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const c=s<t.length?n[t.charAt(s)]:64;++s;const m=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||c==null||m==null)throw new xR;const g=i<<2|l>>4;if(r.push(g),c!==64){const E=l<<4&240|c>>2;if(r.push(E),m!==64){const A=c<<6&192|m;r.push(A)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class xR extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const TR=function(t){const e=_w(t);return ww.encodeByteArray(e,!0)},Eu=function(t){return TR(t).replace(/\./g,"")},Ew=function(t){try{return ww.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IR(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SR=()=>IR().__FIREBASE_DEFAULTS__,RR=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},AR=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Ew(t[1]);return e&&JSON.parse(e)},ic=()=>{try{return wR()||SR()||RR()||AR()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},xw=t=>{var e,n;return(n=(e=ic())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},CR=t=>{const e=xw(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},Tw=()=>{var t;return(t=ic())==null?void 0:t.config},Iw=t=>{var e;return(e=ic())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PR{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ni(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Sw(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NR(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t},l="";return[Eu(JSON.stringify(n)),Eu(JSON.stringify(o)),l].join(".")}const Do={};function kR(){const t={prod:[],emulator:[]};for(const e of Object.keys(Do))Do[e]?t.emulator.push(e):t.prod.push(e);return t}function bR(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let gy=!1;function Rw(t,e){if(typeof window>"u"||typeof document>"u"||!Ni(window.location.host)||Do[t]===e||Do[t]||gy)return;Do[t]=e;function n(g){return`__firebase__banner__${g}`}const r="__firebase__banner",i=kR().prod.length>0;function o(){const g=document.getElementById(r);g&&g.remove()}function l(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function u(g,E){g.setAttribute("width","24"),g.setAttribute("id",E),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function c(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{gy=!0,o()},g}function d(g,E){g.setAttribute("id",E),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function m(){const g=bR(r),E=n("text"),A=document.getElementById(E)||document.createElement("span"),C=n("learnmore"),N=document.getElementById(C)||document.createElement("a"),x=n("preprendIcon"),v=document.getElementById(x)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const T=g.element;l(T),d(N,C);const D=c();u(v,x),T.append(v,A,N,D),document.body.appendChild(T)}i?(A.innerText="Preview backend disconnected.",v.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(v.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,A.innerText="Preview backend running in this workspace."),A.setAttribute("id",E)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function DR(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(vt())}function jR(){var e;const t=(e=ic())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function VR(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function OR(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function MR(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function LR(){const t=vt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function FR(){return!jR()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function UR(){try{return typeof indexedDB=="object"}catch{return!1}}function BR(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zR="FirebaseError";class Xn extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=zR,Object.setPrototypeOf(this,Xn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,xa.prototype.create)}}class xa{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?$R(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new Xn(s,l,r)}}function $R(t,e){return t.replace(HR,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const HR=/\{\$([^}]+)}/g;function GR(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function ys(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(yy(i)&&yy(o)){if(!ys(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function yy(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ta(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function WR(t,e){const n=new qR(t,e);return n.subscribe.bind(n)}class qR{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");KR(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=gh),s.error===void 0&&(s.error=gh),s.complete===void 0&&(s.complete=gh);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function KR(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function gh(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ye(t){return t&&t._delegate?t._delegate:t}class vs{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const es="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QR{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new PR;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(JR(e))try{this.getOrInitializeService({instanceIdentifier:es})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=es){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=es){return this.instances.has(e)}getOptions(e=es){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&o.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:YR(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=es){return this.component?this.component.multipleInstances?e:es:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function YR(t){return t===es?void 0:t}function JR(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XR{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new QR(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ie;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ie||(ie={}));const ZR={debug:ie.DEBUG,verbose:ie.VERBOSE,info:ie.INFO,warn:ie.WARN,error:ie.ERROR,silent:ie.SILENT},eA=ie.INFO,tA={[ie.DEBUG]:"log",[ie.VERBOSE]:"log",[ie.INFO]:"info",[ie.WARN]:"warn",[ie.ERROR]:"error"},nA=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=tA[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class rp{constructor(e){this.name=e,this._logLevel=eA,this._logHandler=nA,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ie))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?ZR[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ie.DEBUG,...e),this._logHandler(this,ie.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ie.VERBOSE,...e),this._logHandler(this,ie.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ie.INFO,...e),this._logHandler(this,ie.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ie.WARN,...e),this._logHandler(this,ie.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ie.ERROR,...e),this._logHandler(this,ie.ERROR,...e)}}const rA=(t,e)=>e.some(n=>t instanceof n);let vy,_y;function sA(){return vy||(vy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function iA(){return _y||(_y=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Aw=new WeakMap,Nd=new WeakMap,Cw=new WeakMap,yh=new WeakMap,sp=new WeakMap;function oA(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Sr(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Aw.set(n,t)}).catch(()=>{}),sp.set(e,t),e}function aA(t){if(Nd.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Nd.set(t,e)}let kd={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Nd.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Cw.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Sr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function lA(t){kd=t(kd)}function uA(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(vh(this),e,...n);return Cw.set(r,e.sort?e.sort():[e]),Sr(r)}:iA().includes(t)?function(...e){return t.apply(vh(this),e),Sr(Aw.get(this))}:function(...e){return Sr(t.apply(vh(this),e))}}function cA(t){return typeof t=="function"?uA(t):(t instanceof IDBTransaction&&aA(t),rA(t,sA())?new Proxy(t,kd):t)}function Sr(t){if(t instanceof IDBRequest)return oA(t);if(yh.has(t))return yh.get(t);const e=cA(t);return e!==t&&(yh.set(t,e),sp.set(e,t)),e}const vh=t=>sp.get(t);function hA(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),l=Sr(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Sr(o.result),u.oldVersion,u.newVersion,Sr(o.transaction),u)}),n&&o.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),l.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),l}const dA=["get","getKey","getAll","getAllKeys","count"],fA=["put","add","delete","clear"],_h=new Map;function wy(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(_h.get(e))return _h.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=fA.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||dA.includes(n)))return;const i=async function(o,...l){const u=this.transaction(o,s?"readwrite":"readonly");let c=u.store;return r&&(c=c.index(l.shift())),(await Promise.all([c[n](...l),s&&u.done]))[0]};return _h.set(e,i),i}lA(t=>({...t,get:(e,n,r)=>wy(e,n)||t.get(e,n,r),has:(e,n)=>!!wy(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pA{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(mA(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function mA(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const bd="@firebase/app",Ey="0.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wn=new rp("@firebase/app"),gA="@firebase/app-compat",yA="@firebase/analytics-compat",vA="@firebase/analytics",_A="@firebase/app-check-compat",wA="@firebase/app-check",EA="@firebase/auth",xA="@firebase/auth-compat",TA="@firebase/database",IA="@firebase/data-connect",SA="@firebase/database-compat",RA="@firebase/functions",AA="@firebase/functions-compat",CA="@firebase/installations",PA="@firebase/installations-compat",NA="@firebase/messaging",kA="@firebase/messaging-compat",bA="@firebase/performance",DA="@firebase/performance-compat",jA="@firebase/remote-config",VA="@firebase/remote-config-compat",OA="@firebase/storage",MA="@firebase/storage-compat",LA="@firebase/firestore",FA="@firebase/ai",UA="@firebase/firestore-compat",BA="firebase",zA="12.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dd="[DEFAULT]",$A={[bd]:"fire-core",[gA]:"fire-core-compat",[vA]:"fire-analytics",[yA]:"fire-analytics-compat",[wA]:"fire-app-check",[_A]:"fire-app-check-compat",[EA]:"fire-auth",[xA]:"fire-auth-compat",[TA]:"fire-rtdb",[IA]:"fire-data-connect",[SA]:"fire-rtdb-compat",[RA]:"fire-fn",[AA]:"fire-fn-compat",[CA]:"fire-iid",[PA]:"fire-iid-compat",[NA]:"fire-fcm",[kA]:"fire-fcm-compat",[bA]:"fire-perf",[DA]:"fire-perf-compat",[jA]:"fire-rc",[VA]:"fire-rc-compat",[OA]:"fire-gcs",[MA]:"fire-gcs-compat",[LA]:"fire-fst",[UA]:"fire-fst-compat",[FA]:"fire-vertex","fire-js":"fire-js",[BA]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xu=new Map,HA=new Map,jd=new Map;function xy(t,e){try{t.container.addComponent(e)}catch(n){Wn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function gi(t){const e=t.name;if(jd.has(e))return Wn.debug(`There were multiple attempts to register component ${e}.`),!1;jd.set(e,t);for(const n of xu.values())xy(n,t);for(const n of HA.values())xy(n,t);return!0}function ip(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function sn(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GA={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Rr=new xa("app","Firebase",GA);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WA{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new vs("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Rr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ki=zA;function Pw(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Dd,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw Rr.create("bad-app-name",{appName:String(s)});if(n||(n=Tw()),!n)throw Rr.create("no-options");const i=xu.get(s);if(i){if(ys(n,i.options)&&ys(r,i.config))return i;throw Rr.create("duplicate-app",{appName:s})}const o=new XR(s);for(const u of jd.values())o.addComponent(u);const l=new WA(n,r,o);return xu.set(s,l),l}function Nw(t=Dd){const e=xu.get(t);if(!e&&t===Dd&&Tw())return Pw();if(!e)throw Rr.create("no-app",{appName:t});return e}function Ar(t,e,n){let r=$A[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${r}" with version "${e}":`];s&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Wn.warn(o.join(" "));return}gi(new vs(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qA="firebase-heartbeat-database",KA=1,oa="firebase-heartbeat-store";let wh=null;function kw(){return wh||(wh=hA(qA,KA,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(oa)}catch(n){console.warn(n)}}}}).catch(t=>{throw Rr.create("idb-open",{originalErrorMessage:t.message})})),wh}async function QA(t){try{const n=(await kw()).transaction(oa),r=await n.objectStore(oa).get(bw(t));return await n.done,r}catch(e){if(e instanceof Xn)Wn.warn(e.message);else{const n=Rr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Wn.warn(n.message)}}}async function Ty(t,e){try{const r=(await kw()).transaction(oa,"readwrite");await r.objectStore(oa).put(e,bw(t)),await r.done}catch(n){if(n instanceof Xn)Wn.warn(n.message);else{const r=Rr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Wn.warn(r.message)}}}function bw(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YA=1024,JA=30;class XA{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new eC(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Iy();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>JA){const o=tC(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Wn.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Iy(),{heartbeatsToSend:r,unsentEntries:s}=ZA(this._heartbeatsCache.heartbeats),i=Eu(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Wn.warn(n),""}}}function Iy(){return new Date().toISOString().substring(0,10)}function ZA(t,e=YA){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Sy(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Sy(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class eC{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return UR()?BR().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await QA(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Ty(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Ty(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Sy(t){return Eu(JSON.stringify({version:2,heartbeats:t})).length}function tC(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nC(t){gi(new vs("platform-logger",e=>new pA(e),"PRIVATE")),gi(new vs("heartbeat",e=>new XA(e),"PRIVATE")),Ar(bd,Ey,t),Ar(bd,Ey,"esm2020"),Ar("fire-js","")}nC("");function Dw(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const rC=Dw,jw=new xa("auth","Firebase",Dw());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tu=new rp("@firebase/auth");function sC(t,...e){Tu.logLevel<=ie.WARN&&Tu.warn(`Auth (${ki}): ${t}`,...e)}function Ml(t,...e){Tu.logLevel<=ie.ERROR&&Tu.error(`Auth (${ki}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function In(t,...e){throw ap(t,...e)}function un(t,...e){return ap(t,...e)}function op(t,e,n){const r={...rC(),[e]:n};return new xa("auth","Firebase",r).create(e,{appName:t.name})}function us(t){return op(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function iC(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&In(t,"argument-error"),op(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function ap(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return jw.create(t,...e)}function X(t,e,...n){if(!t)throw ap(e,...n)}function Mn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Ml(e),new Error(e)}function qn(t,e){t||Mn(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vd(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function oC(){return Ry()==="http:"||Ry()==="https:"}function Ry(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aC(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(oC()||OR()||"connection"in navigator)?navigator.onLine:!0}function lC(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ia{constructor(e,n){this.shortDelay=e,this.longDelay=n,qn(n>e,"Short delay should be less than long delay!"),this.isMobile=DR()||MR()}get(){return aC()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lp(t,e){qn(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vw{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Mn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Mn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Mn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uC={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cC=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],hC=new Ia(3e4,6e4);function up(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function bi(t,e,n,r,s={}){return Ow(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const l=Ta({key:t.config.apiKey,...o}).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const c={method:e,headers:u,...i};return VR()||(c.referrerPolicy="no-referrer"),t.emulatorConfig&&Ni(t.emulatorConfig.host)&&(c.credentials="include"),Vw.fetch()(await Mw(t,t.config.apiHost,n,l),c)})}async function Ow(t,e,n){t._canInitEmulator=!1;const r={...uC,...e};try{const s=new fC(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw yl(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[u,c]=l.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw yl(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw yl(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw yl(t,"user-disabled",o);const d=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw op(t,d,c);In(t,d)}}catch(s){if(s instanceof Xn)throw s;In(t,"network-request-failed",{message:String(s)})}}async function dC(t,e,n,r,s={}){const i=await bi(t,e,n,r,s);return"mfaPendingCredential"in i&&In(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function Mw(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?lp(t.config,s):`${t.config.apiScheme}://${s}`;return cC.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}class fC{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(un(this.auth,"network-request-failed")),hC.get())})}}function yl(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=un(t,e,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pC(t,e){return bi(t,"POST","/v1/accounts:delete",e)}async function Iu(t,e){return bi(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jo(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function mC(t,e=!1){const n=Ye(t),r=await n.getIdToken(e),s=cp(r);X(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:jo(Eh(s.auth_time)),issuedAtTime:jo(Eh(s.iat)),expirationTime:jo(Eh(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Eh(t){return Number(t)*1e3}function cp(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Ml("JWT malformed, contained fewer than 3 sections"),null;try{const s=Ew(n);return s?JSON.parse(s):(Ml("Failed to decode base64 JWT payload"),null)}catch(s){return Ml("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Ay(t){const e=cp(t);return X(e,"internal-error"),X(typeof e.exp<"u","internal-error"),X(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aa(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Xn&&gC(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function gC({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yC{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Od{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=jo(this.lastLoginAt),this.creationTime=jo(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Su(t){var m;const e=t.auth,n=await t.getIdToken(),r=await aa(t,Iu(e,{idToken:n}));X(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const i=(m=s.providerUserInfo)!=null&&m.length?Lw(s.providerUserInfo):[],o=_C(t.providerData,i),l=t.isAnonymous,u=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),c=l?u:!1,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Od(s.createdAt,s.lastLoginAt),isAnonymous:c};Object.assign(t,d)}async function vC(t){const e=Ye(t);await Su(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function _C(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function Lw(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wC(t,e){const n=await Ow(t,{},async()=>{const r=Ta({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await Mw(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:l,body:r};return t.emulatorConfig&&Ni(t.emulatorConfig.host)&&(u.credentials="include"),Vw.fetch()(o,u)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function EC(t,e){return bi(t,"POST","/v2/accounts:revokeToken",up(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class si{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){X(e.idToken,"internal-error"),X(typeof e.idToken<"u","internal-error"),X(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Ay(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){X(e.length!==0,"internal-error");const n=Ay(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(X(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await wC(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new si;return r&&(X(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(X(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(X(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new si,this.toJSON())}_performRefresh(){return Mn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sr(t,e){X(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class on{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new yC(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Od(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await aa(this,this.stsTokenManager.getToken(this.auth,e));return X(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return mC(this,e)}reload(){return vC(this)}_assign(e){this!==e&&(X(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new on({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){X(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Su(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(sn(this.auth.app))return Promise.reject(us(this.auth));const e=await this.getIdToken();return await aa(this,pC(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,i=n.phoneNumber??void 0,o=n.photoURL??void 0,l=n.tenantId??void 0,u=n._redirectEventId??void 0,c=n.createdAt??void 0,d=n.lastLoginAt??void 0,{uid:m,emailVerified:g,isAnonymous:E,providerData:A,stsTokenManager:C}=n;X(m&&C,e,"internal-error");const N=si.fromJSON(this.name,C);X(typeof m=="string",e,"internal-error"),sr(r,e.name),sr(s,e.name),X(typeof g=="boolean",e,"internal-error"),X(typeof E=="boolean",e,"internal-error"),sr(i,e.name),sr(o,e.name),sr(l,e.name),sr(u,e.name),sr(c,e.name),sr(d,e.name);const x=new on({uid:m,auth:e,email:s,emailVerified:g,displayName:r,isAnonymous:E,photoURL:o,phoneNumber:i,tenantId:l,stsTokenManager:N,createdAt:c,lastLoginAt:d});return A&&Array.isArray(A)&&(x.providerData=A.map(v=>({...v}))),u&&(x._redirectEventId=u),x}static async _fromIdTokenResponse(e,n,r=!1){const s=new si;s.updateFromServerResponse(n);const i=new on({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Su(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];X(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?Lw(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),l=new si;l.updateFromIdToken(r);const u=new on({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:o}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Od(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(u,c),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cy=new Map;function Ln(t){qn(t instanceof Function,"Expected a class definition");let e=Cy.get(t);return e?(qn(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Cy.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}Fw.type="NONE";const Py=Fw;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ll(t,e,n){return`firebase:${t}:${e}:${n}`}class ii{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Ll(this.userKey,s.apiKey,i),this.fullPersistenceKey=Ll("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Iu(this.auth,{idToken:e}).catch(()=>{});return n?on._fromGetAccountInfoResponse(this.auth,n,e):null}return on._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new ii(Ln(Py),e,r);const s=(await Promise.all(n.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let i=s[0]||Ln(Py);const o=Ll(r,e.config.apiKey,e.name);let l=null;for(const c of n)try{const d=await c._get(o);if(d){let m;if(typeof d=="string"){const g=await Iu(e,{idToken:d}).catch(()=>{});if(!g)break;m=await on._fromGetAccountInfoResponse(e,g,d)}else m=on._fromJSON(e,d);c!==i&&(l=m),i=c;break}}catch{}const u=s.filter(c=>c._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new ii(i,e,r):(i=u[0],l&&await i._set(o,l.toJSON()),await Promise.all(n.map(async c=>{if(c!==i)try{await c._remove(o)}catch{}})),new ii(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ny(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if($w(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Uw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Gw(e))return"Blackberry";if(Ww(e))return"Webos";if(Bw(e))return"Safari";if((e.includes("chrome/")||zw(e))&&!e.includes("edge/"))return"Chrome";if(Hw(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function Uw(t=vt()){return/firefox\//i.test(t)}function Bw(t=vt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function zw(t=vt()){return/crios\//i.test(t)}function $w(t=vt()){return/iemobile/i.test(t)}function Hw(t=vt()){return/android/i.test(t)}function Gw(t=vt()){return/blackberry/i.test(t)}function Ww(t=vt()){return/webos/i.test(t)}function hp(t=vt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function xC(t=vt()){var e;return hp(t)&&!!((e=window.navigator)!=null&&e.standalone)}function TC(){return LR()&&document.documentMode===10}function qw(t=vt()){return hp(t)||Hw(t)||Ww(t)||Gw(t)||/windows phone/i.test(t)||$w(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kw(t,e=[]){let n;switch(t){case"Browser":n=Ny(vt());break;case"Worker":n=`${Ny(vt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${ki}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IC{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,l)=>{try{const u=e(i);o(u)}catch(u){l(u)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SC(t,e={}){return bi(t,"GET","/v2/passwordPolicy",up(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RC=6;class AC{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??RC,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CC{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ky(this),this.idTokenSubscription=new ky(this),this.beforeStateQueue=new IC(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=jw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Ln(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await ii.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Iu(this,{idToken:e}),r=await on._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(sn(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,l=r==null?void 0:r._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===l)&&(u!=null&&u.user)&&(r=u.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return X(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Su(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=lC()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(sn(this.app))return Promise.reject(us(this));const n=e?Ye(e):null;return n&&X(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&X(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return sn(this.app)?Promise.reject(us(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return sn(this.app)?Promise.reject(us(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ln(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await SC(this),n=new AC(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new xa("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await EC(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Ln(e)||this._popupRedirectResolver;X(n,this,"argument-error"),this.redirectPersistenceManager=await ii.create(this,[Ln(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(X(l,this,"internal-error"),l.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const u=e.addObserver(n,r,s);return()=>{o=!0,u()}}else{const u=e.addObserver(n);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return X(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Kw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(sn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&sC(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function oc(t){return Ye(t)}class ky{constructor(e){this.auth=e,this.observer=null,this.addObserver=WR(n=>this.observer=n)}get next(){return X(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dp={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function PC(t){dp=t}function NC(t){return dp.loadJS(t)}function kC(){return dp.gapiScript}function bC(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DC(t,e){const n=ip(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(ys(i,e??{}))return s;In(s,"already-initialized")}return n.initialize({options:e})}function jC(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Ln);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function VC(t,e,n){const r=oc(t);X(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!(n!=null&&n.disableWarnings),i=Qw(e),{host:o,port:l}=OC(e),u=l===null?"":`:${l}`,c={url:`${i}//${o}${u}/`},d=Object.freeze({host:o,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){X(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),X(ys(c,r.config.emulator)&&ys(d,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=c,r.emulatorConfig=d,r.settings.appVerificationDisabledForTesting=!0,Ni(o)?(Sw(`${i}//${o}${u}`),Rw("Auth",!0)):s||MC()}function Qw(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function OC(t){const e=Qw(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:by(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:by(o)}}}function by(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function MC(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yw{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Mn("not implemented")}_getIdTokenResponse(e){return Mn("not implemented")}_linkToIdToken(e,n){return Mn("not implemented")}_getReauthenticationResolver(e){return Mn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oi(t,e){return dC(t,"POST","/v1/accounts:signInWithIdp",up(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LC="http://localhost";class _s extends Yw{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new _s(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):In("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=n;if(!r||!s)return null;const o=new _s(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return oi(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,oi(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,oi(e,n)}buildRequest(){const e={requestUri:LC,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Ta(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fp{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sa extends fp{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ur extends Sa{constructor(){super("facebook.com")}static credential(e){return _s._fromParams({providerId:ur.PROVIDER_ID,signInMethod:ur.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ur.credentialFromTaggedObject(e)}static credentialFromError(e){return ur.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ur.credential(e.oauthAccessToken)}catch{return null}}}ur.FACEBOOK_SIGN_IN_METHOD="facebook.com";ur.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn extends Sa{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return _s._fromParams({providerId:jn.PROVIDER_ID,signInMethod:jn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return jn.credentialFromTaggedObject(e)}static credentialFromError(e){return jn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return jn.credential(n,r)}catch{return null}}}jn.GOOGLE_SIGN_IN_METHOD="google.com";jn.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr extends Sa{constructor(){super("github.com")}static credential(e){return _s._fromParams({providerId:cr.PROVIDER_ID,signInMethod:cr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return cr.credentialFromTaggedObject(e)}static credentialFromError(e){return cr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return cr.credential(e.oauthAccessToken)}catch{return null}}}cr.GITHUB_SIGN_IN_METHOD="github.com";cr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hr extends Sa{constructor(){super("twitter.com")}static credential(e,n){return _s._fromParams({providerId:hr.PROVIDER_ID,signInMethod:hr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return hr.credentialFromTaggedObject(e)}static credentialFromError(e){return hr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return hr.credential(n,r)}catch{return null}}}hr.TWITTER_SIGN_IN_METHOD="twitter.com";hr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yi{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await on._fromIdTokenResponse(e,r,s),o=Dy(r);return new yi({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=Dy(r);return new yi({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function Dy(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ru extends Xn{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Ru.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Ru(e,n,r,s)}}function Jw(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Ru._fromErrorAndOperation(t,i,e,r):i})}async function FC(t,e,n=!1){const r=await aa(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return yi._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UC(t,e,n=!1){const{auth:r}=t;if(sn(r.app))return Promise.reject(us(r));const s="reauthenticate";try{const i=await aa(t,Jw(r,s,e,t),n);X(i.idToken,r,"internal-error");const o=cp(i.idToken);X(o,r,"internal-error");const{sub:l}=o;return X(t.uid===l,r,"user-mismatch"),yi._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&In(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BC(t,e,n=!1){if(sn(t.app))return Promise.reject(us(t));const r="signIn",s=await Jw(t,r,e),i=await yi._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}function zC(t,e,n,r){return Ye(t).onIdTokenChanged(e,n,r)}function $C(t,e,n){return Ye(t).beforeAuthStateChanged(e,n)}function HC(t,e,n,r){return Ye(t).onAuthStateChanged(e,n,r)}function GC(t){return Ye(t).signOut()}const Au="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xw{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Au,"1"),this.storage.removeItem(Au),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WC=1e3,qC=10;class Zw extends Xw{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=qw(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,l,u)=>{this.notifyListeners(o,u)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);TC()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,qC):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},WC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}Zw.type="LOCAL";const KC=Zw;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eE extends Xw{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}eE.type="SESSION";const tE=eE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QC(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ac{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new ac(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(o).map(async c=>c(n.origin,i)),u=await QC(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ac.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pp(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YC{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((l,u)=>{const c=pp("",20);s.port1.start();const d=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(m){const g=m;if(g.data.eventId===c)switch(g.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(g.data.response);break;default:clearTimeout(d),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _n(){return window}function JC(t){_n().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nE(){return typeof _n().WorkerGlobalScope<"u"&&typeof _n().importScripts=="function"}async function XC(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function ZC(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function eP(){return nE()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rE="firebaseLocalStorageDb",tP=1,Cu="firebaseLocalStorage",sE="fbase_key";class Ra{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function lc(t,e){return t.transaction([Cu],e?"readwrite":"readonly").objectStore(Cu)}function nP(){const t=indexedDB.deleteDatabase(rE);return new Ra(t).toPromise()}function Md(){const t=indexedDB.open(rE,tP);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Cu,{keyPath:sE})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Cu)?e(r):(r.close(),await nP(),e(await Md()))})})}async function jy(t,e,n){const r=lc(t,!0).put({[sE]:e,value:n});return new Ra(r).toPromise()}async function rP(t,e){const n=lc(t,!1).get(e),r=await new Ra(n).toPromise();return r===void 0?null:r.value}function Vy(t,e){const n=lc(t,!0).delete(e);return new Ra(n).toPromise()}const sP=800,iP=3;class iE{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Md(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>iP)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return nE()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ac._getInstance(eP()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await XC(),!this.activeServiceWorker)return;this.sender=new YC(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||ZC()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Md();return await jy(e,Au,"1"),await Vy(e,Au),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>jy(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>rP(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Vy(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=lc(s,!1).getAll();return new Ra(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),sP)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}iE.type="LOCAL";const oP=iE;new Ia(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oE(t,e){return e?Ln(e):(X(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mp extends Yw{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return oi(e,this._buildIdpRequest())}_linkToIdToken(e,n){return oi(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return oi(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function aP(t){return BC(t.auth,new mp(t),t.bypassAuthState)}function lP(t){const{auth:e,user:n}=t;return X(n,e,"internal-error"),UC(n,new mp(t),t.bypassAuthState)}async function uP(t){const{auth:e,user:n}=t;return X(n,e,"internal-error"),FC(n,new mp(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aE{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:l}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(u))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return aP;case"linkViaPopup":case"linkViaRedirect":return uP;case"reauthViaPopup":case"reauthViaRedirect":return lP;default:In(this.auth,"internal-error")}}resolve(e){qn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){qn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cP=new Ia(2e3,1e4);async function hP(t,e,n){if(sn(t.app))return Promise.reject(un(t,"operation-not-supported-in-this-environment"));const r=oc(t);iC(t,e,fp);const s=oE(r,n);return new is(r,"signInViaPopup",e,s).executeNotNull()}class is extends aE{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,is.currentPopupAction&&is.currentPopupAction.cancel(),is.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return X(e,this.auth,"internal-error"),e}async onExecution(){qn(this.filter.length===1,"Popup operations only handle one event");const e=pp();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(un(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(un(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,is.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(un(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,cP.get())};e()}}is.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dP="pendingRedirect",Fl=new Map;class fP extends aE{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Fl.get(this.auth._key());if(!e){try{const r=await pP(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Fl.set(this.auth._key(),e)}return this.bypassAuthState||Fl.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function pP(t,e){const n=yP(e),r=gP(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function mP(t,e){Fl.set(t._key(),e)}function gP(t){return Ln(t._redirectPersistence)}function yP(t){return Ll(dP,t.config.apiKey,t.name)}async function vP(t,e,n=!1){if(sn(t.app))return Promise.reject(us(t));const r=oc(t),s=oE(r,e),o=await new fP(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _P=10*60*1e3;class wP{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!EP(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!lE(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(un(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=_P&&this.cachedEventUids.clear(),this.cachedEventUids.has(Oy(e))}saveEventToCache(e){this.cachedEventUids.add(Oy(e)),this.lastProcessedEventTime=Date.now()}}function Oy(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function lE({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function EP(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return lE(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xP(t,e={}){return bi(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TP=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,IP=/^https?/;async function SP(t){if(t.config.emulator)return;const{authorizedDomains:e}=await xP(t);for(const n of e)try{if(RP(n))return}catch{}In(t,"unauthorized-domain")}function RP(t){const e=Vd(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!IP.test(n))return!1;if(TP.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AP=new Ia(3e4,6e4);function My(){const t=_n().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function CP(t){return new Promise((e,n)=>{var s,i,o;function r(){My(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{My(),n(un(t,"network-request-failed"))},timeout:AP.get()})}if((i=(s=_n().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=_n().gapi)!=null&&o.load)r();else{const l=bC("iframefcb");return _n()[l]=()=>{gapi.load?r():n(un(t,"network-request-failed"))},NC(`${kC()}?onload=${l}`).catch(u=>n(u))}}).catch(e=>{throw Ul=null,e})}let Ul=null;function PP(t){return Ul=Ul||CP(t),Ul}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NP=new Ia(5e3,15e3),kP="__/auth/iframe",bP="emulator/auth/iframe",DP={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},jP=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function VP(t){const e=t.config;X(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?lp(e,bP):`https://${t.config.authDomain}/${kP}`,r={apiKey:e.apiKey,appName:t.name,v:ki},s=jP.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Ta(r).slice(1)}`}async function OP(t){const e=await PP(t),n=_n().gapi;return X(n,t,"internal-error"),e.open({where:document.body,url:VP(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:DP,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=un(t,"network-request-failed"),l=_n().setTimeout(()=>{i(o)},NP.get());function u(){_n().clearTimeout(l),s(r)}r.ping(u).then(u,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MP={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},LP=500,FP=600,UP="_blank",BP="http://localhost";class Ly{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function zP(t,e,n,r=LP,s=FP){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const u={...MP,width:r.toString(),height:s.toString(),top:i,left:o},c=vt().toLowerCase();n&&(l=zw(c)?UP:n),Uw(c)&&(e=e||BP,u.scrollbars="yes");const d=Object.entries(u).reduce((g,[E,A])=>`${g}${E}=${A},`,"");if(xC(c)&&l!=="_self")return $P(e||"",l),new Ly(null);const m=window.open(e||"",l,d);X(m,t,"popup-blocked");try{m.focus()}catch{}return new Ly(m)}function $P(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HP="__/auth/handler",GP="emulator/auth/handler",WP=encodeURIComponent("fac");async function Fy(t,e,n,r,s,i){X(t.config.authDomain,t,"auth-domain-config-required"),X(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:ki,eventId:s};if(e instanceof fp){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",GR(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,m]of Object.entries(i||{}))o[d]=m}if(e instanceof Sa){const d=e.getScopes().filter(m=>m!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const d of Object.keys(l))l[d]===void 0&&delete l[d];const u=await t._getAppCheckToken(),c=u?`#${WP}=${encodeURIComponent(u)}`:"";return`${qP(t)}?${Ta(l).slice(1)}${c}`}function qP({config:t}){return t.emulator?lp(t,GP):`https://${t.authDomain}/${HP}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xh="webStorageSupport";class KP{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=tE,this._completeRedirectFn=vP,this._overrideRedirectResult=mP}async _openPopup(e,n,r,s){var o;qn((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await Fy(e,n,r,Vd(),s);return zP(e,i,pp())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await Fy(e,n,r,Vd(),s);return JC(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(qn(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await OP(e),r=new wP(e);return n.register("authEvent",s=>(X(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(xh,{type:xh},s=>{var o;const i=(o=s==null?void 0:s[0])==null?void 0:o[xh];i!==void 0&&n(!!i),In(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=SP(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return qw()||Bw()||hp()}}const QP=KP;var Uy="@firebase/auth",By="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YP{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){X(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JP(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function XP(t){gi(new vs("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;X(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Kw(t)},c=new CC(r,s,i,u);return jC(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),gi(new vs("auth-internal",e=>{const n=oc(e.getProvider("auth").getImmediate());return(r=>new YP(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ar(Uy,By,JP(t)),Ar(Uy,By,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZP=5*60,eN=Iw("authIdTokenMaxAge")||ZP;let zy=null;const tN=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>eN)return;const s=n==null?void 0:n.token;zy!==s&&(zy=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function nN(t=Nw()){const e=ip(t,"auth");if(e.isInitialized())return e.getImmediate();const n=DC(t,{popupRedirectResolver:QP,persistence:[oP,KC,tE]}),r=Iw("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=tN(i.toString());$C(n,o,()=>o(n.currentUser)),zC(n,l=>o(l))}}const s=xw("auth");return s&&VC(n,`http://${s}`),n}function rN(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}PC({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=un("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",rN().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});XP("Browser");var sN="firebase",iN="12.1.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ar(sN,iN,"app");var $y=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Cr,uE;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(I,_){function S(){}S.prototype=_.prototype,I.D=_.prototype,I.prototype=new S,I.prototype.constructor=I,I.C=function(w,P,b){for(var R=Array(arguments.length-2),Ue=2;Ue<arguments.length;Ue++)R[Ue-2]=arguments[Ue];return _.prototype[P].apply(w,R)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(I,_,S){S||(S=0);var w=Array(16);if(typeof _=="string")for(var P=0;16>P;++P)w[P]=_.charCodeAt(S++)|_.charCodeAt(S++)<<8|_.charCodeAt(S++)<<16|_.charCodeAt(S++)<<24;else for(P=0;16>P;++P)w[P]=_[S++]|_[S++]<<8|_[S++]<<16|_[S++]<<24;_=I.g[0],S=I.g[1],P=I.g[2];var b=I.g[3],R=_+(b^S&(P^b))+w[0]+3614090360&4294967295;_=S+(R<<7&4294967295|R>>>25),R=b+(P^_&(S^P))+w[1]+3905402710&4294967295,b=_+(R<<12&4294967295|R>>>20),R=P+(S^b&(_^S))+w[2]+606105819&4294967295,P=b+(R<<17&4294967295|R>>>15),R=S+(_^P&(b^_))+w[3]+3250441966&4294967295,S=P+(R<<22&4294967295|R>>>10),R=_+(b^S&(P^b))+w[4]+4118548399&4294967295,_=S+(R<<7&4294967295|R>>>25),R=b+(P^_&(S^P))+w[5]+1200080426&4294967295,b=_+(R<<12&4294967295|R>>>20),R=P+(S^b&(_^S))+w[6]+2821735955&4294967295,P=b+(R<<17&4294967295|R>>>15),R=S+(_^P&(b^_))+w[7]+4249261313&4294967295,S=P+(R<<22&4294967295|R>>>10),R=_+(b^S&(P^b))+w[8]+1770035416&4294967295,_=S+(R<<7&4294967295|R>>>25),R=b+(P^_&(S^P))+w[9]+2336552879&4294967295,b=_+(R<<12&4294967295|R>>>20),R=P+(S^b&(_^S))+w[10]+4294925233&4294967295,P=b+(R<<17&4294967295|R>>>15),R=S+(_^P&(b^_))+w[11]+2304563134&4294967295,S=P+(R<<22&4294967295|R>>>10),R=_+(b^S&(P^b))+w[12]+1804603682&4294967295,_=S+(R<<7&4294967295|R>>>25),R=b+(P^_&(S^P))+w[13]+4254626195&4294967295,b=_+(R<<12&4294967295|R>>>20),R=P+(S^b&(_^S))+w[14]+2792965006&4294967295,P=b+(R<<17&4294967295|R>>>15),R=S+(_^P&(b^_))+w[15]+1236535329&4294967295,S=P+(R<<22&4294967295|R>>>10),R=_+(P^b&(S^P))+w[1]+4129170786&4294967295,_=S+(R<<5&4294967295|R>>>27),R=b+(S^P&(_^S))+w[6]+3225465664&4294967295,b=_+(R<<9&4294967295|R>>>23),R=P+(_^S&(b^_))+w[11]+643717713&4294967295,P=b+(R<<14&4294967295|R>>>18),R=S+(b^_&(P^b))+w[0]+3921069994&4294967295,S=P+(R<<20&4294967295|R>>>12),R=_+(P^b&(S^P))+w[5]+3593408605&4294967295,_=S+(R<<5&4294967295|R>>>27),R=b+(S^P&(_^S))+w[10]+38016083&4294967295,b=_+(R<<9&4294967295|R>>>23),R=P+(_^S&(b^_))+w[15]+3634488961&4294967295,P=b+(R<<14&4294967295|R>>>18),R=S+(b^_&(P^b))+w[4]+3889429448&4294967295,S=P+(R<<20&4294967295|R>>>12),R=_+(P^b&(S^P))+w[9]+568446438&4294967295,_=S+(R<<5&4294967295|R>>>27),R=b+(S^P&(_^S))+w[14]+3275163606&4294967295,b=_+(R<<9&4294967295|R>>>23),R=P+(_^S&(b^_))+w[3]+4107603335&4294967295,P=b+(R<<14&4294967295|R>>>18),R=S+(b^_&(P^b))+w[8]+1163531501&4294967295,S=P+(R<<20&4294967295|R>>>12),R=_+(P^b&(S^P))+w[13]+2850285829&4294967295,_=S+(R<<5&4294967295|R>>>27),R=b+(S^P&(_^S))+w[2]+4243563512&4294967295,b=_+(R<<9&4294967295|R>>>23),R=P+(_^S&(b^_))+w[7]+1735328473&4294967295,P=b+(R<<14&4294967295|R>>>18),R=S+(b^_&(P^b))+w[12]+2368359562&4294967295,S=P+(R<<20&4294967295|R>>>12),R=_+(S^P^b)+w[5]+4294588738&4294967295,_=S+(R<<4&4294967295|R>>>28),R=b+(_^S^P)+w[8]+2272392833&4294967295,b=_+(R<<11&4294967295|R>>>21),R=P+(b^_^S)+w[11]+1839030562&4294967295,P=b+(R<<16&4294967295|R>>>16),R=S+(P^b^_)+w[14]+4259657740&4294967295,S=P+(R<<23&4294967295|R>>>9),R=_+(S^P^b)+w[1]+2763975236&4294967295,_=S+(R<<4&4294967295|R>>>28),R=b+(_^S^P)+w[4]+1272893353&4294967295,b=_+(R<<11&4294967295|R>>>21),R=P+(b^_^S)+w[7]+4139469664&4294967295,P=b+(R<<16&4294967295|R>>>16),R=S+(P^b^_)+w[10]+3200236656&4294967295,S=P+(R<<23&4294967295|R>>>9),R=_+(S^P^b)+w[13]+681279174&4294967295,_=S+(R<<4&4294967295|R>>>28),R=b+(_^S^P)+w[0]+3936430074&4294967295,b=_+(R<<11&4294967295|R>>>21),R=P+(b^_^S)+w[3]+3572445317&4294967295,P=b+(R<<16&4294967295|R>>>16),R=S+(P^b^_)+w[6]+76029189&4294967295,S=P+(R<<23&4294967295|R>>>9),R=_+(S^P^b)+w[9]+3654602809&4294967295,_=S+(R<<4&4294967295|R>>>28),R=b+(_^S^P)+w[12]+3873151461&4294967295,b=_+(R<<11&4294967295|R>>>21),R=P+(b^_^S)+w[15]+530742520&4294967295,P=b+(R<<16&4294967295|R>>>16),R=S+(P^b^_)+w[2]+3299628645&4294967295,S=P+(R<<23&4294967295|R>>>9),R=_+(P^(S|~b))+w[0]+4096336452&4294967295,_=S+(R<<6&4294967295|R>>>26),R=b+(S^(_|~P))+w[7]+1126891415&4294967295,b=_+(R<<10&4294967295|R>>>22),R=P+(_^(b|~S))+w[14]+2878612391&4294967295,P=b+(R<<15&4294967295|R>>>17),R=S+(b^(P|~_))+w[5]+4237533241&4294967295,S=P+(R<<21&4294967295|R>>>11),R=_+(P^(S|~b))+w[12]+1700485571&4294967295,_=S+(R<<6&4294967295|R>>>26),R=b+(S^(_|~P))+w[3]+2399980690&4294967295,b=_+(R<<10&4294967295|R>>>22),R=P+(_^(b|~S))+w[10]+4293915773&4294967295,P=b+(R<<15&4294967295|R>>>17),R=S+(b^(P|~_))+w[1]+2240044497&4294967295,S=P+(R<<21&4294967295|R>>>11),R=_+(P^(S|~b))+w[8]+1873313359&4294967295,_=S+(R<<6&4294967295|R>>>26),R=b+(S^(_|~P))+w[15]+4264355552&4294967295,b=_+(R<<10&4294967295|R>>>22),R=P+(_^(b|~S))+w[6]+2734768916&4294967295,P=b+(R<<15&4294967295|R>>>17),R=S+(b^(P|~_))+w[13]+1309151649&4294967295,S=P+(R<<21&4294967295|R>>>11),R=_+(P^(S|~b))+w[4]+4149444226&4294967295,_=S+(R<<6&4294967295|R>>>26),R=b+(S^(_|~P))+w[11]+3174756917&4294967295,b=_+(R<<10&4294967295|R>>>22),R=P+(_^(b|~S))+w[2]+718787259&4294967295,P=b+(R<<15&4294967295|R>>>17),R=S+(b^(P|~_))+w[9]+3951481745&4294967295,I.g[0]=I.g[0]+_&4294967295,I.g[1]=I.g[1]+(P+(R<<21&4294967295|R>>>11))&4294967295,I.g[2]=I.g[2]+P&4294967295,I.g[3]=I.g[3]+b&4294967295}r.prototype.u=function(I,_){_===void 0&&(_=I.length);for(var S=_-this.blockSize,w=this.B,P=this.h,b=0;b<_;){if(P==0)for(;b<=S;)s(this,I,b),b+=this.blockSize;if(typeof I=="string"){for(;b<_;)if(w[P++]=I.charCodeAt(b++),P==this.blockSize){s(this,w),P=0;break}}else for(;b<_;)if(w[P++]=I[b++],P==this.blockSize){s(this,w),P=0;break}}this.h=P,this.o+=_},r.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var _=1;_<I.length-8;++_)I[_]=0;var S=8*this.o;for(_=I.length-8;_<I.length;++_)I[_]=S&255,S/=256;for(this.u(I),I=Array(16),_=S=0;4>_;++_)for(var w=0;32>w;w+=8)I[S++]=this.g[_]>>>w&255;return I};function i(I,_){var S=l;return Object.prototype.hasOwnProperty.call(S,I)?S[I]:S[I]=_(I)}function o(I,_){this.h=_;for(var S=[],w=!0,P=I.length-1;0<=P;P--){var b=I[P]|0;w&&b==_||(S[P]=b,w=!1)}this.g=S}var l={};function u(I){return-128<=I&&128>I?i(I,function(_){return new o([_|0],0>_?-1:0)}):new o([I|0],0>I?-1:0)}function c(I){if(isNaN(I)||!isFinite(I))return m;if(0>I)return N(c(-I));for(var _=[],S=1,w=0;I>=S;w++)_[w]=I/S|0,S*=4294967296;return new o(_,0)}function d(I,_){if(I.length==0)throw Error("number format error: empty string");if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(I.charAt(0)=="-")return N(d(I.substring(1),_));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var S=c(Math.pow(_,8)),w=m,P=0;P<I.length;P+=8){var b=Math.min(8,I.length-P),R=parseInt(I.substring(P,P+b),_);8>b?(b=c(Math.pow(_,b)),w=w.j(b).add(c(R))):(w=w.j(S),w=w.add(c(R)))}return w}var m=u(0),g=u(1),E=u(16777216);t=o.prototype,t.m=function(){if(C(this))return-N(this).m();for(var I=0,_=1,S=0;S<this.g.length;S++){var w=this.i(S);I+=(0<=w?w:4294967296+w)*_,_*=4294967296}return I},t.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(A(this))return"0";if(C(this))return"-"+N(this).toString(I);for(var _=c(Math.pow(I,6)),S=this,w="";;){var P=D(S,_).g;S=x(S,P.j(_));var b=((0<S.g.length?S.g[0]:S.h)>>>0).toString(I);if(S=P,A(S))return b+w;for(;6>b.length;)b="0"+b;w=b+w}},t.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function A(I){if(I.h!=0)return!1;for(var _=0;_<I.g.length;_++)if(I.g[_]!=0)return!1;return!0}function C(I){return I.h==-1}t.l=function(I){return I=x(this,I),C(I)?-1:A(I)?0:1};function N(I){for(var _=I.g.length,S=[],w=0;w<_;w++)S[w]=~I.g[w];return new o(S,~I.h).add(g)}t.abs=function(){return C(this)?N(this):this},t.add=function(I){for(var _=Math.max(this.g.length,I.g.length),S=[],w=0,P=0;P<=_;P++){var b=w+(this.i(P)&65535)+(I.i(P)&65535),R=(b>>>16)+(this.i(P)>>>16)+(I.i(P)>>>16);w=R>>>16,b&=65535,R&=65535,S[P]=R<<16|b}return new o(S,S[S.length-1]&-2147483648?-1:0)};function x(I,_){return I.add(N(_))}t.j=function(I){if(A(this)||A(I))return m;if(C(this))return C(I)?N(this).j(N(I)):N(N(this).j(I));if(C(I))return N(this.j(N(I)));if(0>this.l(E)&&0>I.l(E))return c(this.m()*I.m());for(var _=this.g.length+I.g.length,S=[],w=0;w<2*_;w++)S[w]=0;for(w=0;w<this.g.length;w++)for(var P=0;P<I.g.length;P++){var b=this.i(w)>>>16,R=this.i(w)&65535,Ue=I.i(P)>>>16,Gt=I.i(P)&65535;S[2*w+2*P]+=R*Gt,v(S,2*w+2*P),S[2*w+2*P+1]+=b*Gt,v(S,2*w+2*P+1),S[2*w+2*P+1]+=R*Ue,v(S,2*w+2*P+1),S[2*w+2*P+2]+=b*Ue,v(S,2*w+2*P+2)}for(w=0;w<_;w++)S[w]=S[2*w+1]<<16|S[2*w];for(w=_;w<2*_;w++)S[w]=0;return new o(S,0)};function v(I,_){for(;(I[_]&65535)!=I[_];)I[_+1]+=I[_]>>>16,I[_]&=65535,_++}function T(I,_){this.g=I,this.h=_}function D(I,_){if(A(_))throw Error("division by zero");if(A(I))return new T(m,m);if(C(I))return _=D(N(I),_),new T(N(_.g),N(_.h));if(C(_))return _=D(I,N(_)),new T(N(_.g),_.h);if(30<I.g.length){if(C(I)||C(_))throw Error("slowDivide_ only works with positive integers.");for(var S=g,w=_;0>=w.l(I);)S=L(S),w=L(w);var P=B(S,1),b=B(w,1);for(w=B(w,2),S=B(S,2);!A(w);){var R=b.add(w);0>=R.l(I)&&(P=P.add(S),b=R),w=B(w,1),S=B(S,1)}return _=x(I,P.j(_)),new T(P,_)}for(P=m;0<=I.l(_);){for(S=Math.max(1,Math.floor(I.m()/_.m())),w=Math.ceil(Math.log(S)/Math.LN2),w=48>=w?1:Math.pow(2,w-48),b=c(S),R=b.j(_);C(R)||0<R.l(I);)S-=w,b=c(S),R=b.j(_);A(b)&&(b=g),P=P.add(b),I=x(I,R)}return new T(P,I)}t.A=function(I){return D(this,I).h},t.and=function(I){for(var _=Math.max(this.g.length,I.g.length),S=[],w=0;w<_;w++)S[w]=this.i(w)&I.i(w);return new o(S,this.h&I.h)},t.or=function(I){for(var _=Math.max(this.g.length,I.g.length),S=[],w=0;w<_;w++)S[w]=this.i(w)|I.i(w);return new o(S,this.h|I.h)},t.xor=function(I){for(var _=Math.max(this.g.length,I.g.length),S=[],w=0;w<_;w++)S[w]=this.i(w)^I.i(w);return new o(S,this.h^I.h)};function L(I){for(var _=I.g.length+1,S=[],w=0;w<_;w++)S[w]=I.i(w)<<1|I.i(w-1)>>>31;return new o(S,I.h)}function B(I,_){var S=_>>5;_%=32;for(var w=I.g.length-S,P=[],b=0;b<w;b++)P[b]=0<_?I.i(b+S)>>>_|I.i(b+S+1)<<32-_:I.i(b+S);return new o(P,I.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,uE=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=d,Cr=o}).apply(typeof $y<"u"?$y:typeof self<"u"?self:typeof window<"u"?window:{});var vl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var cE,wo,hE,Bl,Ld,dE,fE,pE;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,h,p){return a==Array.prototype||a==Object.prototype||(a[h]=p.value),a};function n(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof vl=="object"&&vl];for(var h=0;h<a.length;++h){var p=a[h];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var r=n(this);function s(a,h){if(h)e:{var p=r;a=a.split(".");for(var y=0;y<a.length-1;y++){var k=a[y];if(!(k in p))break e;p=p[k]}a=a[a.length-1],y=p[a],h=h(y),h!=y&&h!=null&&e(p,a,{configurable:!0,writable:!0,value:h})}}function i(a,h){a instanceof String&&(a+="");var p=0,y=!1,k={next:function(){if(!y&&p<a.length){var j=p++;return{value:h(j,a[j]),done:!1}}return y=!0,{done:!0,value:void 0}}};return k[Symbol.iterator]=function(){return k},k}s("Array.prototype.values",function(a){return a||function(){return i(this,function(h,p){return p})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function u(a){var h=typeof a;return h=h!="object"?h:a?Array.isArray(a)?"array":h:"null",h=="array"||h=="object"&&typeof a.length=="number"}function c(a){var h=typeof a;return h=="object"&&a!=null||h=="function"}function d(a,h,p){return a.call.apply(a.bind,arguments)}function m(a,h,p){if(!a)throw Error();if(2<arguments.length){var y=Array.prototype.slice.call(arguments,2);return function(){var k=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(k,y),a.apply(h,k)}}return function(){return a.apply(h,arguments)}}function g(a,h,p){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:m,g.apply(null,arguments)}function E(a,h){var p=Array.prototype.slice.call(arguments,1);return function(){var y=p.slice();return y.push.apply(y,arguments),a.apply(this,y)}}function A(a,h){function p(){}p.prototype=h.prototype,a.aa=h.prototype,a.prototype=new p,a.prototype.constructor=a,a.Qb=function(y,k,j){for(var z=Array(arguments.length-2),ge=2;ge<arguments.length;ge++)z[ge-2]=arguments[ge];return h.prototype[k].apply(y,z)}}function C(a){const h=a.length;if(0<h){const p=Array(h);for(let y=0;y<h;y++)p[y]=a[y];return p}return[]}function N(a,h){for(let p=1;p<arguments.length;p++){const y=arguments[p];if(u(y)){const k=a.length||0,j=y.length||0;a.length=k+j;for(let z=0;z<j;z++)a[k+z]=y[z]}else a.push(y)}}class x{constructor(h,p){this.i=h,this.j=p,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function v(a){return/^[\s\xa0]*$/.test(a)}function T(){var a=l.navigator;return a&&(a=a.userAgent)?a:""}function D(a){return D[" "](a),a}D[" "]=function(){};var L=T().indexOf("Gecko")!=-1&&!(T().toLowerCase().indexOf("webkit")!=-1&&T().indexOf("Edge")==-1)&&!(T().indexOf("Trident")!=-1||T().indexOf("MSIE")!=-1)&&T().indexOf("Edge")==-1;function B(a,h,p){for(const y in a)h.call(p,a[y],y,a)}function I(a,h){for(const p in a)h.call(void 0,a[p],p,a)}function _(a){const h={};for(const p in a)h[p]=a[p];return h}const S="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function w(a,h){let p,y;for(let k=1;k<arguments.length;k++){y=arguments[k];for(p in y)a[p]=y[p];for(let j=0;j<S.length;j++)p=S[j],Object.prototype.hasOwnProperty.call(y,p)&&(a[p]=y[p])}}function P(a){var h=1;a=a.split(":");const p=[];for(;0<h&&a.length;)p.push(a.shift()),h--;return a.length&&p.push(a.join(":")),p}function b(a){l.setTimeout(()=>{throw a},0)}function R(){var a=$;let h=null;return a.g&&(h=a.g,a.g=a.g.next,a.g||(a.h=null),h.next=null),h}class Ue{constructor(){this.h=this.g=null}add(h,p){const y=Gt.get();y.set(h,p),this.h?this.h.next=y:this.g=y,this.h=y}}var Gt=new x(()=>new jt,a=>a.reset());class jt{constructor(){this.next=this.g=this.h=null}set(h,p){this.h=h,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let Je,H=!1,$=new Ue,q=()=>{const a=l.Promise.resolve(void 0);Je=()=>{a.then(ne)}};var ne=()=>{for(var a;a=R();){try{a.h.call(a.g)}catch(p){b(p)}var h=Gt;h.j(a),100>h.h&&(h.h++,a.next=h.g,h.g=a)}H=!1};function te(){this.s=this.s,this.C=this.C}te.prototype.s=!1,te.prototype.ma=function(){this.s||(this.s=!0,this.N())},te.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function se(a,h){this.type=a,this.g=this.target=h,this.defaultPrevented=!1}se.prototype.h=function(){this.defaultPrevented=!0};var De=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var a=!1,h=Object.defineProperty({},"passive",{get:function(){a=!0}});try{const p=()=>{};l.addEventListener("test",p,h),l.removeEventListener("test",p,h)}catch{}return a}();function Be(a,h){if(se.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var p=this.type=a.type,y=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=h,h=a.relatedTarget){if(L){e:{try{D(h.nodeName);var k=!0;break e}catch{}k=!1}k||(h=null)}}else p=="mouseover"?h=a.fromElement:p=="mouseout"&&(h=a.toElement);this.relatedTarget=h,y?(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:je[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&Be.aa.h.call(this)}}A(Be,se);var je={2:"touch",3:"pen",4:"mouse"};Be.prototype.h=function(){Be.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var Xe="closure_listenable_"+(1e6*Math.random()|0),Zn=0;function Da(a,h,p,y,k){this.listener=a,this.proxy=null,this.src=h,this.type=p,this.capture=!!y,this.ha=k,this.key=++Zn,this.da=this.fa=!1}function Gr(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function Wr(a){this.src=a,this.g={},this.h=0}Wr.prototype.add=function(a,h,p,y,k){var j=a.toString();a=this.g[j],a||(a=this.g[j]=[],this.h++);var z=As(a,h,y,k);return-1<z?(h=a[z],p||(h.fa=!1)):(h=new Da(h,this.src,j,!!y,k),h.fa=p,a.push(h)),h};function Rs(a,h){var p=h.type;if(p in a.g){var y=a.g[p],k=Array.prototype.indexOf.call(y,h,void 0),j;(j=0<=k)&&Array.prototype.splice.call(y,k,1),j&&(Gr(h),a.g[p].length==0&&(delete a.g[p],a.h--))}}function As(a,h,p,y){for(var k=0;k<a.length;++k){var j=a[k];if(!j.da&&j.listener==h&&j.capture==!!p&&j.ha==y)return k}return-1}var Cs="closure_lm_"+(1e6*Math.random()|0),Ps={};function ja(a,h,p,y,k){if(y&&y.once)return Oa(a,h,p,y,k);if(Array.isArray(h)){for(var j=0;j<h.length;j++)ja(a,h[j],p,y,k);return null}return p=Hi(p),a&&a[Xe]?a.K(h,p,c(y)?!!y.capture:!!y,k):Va(a,h,p,!1,y,k)}function Va(a,h,p,y,k,j){if(!h)throw Error("Invalid event type");var z=c(k)?!!k.capture:!!k,ge=zi(a);if(ge||(a[Cs]=ge=new Wr(a)),p=ge.add(h,p,y,z,j),p.proxy)return p;if(y=Ic(),p.proxy=y,y.src=a,y.listener=p,a.addEventListener)De||(k=z),k===void 0&&(k=!1),a.addEventListener(h.toString(),y,k);else if(a.attachEvent)a.attachEvent(Bi(h.toString()),y);else if(a.addListener&&a.removeListener)a.addListener(y);else throw Error("addEventListener and attachEvent are unavailable.");return p}function Ic(){function a(p){return h.call(a.src,a.listener,p)}const h=Sc;return a}function Oa(a,h,p,y,k){if(Array.isArray(h)){for(var j=0;j<h.length;j++)Oa(a,h[j],p,y,k);return null}return p=Hi(p),a&&a[Xe]?a.L(h,p,c(y)?!!y.capture:!!y,k):Va(a,h,p,!0,y,k)}function Ma(a,h,p,y,k){if(Array.isArray(h))for(var j=0;j<h.length;j++)Ma(a,h[j],p,y,k);else y=c(y)?!!y.capture:!!y,p=Hi(p),a&&a[Xe]?(a=a.i,h=String(h).toString(),h in a.g&&(j=a.g[h],p=As(j,p,y,k),-1<p&&(Gr(j[p]),Array.prototype.splice.call(j,p,1),j.length==0&&(delete a.g[h],a.h--)))):a&&(a=zi(a))&&(h=a.g[h.toString()],a=-1,h&&(a=As(h,p,y,k)),(p=-1<a?h[a]:null)&&Ui(p))}function Ui(a){if(typeof a!="number"&&a&&!a.da){var h=a.src;if(h&&h[Xe])Rs(h.i,a);else{var p=a.type,y=a.proxy;h.removeEventListener?h.removeEventListener(p,y,a.capture):h.detachEvent?h.detachEvent(Bi(p),y):h.addListener&&h.removeListener&&h.removeListener(y),(p=zi(h))?(Rs(p,a),p.h==0&&(p.src=null,h[Cs]=null)):Gr(a)}}}function Bi(a){return a in Ps?Ps[a]:Ps[a]="on"+a}function Sc(a,h){if(a.da)a=!0;else{h=new Be(h,this);var p=a.listener,y=a.ha||a.src;a.fa&&Ui(a),a=p.call(y,h)}return a}function zi(a){return a=a[Cs],a instanceof Wr?a:null}var $i="__closure_events_fn_"+(1e9*Math.random()>>>0);function Hi(a){return typeof a=="function"?a:(a[$i]||(a[$i]=function(h){return a.handleEvent(h)}),a[$i])}function Ge(){te.call(this),this.i=new Wr(this),this.M=this,this.F=null}A(Ge,te),Ge.prototype[Xe]=!0,Ge.prototype.removeEventListener=function(a,h,p,y){Ma(this,a,h,p,y)};function Ze(a,h){var p,y=a.F;if(y)for(p=[];y;y=y.F)p.push(y);if(a=a.M,y=h.type||h,typeof h=="string")h=new se(h,a);else if(h instanceof se)h.target=h.target||a;else{var k=h;h=new se(y,a),w(h,k)}if(k=!0,p)for(var j=p.length-1;0<=j;j--){var z=h.g=p[j];k=qr(z,y,!0,h)&&k}if(z=h.g=a,k=qr(z,y,!0,h)&&k,k=qr(z,y,!1,h)&&k,p)for(j=0;j<p.length;j++)z=h.g=p[j],k=qr(z,y,!1,h)&&k}Ge.prototype.N=function(){if(Ge.aa.N.call(this),this.i){var a=this.i,h;for(h in a.g){for(var p=a.g[h],y=0;y<p.length;y++)Gr(p[y]);delete a.g[h],a.h--}}this.F=null},Ge.prototype.K=function(a,h,p,y){return this.i.add(String(a),h,!1,p,y)},Ge.prototype.L=function(a,h,p,y){return this.i.add(String(a),h,!0,p,y)};function qr(a,h,p,y){if(h=a.i.g[String(h)],!h)return!0;h=h.concat();for(var k=!0,j=0;j<h.length;++j){var z=h[j];if(z&&!z.da&&z.capture==p){var ge=z.listener,et=z.ha||z.src;z.fa&&Rs(a.i,z),k=ge.call(et,y)!==!1&&k}}return k&&!y.defaultPrevented}function Gi(a,h,p){if(typeof a=="function")p&&(a=g(a,p));else if(a&&typeof a.handleEvent=="function")a=g(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:l.setTimeout(a,h||0)}function Wi(a){a.g=Gi(()=>{a.g=null,a.i&&(a.i=!1,Wi(a))},a.l);const h=a.h;a.h=null,a.m.apply(null,h)}class W extends te{constructor(h,p){super(),this.m=h,this.l=p,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:Wi(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function F(a){te.call(this),this.h=a,this.g={}}A(F,te);var le=[];function de(a){B(a.g,function(h,p){this.g.hasOwnProperty(p)&&Ui(h)},a),a.g={}}F.prototype.N=function(){F.aa.N.call(this),de(this)},F.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var An=l.JSON.stringify,_t=l.JSON.parse,La=class{stringify(a){return l.JSON.stringify(a,void 0)}parse(a){return l.JSON.parse(a,void 0)}};function Rc(){}Rc.prototype.h=null;function sm(a){return a.h||(a.h=a.i())}function im(){}var qi={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ac(){se.call(this,"d")}A(Ac,se);function Cc(){se.call(this,"c")}A(Cc,se);var Kr={},om=null;function Fa(){return om=om||new Ge}Kr.La="serverreachability";function am(a){se.call(this,Kr.La,a)}A(am,se);function Ki(a){const h=Fa();Ze(h,new am(h))}Kr.STAT_EVENT="statevent";function lm(a,h){se.call(this,Kr.STAT_EVENT,a),this.stat=h}A(lm,se);function wt(a){const h=Fa();Ze(h,new lm(h,a))}Kr.Ma="timingevent";function um(a,h){se.call(this,Kr.Ma,a),this.size=h}A(um,se);function Qi(a,h){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){a()},h)}function Yi(){this.g=!0}Yi.prototype.xa=function(){this.g=!1};function B1(a,h,p,y,k,j){a.info(function(){if(a.g)if(j)for(var z="",ge=j.split("&"),et=0;et<ge.length;et++){var fe=ge[et].split("=");if(1<fe.length){var lt=fe[0];fe=fe[1];var ut=lt.split("_");z=2<=ut.length&&ut[1]=="type"?z+(lt+"="+fe+"&"):z+(lt+"=redacted&")}}else z=null;else z=j;return"XMLHTTP REQ ("+y+") [attempt "+k+"]: "+h+`
`+p+`
`+z})}function z1(a,h,p,y,k,j,z){a.info(function(){return"XMLHTTP RESP ("+y+") [ attempt "+k+"]: "+h+`
`+p+`
`+j+" "+z})}function Ns(a,h,p,y){a.info(function(){return"XMLHTTP TEXT ("+h+"): "+H1(a,p)+(y?" "+y:"")})}function $1(a,h){a.info(function(){return"TIMEOUT: "+h})}Yi.prototype.info=function(){};function H1(a,h){if(!a.g)return h;if(!h)return null;try{var p=JSON.parse(h);if(p){for(a=0;a<p.length;a++)if(Array.isArray(p[a])){var y=p[a];if(!(2>y.length)){var k=y[1];if(Array.isArray(k)&&!(1>k.length)){var j=k[0];if(j!="noop"&&j!="stop"&&j!="close")for(var z=1;z<k.length;z++)k[z]=""}}}}return An(p)}catch{return h}}var Ua={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},cm={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Pc;function Ba(){}A(Ba,Rc),Ba.prototype.g=function(){return new XMLHttpRequest},Ba.prototype.i=function(){return{}},Pc=new Ba;function er(a,h,p,y){this.j=a,this.i=h,this.l=p,this.R=y||1,this.U=new F(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new hm}function hm(){this.i=null,this.g="",this.h=!1}var dm={},Nc={};function kc(a,h,p){a.L=1,a.v=Ga(Cn(h)),a.m=p,a.P=!0,fm(a,null)}function fm(a,h){a.F=Date.now(),za(a),a.A=Cn(a.v);var p=a.A,y=a.R;Array.isArray(y)||(y=[String(y)]),Am(p.i,"t",y),a.C=0,p=a.j.J,a.h=new hm,a.g=Gm(a.j,p?h:null,!a.m),0<a.O&&(a.M=new W(g(a.Y,a,a.g),a.O)),h=a.U,p=a.g,y=a.ca;var k="readystatechange";Array.isArray(k)||(k&&(le[0]=k.toString()),k=le);for(var j=0;j<k.length;j++){var z=ja(p,k[j],y||h.handleEvent,!1,h.h||h);if(!z)break;h.g[z.key]=z}h=a.H?_(a.H):{},a.m?(a.u||(a.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,h)):(a.u="GET",a.g.ea(a.A,a.u,null,h)),Ki(),B1(a.i,a.u,a.A,a.l,a.R,a.m)}er.prototype.ca=function(a){a=a.target;const h=this.M;h&&Pn(a)==3?h.j():this.Y(a)},er.prototype.Y=function(a){try{if(a==this.g)e:{const ut=Pn(this.g);var h=this.g.Ba();const Ds=this.g.Z();if(!(3>ut)&&(ut!=3||this.g&&(this.h.h||this.g.oa()||jm(this.g)))){this.J||ut!=4||h==7||(h==8||0>=Ds?Ki(3):Ki(2)),bc(this);var p=this.g.Z();this.X=p;t:if(pm(this)){var y=jm(this.g);a="";var k=y.length,j=Pn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Qr(this),Ji(this);var z="";break t}this.h.i=new l.TextDecoder}for(h=0;h<k;h++)this.h.h=!0,a+=this.h.i.decode(y[h],{stream:!(j&&h==k-1)});y.length=0,this.h.g+=a,this.C=0,z=this.h.g}else z=this.g.oa();if(this.o=p==200,z1(this.i,this.u,this.A,this.l,this.R,ut,p),this.o){if(this.T&&!this.K){t:{if(this.g){var ge,et=this.g;if((ge=et.g?et.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!v(ge)){var fe=ge;break t}}fe=null}if(p=fe)Ns(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Dc(this,p);else{this.o=!1,this.s=3,wt(12),Qr(this),Ji(this);break e}}if(this.P){p=!0;let Zt;for(;!this.J&&this.C<z.length;)if(Zt=G1(this,z),Zt==Nc){ut==4&&(this.s=4,wt(14),p=!1),Ns(this.i,this.l,null,"[Incomplete Response]");break}else if(Zt==dm){this.s=4,wt(15),Ns(this.i,this.l,z,"[Invalid Chunk]"),p=!1;break}else Ns(this.i,this.l,Zt,null),Dc(this,Zt);if(pm(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ut!=4||z.length!=0||this.h.h||(this.s=1,wt(16),p=!1),this.o=this.o&&p,!p)Ns(this.i,this.l,z,"[Invalid Chunked Response]"),Qr(this),Ji(this);else if(0<z.length&&!this.W){this.W=!0;var lt=this.j;lt.g==this&&lt.ba&&!lt.M&&(lt.j.info("Great, no buffering proxy detected. Bytes received: "+z.length),Fc(lt),lt.M=!0,wt(11))}}else Ns(this.i,this.l,z,null),Dc(this,z);ut==4&&Qr(this),this.o&&!this.J&&(ut==4?Bm(this.j,this):(this.o=!1,za(this)))}else lx(this.g),p==400&&0<z.indexOf("Unknown SID")?(this.s=3,wt(12)):(this.s=0,wt(13)),Qr(this),Ji(this)}}}catch{}finally{}};function pm(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function G1(a,h){var p=a.C,y=h.indexOf(`
`,p);return y==-1?Nc:(p=Number(h.substring(p,y)),isNaN(p)?dm:(y+=1,y+p>h.length?Nc:(h=h.slice(y,y+p),a.C=y+p,h)))}er.prototype.cancel=function(){this.J=!0,Qr(this)};function za(a){a.S=Date.now()+a.I,mm(a,a.I)}function mm(a,h){if(a.B!=null)throw Error("WatchDog timer not null");a.B=Qi(g(a.ba,a),h)}function bc(a){a.B&&(l.clearTimeout(a.B),a.B=null)}er.prototype.ba=function(){this.B=null;const a=Date.now();0<=a-this.S?($1(this.i,this.A),this.L!=2&&(Ki(),wt(17)),Qr(this),this.s=2,Ji(this)):mm(this,this.S-a)};function Ji(a){a.j.G==0||a.J||Bm(a.j,a)}function Qr(a){bc(a);var h=a.M;h&&typeof h.ma=="function"&&h.ma(),a.M=null,de(a.U),a.g&&(h=a.g,a.g=null,h.abort(),h.ma())}function Dc(a,h){try{var p=a.j;if(p.G!=0&&(p.g==a||jc(p.h,a))){if(!a.K&&jc(p.h,a)&&p.G==3){try{var y=p.Da.g.parse(h)}catch{y=null}if(Array.isArray(y)&&y.length==3){var k=y;if(k[0]==0){e:if(!p.u){if(p.g)if(p.g.F+3e3<a.F)Ja(p),Qa(p);else break e;Lc(p),wt(18)}}else p.za=k[1],0<p.za-p.T&&37500>k[2]&&p.F&&p.v==0&&!p.C&&(p.C=Qi(g(p.Za,p),6e3));if(1>=vm(p.h)&&p.ca){try{p.ca()}catch{}p.ca=void 0}}else Jr(p,11)}else if((a.K||p.g==a)&&Ja(p),!v(h))for(k=p.Da.g.parse(h),h=0;h<k.length;h++){let fe=k[h];if(p.T=fe[0],fe=fe[1],p.G==2)if(fe[0]=="c"){p.K=fe[1],p.ia=fe[2];const lt=fe[3];lt!=null&&(p.la=lt,p.j.info("VER="+p.la));const ut=fe[4];ut!=null&&(p.Aa=ut,p.j.info("SVER="+p.Aa));const Ds=fe[5];Ds!=null&&typeof Ds=="number"&&0<Ds&&(y=1.5*Ds,p.L=y,p.j.info("backChannelRequestTimeoutMs_="+y)),y=p;const Zt=a.g;if(Zt){const Za=Zt.g?Zt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Za){var j=y.h;j.g||Za.indexOf("spdy")==-1&&Za.indexOf("quic")==-1&&Za.indexOf("h2")==-1||(j.j=j.l,j.g=new Set,j.h&&(Vc(j,j.h),j.h=null))}if(y.D){const Uc=Zt.g?Zt.g.getResponseHeader("X-HTTP-Session-Id"):null;Uc&&(y.ya=Uc,_e(y.I,y.D,Uc))}}p.G=3,p.l&&p.l.ua(),p.ba&&(p.R=Date.now()-a.F,p.j.info("Handshake RTT: "+p.R+"ms")),y=p;var z=a;if(y.qa=Hm(y,y.J?y.ia:null,y.W),z.K){_m(y.h,z);var ge=z,et=y.L;et&&(ge.I=et),ge.B&&(bc(ge),za(ge)),y.g=z}else Fm(y);0<p.i.length&&Ya(p)}else fe[0]!="stop"&&fe[0]!="close"||Jr(p,7);else p.G==3&&(fe[0]=="stop"||fe[0]=="close"?fe[0]=="stop"?Jr(p,7):Mc(p):fe[0]!="noop"&&p.l&&p.l.ta(fe),p.v=0)}}Ki(4)}catch{}}var W1=class{constructor(a,h){this.g=a,this.map=h}};function gm(a){this.l=a||10,l.PerformanceNavigationTiming?(a=l.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ym(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function vm(a){return a.h?1:a.g?a.g.size:0}function jc(a,h){return a.h?a.h==h:a.g?a.g.has(h):!1}function Vc(a,h){a.g?a.g.add(h):a.h=h}function _m(a,h){a.h&&a.h==h?a.h=null:a.g&&a.g.has(h)&&a.g.delete(h)}gm.prototype.cancel=function(){if(this.i=wm(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const a of this.g.values())a.cancel();this.g.clear()}};function wm(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let h=a.i;for(const p of a.g.values())h=h.concat(p.D);return h}return C(a.i)}function q1(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(u(a)){for(var h=[],p=a.length,y=0;y<p;y++)h.push(a[y]);return h}h=[],p=0;for(y in a)h[p++]=a[y];return h}function K1(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(u(a)||typeof a=="string"){var h=[];a=a.length;for(var p=0;p<a;p++)h.push(p);return h}h=[],p=0;for(const y in a)h[p++]=y;return h}}}function Em(a,h){if(a.forEach&&typeof a.forEach=="function")a.forEach(h,void 0);else if(u(a)||typeof a=="string")Array.prototype.forEach.call(a,h,void 0);else for(var p=K1(a),y=q1(a),k=y.length,j=0;j<k;j++)h.call(void 0,y[j],p&&p[j],a)}var xm=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Q1(a,h){if(a){a=a.split("&");for(var p=0;p<a.length;p++){var y=a[p].indexOf("="),k=null;if(0<=y){var j=a[p].substring(0,y);k=a[p].substring(y+1)}else j=a[p];h(j,k?decodeURIComponent(k.replace(/\+/g," ")):"")}}}function Yr(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof Yr){this.h=a.h,$a(this,a.j),this.o=a.o,this.g=a.g,Ha(this,a.s),this.l=a.l;var h=a.i,p=new eo;p.i=h.i,h.g&&(p.g=new Map(h.g),p.h=h.h),Tm(this,p),this.m=a.m}else a&&(h=String(a).match(xm))?(this.h=!1,$a(this,h[1]||"",!0),this.o=Xi(h[2]||""),this.g=Xi(h[3]||"",!0),Ha(this,h[4]),this.l=Xi(h[5]||"",!0),Tm(this,h[6]||"",!0),this.m=Xi(h[7]||"")):(this.h=!1,this.i=new eo(null,this.h))}Yr.prototype.toString=function(){var a=[],h=this.j;h&&a.push(Zi(h,Im,!0),":");var p=this.g;return(p||h=="file")&&(a.push("//"),(h=this.o)&&a.push(Zi(h,Im,!0),"@"),a.push(encodeURIComponent(String(p)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.s,p!=null&&a.push(":",String(p))),(p=this.l)&&(this.g&&p.charAt(0)!="/"&&a.push("/"),a.push(Zi(p,p.charAt(0)=="/"?X1:J1,!0))),(p=this.i.toString())&&a.push("?",p),(p=this.m)&&a.push("#",Zi(p,ex)),a.join("")};function Cn(a){return new Yr(a)}function $a(a,h,p){a.j=p?Xi(h,!0):h,a.j&&(a.j=a.j.replace(/:$/,""))}function Ha(a,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);a.s=h}else a.s=null}function Tm(a,h,p){h instanceof eo?(a.i=h,tx(a.i,a.h)):(p||(h=Zi(h,Z1)),a.i=new eo(h,a.h))}function _e(a,h,p){a.i.set(h,p)}function Ga(a){return _e(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function Xi(a,h){return a?h?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function Zi(a,h,p){return typeof a=="string"?(a=encodeURI(a).replace(h,Y1),p&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function Y1(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Im=/[#\/\?@]/g,J1=/[#\?:]/g,X1=/[#\?]/g,Z1=/[#\?@]/g,ex=/#/g;function eo(a,h){this.h=this.g=null,this.i=a||null,this.j=!!h}function tr(a){a.g||(a.g=new Map,a.h=0,a.i&&Q1(a.i,function(h,p){a.add(decodeURIComponent(h.replace(/\+/g," ")),p)}))}t=eo.prototype,t.add=function(a,h){tr(this),this.i=null,a=ks(this,a);var p=this.g.get(a);return p||this.g.set(a,p=[]),p.push(h),this.h+=1,this};function Sm(a,h){tr(a),h=ks(a,h),a.g.has(h)&&(a.i=null,a.h-=a.g.get(h).length,a.g.delete(h))}function Rm(a,h){return tr(a),h=ks(a,h),a.g.has(h)}t.forEach=function(a,h){tr(this),this.g.forEach(function(p,y){p.forEach(function(k){a.call(h,k,y,this)},this)},this)},t.na=function(){tr(this);const a=Array.from(this.g.values()),h=Array.from(this.g.keys()),p=[];for(let y=0;y<h.length;y++){const k=a[y];for(let j=0;j<k.length;j++)p.push(h[y])}return p},t.V=function(a){tr(this);let h=[];if(typeof a=="string")Rm(this,a)&&(h=h.concat(this.g.get(ks(this,a))));else{a=Array.from(this.g.values());for(let p=0;p<a.length;p++)h=h.concat(a[p])}return h},t.set=function(a,h){return tr(this),this.i=null,a=ks(this,a),Rm(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[h]),this.h+=1,this},t.get=function(a,h){return a?(a=this.V(a),0<a.length?String(a[0]):h):h};function Am(a,h,p){Sm(a,h),0<p.length&&(a.i=null,a.g.set(ks(a,h),C(p)),a.h+=p.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const a=[],h=Array.from(this.g.keys());for(var p=0;p<h.length;p++){var y=h[p];const j=encodeURIComponent(String(y)),z=this.V(y);for(y=0;y<z.length;y++){var k=j;z[y]!==""&&(k+="="+encodeURIComponent(String(z[y]))),a.push(k)}}return this.i=a.join("&")};function ks(a,h){return h=String(h),a.j&&(h=h.toLowerCase()),h}function tx(a,h){h&&!a.j&&(tr(a),a.i=null,a.g.forEach(function(p,y){var k=y.toLowerCase();y!=k&&(Sm(this,y),Am(this,k,p))},a)),a.j=h}function nx(a,h){const p=new Yi;if(l.Image){const y=new Image;y.onload=E(nr,p,"TestLoadImage: loaded",!0,h,y),y.onerror=E(nr,p,"TestLoadImage: error",!1,h,y),y.onabort=E(nr,p,"TestLoadImage: abort",!1,h,y),y.ontimeout=E(nr,p,"TestLoadImage: timeout",!1,h,y),l.setTimeout(function(){y.ontimeout&&y.ontimeout()},1e4),y.src=a}else h(!1)}function rx(a,h){const p=new Yi,y=new AbortController,k=setTimeout(()=>{y.abort(),nr(p,"TestPingServer: timeout",!1,h)},1e4);fetch(a,{signal:y.signal}).then(j=>{clearTimeout(k),j.ok?nr(p,"TestPingServer: ok",!0,h):nr(p,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(k),nr(p,"TestPingServer: error",!1,h)})}function nr(a,h,p,y,k){try{k&&(k.onload=null,k.onerror=null,k.onabort=null,k.ontimeout=null),y(p)}catch{}}function sx(){this.g=new La}function ix(a,h,p){const y=p||"";try{Em(a,function(k,j){let z=k;c(k)&&(z=An(k)),h.push(y+j+"="+encodeURIComponent(z))})}catch(k){throw h.push(y+"type="+encodeURIComponent("_badmap")),k}}function Wa(a){this.l=a.Ub||null,this.j=a.eb||!1}A(Wa,Rc),Wa.prototype.g=function(){return new qa(this.l,this.j)},Wa.prototype.i=function(a){return function(){return a}}({});function qa(a,h){Ge.call(this),this.D=a,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}A(qa,Ge),t=qa.prototype,t.open=function(a,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=h,this.readyState=1,no(this)},t.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(h.body=a),(this.D||l).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,to(this)),this.readyState=0},t.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,no(this)),this.g&&(this.readyState=3,no(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Cm(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function Cm(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}t.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var h=a.value?a.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!a.done}))&&(this.response=this.responseText+=h)}a.done?to(this):no(this),this.readyState==3&&Cm(this)}},t.Ra=function(a){this.g&&(this.response=this.responseText=a,to(this))},t.Qa=function(a){this.g&&(this.response=a,to(this))},t.ga=function(){this.g&&to(this)};function to(a){a.readyState=4,a.l=null,a.j=null,a.v=null,no(a)}t.setRequestHeader=function(a,h){this.u.append(a,h)},t.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const a=[],h=this.h.entries();for(var p=h.next();!p.done;)p=p.value,a.push(p[0]+": "+p[1]),p=h.next();return a.join(`\r
`)};function no(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(qa.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function Pm(a){let h="";return B(a,function(p,y){h+=y,h+=":",h+=p,h+=`\r
`}),h}function Oc(a,h,p){e:{for(y in p){var y=!1;break e}y=!0}y||(p=Pm(p),typeof a=="string"?p!=null&&encodeURIComponent(String(p)):_e(a,h,p))}function Ae(a){Ge.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}A(Ae,Ge);var ox=/^https?$/i,ax=["POST","PUT"];t=Ae.prototype,t.Ha=function(a){this.J=a},t.ea=function(a,h,p,y){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);h=h?h.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Pc.g(),this.v=this.o?sm(this.o):sm(Pc),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(h,String(a),!0),this.B=!1}catch(j){Nm(this,j);return}if(a=p||"",p=new Map(this.headers),y)if(Object.getPrototypeOf(y)===Object.prototype)for(var k in y)p.set(k,y[k]);else if(typeof y.keys=="function"&&typeof y.get=="function")for(const j of y.keys())p.set(j,y.get(j));else throw Error("Unknown input type for opt_headers: "+String(y));y=Array.from(p.keys()).find(j=>j.toLowerCase()=="content-type"),k=l.FormData&&a instanceof l.FormData,!(0<=Array.prototype.indexOf.call(ax,h,void 0))||y||k||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[j,z]of p)this.g.setRequestHeader(j,z);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Dm(this),this.u=!0,this.g.send(a),this.u=!1}catch(j){Nm(this,j)}};function Nm(a,h){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=h,a.m=5,km(a),Ka(a)}function km(a){a.A||(a.A=!0,Ze(a,"complete"),Ze(a,"error"))}t.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,Ze(this,"complete"),Ze(this,"abort"),Ka(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ka(this,!0)),Ae.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?bm(this):this.bb())},t.bb=function(){bm(this)};function bm(a){if(a.h&&typeof o<"u"&&(!a.v[1]||Pn(a)!=4||a.Z()!=2)){if(a.u&&Pn(a)==4)Gi(a.Ea,0,a);else if(Ze(a,"readystatechange"),Pn(a)==4){a.h=!1;try{const z=a.Z();e:switch(z){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var p;if(!(p=h)){var y;if(y=z===0){var k=String(a.D).match(xm)[1]||null;!k&&l.self&&l.self.location&&(k=l.self.location.protocol.slice(0,-1)),y=!ox.test(k?k.toLowerCase():"")}p=y}if(p)Ze(a,"complete"),Ze(a,"success");else{a.m=6;try{var j=2<Pn(a)?a.g.statusText:""}catch{j=""}a.l=j+" ["+a.Z()+"]",km(a)}}finally{Ka(a)}}}}function Ka(a,h){if(a.g){Dm(a);const p=a.g,y=a.v[0]?()=>{}:null;a.g=null,a.v=null,h||Ze(a,"ready");try{p.onreadystatechange=y}catch{}}}function Dm(a){a.I&&(l.clearTimeout(a.I),a.I=null)}t.isActive=function(){return!!this.g};function Pn(a){return a.g?a.g.readyState:0}t.Z=function(){try{return 2<Pn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(a){if(this.g){var h=this.g.responseText;return a&&h.indexOf(a)==0&&(h=h.substring(a.length)),_t(h)}};function jm(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function lx(a){const h={};a=(a.g&&2<=Pn(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let y=0;y<a.length;y++){if(v(a[y]))continue;var p=P(a[y]);const k=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();const j=h[k]||[];h[k]=j,j.push(p)}I(h,function(y){return y.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ro(a,h,p){return p&&p.internalChannelParams&&p.internalChannelParams[a]||h}function Vm(a){this.Aa=0,this.i=[],this.j=new Yi,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ro("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ro("baseRetryDelayMs",5e3,a),this.cb=ro("retryDelaySeedMs",1e4,a),this.Wa=ro("forwardChannelMaxRetries",2,a),this.wa=ro("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new gm(a&&a.concurrentRequestLimit),this.Da=new sx,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Vm.prototype,t.la=8,t.G=1,t.connect=function(a,h,p,y){wt(0),this.W=a,this.H=h||{},p&&y!==void 0&&(this.H.OSID=p,this.H.OAID=y),this.F=this.X,this.I=Hm(this,null,this.W),Ya(this)};function Mc(a){if(Om(a),a.G==3){var h=a.U++,p=Cn(a.I);if(_e(p,"SID",a.K),_e(p,"RID",h),_e(p,"TYPE","terminate"),so(a,p),h=new er(a,a.j,h),h.L=2,h.v=Ga(Cn(p)),p=!1,l.navigator&&l.navigator.sendBeacon)try{p=l.navigator.sendBeacon(h.v.toString(),"")}catch{}!p&&l.Image&&(new Image().src=h.v,p=!0),p||(h.g=Gm(h.j,null),h.g.ea(h.v)),h.F=Date.now(),za(h)}$m(a)}function Qa(a){a.g&&(Fc(a),a.g.cancel(),a.g=null)}function Om(a){Qa(a),a.u&&(l.clearTimeout(a.u),a.u=null),Ja(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&l.clearTimeout(a.s),a.s=null)}function Ya(a){if(!ym(a.h)&&!a.s){a.s=!0;var h=a.Ga;Je||q(),H||(Je(),H=!0),$.add(h,a),a.B=0}}function ux(a,h){return vm(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=h.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=Qi(g(a.Ga,a,h),zm(a,a.B)),a.B++,!0)}t.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;const k=new er(this,this.j,a);let j=this.o;if(this.S&&(j?(j=_(j),w(j,this.S)):j=this.S),this.m!==null||this.O||(k.H=j,j=null),this.P)e:{for(var h=0,p=0;p<this.i.length;p++){t:{var y=this.i[p];if("__data__"in y.map&&(y=y.map.__data__,typeof y=="string")){y=y.length;break t}y=void 0}if(y===void 0)break;if(h+=y,4096<h){h=p;break e}if(h===4096||p===this.i.length-1){h=p+1;break e}}h=1e3}else h=1e3;h=Lm(this,k,h),p=Cn(this.I),_e(p,"RID",a),_e(p,"CVER",22),this.D&&_e(p,"X-HTTP-Session-Id",this.D),so(this,p),j&&(this.O?h="headers="+encodeURIComponent(String(Pm(j)))+"&"+h:this.m&&Oc(p,this.m,j)),Vc(this.h,k),this.Ua&&_e(p,"TYPE","init"),this.P?(_e(p,"$req",h),_e(p,"SID","null"),k.T=!0,kc(k,p,null)):kc(k,p,h),this.G=2}}else this.G==3&&(a?Mm(this,a):this.i.length==0||ym(this.h)||Mm(this))};function Mm(a,h){var p;h?p=h.l:p=a.U++;const y=Cn(a.I);_e(y,"SID",a.K),_e(y,"RID",p),_e(y,"AID",a.T),so(a,y),a.m&&a.o&&Oc(y,a.m,a.o),p=new er(a,a.j,p,a.B+1),a.m===null&&(p.H=a.o),h&&(a.i=h.D.concat(a.i)),h=Lm(a,p,1e3),p.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),Vc(a.h,p),kc(p,y,h)}function so(a,h){a.H&&B(a.H,function(p,y){_e(h,y,p)}),a.l&&Em({},function(p,y){_e(h,y,p)})}function Lm(a,h,p){p=Math.min(a.i.length,p);var y=a.l?g(a.l.Na,a.l,a):null;e:{var k=a.i;let j=-1;for(;;){const z=["count="+p];j==-1?0<p?(j=k[0].g,z.push("ofs="+j)):j=0:z.push("ofs="+j);let ge=!0;for(let et=0;et<p;et++){let fe=k[et].g;const lt=k[et].map;if(fe-=j,0>fe)j=Math.max(0,k[et].g-100),ge=!1;else try{ix(lt,z,"req"+fe+"_")}catch{y&&y(lt)}}if(ge){y=z.join("&");break e}}}return a=a.i.splice(0,p),h.D=a,y}function Fm(a){if(!a.g&&!a.u){a.Y=1;var h=a.Fa;Je||q(),H||(Je(),H=!0),$.add(h,a),a.v=0}}function Lc(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=Qi(g(a.Fa,a),zm(a,a.v)),a.v++,!0)}t.Fa=function(){if(this.u=null,Um(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=Qi(g(this.ab,this),a)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,wt(10),Qa(this),Um(this))};function Fc(a){a.A!=null&&(l.clearTimeout(a.A),a.A=null)}function Um(a){a.g=new er(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var h=Cn(a.qa);_e(h,"RID","rpc"),_e(h,"SID",a.K),_e(h,"AID",a.T),_e(h,"CI",a.F?"0":"1"),!a.F&&a.ja&&_e(h,"TO",a.ja),_e(h,"TYPE","xmlhttp"),so(a,h),a.m&&a.o&&Oc(h,a.m,a.o),a.L&&(a.g.I=a.L);var p=a.g;a=a.ia,p.L=1,p.v=Ga(Cn(h)),p.m=null,p.P=!0,fm(p,a)}t.Za=function(){this.C!=null&&(this.C=null,Qa(this),Lc(this),wt(19))};function Ja(a){a.C!=null&&(l.clearTimeout(a.C),a.C=null)}function Bm(a,h){var p=null;if(a.g==h){Ja(a),Fc(a),a.g=null;var y=2}else if(jc(a.h,h))p=h.D,_m(a.h,h),y=1;else return;if(a.G!=0){if(h.o)if(y==1){p=h.m?h.m.length:0,h=Date.now()-h.F;var k=a.B;y=Fa(),Ze(y,new um(y,p)),Ya(a)}else Fm(a);else if(k=h.s,k==3||k==0&&0<h.X||!(y==1&&ux(a,h)||y==2&&Lc(a)))switch(p&&0<p.length&&(h=a.h,h.i=h.i.concat(p)),k){case 1:Jr(a,5);break;case 4:Jr(a,10);break;case 3:Jr(a,6);break;default:Jr(a,2)}}}function zm(a,h){let p=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(p*=2),p*h}function Jr(a,h){if(a.j.info("Error code "+h),h==2){var p=g(a.fb,a),y=a.Xa;const k=!y;y=new Yr(y||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||$a(y,"https"),Ga(y),k?nx(y.toString(),p):rx(y.toString(),p)}else wt(2);a.G=0,a.l&&a.l.sa(h),$m(a),Om(a)}t.fb=function(a){a?(this.j.info("Successfully pinged google.com"),wt(2)):(this.j.info("Failed to ping google.com"),wt(1))};function $m(a){if(a.G=0,a.ka=[],a.l){const h=wm(a.h);(h.length!=0||a.i.length!=0)&&(N(a.ka,h),N(a.ka,a.i),a.h.i.length=0,C(a.i),a.i.length=0),a.l.ra()}}function Hm(a,h,p){var y=p instanceof Yr?Cn(p):new Yr(p);if(y.g!="")h&&(y.g=h+"."+y.g),Ha(y,y.s);else{var k=l.location;y=k.protocol,h=h?h+"."+k.hostname:k.hostname,k=+k.port;var j=new Yr(null);y&&$a(j,y),h&&(j.g=h),k&&Ha(j,k),p&&(j.l=p),y=j}return p=a.D,h=a.ya,p&&h&&_e(y,p,h),_e(y,"VER",a.la),so(a,y),y}function Gm(a,h,p){if(h&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=a.Ca&&!a.pa?new Ae(new Wa({eb:p})):new Ae(a.pa),h.Ha(a.J),h}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Wm(){}t=Wm.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Xa(){}Xa.prototype.g=function(a,h){return new Vt(a,h)};function Vt(a,h){Ge.call(this),this.g=new Vm(h),this.l=a,this.h=h&&h.messageUrlParams||null,a=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(a?a["X-WebChannel-Content-Type"]=h.messageContentType:a={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(a?a["X-WebChannel-Client-Profile"]=h.va:a={"X-WebChannel-Client-Profile":h.va}),this.g.S=a,(a=h&&h.Sb)&&!v(a)&&(this.g.m=a),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!v(h)&&(this.g.D=h,a=this.h,a!==null&&h in a&&(a=this.h,h in a&&delete a[h])),this.j=new bs(this)}A(Vt,Ge),Vt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Vt.prototype.close=function(){Mc(this.g)},Vt.prototype.o=function(a){var h=this.g;if(typeof a=="string"){var p={};p.__data__=a,a=p}else this.u&&(p={},p.__data__=An(a),a=p);h.i.push(new W1(h.Ya++,a)),h.G==3&&Ya(h)},Vt.prototype.N=function(){this.g.l=null,delete this.j,Mc(this.g),delete this.g,Vt.aa.N.call(this)};function qm(a){Ac.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var h=a.__sm__;if(h){e:{for(const p in h){a=p;break e}a=void 0}(this.i=a)&&(a=this.i,h=h!==null&&a in h?h[a]:void 0),this.data=h}else this.data=a}A(qm,Ac);function Km(){Cc.call(this),this.status=1}A(Km,Cc);function bs(a){this.g=a}A(bs,Wm),bs.prototype.ua=function(){Ze(this.g,"a")},bs.prototype.ta=function(a){Ze(this.g,new qm(a))},bs.prototype.sa=function(a){Ze(this.g,new Km)},bs.prototype.ra=function(){Ze(this.g,"b")},Xa.prototype.createWebChannel=Xa.prototype.g,Vt.prototype.send=Vt.prototype.o,Vt.prototype.open=Vt.prototype.m,Vt.prototype.close=Vt.prototype.close,pE=function(){return new Xa},fE=function(){return Fa()},dE=Kr,Ld={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ua.NO_ERROR=0,Ua.TIMEOUT=8,Ua.HTTP_ERROR=6,Bl=Ua,cm.COMPLETE="complete",hE=cm,im.EventType=qi,qi.OPEN="a",qi.CLOSE="b",qi.ERROR="c",qi.MESSAGE="d",Ge.prototype.listen=Ge.prototype.K,wo=im,Ae.prototype.listenOnce=Ae.prototype.L,Ae.prototype.getLastError=Ae.prototype.Ka,Ae.prototype.getLastErrorCode=Ae.prototype.Ba,Ae.prototype.getStatus=Ae.prototype.Z,Ae.prototype.getResponseJson=Ae.prototype.Oa,Ae.prototype.getResponseText=Ae.prototype.oa,Ae.prototype.send=Ae.prototype.ea,Ae.prototype.setWithCredentials=Ae.prototype.Ha,cE=Ae}).apply(typeof vl<"u"?vl:typeof self<"u"?self:typeof window<"u"?window:{});const Hy="@firebase/firestore",Gy="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}pt.UNAUTHENTICATED=new pt(null),pt.GOOGLE_CREDENTIALS=new pt("google-credentials-uid"),pt.FIRST_PARTY=new pt("first-party-uid"),pt.MOCK_USER=new pt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Di="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ws=new rp("@firebase/firestore");function Os(){return ws.logLevel}function K(t,...e){if(ws.logLevel<=ie.DEBUG){const n=e.map(gp);ws.debug(`Firestore (${Di}): ${t}`,...n)}}function Kn(t,...e){if(ws.logLevel<=ie.ERROR){const n=e.map(gp);ws.error(`Firestore (${Di}): ${t}`,...n)}}function vi(t,...e){if(ws.logLevel<=ie.WARN){const n=e.map(gp);ws.warn(`Firestore (${Di}): ${t}`,...n)}}function gp(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,mE(t,r,n)}function mE(t,e,n){let r=`FIRESTORE (${Di}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Kn(r),new Error(r)}function pe(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||mE(e,s,r)}function Z(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class G extends Xn{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Un{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gE{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class oN{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(pt.UNAUTHENTICATED))}shutdown(){}}class aN{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class lN{constructor(e){this.t=e,this.currentUser=pt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){pe(this.o===void 0,42304);let r=this.i;const s=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let i=new Un;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Un,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},l=u=>{K("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(K("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Un)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(K("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(pe(typeof r.accessToken=="string",31837,{l:r}),new gE(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return pe(e===null||typeof e=="string",2055,{h:e}),new pt(e)}}class uN{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=pt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class cN{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new uN(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(pt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Wy{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class hN{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,sn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){pe(this.o===void 0,3512);const r=i=>{i.error!=null&&K("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,K("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{K("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):K("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Wy(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(pe(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new Wy(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dN(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yp{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=dN(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function oe(t,e){return t<e?-1:t>e?1:0}function Fd(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const s=t.charAt(r),i=e.charAt(r);if(s!==i)return Th(s)===Th(i)?oe(s,i):Th(s)?1:-1}return oe(t.length,e.length)}const fN=55296,pN=57343;function Th(t){const e=t.charCodeAt(0);return e>=fN&&e<=pN}function _i(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qy="__name__";class mn{constructor(e,n,r){n===void 0?n=0:n>e.length&&J(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&J(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return mn.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof mn?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=mn.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return oe(e.length,n.length)}static compareSegments(e,n){const r=mn.isNumericId(e),s=mn.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?mn.extractNumericId(e).compare(mn.extractNumericId(n)):Fd(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Cr.fromString(e.substring(4,e.length-2))}}class ye extends mn{construct(e,n,r){return new ye(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new G(V.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new ye(n)}static emptyPath(){return new ye([])}}const mN=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class st extends mn{construct(e,n,r){return new st(e,n,r)}static isValidIdentifier(e){return mN.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),st.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===qy}static keyField(){return new st([qy])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new G(V.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new G(V.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new G(V.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(r+=l,s++):(i(),s++)}if(i(),o)throw new G(V.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new st(n)}static emptyPath(){return new st([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y{constructor(e){this.path=e}static fromPath(e){return new Y(ye.fromString(e))}static fromName(e){return new Y(ye.fromString(e).popFirst(5))}static empty(){return new Y(ye.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ye.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ye.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Y(new ye(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yE(t,e,n){if(!n)throw new G(V.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function gN(t,e,n,r){if(e===!0&&r===!0)throw new G(V.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Ky(t){if(!Y.isDocumentKey(t))throw new G(V.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Qy(t){if(Y.isDocumentKey(t))throw new G(V.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function vE(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function uc(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":J(12329,{type:typeof t})}function It(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new G(V.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=uc(t);throw new G(V.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fe(t,e){const n={typeString:t};return e&&(n.value=e),n}function Aa(t,e){if(!vE(t))throw new G(V.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(s&&typeof o!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new G(V.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yy=-62135596800,Jy=1e6;class ce{static now(){return ce.fromMillis(Date.now())}static fromDate(e){return ce.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*Jy);return new ce(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new G(V.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new G(V.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<Yy)throw new G(V.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new G(V.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Jy}_compareTo(e){return this.seconds===e.seconds?oe(this.nanoseconds,e.nanoseconds):oe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ce._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Aa(e,ce._jsonSchema))return new ce(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Yy;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ce._jsonSchemaVersion="firestore/timestamp/1.0",ce._jsonSchema={type:Fe("string",ce._jsonSchemaVersion),seconds:Fe("number"),nanoseconds:Fe("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ee{static fromTimestamp(e){return new ee(e)}static min(){return new ee(new ce(0,0))}static max(){return new ee(new ce(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const la=-1;function yN(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=ee.fromTimestamp(r===1e9?new ce(n+1,0):new ce(n,r));return new br(s,Y.empty(),e)}function vN(t){return new br(t.readTime,t.key,la)}class br{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new br(ee.min(),Y.empty(),la)}static max(){return new br(ee.max(),Y.empty(),la)}}function _N(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Y.comparator(t.documentKey,e.documentKey),n!==0?n:oe(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wN="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class EN{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ji(t){if(t.code!==V.FAILED_PRECONDITION||t.message!==wN)throw t;K("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&J(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new O((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof O?n:O.resolve(n)}catch(n){return O.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):O.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):O.reject(n)}static resolve(e){return new O((n,r)=>{n(e)})}static reject(e){return new O((n,r)=>{r(e)})}static waitFor(e){return new O((n,r)=>{let s=0,i=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++i,o&&i===s&&n()},u=>r(u))}),o=!0,i===s&&n()})}static or(e){let n=O.resolve(!1);for(const r of e)n=n.next(s=>s?O.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new O((r,s)=>{const i=e.length,o=new Array(i);let l=0;for(let u=0;u<i;u++){const c=u;n(e[c]).next(d=>{o[c]=d,++l,l===i&&r(o)},d=>s(d))}})}static doWhile(e,n){return new O((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function xN(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Vi(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cc{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}cc.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vp=-1;function hc(t){return t==null}function Pu(t){return t===0&&1/t==-1/0}function TN(t){return typeof t=="number"&&Number.isInteger(t)&&!Pu(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _E="";function IN(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=Xy(e)),e=SN(t.get(n),e);return Xy(e)}function SN(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case _E:n+="";break;default:n+=i}}return n}function Xy(t){return t+_E+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zy(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function zr(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function wE(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Re{constructor(e,n){this.comparator=e,this.root=n||rt.EMPTY}insert(e,n){return new Re(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,rt.BLACK,null,null))}remove(e){return new Re(this.comparator,this.root.remove(e,this.comparator).copy(null,null,rt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new _l(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new _l(this.root,e,this.comparator,!1)}getReverseIterator(){return new _l(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new _l(this.root,e,this.comparator,!0)}}class _l{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class rt{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??rt.RED,this.left=s??rt.EMPTY,this.right=i??rt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new rt(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return rt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return rt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,rt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,rt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw J(43730,{key:this.key,value:this.value});if(this.right.isRed())throw J(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw J(27949);return e+(this.isRed()?0:1)}}rt.EMPTY=null,rt.RED=!0,rt.BLACK=!1;rt.EMPTY=new class{constructor(){this.size=0}get key(){throw J(57766)}get value(){throw J(16141)}get color(){throw J(16727)}get left(){throw J(29726)}get right(){throw J(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new rt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class He{constructor(e){this.comparator=e,this.data=new Re(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new ev(this.data.getIterator())}getIteratorFrom(e){return new ev(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof He)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new He(this.comparator);return n.data=e,n}}class ev{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ut{constructor(e){this.fields=e,e.sort(st.comparator)}static empty(){return new Ut([])}unionWith(e){let n=new He(st.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Ut(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return _i(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EE extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new EE("Invalid base64 string: "+i):i}}(e);return new at(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new at(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return oe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}at.EMPTY_BYTE_STRING=new at("");const RN=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Dr(t){if(pe(!!t,39018),typeof t=="string"){let e=0;const n=RN.exec(t);if(pe(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ne(t.seconds),nanos:Ne(t.nanos)}}function Ne(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function jr(t){return typeof t=="string"?at.fromBase64String(t):at.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xE="server_timestamp",TE="__type__",IE="__previous_value__",SE="__local_write_time__";function _p(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[TE])==null?void 0:r.stringValue)===xE}function dc(t){const e=t.mapValue.fields[IE];return _p(e)?dc(e):e}function ua(t){const e=Dr(t.mapValue.fields[SE].timestampValue);return new ce(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AN{constructor(e,n,r,s,i,o,l,u,c,d){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=c,this.isUsingEmulator=d}}const Nu="(default)";class ca{constructor(e,n){this.projectId=e,this.database=n||Nu}static empty(){return new ca("","")}get isDefaultDatabase(){return this.database===Nu}isEqual(e){return e instanceof ca&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RE="__type__",AE="__max__",wl={mapValue:{fields:{__type__:{stringValue:AE}}}},CE="__vector__",ku="value";function Vr(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?_p(t)?4:PN(t)?9007199254740991:CN(t)?10:11:J(28295,{value:t})}function Sn(t,e){if(t===e)return!0;const n=Vr(t);if(n!==Vr(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ua(t).isEqual(ua(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Dr(s.timestampValue),l=Dr(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return jr(s.bytesValue).isEqual(jr(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Ne(s.geoPointValue.latitude)===Ne(i.geoPointValue.latitude)&&Ne(s.geoPointValue.longitude)===Ne(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Ne(s.integerValue)===Ne(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Ne(s.doubleValue),l=Ne(i.doubleValue);return o===l?Pu(o)===Pu(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return _i(t.arrayValue.values||[],e.arrayValue.values||[],Sn);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},l=i.mapValue.fields||{};if(Zy(o)!==Zy(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!Sn(o[u],l[u])))return!1;return!0}(t,e);default:return J(52216,{left:t})}}function ha(t,e){return(t.values||[]).find(n=>Sn(n,e))!==void 0}function wi(t,e){if(t===e)return 0;const n=Vr(t),r=Vr(e);if(n!==r)return oe(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return oe(t.booleanValue,e.booleanValue);case 2:return function(i,o){const l=Ne(i.integerValue||i.doubleValue),u=Ne(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(t,e);case 3:return tv(t.timestampValue,e.timestampValue);case 4:return tv(ua(t),ua(e));case 5:return Fd(t.stringValue,e.stringValue);case 6:return function(i,o){const l=jr(i),u=jr(o);return l.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),u=o.split("/");for(let c=0;c<l.length&&c<u.length;c++){const d=oe(l[c],u[c]);if(d!==0)return d}return oe(l.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const l=oe(Ne(i.latitude),Ne(o.latitude));return l!==0?l:oe(Ne(i.longitude),Ne(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return nv(t.arrayValue,e.arrayValue);case 10:return function(i,o){var g,E,A,C;const l=i.fields||{},u=o.fields||{},c=(g=l[ku])==null?void 0:g.arrayValue,d=(E=u[ku])==null?void 0:E.arrayValue,m=oe(((A=c==null?void 0:c.values)==null?void 0:A.length)||0,((C=d==null?void 0:d.values)==null?void 0:C.length)||0);return m!==0?m:nv(c,d)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===wl.mapValue&&o===wl.mapValue)return 0;if(i===wl.mapValue)return 1;if(o===wl.mapValue)return-1;const l=i.fields||{},u=Object.keys(l),c=o.fields||{},d=Object.keys(c);u.sort(),d.sort();for(let m=0;m<u.length&&m<d.length;++m){const g=Fd(u[m],d[m]);if(g!==0)return g;const E=wi(l[u[m]],c[d[m]]);if(E!==0)return E}return oe(u.length,d.length)}(t.mapValue,e.mapValue);default:throw J(23264,{he:n})}}function tv(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return oe(t,e);const n=Dr(t),r=Dr(e),s=oe(n.seconds,r.seconds);return s!==0?s:oe(n.nanos,r.nanos)}function nv(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=wi(n[s],r[s]);if(i)return i}return oe(n.length,r.length)}function Ei(t){return Ud(t)}function Ud(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Dr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return jr(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return Y.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Ud(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${Ud(n.fields[o])}`;return s+"}"}(t.mapValue):J(61005,{value:t})}function zl(t){switch(Vr(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=dc(t);return e?16+zl(e):16;case 5:return 2*t.stringValue.length;case 6:return jr(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+zl(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return zr(r.fields,(i,o)=>{s+=i.length+zl(o)}),s}(t.mapValue);default:throw J(13486,{value:t})}}function rv(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Bd(t){return!!t&&"integerValue"in t}function wp(t){return!!t&&"arrayValue"in t}function sv(t){return!!t&&"nullValue"in t}function iv(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function $l(t){return!!t&&"mapValue"in t}function CN(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[RE])==null?void 0:r.stringValue)===CE}function Vo(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return zr(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Vo(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Vo(t.arrayValue.values[n]);return e}return{...t}}function PN(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===AE}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt{constructor(e){this.value=e}static empty(){return new Pt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!$l(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Vo(n)}setAll(e){let n=st.emptyPath(),r={},s=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const u=this.getFieldsMap(n);this.applyChanges(u,r,s),r={},s=[],n=l.popLast()}o?r[l.lastSegment()]=Vo(o):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());$l(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Sn(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];$l(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){zr(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Pt(Vo(this.value))}}function PE(t){const e=[];return zr(t.fields,(n,r)=>{const s=new st([n]);if($l(r)){const i=PE(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Ut(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gt{constructor(e,n,r,s,i,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new gt(e,0,ee.min(),ee.min(),ee.min(),Pt.empty(),0)}static newFoundDocument(e,n,r,s){return new gt(e,1,n,ee.min(),r,s,0)}static newNoDocument(e,n){return new gt(e,2,n,ee.min(),ee.min(),Pt.empty(),0)}static newUnknownDocument(e,n){return new gt(e,3,n,ee.min(),ee.min(),Pt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ee.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Pt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Pt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ee.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof gt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new gt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu{constructor(e,n){this.position=e,this.inclusive=n}}function ov(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=Y.comparator(Y.fromName(o.referenceValue),n.key):r=wi(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function av(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Sn(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class da{constructor(e,n="asc"){this.field=e,this.dir=n}}function NN(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NE{}class Le extends NE{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new bN(e,n,r):n==="array-contains"?new VN(e,r):n==="in"?new ON(e,r):n==="not-in"?new MN(e,r):n==="array-contains-any"?new LN(e,r):new Le(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new DN(e,r):new jN(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(wi(n,this.value)):n!==null&&Vr(this.value)===Vr(n)&&this.matchesComparison(wi(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return J(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class dn extends NE{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new dn(e,n)}matches(e){return kE(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function kE(t){return t.op==="and"}function bE(t){return kN(t)&&kE(t)}function kN(t){for(const e of t.filters)if(e instanceof dn)return!1;return!0}function zd(t){if(t instanceof Le)return t.field.canonicalString()+t.op.toString()+Ei(t.value);if(bE(t))return t.filters.map(e=>zd(e)).join(",");{const e=t.filters.map(n=>zd(n)).join(",");return`${t.op}(${e})`}}function DE(t,e){return t instanceof Le?function(r,s){return s instanceof Le&&r.op===s.op&&r.field.isEqual(s.field)&&Sn(r.value,s.value)}(t,e):t instanceof dn?function(r,s){return s instanceof dn&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,l)=>i&&DE(o,s.filters[l]),!0):!1}(t,e):void J(19439)}function jE(t){return t instanceof Le?function(n){return`${n.field.canonicalString()} ${n.op} ${Ei(n.value)}`}(t):t instanceof dn?function(n){return n.op.toString()+" {"+n.getFilters().map(jE).join(" ,")+"}"}(t):"Filter"}class bN extends Le{constructor(e,n,r){super(e,n,r),this.key=Y.fromName(r.referenceValue)}matches(e){const n=Y.comparator(e.key,this.key);return this.matchesComparison(n)}}class DN extends Le{constructor(e,n){super(e,"in",n),this.keys=VE("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class jN extends Le{constructor(e,n){super(e,"not-in",n),this.keys=VE("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function VE(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>Y.fromName(r.referenceValue))}class VN extends Le{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return wp(n)&&ha(n.arrayValue,this.value)}}class ON extends Le{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&ha(this.value.arrayValue,n)}}class MN extends Le{constructor(e,n){super(e,"not-in",n)}matches(e){if(ha(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!ha(this.value.arrayValue,n)}}class LN extends Le{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!wp(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>ha(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FN{constructor(e,n=null,r=[],s=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=l,this.Te=null}}function lv(t,e=null,n=[],r=[],s=null,i=null,o=null){return new FN(t,e,n,r,s,i,o)}function Ep(t){const e=Z(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>zd(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),hc(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Ei(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Ei(r)).join(",")),e.Te=n}return e.Te}function xp(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!NN(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!DE(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!av(t.startAt,e.startAt)&&av(t.endAt,e.endAt)}function $d(t){return Y.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oi{constructor(e,n=null,r=[],s=[],i=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function UN(t,e,n,r,s,i,o,l){return new Oi(t,e,n,r,s,i,o,l)}function fc(t){return new Oi(t)}function uv(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function OE(t){return t.collectionGroup!==null}function Oo(t){const e=Z(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new He(st.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(c=>{c.isInequality()&&(l=l.add(c.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new da(i,r))}),n.has(st.keyField().canonicalString())||e.Ie.push(new da(st.keyField(),r))}return e.Ie}function wn(t){const e=Z(t);return e.Ee||(e.Ee=BN(e,Oo(t))),e.Ee}function BN(t,e){if(t.limitType==="F")return lv(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new da(s.field,i)});const n=t.endAt?new bu(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new bu(t.startAt.position,t.startAt.inclusive):null;return lv(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Hd(t,e){const n=t.filters.concat([e]);return new Oi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Gd(t,e,n){return new Oi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function pc(t,e){return xp(wn(t),wn(e))&&t.limitType===e.limitType}function ME(t){return`${Ep(wn(t))}|lt:${t.limitType}`}function Ms(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>jE(s)).join(", ")}]`),hc(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>Ei(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>Ei(s)).join(",")),`Target(${r})`}(wn(t))}; limitType=${t.limitType})`}function mc(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):Y.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of Oo(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,l,u){const c=ov(o,l,u);return o.inclusive?c<=0:c<0}(r.startAt,Oo(r),s)||r.endAt&&!function(o,l,u){const c=ov(o,l,u);return o.inclusive?c>=0:c>0}(r.endAt,Oo(r),s))}(t,e)}function zN(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function LE(t){return(e,n)=>{let r=!1;for(const s of Oo(t)){const i=$N(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function $N(t,e,n){const r=t.field.isKeyField()?Y.comparator(e.key,n.key):function(i,o,l){const u=o.data.field(i),c=l.data.field(i);return u!==null&&c!==null?wi(u,c):J(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return J(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){zr(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return wE(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HN=new Re(Y.comparator);function Qn(){return HN}const FE=new Re(Y.comparator);function Eo(...t){let e=FE;for(const n of t)e=e.insert(n.key,n);return e}function UE(t){let e=FE;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function os(){return Mo()}function BE(){return Mo()}function Mo(){return new Is(t=>t.toString(),(t,e)=>t.isEqual(e))}const GN=new Re(Y.comparator),WN=new He(Y.comparator);function ae(...t){let e=WN;for(const n of t)e=e.add(n);return e}const qN=new He(oe);function KN(){return qN}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tp(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Pu(e)?"-0":e}}function zE(t){return{integerValue:""+t}}function QN(t,e){return TN(e)?zE(e):Tp(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gc{constructor(){this._=void 0}}function YN(t,e,n){return t instanceof Du?function(s,i){const o={fields:{[TE]:{stringValue:xE},[SE]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&_p(i)&&(i=dc(i)),i&&(o.fields[IE]=i),{mapValue:o}}(n,e):t instanceof fa?HE(t,e):t instanceof pa?GE(t,e):function(s,i){const o=$E(s,i),l=cv(o)+cv(s.Ae);return Bd(o)&&Bd(s.Ae)?zE(l):Tp(s.serializer,l)}(t,e)}function JN(t,e,n){return t instanceof fa?HE(t,e):t instanceof pa?GE(t,e):n}function $E(t,e){return t instanceof ju?function(r){return Bd(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Du extends gc{}class fa extends gc{constructor(e){super(),this.elements=e}}function HE(t,e){const n=WE(e);for(const r of t.elements)n.some(s=>Sn(s,r))||n.push(r);return{arrayValue:{values:n}}}class pa extends gc{constructor(e){super(),this.elements=e}}function GE(t,e){let n=WE(e);for(const r of t.elements)n=n.filter(s=>!Sn(s,r));return{arrayValue:{values:n}}}class ju extends gc{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function cv(t){return Ne(t.integerValue||t.doubleValue)}function WE(t){return wp(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function XN(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof fa&&s instanceof fa||r instanceof pa&&s instanceof pa?_i(r.elements,s.elements,Sn):r instanceof ju&&s instanceof ju?Sn(r.Ae,s.Ae):r instanceof Du&&s instanceof Du}(t.transform,e.transform)}class ZN{constructor(e,n){this.version=e,this.transformResults=n}}class cn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new cn}static exists(e){return new cn(void 0,e)}static updateTime(e){return new cn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Hl(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class yc{}function qE(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Ip(t.key,cn.none()):new Ca(t.key,t.data,cn.none());{const n=t.data,r=Pt.empty();let s=new He(st.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new $r(t.key,r,new Ut(s.toArray()),cn.none())}}function ek(t,e,n){t instanceof Ca?function(s,i,o){const l=s.value.clone(),u=dv(s.fieldTransforms,i,o.transformResults);l.setAll(u),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof $r?function(s,i,o){if(!Hl(s.precondition,i))return void i.convertToUnknownDocument(o.version);const l=dv(s.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(KE(s)),u.setAll(l),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Lo(t,e,n,r){return t instanceof Ca?function(i,o,l,u){if(!Hl(i.precondition,o))return l;const c=i.value.clone(),d=fv(i.fieldTransforms,u,o);return c.setAll(d),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(t,e,n,r):t instanceof $r?function(i,o,l,u){if(!Hl(i.precondition,o))return l;const c=fv(i.fieldTransforms,u,o),d=o.data;return d.setAll(KE(i)),d.setAll(c),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(m=>m.field))}(t,e,n,r):function(i,o,l){return Hl(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function tk(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=$E(r.transform,s||null);i!=null&&(n===null&&(n=Pt.empty()),n.set(r.field,i))}return n||null}function hv(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&_i(r,s,(i,o)=>XN(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Ca extends yc{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class $r extends yc{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function KE(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function dv(t,e,n){const r=new Map;pe(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,l=e.data.field(i.field);r.set(i.field,JN(o,l,n[s]))}return r}function fv(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,YN(i,o,e))}return r}class Ip extends yc{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class nk extends yc{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rk{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&ek(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Lo(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Lo(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=BE();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=n.has(s.key)?null:l;const u=qE(o,l);u!==null&&r.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(ee.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ae())}isEqual(e){return this.batchId===e.batchId&&_i(this.mutations,e.mutations,(n,r)=>hv(n,r))&&_i(this.baseMutations,e.baseMutations,(n,r)=>hv(n,r))}}class Sp{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){pe(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=function(){return GN}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Sp(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sk{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ik{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ve,ue;function ok(t){switch(t){case V.OK:return J(64938);case V.CANCELLED:case V.UNKNOWN:case V.DEADLINE_EXCEEDED:case V.RESOURCE_EXHAUSTED:case V.INTERNAL:case V.UNAVAILABLE:case V.UNAUTHENTICATED:return!1;case V.INVALID_ARGUMENT:case V.NOT_FOUND:case V.ALREADY_EXISTS:case V.PERMISSION_DENIED:case V.FAILED_PRECONDITION:case V.ABORTED:case V.OUT_OF_RANGE:case V.UNIMPLEMENTED:case V.DATA_LOSS:return!0;default:return J(15467,{code:t})}}function QE(t){if(t===void 0)return Kn("GRPC error has no .code"),V.UNKNOWN;switch(t){case Ve.OK:return V.OK;case Ve.CANCELLED:return V.CANCELLED;case Ve.UNKNOWN:return V.UNKNOWN;case Ve.DEADLINE_EXCEEDED:return V.DEADLINE_EXCEEDED;case Ve.RESOURCE_EXHAUSTED:return V.RESOURCE_EXHAUSTED;case Ve.INTERNAL:return V.INTERNAL;case Ve.UNAVAILABLE:return V.UNAVAILABLE;case Ve.UNAUTHENTICATED:return V.UNAUTHENTICATED;case Ve.INVALID_ARGUMENT:return V.INVALID_ARGUMENT;case Ve.NOT_FOUND:return V.NOT_FOUND;case Ve.ALREADY_EXISTS:return V.ALREADY_EXISTS;case Ve.PERMISSION_DENIED:return V.PERMISSION_DENIED;case Ve.FAILED_PRECONDITION:return V.FAILED_PRECONDITION;case Ve.ABORTED:return V.ABORTED;case Ve.OUT_OF_RANGE:return V.OUT_OF_RANGE;case Ve.UNIMPLEMENTED:return V.UNIMPLEMENTED;case Ve.DATA_LOSS:return V.DATA_LOSS;default:return J(39323,{code:t})}}(ue=Ve||(Ve={}))[ue.OK=0]="OK",ue[ue.CANCELLED=1]="CANCELLED",ue[ue.UNKNOWN=2]="UNKNOWN",ue[ue.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ue[ue.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ue[ue.NOT_FOUND=5]="NOT_FOUND",ue[ue.ALREADY_EXISTS=6]="ALREADY_EXISTS",ue[ue.PERMISSION_DENIED=7]="PERMISSION_DENIED",ue[ue.UNAUTHENTICATED=16]="UNAUTHENTICATED",ue[ue.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ue[ue.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ue[ue.ABORTED=10]="ABORTED",ue[ue.OUT_OF_RANGE=11]="OUT_OF_RANGE",ue[ue.UNIMPLEMENTED=12]="UNIMPLEMENTED",ue[ue.INTERNAL=13]="INTERNAL",ue[ue.UNAVAILABLE=14]="UNAVAILABLE",ue[ue.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ak(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lk=new Cr([4294967295,4294967295],0);function pv(t){const e=ak().encode(t),n=new uE;return n.update(e),new Uint8Array(n.digest())}function mv(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Cr([n,r],0),new Cr([s,i],0)]}class Rp{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new xo(`Invalid padding: ${n}`);if(r<0)throw new xo(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new xo(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new xo(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Cr.fromNumber(this.ge)}ye(e,n,r){let s=e.add(n.multiply(Cr.fromNumber(r)));return s.compare(lk)===1&&(s=new Cr([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=pv(e),[r,s]=mv(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);if(!this.we(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Rp(i,s,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.ge===0)return;const n=pv(e),[r,s]=mv(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class xo extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vc{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Pa.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new vc(ee.min(),s,new Re(oe),Qn(),ae())}}class Pa{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Pa(r,n,ae(),ae(),ae())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gl{constructor(e,n,r,s){this.be=e,this.removedTargetIds=n,this.key=r,this.De=s}}class YE{constructor(e,n){this.targetId=e,this.Ce=n}}class JE{constructor(e,n,r=at.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class gv{constructor(){this.ve=0,this.Fe=yv(),this.Me=at.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=ae(),n=ae(),r=ae();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:J(38017,{changeType:i})}}),new Pa(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=yv()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,pe(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class uk{constructor(e){this.Ge=e,this.ze=new Map,this.je=Qn(),this.Je=El(),this.He=El(),this.Ye=new Re(oe)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:J(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,s)=>{this.rt(s)&&n(s)})}st(e){const n=e.targetId,r=e.Ce.count,s=this.ot(n);if(s){const i=s.target;if($d(i))if(r===0){const o=new Y(i.path);this.et(n,o,gt.newNoDocument(o,ee.min()))}else pe(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const l=this.ut(e),u=l?this.ct(l,e,o):1;if(u!==0){this.it(n);const c=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,c)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,l;try{o=jr(r).toUint8Array()}catch(u){if(u instanceof EE)return vi("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new Rp(o,s,i)}catch(u){return vi(u instanceof xo?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.ge===0?null:l}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Ge.ht(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.et(n,i,null),s++)}),s}Tt(e){const n=new Map;this.ze.forEach((i,o)=>{const l=this.ot(o);if(l){if(i.current&&$d(l.target)){const u=new Y(l.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,gt.newNoDocument(u,e))}i.Be&&(n.set(o,i.ke()),i.qe())}});let r=ae();this.He.forEach((i,o)=>{let l=!0;o.forEachWhile(u=>{const c=this.ot(u);return!c||c.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const s=new vc(e,n,this.Ye,this.je,r);return this.je=Qn(),this.Je=El(),this.He=El(),this.Ye=new Re(oe),s}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,n)?s.Qe(n,1):s.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new gv,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new He(oe),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new He(oe),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||K("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new gv),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function El(){return new Re(Y.comparator)}function yv(){return new Re(Y.comparator)}const ck=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),hk=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),dk=(()=>({and:"AND",or:"OR"}))();class fk{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Wd(t,e){return t.useProto3Json||hc(e)?e:{value:e}}function Vu(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function XE(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function pk(t,e){return Vu(t,e.toTimestamp())}function En(t){return pe(!!t,49232),ee.fromTimestamp(function(n){const r=Dr(n);return new ce(r.seconds,r.nanos)}(t))}function Ap(t,e){return qd(t,e).canonicalString()}function qd(t,e){const n=function(s){return new ye(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function ZE(t){const e=ye.fromString(t);return pe(s1(e),10190,{key:e.toString()}),e}function Kd(t,e){return Ap(t.databaseId,e.path)}function Ih(t,e){const n=ZE(e);if(n.get(1)!==t.databaseId.projectId)throw new G(V.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new G(V.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Y(t1(n))}function e1(t,e){return Ap(t.databaseId,e)}function mk(t){const e=ZE(t);return e.length===4?ye.emptyPath():t1(e)}function Qd(t){return new ye(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function t1(t){return pe(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function vv(t,e,n){return{name:Kd(t,e),fields:n.value.mapValue.fields}}function gk(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:J(39313,{state:c})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(c,d){return c.useProto3Json?(pe(d===void 0||typeof d=="string",58123),at.fromBase64String(d||"")):(pe(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),at.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(c){const d=c.code===void 0?V.UNKNOWN:QE(c.code);return new G(d,c.message||"")}(o);n=new JE(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Ih(t,r.document.name),i=En(r.document.updateTime),o=r.document.createTime?En(r.document.createTime):ee.min(),l=new Pt({mapValue:{fields:r.document.fields}}),u=gt.newFoundDocument(s,i,o,l),c=r.targetIds||[],d=r.removedTargetIds||[];n=new Gl(c,d,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Ih(t,r.document),i=r.readTime?En(r.readTime):ee.min(),o=gt.newNoDocument(s,i),l=r.removedTargetIds||[];n=new Gl([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Ih(t,r.document),i=r.removedTargetIds||[];n=new Gl([],i,s,null)}else{if(!("filter"in e))return J(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new ik(s,i),l=r.targetId;n=new YE(l,o)}}return n}function yk(t,e){let n;if(e instanceof Ca)n={update:vv(t,e.key,e.value)};else if(e instanceof Ip)n={delete:Kd(t,e.key)};else if(e instanceof $r)n={update:vv(t,e.key,e.data),updateMask:Rk(e.fieldMask)};else{if(!(e instanceof nk))return J(16599,{Vt:e.type});n={verify:Kd(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const l=o.transform;if(l instanceof Du)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof fa)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof pa)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof ju)return{fieldPath:o.field.canonicalString(),increment:l.Ae};throw J(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:pk(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:J(27497)}(t,e.precondition)),n}function vk(t,e){return t&&t.length>0?(pe(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?En(s.updateTime):En(i);return o.isEqual(ee.min())&&(o=En(i)),new ZN(o,s.transformResults||[])}(n,e))):[]}function _k(t,e){return{documents:[e1(t,e.path)]}}function wk(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=e1(t,s);const i=function(c){if(c.length!==0)return r1(dn.create(c,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(c){if(c.length!==0)return c.map(d=>function(g){return{field:Ls(g.field),direction:Tk(g.dir)}}(d))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=Wd(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{ft:n,parent:s}}function Ek(t){let e=mk(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){pe(r===1,65062);const d=n.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];n.where&&(i=function(m){const g=n1(m);return g instanceof dn&&bE(g)?g.getFilters():[g]}(n.where));let o=[];n.orderBy&&(o=function(m){return m.map(g=>function(A){return new da(Fs(A.field),function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(A.direction))}(g))}(n.orderBy));let l=null;n.limit&&(l=function(m){let g;return g=typeof m=="object"?m.value:m,hc(g)?null:g}(n.limit));let u=null;n.startAt&&(u=function(m){const g=!!m.before,E=m.values||[];return new bu(E,g)}(n.startAt));let c=null;return n.endAt&&(c=function(m){const g=!m.before,E=m.values||[];return new bu(E,g)}(n.endAt)),UN(e,s,o,i,l,"F",u,c)}function xk(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return J(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function n1(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Fs(n.unaryFilter.field);return Le.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Fs(n.unaryFilter.field);return Le.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Fs(n.unaryFilter.field);return Le.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Fs(n.unaryFilter.field);return Le.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return J(61313);default:return J(60726)}}(t):t.fieldFilter!==void 0?function(n){return Le.create(Fs(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return J(58110);default:return J(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return dn.create(n.compositeFilter.filters.map(r=>n1(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return J(1026)}}(n.compositeFilter.op))}(t):J(30097,{filter:t})}function Tk(t){return ck[t]}function Ik(t){return hk[t]}function Sk(t){return dk[t]}function Ls(t){return{fieldPath:t.canonicalString()}}function Fs(t){return st.fromServerFormat(t.fieldPath)}function r1(t){return t instanceof Le?function(n){if(n.op==="=="){if(iv(n.value))return{unaryFilter:{field:Ls(n.field),op:"IS_NAN"}};if(sv(n.value))return{unaryFilter:{field:Ls(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(iv(n.value))return{unaryFilter:{field:Ls(n.field),op:"IS_NOT_NAN"}};if(sv(n.value))return{unaryFilter:{field:Ls(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ls(n.field),op:Ik(n.op),value:n.value}}}(t):t instanceof dn?function(n){const r=n.getFilters().map(s=>r1(s));return r.length===1?r[0]:{compositeFilter:{op:Sk(n.op),filters:r}}}(t):J(54877,{filter:t})}function Rk(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function s1(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mr{constructor(e,n,r,s,i=ee.min(),o=ee.min(),l=at.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new mr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new mr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new mr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new mr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ak{constructor(e){this.yt=e}}function Ck(t){const e=Ek({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Gd(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pk{constructor(){this.Cn=new Nk}addToCollectionParentIndex(e,n){return this.Cn.add(n),O.resolve()}getCollectionParents(e,n){return O.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return O.resolve()}deleteFieldIndex(e,n){return O.resolve()}deleteAllFieldIndexes(e){return O.resolve()}createTargetIndexes(e,n){return O.resolve()}getDocumentsMatchingTarget(e,n){return O.resolve(null)}getIndexType(e,n){return O.resolve(0)}getFieldIndexes(e,n){return O.resolve([])}getNextCollectionGroupToUpdate(e){return O.resolve(null)}getMinOffset(e,n){return O.resolve(br.min())}getMinOffsetFromCollectionGroup(e,n){return O.resolve(br.min())}updateCollectionGroup(e,n,r){return O.resolve()}updateIndexEntries(e,n){return O.resolve()}}class Nk{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new He(ye.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new He(ye.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _v={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},i1=41943040;class At{static withCacheSize(e){return new At(e,At.DEFAULT_COLLECTION_PERCENTILE,At.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */At.DEFAULT_COLLECTION_PERCENTILE=10,At.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,At.DEFAULT=new At(i1,At.DEFAULT_COLLECTION_PERCENTILE,At.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),At.DISABLED=new At(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xi{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new xi(0)}static cr(){return new xi(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wv="LruGarbageCollector",kk=1048576;function Ev([t,e],[n,r]){const s=oe(t,n);return s===0?oe(e,r):s}class bk{constructor(e){this.Ir=e,this.buffer=new He(Ev),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Ev(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class Dk{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){K(wv,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Vi(n)?K(wv,"Ignoring IndexedDB error during garbage collection: ",n):await ji(n)}await this.Vr(3e5)})}}class jk{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return O.resolve(cc.ce);const r=new bk(n);return this.mr.forEachTarget(e,s=>r.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>r.Ar(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(K("LruGarbageCollector","Garbage collection skipped; disabled"),O.resolve(_v)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(K("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),_v):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,s,i,o,l,u,c;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(K("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),s=this.params.maximumSequenceNumbersToCollect):s=m,o=Date.now(),this.nthSequenceNumber(e,s))).next(m=>(r=m,l=Date.now(),this.removeTargets(e,r,n))).next(m=>(i=m,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(m=>(c=Date.now(),Os()<=ie.DEBUG&&K("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${s} in `+(l-o)+`ms
	Removed ${i} targets in `+(u-l)+`ms
	Removed ${m} documents in `+(c-u)+`ms
Total Duration: ${c-d}ms`),O.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:m})))}}function Vk(t,e){return new jk(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ok{constructor(){this.changes=new Is(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,gt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?O.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mk{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lk{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Lo(r.mutation,s,Ut.empty(),ce.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ae()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ae()){const s=os();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=Eo();return i.forEach((l,u)=>{o=o.insert(l,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=os();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ae()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,s){let i=Qn();const o=Mo(),l=function(){return Mo()}();return n.forEach((u,c)=>{const d=r.get(c.key);s.has(c.key)&&(d===void 0||d.mutation instanceof $r)?i=i.insert(c.key,c):d!==void 0?(o.set(c.key,d.mutation.getFieldMask()),Lo(d.mutation,c,d.mutation.getFieldMask(),ce.now())):o.set(c.key,Ut.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((c,d)=>o.set(c,d)),n.forEach((c,d)=>l.set(c,new Mk(d,o.get(c)??null))),l))}recalculateAndSaveOverlays(e,n){const r=Mo();let s=new Re((o,l)=>o-l),i=ae();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(u=>{const c=n.get(u);if(c===null)return;let d=r.get(u)||Ut.empty();d=l.applyToLocalView(c,d),r.set(u,d);const m=(s.get(l.batchId)||ae()).add(u);s=s.insert(l.batchId,m)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),c=u.key,d=u.value,m=BE();d.forEach(g=>{if(!i.has(g)){const E=qE(n.get(g),r.get(g));E!==null&&m.set(g,E),i=i.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,m))}return O.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return Y.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):OE(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):O.resolve(os());let l=la,u=i;return o.next(c=>O.forEach(c,(d,m)=>(l<m.largestBatchId&&(l=m.largestBatchId),i.get(d)?O.resolve():this.remoteDocumentCache.getEntry(e,d).next(g=>{u=u.insert(d,g)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,u,c,ae())).next(d=>({batchId:l,changes:UE(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Y(n)).next(r=>{let s=Eo();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=Eo();return this.indexManager.getCollectionParents(e,i).next(l=>O.forEach(l,u=>{const c=function(m,g){return new Oi(g,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(n,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,r,s).next(d=>{d.forEach((m,g)=>{o=o.insert(m,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((u,c)=>{const d=c.getKey();o.get(d)===null&&(o=o.insert(d,gt.newInvalidDocument(d)))});let l=Eo();return o.forEach((u,c)=>{const d=i.get(u);d!==void 0&&Lo(d.mutation,c,Ut.empty(),ce.now()),mc(n,c)&&(l=l.insert(u,c))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fk{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return O.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:En(s.createTime)}}(n)),O.resolve()}getNamedQuery(e,n){return O.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(s){return{name:s.name,query:Ck(s.bundledQuery),readTime:En(s.readTime)}}(n)),O.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uk{constructor(){this.overlays=new Re(Y.comparator),this.qr=new Map}getOverlay(e,n){return O.resolve(this.overlays.get(n))}getOverlays(e,n){const r=os();return O.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.St(e,n,i)}),O.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(r)),O.resolve()}getOverlaysForCollection(e,n,r){const s=os(),i=n.length+1,o=new Y(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,c=u.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return O.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Re((c,d)=>c-d);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let d=i.get(c.largestBatchId);d===null&&(d=os(),i=i.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}const l=os(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((c,d)=>l.set(c,d)),!(l.size()>=s)););return O.resolve(l)}St(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new sk(n,r));let i=this.qr.get(n);i===void 0&&(i=ae(),this.qr.set(n,i)),this.qr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bk{constructor(){this.sessionToken=at.EMPTY_BYTE_STRING}getSessionToken(e){return O.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,O.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cp{constructor(){this.Qr=new He(We.$r),this.Ur=new He(We.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new We(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new We(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new Y(new ye([])),r=new We(n,e),s=new We(n,e+1),i=[];return this.Ur.forEachInRange([r,s],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new Y(new ye([])),r=new We(n,e),s=new We(n,e+1);let i=ae();return this.Ur.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new We(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class We{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return Y.comparator(e.key,n.key)||oe(e.Yr,n.Yr)}static Kr(e,n){return oe(e.Yr,n.Yr)||Y.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zk{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new He(We.$r)}checkEmpty(e){return O.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new rk(i,n,r,s);this.mutationQueue.push(o);for(const l of s)this.Zr=this.Zr.add(new We(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return O.resolve(o)}lookupMutationBatch(e,n){return O.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ei(r),i=s<0?0:s;return O.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return O.resolve(this.mutationQueue.length===0?vp:this.tr-1)}getAllMutationBatches(e){return O.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new We(n,0),s=new We(n,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],o=>{const l=this.Xr(o.Yr);i.push(l)}),O.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new He(oe);return n.forEach(s=>{const i=new We(s,0),o=new We(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],l=>{r=r.add(l.Yr)})}),O.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;Y.isDocumentKey(i)||(i=i.child(""));const o=new We(new Y(i),0);let l=new He(oe);return this.Zr.forEachWhile(u=>{const c=u.key.path;return!!r.isPrefixOf(c)&&(c.length===s&&(l=l.add(u.Yr)),!0)},o),O.resolve(this.ti(l))}ti(e){const n=[];return e.forEach(r=>{const s=this.Xr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){pe(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return O.forEach(n.mutations,s=>{const i=new We(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new We(n,0),s=this.Zr.firstAfterOrEqual(r);return O.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,O.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $k{constructor(e){this.ri=e,this.docs=function(){return new Re(Y.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return O.resolve(r?r.document.mutableCopy():gt.newInvalidDocument(n))}getEntries(e,n){let r=Qn();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():gt.newInvalidDocument(s))}),O.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=Qn();const o=n.path,l=new Y(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:c,value:{document:d}}=u.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||_N(vN(d),r)<=0||(s.has(d.key)||mc(n,d))&&(i=i.insert(d.key,d.mutableCopy()))}return O.resolve(i)}getAllFromCollectionGroup(e,n,r,s){J(9500)}ii(e,n){return O.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new Hk(this)}getSize(e){return O.resolve(this.size)}}class Hk extends Ok{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)}),O.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gk{constructor(e){this.persistence=e,this.si=new Is(n=>Ep(n),xp),this.lastRemoteSnapshotVersion=ee.min(),this.highestTargetId=0,this.oi=0,this._i=new Cp,this.targetCount=0,this.ai=xi.ur()}forEachTarget(e,n){return this.si.forEach((r,s)=>n(s)),O.resolve()}getLastRemoteSnapshotVersion(e){return O.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return O.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),O.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),O.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new xi(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,O.resolve()}updateTargetData(e,n){return this.Pr(n),O.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,O.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.si.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),O.waitFor(i).next(()=>s)}getTargetCount(e){return O.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return O.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),O.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),O.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),O.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return O.resolve(r)}containsKey(e,n){return O.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o1{constructor(e,n){this.ui={},this.overlays={},this.ci=new cc(0),this.li=!1,this.li=!0,this.hi=new Bk,this.referenceDelegate=e(this),this.Pi=new Gk(this),this.indexManager=new Pk,this.remoteDocumentCache=function(s){return new $k(s)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new Ak(n),this.Ii=new Fk(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new Uk,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new zk(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){K("MemoryPersistence","Starting transaction:",e);const s=new Wk(this.ci.next());return this.referenceDelegate.Ei(),r(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ai(e,n){return O.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class Wk extends EN{constructor(e){super(),this.currentSequenceNumber=e}}class Pp{constructor(e){this.persistence=e,this.Ri=new Cp,this.Vi=null}static mi(e){return new Pp(e)}get fi(){if(this.Vi)return this.Vi;throw J(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),O.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),O.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),O.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(s=>this.fi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.fi.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return O.forEach(this.fi,r=>{const s=Y.fromPath(r);return this.gi(e,s).next(i=>{i||n.removeEntry(s,ee.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return O.or([()=>O.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class Ou{constructor(e,n){this.persistence=e,this.pi=new Is(r=>IN(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=Vk(this,n)}static mi(e,n){return new Ou(e,n)}Ei(){}di(e){return O.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return O.forEach(this.pi,(r,s)=>this.br(e,r,s).next(i=>i?O.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,o=>this.br(e,o,n).next(l=>{l||(r++,i.removeEntry(o,ee.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),O.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),O.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),O.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),O.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=zl(e.data.value)),n}br(e,n,r){return O.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.pi.get(n);return O.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Np{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=s}static As(e,n){let r=ae(),s=ae();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Np(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qk{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kk{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return FR()?8:xN(vt())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.ys(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new qk;return this.Ss(e,n,o).next(l=>{if(i.result=l,this.Vs)return this.bs(e,n,o,l.size)})}).next(()=>i.result)}bs(e,n,r,s){return r.documentReadCount<this.fs?(Os()<=ie.DEBUG&&K("QueryEngine","SDK will not create cache indexes for query:",Ms(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),O.resolve()):(Os()<=ie.DEBUG&&K("QueryEngine","Query:",Ms(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(Os()<=ie.DEBUG&&K("QueryEngine","The SDK decides to create cache indexes for query:",Ms(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,wn(n))):O.resolve())}ys(e,n){if(uv(n))return O.resolve(null);let r=wn(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Gd(n,null,"F"),r=wn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=ae(...i);return this.ps.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(u=>{const c=this.Ds(n,l);return this.Cs(n,c,o,u.readTime)?this.ys(e,Gd(n,null,"F")):this.vs(e,c,n,u)}))})))}ws(e,n,r,s){return uv(n)||s.isEqual(ee.min())?O.resolve(null):this.ps.getDocuments(e,r).next(i=>{const o=this.Ds(n,i);return this.Cs(n,o,r,s)?O.resolve(null):(Os()<=ie.DEBUG&&K("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Ms(n)),this.vs(e,o,n,yN(s,la)).next(l=>l))})}Ds(e,n){let r=new He(LE(e));return n.forEach((s,i)=>{mc(e,i)&&(r=r.add(i))}),r}Cs(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,n,r){return Os()<=ie.DEBUG&&K("QueryEngine","Using full collection scan to execute query:",Ms(n)),this.ps.getDocumentsMatchingQuery(e,n,br.min(),r)}vs(e,n,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kp="LocalStore",Qk=3e8;class Yk{constructor(e,n,r,s){this.persistence=e,this.Fs=n,this.serializer=s,this.Ms=new Re(oe),this.xs=new Is(i=>Ep(i),xp),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Lk(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function Jk(t,e,n,r){return new Yk(t,e,n,r)}async function a1(t,e){const n=Z(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],l=[];let u=ae();for(const c of s){o.push(c.batchId);for(const d of c.mutations)u=u.add(d.key)}for(const c of i){l.push(c.batchId);for(const d of c.mutations)u=u.add(d.key)}return n.localDocuments.getDocuments(r,u).next(c=>({Ls:c,removedBatchIds:o,addedBatchIds:l}))})})}function Xk(t,e){const n=Z(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(l,u,c,d){const m=c.batch,g=m.keys();let E=O.resolve();return g.forEach(A=>{E=E.next(()=>d.getEntry(u,A)).next(C=>{const N=c.docVersions.get(A);pe(N!==null,48541),C.version.compareTo(N)<0&&(m.applyToRemoteDocument(C,c),C.isValidDocument()&&(C.setReadTime(c.commitVersion),d.addEntry(C)))})}),E.next(()=>l.mutationQueue.removeMutationBatch(u,m))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let u=ae();for(let c=0;c<l.mutationResults.length;++c)l.mutationResults[c].transformResults.length>0&&(u=u.add(l.batch.mutations[c].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function l1(t){const e=Z(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function Zk(t,e){const n=Z(t),r=e.snapshotVersion;let s=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});s=n.Ms;const l=[];e.targetChanges.forEach((d,m)=>{const g=s.get(m);if(!g)return;l.push(n.Pi.removeMatchingKeys(i,d.removedDocuments,m).next(()=>n.Pi.addMatchingKeys(i,d.addedDocuments,m)));let E=g.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(m)!==null?E=E.withResumeToken(at.EMPTY_BYTE_STRING,ee.min()).withLastLimboFreeSnapshotVersion(ee.min()):d.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(d.resumeToken,r)),s=s.insert(m,E),function(C,N,x){return C.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-C.snapshotVersion.toMicroseconds()>=Qk?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0}(g,E,d)&&l.push(n.Pi.updateTargetData(i,E))});let u=Qn(),c=ae();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,d))}),l.push(eb(i,o,e.documentUpdates).next(d=>{u=d.ks,c=d.qs})),!r.isEqual(ee.min())){const d=n.Pi.getLastRemoteSnapshotVersion(i).next(m=>n.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(d)}return O.waitFor(l).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,u,c)).next(()=>u)}).then(i=>(n.Ms=s,i))}function eb(t,e,n){let r=ae(),s=ae();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=Qn();return n.forEach((l,u)=>{const c=i.get(l);u.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(l)),u.isNoDocument()&&u.version.isEqual(ee.min())?(e.removeEntry(l,u.readTime),o=o.insert(l,u)):!c.isValidDocument()||u.version.compareTo(c.version)>0||u.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(u),o=o.insert(l,u)):K(kp,"Ignoring outdated watch update for ",l,". Current version:",c.version," Watch version:",u.version)}),{ks:o,qs:s}})}function tb(t,e){const n=Z(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=vp),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function nb(t,e){const n=Z(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Pi.getTargetData(r,e).next(i=>i?(s=i,O.resolve(s)):n.Pi.allocateTargetId(r).next(o=>(s=new mr(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function Yd(t,e,n){const r=Z(t),s=r.Ms.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Vi(o))throw o;K(kp,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function xv(t,e,n){const r=Z(t);let s=ee.min(),i=ae();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,c,d){const m=Z(u),g=m.xs.get(d);return g!==void 0?O.resolve(m.Ms.get(g)):m.Pi.getTargetData(c,d)}(r,o,wn(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,l.targetId).next(u=>{i=u})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?s:ee.min(),n?i:ae())).next(l=>(rb(r,zN(e),l),{documents:l,Qs:i})))}function rb(t,e,n){let r=t.Os.get(e)||ee.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Os.set(e,r)}class Tv{constructor(){this.activeTargetIds=KN()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class sb{constructor(){this.Mo=new Tv,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Tv,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ib{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iv="ConnectivityMonitor";class Sv{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){K(Iv,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){K(Iv,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xl=null;function Jd(){return xl===null?xl=function(){return 268435456+Math.round(2147483648*Math.random())}():xl++,"0x"+xl.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sh="RestConnection",ob={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class ab{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===Nu?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,n,r,s,i){const o=Jd(),l=this.zo(e,n.toUriEncodedString());K(Sh,`Sending RPC '${e}' ${o}:`,l,r);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,s,i);const{host:c}=new URL(l),d=Ni(c);return this.Jo(e,l,u,r,d).then(m=>(K(Sh,`Received RPC '${e}' ${o}: `,m),m),m=>{throw vi(Sh,`RPC '${e}' ${o} failed with error: `,m,"url: ",l,"request:",r),m})}Ho(e,n,r,s,i,o){return this.Go(e,n,r,s,i)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Di}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}zo(e,n){const r=ob[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lb{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dt="WebChannelConnection";class ub extends ab{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,s,i){const o=Jd();return new Promise((l,u)=>{const c=new cE;c.setWithCredentials(!0),c.listenOnce(hE.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Bl.NO_ERROR:const m=c.getResponseJson();K(dt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(m)),l(m);break;case Bl.TIMEOUT:K(dt,`RPC '${e}' ${o} timed out`),u(new G(V.DEADLINE_EXCEEDED,"Request time out"));break;case Bl.HTTP_ERROR:const g=c.getStatus();if(K(dt,`RPC '${e}' ${o} failed with status:`,g,"response text:",c.getResponseText()),g>0){let E=c.getResponseJson();Array.isArray(E)&&(E=E[0]);const A=E==null?void 0:E.error;if(A&&A.status&&A.message){const C=function(x){const v=x.toLowerCase().replace(/_/g,"-");return Object.values(V).indexOf(v)>=0?v:V.UNKNOWN}(A.status);u(new G(C,A.message))}else u(new G(V.UNKNOWN,"Server responded with status "+c.getStatus()))}else u(new G(V.UNAVAILABLE,"Connection failed."));break;default:J(9055,{l_:e,streamId:o,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{K(dt,`RPC '${e}' ${o} completed.`)}});const d=JSON.stringify(s);K(dt,`RPC '${e}' ${o} sending request:`,s),c.send(n,"POST",d,r,15)})}T_(e,n,r){const s=Jd(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=pE(),l=fE(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(u.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const d=i.join("");K(dt,`Creating RPC '${e}' stream ${s}: ${d}`,u);const m=o.createWebChannel(d,u);this.I_(m);let g=!1,E=!1;const A=new lb({Yo:N=>{E?K(dt,`Not sending because RPC '${e}' stream ${s} is closed:`,N):(g||(K(dt,`Opening RPC '${e}' stream ${s} transport.`),m.open(),g=!0),K(dt,`RPC '${e}' stream ${s} sending:`,N),m.send(N))},Zo:()=>m.close()}),C=(N,x,v)=>{N.listen(x,T=>{try{v(T)}catch(D){setTimeout(()=>{throw D},0)}})};return C(m,wo.EventType.OPEN,()=>{E||(K(dt,`RPC '${e}' stream ${s} transport opened.`),A.o_())}),C(m,wo.EventType.CLOSE,()=>{E||(E=!0,K(dt,`RPC '${e}' stream ${s} transport closed`),A.a_(),this.E_(m))}),C(m,wo.EventType.ERROR,N=>{E||(E=!0,vi(dt,`RPC '${e}' stream ${s} transport errored. Name:`,N.name,"Message:",N.message),A.a_(new G(V.UNAVAILABLE,"The operation could not be completed")))}),C(m,wo.EventType.MESSAGE,N=>{var x;if(!E){const v=N.data[0];pe(!!v,16349);const T=v,D=(T==null?void 0:T.error)||((x=T[0])==null?void 0:x.error);if(D){K(dt,`RPC '${e}' stream ${s} received error:`,D);const L=D.status;let B=function(S){const w=Ve[S];if(w!==void 0)return QE(w)}(L),I=D.message;B===void 0&&(B=V.INTERNAL,I="Unknown error status: "+L+" with message "+D.message),E=!0,A.a_(new G(B,I)),m.close()}else K(dt,`RPC '${e}' stream ${s} received:`,v),A.u_(v)}}),C(l,dE.STAT_EVENT,N=>{N.stat===Ld.PROXY?K(dt,`RPC '${e}' stream ${s} detected buffering proxy`):N.stat===Ld.NOPROXY&&K(dt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{A.__()},0),A}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}function Rh(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _c(t){return new fk(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u1{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,n-r);s>0&&K("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rv="PersistentStream";class c1{constructor(e,n,r,s,i,o,l,u){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new u1(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===V.RESOURCE_EXHAUSTED?(Kn(n.toString()),Kn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===V.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.D_===n&&this.G_(r,s)},r=>{e(()=>{const s=new G(V.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{r(()=>this.z_(s))}),this.stream.onMessage(s=>{r(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return K(Rv,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(K(Rv,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class cb extends c1{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=gk(this.serializer,e),r=function(i){if(!("targetChange"in i))return ee.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?ee.min():o.readTime?En(o.readTime):ee.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=Qd(this.serializer),n.addTarget=function(i,o){let l;const u=o.target;if(l=$d(u)?{documents:_k(i,u)}:{query:wk(i,u).ft},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=XE(i,o.resumeToken);const c=Wd(i,o.expectedCount);c!==null&&(l.expectedCount=c)}else if(o.snapshotVersion.compareTo(ee.min())>0){l.readTime=Vu(i,o.snapshotVersion.toTimestamp());const c=Wd(i,o.expectedCount);c!==null&&(l.expectedCount=c)}return l}(this.serializer,e);const r=xk(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=Qd(this.serializer),n.removeTarget=e,this.q_(n)}}class hb extends c1{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return pe(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,pe(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){pe(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=vk(e.writeResults,e.commitTime),r=En(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=Qd(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>yk(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class db{}class fb extends db{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new G(V.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,qd(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===V.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new G(V.UNKNOWN,i.toString())})}Ho(e,n,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Ho(e,qd(n,r),s,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===V.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new G(V.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class pb{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Kn(n),this.aa=!1):K("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Es="RemoteStore";class mb{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{Ss(this)&&(K(Es,"Restarting streams for network reachability change."),await async function(u){const c=Z(u);c.Ea.add(4),await Mi(c),c.Ra.set("Unknown"),c.Ea.delete(4),await Na(c)}(this))})}),this.Ra=new pb(r,s)}}async function Na(t){if(Ss(t))for(const e of t.da)await e(!0)}async function Mi(t){for(const e of t.da)await e(!1)}function h1(t,e){const n=Z(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),Vp(n)?jp(n):Li(n).O_()&&Dp(n,e))}function bp(t,e){const n=Z(t),r=Li(n);n.Ia.delete(e),r.O_()&&d1(n,e),n.Ia.size===0&&(r.O_()?r.L_():Ss(n)&&n.Ra.set("Unknown"))}function Dp(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ee.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Li(t).Y_(e)}function d1(t,e){t.Va.Ue(e),Li(t).Z_(e)}function jp(t){t.Va=new uk({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Li(t).start(),t.Ra.ua()}function Vp(t){return Ss(t)&&!Li(t).x_()&&t.Ia.size>0}function Ss(t){return Z(t).Ea.size===0}function f1(t){t.Va=void 0}async function gb(t){t.Ra.set("Online")}async function yb(t){t.Ia.forEach((e,n)=>{Dp(t,e)})}async function vb(t,e){f1(t),Vp(t)?(t.Ra.ha(e),jp(t)):t.Ra.set("Unknown")}async function _b(t,e,n){if(t.Ra.set("Online"),e instanceof JE&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const l of i.targetIds)s.Ia.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.Ia.delete(l),s.Va.removeTarget(l))}(t,e)}catch(r){K(Es,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Mu(t,r)}else if(e instanceof Gl?t.Va.Ze(e):e instanceof YE?t.Va.st(e):t.Va.tt(e),!n.isEqual(ee.min()))try{const r=await l1(t.localStore);n.compareTo(r)>=0&&await function(i,o){const l=i.Va.Tt(o);return l.targetChanges.forEach((u,c)=>{if(u.resumeToken.approximateByteSize()>0){const d=i.Ia.get(c);d&&i.Ia.set(c,d.withResumeToken(u.resumeToken,o))}}),l.targetMismatches.forEach((u,c)=>{const d=i.Ia.get(u);if(!d)return;i.Ia.set(u,d.withResumeToken(at.EMPTY_BYTE_STRING,d.snapshotVersion)),d1(i,u);const m=new mr(d.target,u,c,d.sequenceNumber);Dp(i,m)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){K(Es,"Failed to raise snapshot:",r),await Mu(t,r)}}async function Mu(t,e,n){if(!Vi(e))throw e;t.Ea.add(1),await Mi(t),t.Ra.set("Offline"),n||(n=()=>l1(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{K(Es,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await Na(t)})}function p1(t,e){return e().catch(n=>Mu(t,n,e))}async function wc(t){const e=Z(t),n=Or(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:vp;for(;wb(e);)try{const s=await tb(e.localStore,r);if(s===null){e.Ta.length===0&&n.L_();break}r=s.batchId,Eb(e,s)}catch(s){await Mu(e,s)}m1(e)&&g1(e)}function wb(t){return Ss(t)&&t.Ta.length<10}function Eb(t,e){t.Ta.push(e);const n=Or(t);n.O_()&&n.X_&&n.ea(e.mutations)}function m1(t){return Ss(t)&&!Or(t).x_()&&t.Ta.length>0}function g1(t){Or(t).start()}async function xb(t){Or(t).ra()}async function Tb(t){const e=Or(t);for(const n of t.Ta)e.ea(n.mutations)}async function Ib(t,e,n){const r=t.Ta.shift(),s=Sp.from(r,e,n);await p1(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await wc(t)}async function Sb(t,e){e&&Or(t).X_&&await async function(r,s){if(function(o){return ok(o)&&o!==V.ABORTED}(s.code)){const i=r.Ta.shift();Or(r).B_(),await p1(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await wc(r)}}(t,e),m1(t)&&g1(t)}async function Av(t,e){const n=Z(t);n.asyncQueue.verifyOperationInProgress(),K(Es,"RemoteStore received new credentials");const r=Ss(n);n.Ea.add(3),await Mi(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await Na(n)}async function Rb(t,e){const n=Z(t);e?(n.Ea.delete(2),await Na(n)):e||(n.Ea.add(2),await Mi(n),n.Ra.set("Unknown"))}function Li(t){return t.ma||(t.ma=function(n,r,s){const i=Z(n);return i.sa(),new cb(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:gb.bind(null,t),t_:yb.bind(null,t),r_:vb.bind(null,t),H_:_b.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Vp(t)?jp(t):t.Ra.set("Unknown")):(await t.ma.stop(),f1(t))})),t.ma}function Or(t){return t.fa||(t.fa=function(n,r,s){const i=Z(n);return i.sa(),new hb(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:xb.bind(null,t),r_:Sb.bind(null,t),ta:Tb.bind(null,t),na:Ib.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await wc(t)):(await t.fa.stop(),t.Ta.length>0&&(K(Es,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Op{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Un,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,l=new Op(e,n,o,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new G(V.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Mp(t,e){if(Kn("AsyncQueue",`${e}: ${t}`),Vi(t))return new G(V.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ai{static emptySet(e){return new ai(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||Y.comparator(n.key,r.key):(n,r)=>Y.comparator(n.key,r.key),this.keyedMap=Eo(),this.sortedSet=new Re(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof ai)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new ai;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cv{constructor(){this.ga=new Re(Y.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):J(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class Ti{constructor(e,n,r,s,i,o,l,u,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=c}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new Ti(e,n,ai.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&pc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ab{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class Cb{constructor(){this.queries=Pv(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const s=Z(n),i=s.queries;s.queries=Pv(),i.forEach((o,l)=>{for(const u of l.Sa)u.onError(r)})})(this,new G(V.ABORTED,"Firestore shutting down"))}}function Pv(){return new Is(t=>ME(t),pc)}async function Lp(t,e){const n=Z(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new Ab,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await n.onListen(s,!0);break;case 1:i.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const l=Mp(o,`Initialization of query '${Ms(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.Sa.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&Up(n)}async function Fp(t,e){const n=Z(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Pb(t,e){const n=Z(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const l of o.Sa)l.Fa(s)&&(r=!0);o.wa=s}}r&&Up(n)}function Nb(t,e,n){const r=Z(t),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(n);r.queries.delete(e)}function Up(t){t.Ca.forEach(e=>{e.next()})}var Xd,Nv;(Nv=Xd||(Xd={})).Ma="default",Nv.Cache="cache";class Bp{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Ti(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Ti.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Xd.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y1{constructor(e){this.key=e}}class v1{constructor(e){this.key=e}}class kb{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=ae(),this.mutatedKeys=ae(),this.eu=LE(e),this.tu=new ai(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new Cv,s=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,l=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((d,m)=>{const g=s.get(d),E=mc(this.query,m)?m:null,A=!!g&&this.mutatedKeys.has(g.key),C=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations);let N=!1;g&&E?g.data.isEqual(E.data)?A!==C&&(r.track({type:3,doc:E}),N=!0):this.su(g,E)||(r.track({type:2,doc:E}),N=!0,(u&&this.eu(E,u)>0||c&&this.eu(E,c)<0)&&(l=!0)):!g&&E?(r.track({type:0,doc:E}),N=!0):g&&!E&&(r.track({type:1,doc:g}),N=!0,(u||c)&&(l=!0)),N&&(E?(o=o.add(E),i=C?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{tu:o,iu:r,Cs:l,mutatedKeys:i}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((d,m)=>function(E,A){const C=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return J(20277,{Rt:N})}};return C(E)-C(A)}(d.type,m.type)||this.eu(d.doc,m.doc)),this.ou(r),s=s??!1;const l=n&&!s?this._u():[],u=this.Xa.size===0&&this.current&&!s?1:0,c=u!==this.Za;return this.Za=u,o.length!==0||c?{snapshot:new Ti(this.query,e.tu,i,o,e.mutatedKeys,u===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:l}:{au:l}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Cv,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=ae(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new v1(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new y1(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=ae();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Ti.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const zp="SyncEngine";class bb{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class Db{constructor(e){this.key=e,this.hu=!1}}class jb{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Is(l=>ME(l),pc),this.Iu=new Map,this.Eu=new Set,this.du=new Re(Y.comparator),this.Au=new Map,this.Ru=new Cp,this.Vu={},this.mu=new Map,this.fu=xi.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Vb(t,e,n=!0){const r=I1(t);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await _1(r,e,n,!0),s}async function Ob(t,e){const n=I1(t);await _1(n,e,!0,!1)}async function _1(t,e,n,r){const s=await nb(t.localStore,wn(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await Mb(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&h1(t.remoteStore,s),l}async function Mb(t,e,n,r,s){t.pu=(m,g,E)=>async function(C,N,x,v){let T=N.view.ru(x);T.Cs&&(T=await xv(C.localStore,N.query,!1).then(({documents:I})=>N.view.ru(I,T)));const D=v&&v.targetChanges.get(N.targetId),L=v&&v.targetMismatches.get(N.targetId)!=null,B=N.view.applyChanges(T,C.isPrimaryClient,D,L);return bv(C,N.targetId,B.au),B.snapshot}(t,m,g,E);const i=await xv(t.localStore,e,!0),o=new kb(e,i.Qs),l=o.ru(i.documents),u=Pa.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),c=o.applyChanges(l,t.isPrimaryClient,u);bv(t,n,c.au);const d=new bb(e,n,o);return t.Tu.set(e,d),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),c.snapshot}async function Lb(t,e,n){const r=Z(t),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter(o=>!pc(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Yd(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&bp(r.remoteStore,s.targetId),Zd(r,s.targetId)}).catch(ji)):(Zd(r,s.targetId),await Yd(r.localStore,s.targetId,!0))}async function Fb(t,e){const n=Z(t),r=n.Tu.get(e),s=n.Iu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),bp(n.remoteStore,r.targetId))}async function Ub(t,e,n){const r=qb(t);try{const s=await function(o,l){const u=Z(o),c=ce.now(),d=l.reduce((E,A)=>E.add(A.key),ae());let m,g;return u.persistence.runTransaction("Locally write mutations","readwrite",E=>{let A=Qn(),C=ae();return u.Ns.getEntries(E,d).next(N=>{A=N,A.forEach((x,v)=>{v.isValidDocument()||(C=C.add(x))})}).next(()=>u.localDocuments.getOverlayedDocuments(E,A)).next(N=>{m=N;const x=[];for(const v of l){const T=tk(v,m.get(v.key).overlayedDocument);T!=null&&x.push(new $r(v.key,T,PE(T.value.mapValue),cn.exists(!0)))}return u.mutationQueue.addMutationBatch(E,c,x,l)}).next(N=>{g=N;const x=N.applyToLocalDocumentSet(m,C);return u.documentOverlayCache.saveOverlays(E,N.batchId,x)})}).then(()=>({batchId:g.batchId,changes:UE(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,l,u){let c=o.Vu[o.currentUser.toKey()];c||(c=new Re(oe)),c=c.insert(l,u),o.Vu[o.currentUser.toKey()]=c}(r,s.batchId,n),await ka(r,s.changes),await wc(r.remoteStore)}catch(s){const i=Mp(s,"Failed to persist write");n.reject(i)}}async function w1(t,e){const n=Z(t);try{const r=await Zk(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Au.get(i);o&&(pe(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?pe(o.hu,14607):s.removedDocuments.size>0&&(pe(o.hu,42227),o.hu=!1))}),await ka(n,r,e)}catch(r){await ji(r)}}function kv(t,e,n){const r=Z(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Tu.forEach((i,o)=>{const l=o.view.va(e);l.snapshot&&s.push(l.snapshot)}),function(o,l){const u=Z(o);u.onlineState=l;let c=!1;u.queries.forEach((d,m)=>{for(const g of m.Sa)g.va(l)&&(c=!0)}),c&&Up(u)}(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function Bb(t,e,n){const r=Z(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Au.get(e),i=s&&s.key;if(i){let o=new Re(Y.comparator);o=o.insert(i,gt.newNoDocument(i,ee.min()));const l=ae().add(i),u=new vc(ee.min(),new Map,new Re(oe),o,l);await w1(r,u),r.du=r.du.remove(i),r.Au.delete(e),$p(r)}else await Yd(r.localStore,e,!1).then(()=>Zd(r,e,n)).catch(ji)}async function zb(t,e){const n=Z(t),r=e.batch.batchId;try{const s=await Xk(n.localStore,e);x1(n,r,null),E1(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await ka(n,s)}catch(s){await ji(s)}}async function $b(t,e,n){const r=Z(t);try{const s=await function(o,l){const u=Z(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let d;return u.mutationQueue.lookupMutationBatch(c,l).next(m=>(pe(m!==null,37113),d=m.keys(),u.mutationQueue.removeMutationBatch(c,m))).next(()=>u.mutationQueue.performConsistencyCheck(c)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(c,d,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,d)).next(()=>u.localDocuments.getDocuments(c,d))})}(r.localStore,e);x1(r,e,n),E1(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await ka(r,s)}catch(s){await ji(s)}}function E1(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function x1(t,e,n){const r=Z(t);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function Zd(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||T1(t,r)})}function T1(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(bp(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),$p(t))}function bv(t,e,n){for(const r of n)r instanceof y1?(t.Ru.addReference(r.key,e),Hb(t,r)):r instanceof v1?(K(zp,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||T1(t,r.key)):J(19791,{wu:r})}function Hb(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(K(zp,"New document in limbo: "+n),t.Eu.add(r),$p(t))}function $p(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new Y(ye.fromString(e)),r=t.fu.next();t.Au.set(r,new Db(n)),t.du=t.du.insert(n,r),h1(t.remoteStore,new mr(wn(fc(n.path)),r,"TargetPurposeLimboResolution",cc.ce))}}async function ka(t,e,n){const r=Z(t),s=[],i=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((l,u)=>{o.push(r.pu(u,e,n).then(c=>{var d;if((c||n)&&r.isPrimaryClient){const m=c?!c.fromCache:(d=n==null?void 0:n.targetChanges.get(u.targetId))==null?void 0:d.current;r.sharedClientState.updateQueryState(u.targetId,m?"current":"not-current")}if(c){s.push(c);const m=Np.As(u.targetId,c);i.push(m)}}))}),await Promise.all(o),r.Pu.H_(s),await async function(u,c){const d=Z(u);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>O.forEach(c,g=>O.forEach(g.Es,E=>d.persistence.referenceDelegate.addReference(m,g.targetId,E)).next(()=>O.forEach(g.ds,E=>d.persistence.referenceDelegate.removeReference(m,g.targetId,E)))))}catch(m){if(!Vi(m))throw m;K(kp,"Failed to update sequence numbers: "+m)}for(const m of c){const g=m.targetId;if(!m.fromCache){const E=d.Ms.get(g),A=E.snapshotVersion,C=E.withLastLimboFreeSnapshotVersion(A);d.Ms=d.Ms.insert(g,C)}}}(r.localStore,i))}async function Gb(t,e){const n=Z(t);if(!n.currentUser.isEqual(e)){K(zp,"User change. New user:",e.toKey());const r=await a1(n.localStore,e);n.currentUser=e,function(i,o){i.mu.forEach(l=>{l.forEach(u=>{u.reject(new G(V.CANCELLED,o))})}),i.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ka(n,r.Ls)}}function Wb(t,e){const n=Z(t),r=n.Au.get(e);if(r&&r.hu)return ae().add(r.key);{let s=ae();const i=n.Iu.get(e);if(!i)return s;for(const o of i){const l=n.Tu.get(o);s=s.unionWith(l.view.nu)}return s}}function I1(t){const e=Z(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=w1.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Wb.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Bb.bind(null,e),e.Pu.H_=Pb.bind(null,e.eventManager),e.Pu.yu=Nb.bind(null,e.eventManager),e}function qb(t){const e=Z(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=zb.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=$b.bind(null,e),e}class Lu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=_c(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return Jk(this.persistence,new Kk,e.initialUser,this.serializer)}Cu(e){return new o1(Pp.mi,this.serializer)}Du(e){return new sb}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Lu.provider={build:()=>new Lu};class Kb extends Lu{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){pe(this.persistence.referenceDelegate instanceof Ou,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new Dk(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?At.withCacheSize(this.cacheSizeBytes):At.DEFAULT;return new o1(r=>Ou.mi(r,n),this.serializer)}}class ef{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>kv(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Gb.bind(null,this.syncEngine),await Rb(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Cb}()}createDatastore(e){const n=_c(e.databaseInfo.databaseId),r=function(i){return new ub(i)}(e.databaseInfo);return function(i,o,l,u){return new fb(i,o,l,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,l){return new mb(r,s,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>kv(this.syncEngine,n,0),function(){return Sv.v()?new Sv:new ib}())}createSyncEngine(e,n){return function(s,i,o,l,u,c,d){const m=new jb(s,i,o,l,u,c);return d&&(m.gu=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=Z(s);K(Es,"RemoteStore shutting down."),i.Ea.add(5),await Mi(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}ef.provider={build:()=>new ef};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hp{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Kn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mr="FirestoreClient";class Qb{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=pt.UNAUTHENTICATED,this.clientId=yp.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{K(Mr,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(K(Mr,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Un;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Mp(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Ah(t,e){t.asyncQueue.verifyOperationInProgress(),K(Mr,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await a1(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Dv(t,e){t.asyncQueue.verifyOperationInProgress();const n=await S1(t);K(Mr,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Av(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>Av(e.remoteStore,s)),t._onlineComponents=e}async function S1(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){K(Mr,"Using user provided OfflineComponentProvider");try{await Ah(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===V.FAILED_PRECONDITION||s.code===V.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;vi("Error using user provided cache. Falling back to memory cache: "+n),await Ah(t,new Lu)}}else K(Mr,"Using default OfflineComponentProvider"),await Ah(t,new Kb(void 0));return t._offlineComponents}async function Gp(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(K(Mr,"Using user provided OnlineComponentProvider"),await Dv(t,t._uninitializedComponentsProvider._online)):(K(Mr,"Using default OnlineComponentProvider"),await Dv(t,new ef))),t._onlineComponents}function R1(t){return S1(t).then(e=>e.persistence)}function A1(t){return Gp(t).then(e=>e.remoteStore)}function Yb(t){return Gp(t).then(e=>e.syncEngine)}async function Fu(t){const e=await Gp(t),n=e.eventManager;return n.onListen=Vb.bind(null,e.syncEngine),n.onUnlisten=Lb.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=Ob.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=Fb.bind(null,e.syncEngine),n}function Jb(t){return t.asyncQueue.enqueue(async()=>{const e=await R1(t),n=await A1(t);return e.setNetworkEnabled(!0),function(s){const i=Z(s);return i.Ea.delete(0),Na(i)}(n)})}function Xb(t){return t.asyncQueue.enqueue(async()=>{const e=await R1(t),n=await A1(t);return e.setNetworkEnabled(!1),async function(s){const i=Z(s);i.Ea.add(0),await Mi(i),i.Ra.set("Offline")}(n)})}function Zb(t,e,n={}){const r=new Un;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,c){const d=new Hp({next:g=>{d.Nu(),o.enqueueAndForget(()=>Fp(i,m));const E=g.docs.has(l);!E&&g.fromCache?c.reject(new G(V.UNAVAILABLE,"Failed to get document because the client is offline.")):E&&g.fromCache&&u&&u.source==="server"?c.reject(new G(V.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(g)},error:g=>c.reject(g)}),m=new Bp(fc(l.path),d,{includeMetadataChanges:!0,qa:!0});return Lp(i,m)}(await Fu(t),t.asyncQueue,e,n,r)),r.promise}function e2(t,e,n={}){const r=new Un;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,c){const d=new Hp({next:g=>{d.Nu(),o.enqueueAndForget(()=>Fp(i,m)),g.fromCache&&u.source==="server"?c.reject(new G(V.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(g)},error:g=>c.reject(g)}),m=new Bp(l,d,{includeMetadataChanges:!0,qa:!0});return Lp(i,m)}(await Fu(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C1(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jv=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P1="firestore.googleapis.com",Vv=!0;class Ov{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new G(V.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=P1,this.ssl=Vv}else this.host=e.host,this.ssl=e.ssl??Vv;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=i1;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<kk)throw new G(V.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}gN("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=C1(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new G(V.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new G(V.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new G(V.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ec{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ov({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new G(V.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new G(V.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ov(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new oN;switch(r.type){case"firstParty":return new cN(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new G(V.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=jv.get(n);r&&(K("ComponentProvider","Removing Datastore"),jv.delete(n),r.terminate())}(this),Promise.resolve()}}function t2(t,e,n,r={}){var c;t=It(t,Ec);const s=Ni(e),i=t._getSettings(),o={...i,emulatorOptions:t._getEmulatorOptions()},l=`${e}:${n}`;s&&(Sw(`https://${l}`),Rw("Firestore",!0)),i.host!==P1&&i.host!==l&&vi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...i,host:l,ssl:s,emulatorOptions:r};if(!ys(u,o)&&(t._setSettings(u),r.mockUserToken)){let d,m;if(typeof r.mockUserToken=="string")d=r.mockUserToken,m=pt.MOCK_USER;else{d=NR(r.mockUserToken,(c=t._app)==null?void 0:c.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new G(V.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new pt(g)}t._authCredentials=new aN(new gE(d,m))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hr{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Hr(this.firestore,e,this._query)}}class Pe{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Pr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Pe(this.firestore,e,this._key)}toJSON(){return{type:Pe._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(Aa(n,Pe._jsonSchema))return new Pe(e,r||null,new Y(ye.fromString(n.referencePath)))}}Pe._jsonSchemaVersion="firestore/documentReference/1.0",Pe._jsonSchema={type:Fe("string",Pe._jsonSchemaVersion),referencePath:Fe("string")};class Pr extends Hr{constructor(e,n,r){super(e,n,fc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Pe(this.firestore,null,new Y(e))}withConverter(e){return new Pr(this.firestore,e,this._path)}}function Vs(t,e,...n){if(t=Ye(t),yE("collection","path",e),t instanceof Ec){const r=ye.fromString(e,...n);return Qy(r),new Pr(t,null,r)}{if(!(t instanceof Pe||t instanceof Pr))throw new G(V.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ye.fromString(e,...n));return Qy(r),new Pr(t.firestore,null,r)}}function Nn(t,e,...n){if(t=Ye(t),arguments.length===1&&(e=yp.newId()),yE("doc","path",e),t instanceof Ec){const r=ye.fromString(e,...n);return Ky(r),new Pe(t,null,new Y(r))}{if(!(t instanceof Pe||t instanceof Pr))throw new G(V.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ye.fromString(e,...n));return Ky(r),new Pe(t.firestore,t instanceof Pr?t.converter:null,new Y(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mv="AsyncQueue";class Lv{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new u1(this,"async_queue_retry"),this._c=()=>{const r=Rh();r&&K(Mv,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=Rh();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Rh();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new Un;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Vi(e))throw e;K(Mv,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,Kn("INTERNAL UNHANDLED ERROR: ",Fv(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const s=Op.createAndSchedule(this,e,n,r,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&J(47125,{Pc:Fv(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function Fv(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uv(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class Rn extends Ec{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new Lv,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Lv(e),this._firestoreClient=void 0,await e}}}function n2(t,e){const n=typeof t=="object"?t:Nw(),r=typeof t=="string"?t:e||Nu,s=ip(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=CR("firestore");i&&t2(s,...i)}return s}function Fi(t){if(t._terminated)throw new G(V.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||r2(t),t._firestoreClient}function r2(t){var r,s,i;const e=t._freezeSettings(),n=function(l,u,c,d){return new AN(l,u,c,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,C1(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new Qb(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(t._componentsProvider))}function s2(t){return Jb(Fi(t=It(t,Rn)))}function i2(t){return Xb(Fi(t=It(t,Rn)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kt{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Kt(at.fromBase64String(e))}catch(n){throw new G(V.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Kt(at.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Kt._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Aa(e,Kt._jsonSchema))return Kt.fromBase64String(e.bytes)}}Kt._jsonSchemaVersion="firestore/bytes/1.0",Kt._jsonSchema={type:Fe("string",Kt._jsonSchemaVersion),bytes:Fe("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xc{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new G(V.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new st(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wp{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xn{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new G(V.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new G(V.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return oe(this._lat,e._lat)||oe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:xn._jsonSchemaVersion}}static fromJSON(e){if(Aa(e,xn._jsonSchema))return new xn(e.latitude,e.longitude)}}xn._jsonSchemaVersion="firestore/geoPoint/1.0",xn._jsonSchema={type:Fe("string",xn._jsonSchemaVersion),latitude:Fe("number"),longitude:Fe("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tn{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Tn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Aa(e,Tn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new Tn(e.vectorValues);throw new G(V.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Tn._jsonSchemaVersion="firestore/vectorValue/1.0",Tn._jsonSchema={type:Fe("string",Tn._jsonSchemaVersion),vectorValues:Fe("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o2=/^__.*__$/;class a2{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new $r(e,this.data,this.fieldMask,n,this.fieldTransforms):new Ca(e,this.data,n,this.fieldTransforms)}}class N1{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new $r(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function k1(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw J(40011,{Ac:t})}}class qp{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new qp({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Uu(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(k1(this.Ac)&&o2.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class l2{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||_c(e)}Cc(e,n,r,s=!1){return new qp({Ac:e,methodName:n,Dc:r,path:st.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Kp(t){const e=t._freezeSettings(),n=_c(t._databaseId);return new l2(t._databaseId,!!e.ignoreUndefinedProperties,n)}function u2(t,e,n,r,s,i={}){const o=t.Cc(i.merge||i.mergeFields?2:0,e,n,s);Qp("Data must be an object, but it was:",o,r);const l=b1(r,o);let u,c;if(i.merge)u=new Ut(o.fieldMask),c=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const m of i.mergeFields){const g=tf(e,m,n);if(!o.contains(g))throw new G(V.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);j1(d,g)||d.push(g)}u=new Ut(d),c=o.fieldTransforms.filter(m=>u.covers(m.field))}else u=null,c=o.fieldTransforms;return new a2(new Pt(l),u,c)}class Tc extends Wp{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Tc}}function c2(t,e,n,r){const s=t.Cc(1,e,n);Qp("Data must be an object, but it was:",s,r);const i=[],o=Pt.empty();zr(r,(u,c)=>{const d=Yp(e,u,n);c=Ye(c);const m=s.yc(d);if(c instanceof Tc)i.push(d);else{const g=ba(c,m);g!=null&&(i.push(d),o.set(d,g))}});const l=new Ut(i);return new N1(o,l,s.fieldTransforms)}function h2(t,e,n,r,s,i){const o=t.Cc(1,e,n),l=[tf(e,r,n)],u=[s];if(i.length%2!=0)throw new G(V.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<i.length;g+=2)l.push(tf(e,i[g])),u.push(i[g+1]);const c=[],d=Pt.empty();for(let g=l.length-1;g>=0;--g)if(!j1(c,l[g])){const E=l[g];let A=u[g];A=Ye(A);const C=o.yc(E);if(A instanceof Tc)c.push(E);else{const N=ba(A,C);N!=null&&(c.push(E),d.set(E,N))}}const m=new Ut(c);return new N1(d,m,o.fieldTransforms)}function d2(t,e,n,r=!1){return ba(n,t.Cc(r?4:3,e))}function ba(t,e){if(D1(t=Ye(t)))return Qp("Unsupported field value:",e,t),b1(t,e);if(t instanceof Wp)return function(r,s){if(!k1(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const l of r){let u=ba(l,s.wc(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Ye(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return QN(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=ce.fromDate(r);return{timestampValue:Vu(s.serializer,i)}}if(r instanceof ce){const i=new ce(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Vu(s.serializer,i)}}if(r instanceof xn)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Kt)return{bytesValue:XE(s.serializer,r._byteString)};if(r instanceof Pe){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Ap(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Tn)return function(o,l){return{mapValue:{fields:{[RE]:{stringValue:CE},[ku]:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw l.Sc("VectorValues must only contain numeric values.");return Tp(l.serializer,c)})}}}}}}(r,s);throw s.Sc(`Unsupported field value: ${uc(r)}`)}(t,e)}function b1(t,e){const n={};return wE(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):zr(t,(r,s)=>{const i=ba(s,e.mc(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function D1(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof ce||t instanceof xn||t instanceof Kt||t instanceof Pe||t instanceof Wp||t instanceof Tn)}function Qp(t,e,n){if(!D1(n)||!vE(n)){const r=uc(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function tf(t,e,n){if((e=Ye(e))instanceof xc)return e._internalPath;if(typeof e=="string")return Yp(t,e);throw Uu("Field path arguments must be of type string or ",t,!1,void 0,n)}const f2=new RegExp("[~\\*/\\[\\]]");function Yp(t,e,n){if(e.search(f2)>=0)throw Uu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new xc(...e.split("."))._internalPath}catch{throw Uu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Uu(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${r}`),o&&(u+=` in document ${s}`),u+=")"),new G(V.INVALID_ARGUMENT,l+t+u)}function j1(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V1{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Pe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new p2(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Jp("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class p2 extends V1{data(){return super.data()}}function Jp(t,e){return typeof e=="string"?Yp(t,e):e instanceof xc?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O1(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new G(V.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Xp{}class M1 extends Xp{}function Tl(t,e,...n){let r=[];e instanceof Xp&&r.push(e),r=r.concat(n),function(i){const o=i.filter(u=>u instanceof em).length,l=i.filter(u=>u instanceof Zp).length;if(o>1||o>0&&l>0)throw new G(V.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Zp extends M1{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Zp(e,n,r)}_apply(e){const n=this._parse(e);return L1(e._query,n),new Hr(e.firestore,e.converter,Hd(e._query,n))}_parse(e){const n=Kp(e.firestore);return function(i,o,l,u,c,d,m){let g;if(c.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new G(V.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){zv(m,d);const A=[];for(const C of m)A.push(Bv(u,i,C));g={arrayValue:{values:A}}}else g=Bv(u,i,m)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||zv(m,d),g=d2(l,o,m,d==="in"||d==="not-in");return Le.create(c,d,g)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}class em extends Xp{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new em(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:dn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const l=i.getFlattenedFilters();for(const u of l)L1(o,u),o=Hd(o,u)}(e._query,n),new Hr(e.firestore,e.converter,Hd(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class tm extends M1{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new tm(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new G(V.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new G(V.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new da(i,o)}(e._query,this._field,this._direction);return new Hr(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new Oi(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function Il(t,e="asc"){const n=e,r=Jp("orderBy",t);return tm._create(r,n)}function Bv(t,e,n){if(typeof(n=Ye(n))=="string"){if(n==="")throw new G(V.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!OE(e)&&n.indexOf("/")!==-1)throw new G(V.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(ye.fromString(n));if(!Y.isDocumentKey(r))throw new G(V.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return rv(t,new Y(r))}if(n instanceof Pe)return rv(t,n._key);throw new G(V.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${uc(n)}.`)}function zv(t,e){if(!Array.isArray(t)||t.length===0)throw new G(V.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function L1(t,e){const n=function(s,i){for(const o of s)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new G(V.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new G(V.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class m2{convertValue(e,n="none"){switch(Vr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ne(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(jr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw J(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return zr(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var r,s,i;const n=(i=(s=(r=e.fields)==null?void 0:r[ku].arrayValue)==null?void 0:s.values)==null?void 0:i.map(o=>Ne(o.doubleValue));return new Tn(n)}convertGeoPoint(e){return new xn(Ne(e.latitude),Ne(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=dc(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(ua(e));default:return null}}convertTimestamp(e){const n=Dr(e);return new ce(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=ye.fromString(e);pe(s1(r),9688,{name:e});const s=new ca(r.get(1),r.get(3)),i=new Y(r.popFirst(5));return s.isEqual(n)||Kn(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g2(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class To{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class cs extends V1{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Wl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Jp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new G(V.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=cs._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}cs._jsonSchemaVersion="firestore/documentSnapshot/1.0",cs._jsonSchema={type:Fe("string",cs._jsonSchemaVersion),bundleSource:Fe("string","DocumentSnapshot"),bundleName:Fe("string"),bundle:Fe("string")};class Wl extends cs{data(e={}){return super.data(e)}}class hs{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new To(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Wl(this._firestore,this._userDataWriter,r.key,r,new To(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new G(V.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(l=>{const u=new Wl(s._firestore,s._userDataWriter,l.doc.key,l.doc,new To(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const u=new Wl(s._firestore,s._userDataWriter,l.doc.key,l.doc,new To(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,d=-1;return l.type!==0&&(c=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),d=o.indexOf(l.doc.key)),{type:y2(l.type),doc:u,oldIndex:c,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new G(V.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=hs._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=yp.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function y2(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return J(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v2(t){t=It(t,Pe);const e=It(t.firestore,Rn);return Zb(Fi(e),t._key).then(n=>F1(e,t,n))}hs._jsonSchemaVersion="firestore/querySnapshot/1.0",hs._jsonSchema={type:Fe("string",hs._jsonSchemaVersion),bundleSource:Fe("string","QuerySnapshot"),bundleName:Fe("string"),bundle:Fe("string")};class nm extends m2{constructor(e){super(),this.firestore=e}convertBytes(e){return new Kt(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Pe(this.firestore,null,n)}}function po(t){t=It(t,Hr);const e=It(t.firestore,Rn),n=Fi(e),r=new nm(e);return O1(t._query),e2(n,t._query).then(s=>new hs(e,r,t,s))}function Ch(t,e,n){t=It(t,Pe);const r=It(t.firestore,Rn),s=g2(t.converter,e,n);return rm(r,[u2(Kp(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,cn.none())])}function Ph(t,e,n,...r){t=It(t,Pe);const s=It(t.firestore,Rn),i=Kp(s);let o;return o=typeof(e=Ye(e))=="string"||e instanceof xc?h2(i,"updateDoc",t._key,e,n,r):c2(i,"updateDoc",t._key,e),rm(s,[o.toMutation(t._key,cn.exists(!0))])}function Nh(t){return rm(It(t.firestore,Rn),[new Ip(t._key,cn.none())])}function _2(t,...e){var u,c,d;t=Ye(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||Uv(e[r])||(n=e[r++]);const s={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(Uv(e[r])){const m=e[r];e[r]=(u=m.next)==null?void 0:u.bind(m),e[r+1]=(c=m.error)==null?void 0:c.bind(m),e[r+2]=(d=m.complete)==null?void 0:d.bind(m)}let i,o,l;if(t instanceof Pe)o=It(t.firestore,Rn),l=fc(t._key.path),i={next:m=>{e[r]&&e[r](F1(o,t,m))},error:e[r+1],complete:e[r+2]};else{const m=It(t,Hr);o=It(m.firestore,Rn),l=m._query;const g=new nm(o);i={next:E=>{e[r]&&e[r](new hs(o,g,m,E))},error:e[r+1],complete:e[r+2]},O1(t._query)}return function(g,E,A,C){const N=new Hp(C),x=new Bp(E,N,A);return g.asyncQueue.enqueueAndForget(async()=>Lp(await Fu(g),x)),()=>{N.Nu(),g.asyncQueue.enqueueAndForget(async()=>Fp(await Fu(g),x))}}(Fi(o),l,s,i)}function rm(t,e){return function(r,s){const i=new Un;return r.asyncQueue.enqueueAndForget(async()=>Ub(await Yb(r),s,i)),i.promise}(Fi(t),e)}function F1(t,e,n){const r=n.docs.get(e._key),s=new nm(t);return new cs(t,s,e._key,r,new To(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(s){Di=s})(ki),gi(new vs("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),l=new Rn(new lN(r.getProvider("auth-internal")),new hN(o,r.getProvider("app-check-internal")),function(c,d){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new G(V.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ca(c.options.projectId,d)}(o,s),o);return i={useFetchStreams:n,...i},l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),Ar(Hy,Gy,e),Ar(Hy,Gy,"esm2020")})();const w2={apiKey:"AIzaSyBBJxbUabZm4ZKhDhIgbN4L3RzSHTB9HRs",authDomain:"knitting-counter-web.firebaseapp.com",projectId:"knitting-counter-web",storageBucket:"knitting-counter-web.firebasestorage.app",messagingSenderId:"991773187813",appId:"1:991773187813:web:97c6cd3d3e0add31213e0c",measurementId:"G-4T4J8NYV3D"},U1=Pw(w2),kh=nN(U1),tt=n2(U1),E2=new jn,ft=gw()(yw((t,e)=>({user:null,isLoading:!1,error:null,setUser:n=>t({user:n}),setLoading:n=>t({isLoading:n}),setError:n=>t({error:n}),signInWithGoogle:async()=>{try{t({isLoading:!0,error:null});const n=await hP(kh,E2);t({user:n.user,isLoading:!1})}catch(n){console.error("Google 登入失敗:",n),t({error:n.message||"登入失敗",isLoading:!1})}},signOut:async()=>{try{t({isLoading:!0,error:null}),await GC(kh),t({user:null,isLoading:!1})}catch(n){console.error("登出失敗:",n),t({error:n.message||"登出失敗",isLoading:!1})}},initialize:()=>HC(kh,n=>{t({user:n,isLoading:!1})})}),{name:"auth-storage",partialize:t=>({user:t.user})}));class x2{async getUserProfile(e){try{const n=Nn(tt,"users",e,"profile","info"),r=await v2(n);if(r.exists()){const s=r.data();return{uid:s.uid,displayName:s.displayName,email:s.email,createdAt:s.createdAt.toDate(),lastLogin:s.lastLogin.toDate()}}return null}catch(n){throw console.error("Error getting user profile:",n),n}}async createUserProfile(e){try{const n=Nn(tt,"users",e.uid,"profile","info");await Ch(n,{uid:e.uid,displayName:e.displayName,email:e.email,createdAt:ce.fromDate(e.createdAt),lastLogin:ce.fromDate(e.lastLogin)})}catch(n){throw console.error("Error creating user profile:",n),n}}async updateUserLastLogin(e){try{const n=Nn(tt,"users",e,"profile","info");await Ph(n,{lastLogin:ce.fromDate(new Date)})}catch(n){throw console.error("Error updating last login:",n),n}}async getUserProjects(e){try{const n=Vs(tt,"users",e,"projects"),r=Tl(n,Il("lastModified","desc")),s=await po(r),i=[];for(const o of s.docs){const l=o.data(),u=Vs(tt,"users",e,"projects",o.id,"rounds"),c=Tl(u,Il("roundNumber")),m=(await po(c)).docs.map(g=>{const E=g.data();return{id:E.id,roundNumber:E.roundNumber,stitches:E.stitches,stitchGroups:E.stitchGroups,notes:E.notes}});i.push({id:l.id,name:l.name,source:l.source,pattern:m,currentRound:l.currentRound,currentStitch:l.currentStitch,yarns:l.yarns,sessions:l.sessions.map(g=>({...g,startTime:g.startTime instanceof Date?g.startTime:g.startTime.toDate()})),createdDate:l.createdDate instanceof Date?l.createdDate:l.createdDate.toDate(),lastModified:l.lastModified instanceof Date?l.lastModified:l.lastModified.toDate(),isCompleted:l.isCompleted})}return i}catch(n){throw console.error("Error getting user projects:",n),n}}async createProject(e,n){try{const r=Nn(tt,"users",e,"projects",n.id),s={id:n.id,name:n.name,source:n.source,currentRound:n.currentRound,currentStitch:n.currentStitch,yarns:n.yarns,sessions:n.sessions.map(i=>({...i,startTime:i.startTime})),createdDate:n.createdDate,lastModified:n.lastModified,isCompleted:n.isCompleted};await Ch(r,{...s,createdDate:ce.fromDate(s.createdDate),lastModified:ce.fromDate(s.lastModified),sessions:s.sessions.map(i=>({...i,startTime:ce.fromDate(i.startTime)}))});for(const i of n.pattern)await this.createRound(e,n.id,i)}catch(r){throw console.error("Error creating project:",r),r}}async updateProject(e,n){try{const r=Nn(tt,"users",e,"projects",n.id),s={name:n.name,source:n.source,currentRound:n.currentRound,currentStitch:n.currentStitch,yarns:n.yarns,sessions:n.sessions.map(i=>({...i,startTime:i.startTime})),lastModified:n.lastModified,isCompleted:n.isCompleted};await Ph(r,{...s,lastModified:ce.fromDate(s.lastModified),sessions:s.sessions.map(i=>({...i,startTime:ce.fromDate(i.startTime)}))}),await this.syncRounds(e,n.id,n.pattern)}catch(r){throw console.error("Error updating project:",r),r}}async deleteProject(e,n){try{const r=Vs(tt,"users",e,"projects",n,"rounds"),s=await po(r);for(const o of s.docs)await Nh(o.ref);const i=Nn(tt,"users",e,"projects",n);await Nh(i)}catch(r){throw console.error("Error deleting project:",r),r}}async createRound(e,n,r){try{const s=Nn(tt,"users",e,"projects",n,"rounds",r.id);await Ch(s,{id:r.id,roundNumber:r.roundNumber,stitches:r.stitches,stitchGroups:r.stitchGroups,notes:r.notes})}catch(s){throw console.error("Error creating round:",s),s}}async updateRound(e,n,r){try{const s=Nn(tt,"users",e,"projects",n,"rounds",r.id);await Ph(s,{roundNumber:r.roundNumber,stitches:r.stitches,stitchGroups:r.stitchGroups,notes:r.notes})}catch(s){throw console.error("Error updating round:",s),s}}async deleteRound(e,n,r){try{const s=Nn(tt,"users",e,"projects",n,"rounds",r);await Nh(s)}catch(s){throw console.error("Error deleting round:",s),s}}async syncRounds(e,n,r){try{const s=Vs(tt,"users",e,"projects",n,"rounds"),i=await po(s),o=new Set(i.docs.map(u=>u.id)),l=new Set(r.map(u=>u.id));for(const u of o)l.has(u)||await this.deleteRound(e,n,u);for(const u of r)o.has(u.id)?await this.updateRound(e,n,u):await this.createRound(e,n,u)}catch(s){throw console.error("Error syncing rounds:",s),s}}subscribeToUserProjects(e,n){const r=Vs(tt,"users",e,"projects"),s=Tl(r,Il("lastModified","desc"));return _2(s,async i=>{try{const o=[];for(const l of i.docs){const u=l.data(),c=Vs(tt,"users",e,"projects",l.id,"rounds"),d=Tl(c,Il("roundNumber")),g=(await po(d)).docs.map(E=>{const A=E.data();return{id:A.id,roundNumber:A.roundNumber,stitches:A.stitches,stitchGroups:A.stitchGroups,notes:A.notes}});o.push({id:u.id,name:u.name,source:u.source,pattern:g,currentRound:u.currentRound,currentStitch:u.currentStitch,yarns:u.yarns,sessions:u.sessions.map(E=>({...E,startTime:E.startTime instanceof Date?E.startTime:E.startTime.toDate()})),createdDate:u.createdDate instanceof Date?u.createdDate:u.createdDate.toDate(),lastModified:u.lastModified instanceof Date?u.lastModified:u.lastModified.toDate(),isCompleted:u.isCompleted})}n(o)}catch(o){console.error("Error in projects subscription:",o)}})}async enableOfflineSupport(){try{await s2(tt)}catch(e){console.error("Error enabling offline support:",e)}}async disableOfflineSupport(){try{await i2(tt)}catch(e){console.error("Error disabling offline support:",e)}}}const Oe=new x2,Lt=gw()(yw((t,e)=>({projects:[],currentProject:null,isLoading:!1,error:null,isSyncing:!1,lastSyncTime:null,setLoading:n=>t({isLoading:n}),setError:n=>t({error:n}),setSyncing:n=>t({isSyncing:n}),clearUserData:()=>{t({projects:[],currentProject:null,error:null,lastSyncTime:null})},clearUserDataSilently:()=>{const n=e();Object.assign(n,{projects:[],currentProject:null,error:null,lastSyncTime:null})},loadUserProjects:async()=>{const{user:n}=ft.getState();if(!n){e().clearUserDataSilently();return}try{t({isLoading:!0,error:null});const r=await Oe.getUserProjects(n.uid);if(r.length>0){console.log("Loaded projects from Firestore:",r.length),t({projects:r,currentProject:r[0]||null,lastSyncTime:new Date});return}const s=`user_${n.uid}_knitting-counter-storage`,i=localStorage.getItem(s);if(i)try{const l=JSON.parse(i),u=l.state||l;if(u.projects&&u.projects.length>0){const c=u.projects.map(d=>{var m;return{...d,createdDate:new Date(d.createdDate),lastModified:new Date(d.lastModified),sessions:((m=d.sessions)==null?void 0:m.map(g=>({...g,startTime:new Date(g.startTime)})))||[]}});console.log("Migrating local projects to Firestore:",c.length);for(const d of c)await Oe.createProject(n.uid,d);t({projects:c,currentProject:c[0]||null,lastSyncTime:new Date});return}}catch(l){console.error("Error parsing saved data:",l)}console.log("No data found, creating sample project");const o=mh();await Oe.createProject(n.uid,o),t({projects:[o],currentProject:o,lastSyncTime:new Date})}catch(r){console.error("Error loading user projects:",r),t({error:"載入專案時發生錯誤"});const s=`user_${n.uid}_knitting-counter-storage`,i=localStorage.getItem(s);if(i)try{const o=JSON.parse(i),l=o.state||o;if(l.projects){const u=l.projects.map(c=>{var d;return{...c,createdDate:new Date(c.createdDate),lastModified:new Date(c.lastModified),sessions:((d=c.sessions)==null?void 0:d.map(m=>({...m,startTime:new Date(m.startTime)})))||[]}});t({projects:u,currentProject:u[0]||null})}}catch(o){console.error("Error loading from localStorage:",o);const l=mh();t({projects:[l],currentProject:l})}}finally{t({isLoading:!1})}},syncWithFirestore:async()=>{const{user:n}=ft.getState();if(n)try{t({isSyncing:!0,error:null});const r=await Oe.getUserProjects(n.uid);t({projects:r,currentProject:r.find(s=>{var i;return s.id===((i=e().currentProject)==null?void 0:i.id)})||r[0]||null,lastSyncTime:new Date})}catch(r){console.error("Error syncing with Firestore:",r),t({error:"同步失敗"})}finally{t({isSyncing:!1})}},initializeUserProfile:async n=>{try{if(await Oe.getUserProfile(n.uid))await Oe.updateUserLastLogin(n.uid);else{const s={uid:n.uid,displayName:n.displayName,email:n.email,createdAt:new Date,lastLogin:new Date};await Oe.createUserProfile(s)}}catch(r){console.error("Error initializing user profile:",r)}},subscribeToFirestoreChanges:()=>{const{user:n}=ft.getState();return n?Oe.subscribeToUserProjects(n.uid,r=>{const s=e();s.isSyncing||t({projects:r,currentProject:r.find(i=>{var o;return i.id===((o=s.currentProject)==null?void 0:o.id)})||r[0]||null,lastSyncTime:new Date})}):null},createProject:async(n,r)=>{const{user:s}=ft.getState(),i={id:Ke(),name:n,source:r,pattern:[],currentRound:1,currentStitch:0,yarns:[],sessions:[],createdDate:new Date,lastModified:new Date};if(t(o=>({projects:[...o.projects,i],currentProject:i})),s)try{await Oe.createProject(s.uid,i),t({lastSyncTime:new Date})}catch(o){console.error("Error syncing new project to Firestore:",o)}},updateProject:async n=>{const{user:r}=ft.getState(),s={...n,lastModified:new Date};if(t(i=>{var o;return{projects:i.projects.map(l=>l.id===n.id?s:l),currentProject:((o=i.currentProject)==null?void 0:o.id)===n.id?s:i.currentProject}}),r)try{await Oe.updateProject(r.uid,s),t({lastSyncTime:new Date})}catch(i){console.error("Error syncing project update to Firestore:",i)}},deleteProject:async n=>{const{user:r}=ft.getState();if(t(s=>{var i;return{projects:s.projects.filter(o=>o.id!==n),currentProject:((i=s.currentProject)==null?void 0:i.id)===n?null:s.currentProject}}),r)try{await Oe.deleteProject(r.uid,n),t({lastSyncTime:new Date})}catch(s){console.error("Error syncing project deletion to Firestore:",s)}},setCurrentProject:n=>{const r=e().projects.find(s=>s.id===n);r&&t({currentProject:r})},loadProjects:async()=>{const{projects:n}=e();if(n.length===0){const r=mh();t({projects:[r],currentProject:r})}},nextStitch:async()=>{const{currentProject:n}=e();if(!n||n.isCompleted){console.log("[DEBUG] nextStitch: No current project or already completed");return}const r=n.pattern.find(c=>c.roundNumber===n.currentRound);if(!r){console.log("[DEBUG] nextStitch: Current round not found",n.currentRound);return}const s=Gn(r);let i=n.currentStitch+1,o=n.currentRound,l=!1;if(i>=s){const c=Math.max(...n.pattern.map(d=>d.roundNumber));n.currentRound>=c?(l=!0,i=s,o=n.currentRound):(i=0,o=n.currentRound+1)}const u={...n,currentRound:o,currentStitch:i,isCompleted:l,lastModified:new Date};await e().updateProject(u)},previousStitch:async()=>{const{currentProject:n}=e();if(!n)return;let r=n.currentStitch-1,s=n.currentRound;if(r<0&&s>1){s=n.currentRound-1;const o=n.pattern.find(l=>l.roundNumber===s);o?r=Gn(o)-1:r=0}else r<0&&(r=0);const i={...n,currentRound:s,currentStitch:r,lastModified:new Date};await e().updateProject(i)},setCurrentRound:async n=>{const{currentProject:r}=e();if(!r)return;const s={...r,currentRound:n,currentStitch:0,lastModified:new Date};await e().updateProject(s)},setCurrentStitch:async n=>{const{currentProject:r}=e();if(!r)return;const s={...r,currentStitch:n,lastModified:new Date};await e().updateProject(s)},startSession:async()=>{const{currentProject:n}=e();if(!n)return;const r={id:Ke(),startTime:new Date,duration:0,roundsCompleted:0,stitchesCompleted:0},s={...n,sessions:[...n.sessions,r],lastModified:new Date};await e().updateProject(s)},endSession:async()=>{const{currentProject:n}=e();if(!n||n.sessions.length===0)return;const r=n.sessions[n.sessions.length-1];if(r.duration>0)return;const i=Math.floor((new Date().getTime()-r.startTime.getTime())/1e3),o={...r,duration:i},l={...n,sessions:[...n.sessions.slice(0,-1),o],lastModified:new Date};await e().updateProject(l)},addRound:async n=>{const{currentProject:r}=e();if(!r)return;const s={...r,pattern:[...r.pattern,n],lastModified:new Date};await e().updateProject(s)},updateRound:async n=>{const{currentProject:r}=e();if(!r)return;const s={...r,pattern:r.pattern.map(i=>i.id===n.id?n:i),lastModified:new Date};await e().updateProject(s)},deleteRound:async n=>{const{currentProject:r}=e();if(!r)return;const i=r.pattern.filter(u=>u.roundNumber!==n).map(u=>u.roundNumber>n?{...u,roundNumber:u.roundNumber-1}:u);let o=r.currentRound;o>n&&(o=Math.max(1,o-1));const l={...r,pattern:i,currentRound:o,currentStitch:0,lastModified:new Date};await e().updateProject(l)},addStitchToRound:async(n,r)=>{const{currentProject:s}=e();if(!s)return;const i=s.pattern.map(l=>l.roundNumber===n?{...l,stitches:[...l.stitches,r]}:l),o={...s,pattern:i,lastModified:new Date};await e().updateProject(o)},addStitchGroupToRound:async(n,r)=>{const{currentProject:s}=e();if(!s)return;const i=s.pattern.map(l=>l.roundNumber===n?{...l,stitchGroups:[...l.stitchGroups,r]}:l),o={...s,pattern:i,lastModified:new Date};await e().updateProject(o)},updateStitchInRound:async(n,r,s)=>{const{currentProject:i}=e();if(!i)return;const o=i.pattern.map(u=>u.roundNumber===n?{...u,stitches:u.stitches.map(c=>c.id===r?s:c)}:u),l={...i,pattern:o,lastModified:new Date};await e().updateProject(l)},deleteStitchFromRound:async(n,r)=>{const{currentProject:s}=e();if(!s)return;const i=s.pattern.map(l=>l.roundNumber===n?{...l,stitches:l.stitches.filter(u=>u.id!==r)}:l),o={...s,pattern:i,lastModified:new Date};await e().updateProject(o)},reorderStitchesInRound:async(n,r,s)=>{const{currentProject:i}=e();if(!i)return;const o=i.pattern.map(u=>{if(u.roundNumber===n){const c=[...u.stitches],[d]=c.splice(r,1);return c.splice(s,0,d),{...u,stitches:c}}return u}),l={...i,pattern:o,lastModified:new Date};await e().updateProject(l)},updateStitchGroupInRound:async(n,r,s)=>{const{currentProject:i}=e();if(!i)return;const o=i.pattern.map(u=>u.roundNumber===n?{...u,stitchGroups:u.stitchGroups.map(c=>c.id===r?s:c)}:u),l={...i,pattern:o,lastModified:new Date};await e().updateProject(l)},deleteStitchGroupFromRound:async(n,r)=>{const{currentProject:s}=e();if(!s)return;const i=s.pattern.map(l=>l.roundNumber===n?{...l,stitchGroups:l.stitchGroups.filter(u=>u.id!==r)}:l),o={...s,pattern:i,lastModified:new Date};await e().updateProject(o)},reorderStitchGroupsInRound:async(n,r,s)=>{const{currentProject:i}=e();if(!i)return;const o=i.pattern.map(u=>{if(u.roundNumber===n){const c=[...u.stitchGroups],[d]=c.splice(r,1);return c.splice(s,0,d),{...u,stitchGroups:c}}return u}),l={...i,pattern:o,lastModified:new Date};await e().updateProject(l)},addYarn:async n=>{const{currentProject:r}=e();if(!r)return;const s={...r,yarns:[...r.yarns,n],lastModified:new Date};await e().updateProject(s)},updateYarn:async n=>{const{currentProject:r}=e();if(!r)return;const s={...r,yarns:r.yarns.map(i=>i.id===n.id?n:i),lastModified:new Date};await e().updateProject(s)},deleteYarn:async n=>{const{currentProject:r}=e();if(!r)return;const s={...r,yarns:r.yarns.filter(i=>i.id!==n),lastModified:new Date};await e().updateProject(s)}}),{name:"synced-knitting-counter-storage",version:1,partialize:t=>({projects:t.projects,currentProject:t.currentProject,lastSyncTime:t.lastSyncTime}),storage:{getItem:t=>{var s;const{user:e}=ft.getState();if(console.log("getItem called:",{name:t,user:e==null?void 0:e.uid}),!e)return console.log("No user - returning empty state"),JSON.stringify({state:{projects:[],currentProject:null,lastSyncTime:null},version:1});const n=`user_${e.uid}_${t}`,r=localStorage.getItem(n);if(console.log("Loading from storage:",{userStorageKey:n,hasData:!!r}),!r)return console.log("No data found - returning empty state"),JSON.stringify({state:{projects:[],currentProject:null,lastSyncTime:null},version:1});try{const i=JSON.parse(r);return i.state&&(i.state.projects&&(i.state.projects=i.state.projects.map(o=>{var l;return{...o,createdDate:new Date(o.createdDate),lastModified:new Date(o.lastModified),sessions:((l=o.sessions)==null?void 0:l.map(u=>({...u,startTime:new Date(u.startTime)})))||[]}})),i.state.currentProject&&(i.state.currentProject={...i.state.currentProject,createdDate:new Date(i.state.currentProject.createdDate),lastModified:new Date(i.state.currentProject.lastModified),sessions:((s=i.state.currentProject.sessions)==null?void 0:s.map(o=>({...o,startTime:new Date(o.startTime)})))||[]}),i.state.lastSyncTime&&(i.state.lastSyncTime=new Date(i.state.lastSyncTime))),i}catch{return null}},setItem:(t,e)=>{var s,i,o,l,u;const{user:n}=ft.getState();if(!n){console.log("No user - skipping save to localStorage");return}const r=`user_${n.uid}_${t}`;console.log(`Saving to ${r}`,{projects:((i=(s=e==null?void 0:e.state)==null?void 0:s.projects)==null?void 0:i.length)||0,currentProject:((l=(o=e==null?void 0:e.state)==null?void 0:o.currentProject)==null?void 0:l.name)||"none",lastSyncTime:(u=e==null?void 0:e.state)==null?void 0:u.lastSyncTime}),localStorage.setItem(r,JSON.stringify(e))},removeItem:t=>{const{user:e}=ft.getState();if(!e)return;const n=`user_${e.uid}_${t}`;localStorage.removeItem(n)}}}));class T2{async mergeLocalAndRemoteData(e,n,r={strategy:"newest_wins",autoResolve:!0}){try{const s=await Oe.getUserProjects(e);console.log("Merging data:",{localCount:n.length,remoteCount:s.length,strategy:r.strategy});const i={success:!0,merged:[],conflicts:[],errors:[]},o=new Map(n.map(c=>[c.id,c])),l=new Map(s.map(c=>[c.id,c])),u=new Set([...o.keys(),...l.keys()]);for(const c of u){const d=o.get(c),m=l.get(c);if(d&&!m){console.log(`Uploading local-only project: ${d.name}`);try{await Oe.createProject(e,d),i.merged.push(d)}catch(g){console.error("Error uploading local project:",g),i.errors.push(`Failed to upload project ${d.name}`),i.merged.push(d)}}else if(!d&&m)console.log(`Adding remote-only project: ${m.name}`),i.merged.push(m);else if(d&&m){const g=await this.mergeProjects(e,d,m,r);g.conflict&&!r.autoResolve&&i.conflicts.push(g.conflict),i.merged.push(g.merged)}}return i.conflicts.length>0&&!r.autoResolve&&(i.success=!1),console.log("Merge completed:",{merged:i.merged.length,conflicts:i.conflicts.length,errors:i.errors.length}),i}catch(s){return console.error("Error in merge operation:",s),{success:!1,merged:n,conflicts:[],errors:[s instanceof Error?s.message:"Unknown error during merge"]}}}async mergeProjects(e,n,r,s){const i=n.lastModified.getTime(),o=r.lastModified.getTime();console.log(`Merging project ${n.name}:`,{localTime:new Date(i).toISOString(),remoteTime:new Date(o).toISOString(),timeDiff:i-o});let l,u;switch(Math.abs(i-o)<1e3?u={projectId:n.id,projectName:n.name,localVersion:n,remoteVersion:r,conflictType:"both_modified"}:i>o?u={projectId:n.id,projectName:n.name,localVersion:n,remoteVersion:r,conflictType:"local_newer"}:u={projectId:n.id,projectName:n.name,localVersion:n,remoteVersion:r,conflictType:"remote_newer"},s.strategy){case"local_wins":l=n;break;case"remote_wins":l=r;break;case"newest_wins":default:l=i>=o?n:r;break}if(s.autoResolve)try{await Oe.updateProject(e,l),console.log(`Auto-resolved conflict for ${l.name}, chose ${i>=o?"local":"remote"} version`),u=void 0}catch(c){console.error("Error auto-resolving conflict:",c),l=n}return{merged:l,conflict:u}}async resolveConflict(e,n,r,s){try{let i;switch(r){case"use_local":i=n.localVersion;break;case"use_remote":i=n.remoteVersion;break;case"custom":if(!s)throw new Error("Custom project required for custom resolution");i=s;break;default:throw new Error(`Unknown resolution type: ${r}`)}return await Oe.updateProject(e,i),console.log(`Conflict resolved for project ${n.projectName} using ${r}`),!0}catch(i){return console.error("Error resolving conflict:",i),!1}}async syncProjectChanges(e,n){try{const s=(await Oe.getUserProjects(e)).find(i=>i.id===n.id);return s?s.lastModified.getTime()>n.lastModified.getTime()?(console.log(`Remote version is newer for ${n.name}, skipping sync`),!1):(await Oe.updateProject(e,n),console.log(`Synced project changes: ${n.name}`),!0):(await Oe.createProject(e,n),console.log(`Created new project in cloud: ${n.name}`),!0)}catch(r){return console.error("Error syncing project changes:",r),!1}}async performIncrementalSync(e,n,r){try{const s={updated:[],conflicts:[],errors:[]},i=await Oe.getUserProjects(e),o=n?i.filter(l=>l.lastModified.getTime()>n.getTime()):i;console.log(`Incremental sync: ${o.length} changed remote projects`);for(const l of o){const u=r.find(c=>c.id===l.id);if(!u)s.updated.push(l);else{const c=u.lastModified.getTime(),d=l.lastModified.getTime();if(Math.abs(c-d)>1e3)if(d>c)s.updated.push(l);else try{await Oe.updateProject(e,u),s.updated.push(u)}catch(m){s.errors.push(`Failed to sync ${u.name}: ${m}`)}}}return s}catch(s){return console.error("Error in incremental sync:",s),{updated:[],conflicts:[],errors:[s instanceof Error?s.message:"Unknown error"]}}}}const $v=new T2;class I2{constructor(){Qm(this,"unsubscribeFirestore",null)}async handleUserLogin(e){console.log("User logged in:",e.uid);try{const n=Lt.getState();await n.initializeUserProfile(e),await n.loadUserProjects(),this.unsubscribeFirestore=n.subscribeToFirestoreChanges(),console.log("User login handling completed")}catch(n){console.error("Error handling user login:",n),Lt.getState().setError("登入時載入數據失敗")}}async handleUserLogout(){console.log("User logged out");try{this.unsubscribeFirestore&&(this.unsubscribeFirestore(),this.unsubscribeFirestore=null),Lt.getState().clearUserData(),console.log("User logout handling completed")}catch(e){console.error("Error handling user logout:",e)}}async handleUserSwitch(e,n){console.log("User switched:",{from:(n==null?void 0:n.uid)||"none",to:e.uid});try{n&&await this.handleUserLogout(),await this.handleUserLogin(e),console.log("User switch handling completed")}catch(r){console.error("Error handling user switch:",r)}}async performCrossDeviceSync(e){console.log("Performing cross-device sync for user:",e.uid);try{const n=Lt.getState();n.setSyncing(!0);const r=n.projects,s=await $v.mergeLocalAndRemoteData(e.uid,r,{strategy:"newest_wins",autoResolve:!0});s.success?(n.projects=s.merged,n.currentProject=s.merged.find(i=>{var o;return i.id===((o=n.currentProject)==null?void 0:o.id)})||s.merged[0]||null,n.lastSyncTime=new Date,console.log("Cross-device sync completed successfully:",{merged:s.merged.length,conflicts:s.conflicts.length,errors:s.errors.length})):(console.warn("Cross-device sync completed with issues:",s.errors),n.setError("同步過程中發生問題"))}catch(n){console.error("Error in cross-device sync:",n),Lt.getState().setError("跨裝置同步失敗")}finally{Lt.getState().setSyncing(!1)}}setupAuthStateListener(){let e=null;const n=ft.getState().initialize(),r=setInterval(()=>{const s=ft.getState().user;(e==null?void 0:e.uid)!==(s==null?void 0:s.uid)&&(console.log("Auth state changed:",{previousUser:(e==null?void 0:e.uid)||"none",currentUser:(s==null?void 0:s.uid)||"none"}),!e&&s?this.handleUserLogin(s):e&&!s?this.handleUserLogout():e&&s&&e.uid!==s.uid?this.handleUserSwitch(s,e):s&&this.performCrossDeviceSync(s),e=s)},1e3);return()=>{n(),clearInterval(r)}}async forceSync(){const{user:e}=ft.getState();e&&await this.performCrossDeviceSync(e)}async resolveConflicts(e,n){const{user:r}=ft.getState();if(!r)return!1;try{for(const s of e){const i=n[s.projectId];i&&await $v.resolveConflict(r.uid,s,i==="local"?"use_local":"use_remote")}return await this.performCrossDeviceSync(r),!0}catch(s){return console.error("Error resolving conflicts:",s),!1}}}const ql=new I2;function S2(){const{user:t,signOut:e,isLoading:n}=ft(),r=async()=>{try{await e()}catch(s){console.error("登出失敗:",s)}};return t?f.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[t.photoURL&&f.jsx("img",{src:t.photoURL,alt:t.displayName||"使用者",className:"w-6 h-6 sm:w-8 sm:h-8 rounded-full"}),f.jsxs("div",{className:"hidden md:block",children:[f.jsx("p",{className:"text-xs sm:text-sm font-medium text-text-primary",children:t.displayName||"使用者"}),f.jsx("p",{className:"text-xs text-text-secondary",children:t.email})]})]}),f.jsx("button",{onClick:r,disabled:n,className:"text-xs sm:text-sm text-text-secondary hover:text-text-primary transition-colors disabled:opacity-50",title:"登出並清除當前用戶數據",children:n?"登出中...":"登出"})]}):null}function R2(){const{projects:t,createProject:e,deleteProject:n}=Lt(),[r,s]=M.useState(!1),[i,o]=M.useState(""),[l,u]=M.useState("");console.log("ProjectListView 渲染，專案數量:",t.length);const c=d=>{d.preventDefault(),i.trim()&&(e(i.trim(),l.trim()||void 0),o(""),u(""),s(!1))};return f.jsxs("div",{className:"min-h-screen bg-background-primary safe-top safe-bottom",children:[f.jsx("div",{className:"bg-background-secondary border-b border-border",children:f.jsx("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-4 sm:py-6",children:f.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[f.jsx("h1",{className:"text-xl sm:text-2xl lg:text-3xl font-bold text-text-primary",children:"編織專案"}),f.jsxs("div",{className:"flex items-center gap-2 sm:gap-4 w-full sm:w-auto justify-between sm:justify-end",children:[f.jsx(S2,{}),f.jsx("button",{onClick:()=>s(!0),className:"btn btn-primary text-xs sm:text-sm",children:"新增專案"})]})]})})}),f.jsx("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-4 sm:py-6",children:t.length===0?f.jsxs("div",{className:"text-center py-8 sm:py-12",children:[f.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-text-primary mb-2",children:"還沒有編織專案"}),f.jsx("p",{className:"text-sm sm:text-base text-text-secondary mb-6",children:"建立你的第一個編織專案開始記錄進度"}),f.jsx("button",{onClick:()=>s(!0),className:"btn btn-primary text-sm sm:text-base",children:"建立新專案"})]}):f.jsx("div",{className:"grid gap-3 sm:gap-4 md:gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:t.map(d=>f.jsxs("div",{className:`card hover:shadow-md transition-shadow ${d.isCompleted?"ring-2 ring-green-200 bg-green-50":""}`,children:[f.jsxs("div",{className:"flex items-start justify-between mb-3",children:[f.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[f.jsx("h3",{className:"text-base sm:text-lg font-semibold text-text-primary truncate",children:d.name}),d.isCompleted&&f.jsx("span",{className:"text-green-600 text-sm font-medium",children:"完成"})]}),f.jsx("button",{onClick:()=>n(d.id),className:"text-text-tertiary hover:text-red-500 transition-colors text-sm sm:text-base ml-2",children:"刪除"})]}),f.jsxs("div",{className:"space-y-2 mb-4",children:[f.jsxs("div",{className:"flex justify-between text-xs sm:text-sm",children:[f.jsx("span",{className:"text-text-secondary",children:"進度"}),f.jsxs("span",{className:"text-text-primary",children:[d.isCompleted?"100":Math.round(Pd(d)*100),"%"]})]}),f.jsx("div",{className:"w-full bg-background-tertiary rounded-full h-1.5 sm:h-2",children:f.jsx("div",{className:`h-1.5 sm:h-2 rounded-full transition-all duration-300 ${d.isCompleted?"bg-green-500":"bg-primary"}`,style:{width:`${d.isCompleted?100:Pd(d)*100}%`}})})]}),f.jsxs("div",{className:"space-y-1 mb-4 text-xs sm:text-sm text-text-secondary",children:[f.jsxs("div",{children:["圈數: ",d.currentRound,"/",wu(d)]}),f.jsxs("div",{children:["針數: ",np(d),"/",ia(d)]}),f.jsxs("div",{children:["更新: ",Cd(d.lastModified)]})]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx(xt,{to:`/project/${d.id}/progress`,className:"btn btn-primary flex-1",children:"開始編織"}),f.jsx(xt,{to:`/project/${d.id}`,className:"btn btn-secondary",children:"詳情"})]})]},d.id))})}),r&&f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:f.jsxs("div",{className:"bg-background-secondary rounded-xl p-6 w-full max-w-md",children:[f.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-4",children:"建立新專案"}),f.jsxs("form",{onSubmit:c,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"專案名稱 *"}),f.jsx("input",{type:"text",value:i,onChange:d=>o(d.target.value),className:"input",placeholder:"輸入專案名稱",required:!0,autoFocus:!0})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"來源網址（選填）"}),f.jsx("input",{type:"url",value:l,onChange:d=>u(d.target.value),className:"input",placeholder:"https://..."})]}),f.jsxs("div",{className:"flex gap-3 pt-4",children:[f.jsx("button",{type:"button",onClick:()=>s(!1),className:"btn btn-secondary flex-1",children:"取消"}),f.jsx("button",{type:"submit",className:"btn btn-primary flex-1",children:"建立"})]})]})]})})]})}function A2(){const{projectId:t}=Ea(),e=Pi(),{currentProject:n,setCurrentProject:r,projects:s}=Lt();return M.useEffect(()=>{t&&(s.find(o=>o.id===t)?r(t):e("/404"))},[t,r,s,e]),n?f.jsxs("div",{className:"min-h-screen bg-background-primary safe-top safe-bottom",children:[f.jsx("div",{className:"bg-background-secondary border-b border-border",children:f.jsx("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-3 sm:py-4",children:f.jsxs("div",{className:"flex items-center gap-3 sm:gap-4",children:[f.jsx(xt,{to:"/",className:"text-text-secondary hover:text-text-primary transition-colors text-sm sm:text-base",children:"← 返回"}),f.jsx("h1",{className:"text-lg sm:text-xl font-semibold text-text-primary truncate",children:n.name})]})})}),f.jsxs("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-4 sm:py-6 space-y-4 sm:space-y-6",children:[f.jsxs("div",{className:"card",children:[f.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-4",children:"專案資訊"}),f.jsxs("div",{className:"space-y-4",children:[n.source&&f.jsxs("div",{children:[f.jsx("div",{className:"text-sm text-text-secondary mb-1",children:"來源"}),f.jsx("a",{href:n.source,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline break-all text-sm",children:n.source})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("div",{className:"text-sm text-text-secondary mb-1",children:"建立日期"}),f.jsx("div",{className:"text-text-primary text-sm",children:Cd(n.createdDate)})]}),f.jsxs("div",{children:[f.jsx("div",{className:"text-sm text-text-secondary mb-1",children:"最後修改"}),f.jsx("div",{className:"text-text-primary text-sm",children:Cd(n.lastModified)})]})]}),f.jsxs("div",{className:"grid grid-cols-3 gap-4 pt-2 border-t border-border",children:[f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"text-sm text-text-secondary",children:"使用毛線"}),f.jsx("div",{className:"text-lg font-semibold text-text-primary",children:n.yarns.length})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"text-sm text-text-secondary",children:"織圖圈數"}),f.jsx("div",{className:"text-lg font-semibold text-text-primary",children:n.pattern.length})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"text-sm text-text-secondary",children:"總針數"}),f.jsx("div",{className:"text-lg font-semibold text-text-primary",children:ia(n)})]})]})]})]}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:[f.jsx(xt,{to:`/project/${n.id}/progress`,className:"card hover:shadow-md transition-shadow cursor-pointer",children:f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx("div",{className:"text-3xl",children:"▶️"}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-semibold text-text-primary",children:"開始編織"}),f.jsx("p",{className:"text-sm text-text-secondary",children:"追蹤編織進度"})]})]})}),f.jsx(xt,{to:`/project/${n.id}/pattern`,className:"card hover:shadow-md transition-shadow cursor-pointer",children:f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx("div",{className:"text-3xl",children:"📝"}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-semibold text-text-primary",children:"編輯織圖"}),f.jsx("p",{className:"text-sm text-text-secondary",children:"管理圈數和針法"})]})]})}),f.jsx(xt,{to:`/project/${n.id}/yarns`,className:"card hover:shadow-md transition-shadow cursor-pointer",children:f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx("div",{className:"text-3xl",children:"🧶"}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-semibold text-text-primary",children:"毛線管理"}),f.jsx("p",{className:"text-sm text-text-secondary",children:"管理專案毛線"})]})]})}),f.jsx(xt,{to:`/project/${n.id}/import-export`,className:"card hover:shadow-md transition-shadow cursor-pointer",children:f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx("div",{className:"text-3xl",children:"📤"}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-semibold text-text-primary",children:"匯入匯出"}),f.jsx("p",{className:"text-sm text-text-secondary",children:"備份和分享"})]})]})})]}),f.jsxs("div",{className:"card",children:[f.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-4",children:"使用的毛線"}),n.yarns.length===0?f.jsxs("div",{className:"text-center py-8",children:[f.jsx("div",{className:"text-4xl mb-3",children:"🧶"}),f.jsx("p",{className:"text-text-tertiary mb-3",children:"尚未添加毛線"}),f.jsx(xt,{to:`/project/${n.id}/yarns`,className:"text-primary hover:underline text-sm",children:"點擊這裡管理毛線"})]}):f.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:n.yarns.map(i=>f.jsxs("div",{className:"flex items-center gap-3 p-3 bg-background-secondary rounded-lg",children:[f.jsx("div",{className:"w-8 h-8 rounded-full border-2 border-white shadow-sm flex-shrink-0",style:{backgroundColor:i.color.hex}}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("h3",{className:"font-medium text-text-primary truncate",children:i.name}),i.brand&&f.jsx("p",{className:"text-sm text-text-secondary truncate",children:i.brand}),f.jsx("p",{className:"text-xs text-text-tertiary",children:i.color.name})]})]},i.id))})]}),f.jsxs("div",{className:"card",children:[f.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-4",children:"織圖"}),n.pattern.length===0?f.jsxs("div",{className:"text-center py-8",children:[f.jsx("div",{className:"text-4xl mb-3",children:"📝"}),f.jsx("p",{className:"text-text-tertiary mb-3",children:"尚未建立織圖"}),f.jsx(xt,{to:`/project/${n.id}/pattern`,className:"text-primary hover:underline text-sm",children:"點擊這裡開始編輯織圖"})]}):f.jsxs("div",{className:"space-y-4",children:[f.jsx("div",{className:"space-y-3",children:n.pattern.slice(0,5).map(i=>{const o=Gn(i),l=vR(i,n.yarns);return f.jsxs("div",{className:"flex gap-3 p-3 bg-background-secondary rounded-lg",children:[f.jsxs("div",{className:"text-sm font-semibold flex-shrink-0 leading-relaxed",style:{color:"#d96699"},children:["R",i.roundNumber]}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("p",{className:"text-text-primary font-medium text-sm leading-relaxed m-0",children:l}),i.notes&&f.jsx("p",{className:"text-xs text-text-tertiary mt-1",children:i.notes})]}),f.jsx("div",{className:"text-right flex-shrink-0",children:f.jsxs("p",{className:"text-sm font-semibold text-text-primary leading-relaxed m-0",children:[o," 針"]})})]},i.id)})}),f.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-border",children:[f.jsxs("div",{className:"text-sm font-medium text-text-secondary",children:["總圈數: ",wu(n)]}),f.jsxs("div",{className:"text-sm font-medium text-text-secondary",children:["總針數: ",ia(n)]})]}),n.pattern.length>5&&f.jsx("div",{className:"text-center pt-2",children:f.jsxs(xt,{to:`/project/${n.id}/pattern`,className:"text-primary hover:underline text-sm",children:["查看全部 ",n.pattern.length," 圈織圖"]})})]})]})]})]}):f.jsx("div",{className:"min-h-screen bg-background-primary flex items-center justify-center",children:f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),f.jsx("p",{className:"text-text-secondary",children:"載入中..."})]})})}function C2(){const{projectId:t}=Ea(),e=Pi(),{currentProject:n,setCurrentProject:r,projects:s,addRound:i,updateRound:o,deleteRound:l,addStitchToRound:u,addStitchGroupToRound:c,updateStitchInRound:d,deleteStitchFromRound:m,reorderStitchesInRound:g,updateStitchGroupInRound:E,deleteStitchGroupFromRound:A,reorderStitchGroupsInRound:C}=Lt(),[N,x]=M.useState(!1),[v,T]=M.useState(null),[D,L]=M.useState(null),[B,I]=M.useState(null),[_,S]=M.useState(null),[w,P]=M.useState(null),[b,R]=M.useState(""),[Ue,Gt]=M.useState(ss.SINGLE),[jt,Je]=M.useState(1),[H,$]=M.useState(""),[q,ne]=M.useState(1),[te,se]=M.useState([]),[De,Be]=M.useState(ss.SINGLE),[je,Xe]=M.useState(1),[Zn,Da]=M.useState(""),[Gr,Wr]=M.useState(1),[Rs,As]=M.useState(null),[Cs,Ps]=M.useState(null);if(M.useEffect(()=>{t&&(s.find(F=>F.id===t)?r(t):e("/404"))},[t,r,s,e]),!n)return f.jsx("div",{className:"min-h-screen bg-background-primary flex items-center justify-center",children:f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),f.jsx("p",{className:"text-text-secondary",children:"載入中..."})]})});const ja=()=>{const W=Math.max(0,...n.pattern.map(le=>le.roundNumber))+1,F={id:Ke(),roundNumber:W,stitches:[],stitchGroups:[],notes:b.trim()||void 0};i(F),R(""),x(!1)},Va=W=>{confirm(`確定要刪除第 ${W} 圈嗎？`)&&l(W)},Ic=W=>{var le;const F={id:Ke(),type:Ue,yarnId:((le=n.yarns[0])==null?void 0:le.id)||"",count:jt};u(W,F),Je(1),T(null)},Oa=W=>{if(te.length===0){alert("請先新增群組中的針法");return}const F={id:Ke(),name:H.trim()||"針目群組",stitches:[...te],repeatCount:q};c(W,F),$(""),ne(1),se([]),L(null)},Ma=()=>{var F;const W={id:Ke(),type:Ue,yarnId:((F=n.yarns[0])==null?void 0:F.id)||"",count:jt};se([...te,W]),Je(1)},Ui=W=>{se(te.filter(F=>F.id!==W))},Bi=(W,F)=>{const le={...W,notes:F.trim()||void 0};o(le),I(null)},Sc=(W,F)=>{S({roundNumber:W,stitchId:F.id}),Be(F.type),Xe(F.count)},zi=(W,F)=>{var de;const le={id:F,type:De,yarnId:((de=n.yarns[0])==null?void 0:de.id)||"",count:je};d(W,F,le),S(null)},$i=(W,F)=>{confirm("確定要刪除這個針法嗎？")&&m(W,F)},Hi=(W,F)=>{P({roundNumber:W,groupId:F.id}),Da(F.name),Wr(F.repeatCount)},Ge=(W,F,le)=>{const de={...le,name:Zn.trim()||"針目群組",repeatCount:Gr};E(W,F,de),P(null)},Ze=(W,F)=>{confirm("確定要刪除這個針目群組嗎？")&&A(W,F)},qr=(W,F,le,de)=>{de==="stitch"?As({index:le,stitch:F}):Ps({index:le,group:F})},Gi=W=>{W.preventDefault()},Wi=(W,F,le,de)=>{W.preventDefault(),de==="stitch"&&Rs?(g(le,Rs.index,F),As(null)):de==="group"&&Cs&&(C(le,Cs.index,F),Ps(null))};return f.jsxs("div",{className:"min-h-screen bg-background-primary safe-top safe-bottom",children:[f.jsx("div",{className:"bg-background-secondary border-b border-border sticky top-0 z-10",children:f.jsx("div",{className:"w-full px-3 sm:px-4 lg:px-6 py-3 sm:py-4",children:f.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[f.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[f.jsx(xt,{to:`/project/${t}`,className:"text-text-secondary hover:text-text-primary transition-colors text-sm sm:text-base",children:"← 返回"}),f.jsx("h1",{className:"text-base sm:text-xl font-semibold text-text-primary",children:"織圖編輯"})]}),f.jsx("button",{onClick:()=>x(!0),className:"btn btn-primary w-full sm:w-auto",children:"新增圈數"})]})})}),f.jsxs("div",{className:"w-full px-3 sm:px-4 lg:px-6 py-4 sm:py-6 space-y-4 sm:space-y-6",children:[f.jsxs("div",{className:"card",children:[f.jsx("h2",{className:"text-lg font-semibold text-text-primary mb-4",children:"織圖總覽"}),f.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-4 gap-4 text-sm",children:[f.jsxs("div",{children:[f.jsx("span",{className:"text-text-secondary",children:"總圈數："}),f.jsx("span",{className:"font-medium text-text-primary",children:n.pattern.length})]}),f.jsxs("div",{children:[f.jsx("span",{className:"text-text-secondary",children:"總針數："}),f.jsx("span",{className:"font-medium text-text-primary",children:n.pattern.reduce((W,F)=>W+Gn(F),0)})]}),f.jsxs("div",{children:[f.jsx("span",{className:"text-text-secondary",children:"使用毛線："}),f.jsxs("span",{className:"font-medium text-text-primary",children:[n.yarns.length," 種"]})]}),f.jsxs("div",{children:[f.jsx("span",{className:"text-text-secondary",children:"當前圈數："}),f.jsxs("span",{className:"font-medium text-text-primary",children:["R",n.currentRound]})]})]})]}),n.pattern.length===0?f.jsxs("div",{className:"card text-center py-12",children:[f.jsx("div",{className:"text-6xl mb-4",children:"📝"}),f.jsx("h3",{className:"text-xl font-semibold text-text-primary mb-2",children:"還沒有織圖圈數"}),f.jsx("p",{className:"text-text-secondary mb-6",children:"開始建立你的第一個圈數"}),f.jsx("button",{onClick:()=>x(!0),className:"btn btn-primary",children:"新增第一圈"})]}):f.jsx("div",{className:"space-y-4",children:n.pattern.sort((W,F)=>W.roundNumber-F.roundNumber).map(W=>f.jsxs("div",{className:"card",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsxs("h3",{className:"text-lg font-semibold text-text-primary",children:["第 ",W.roundNumber," 圈"]}),f.jsxs("div",{className:"text-sm text-text-secondary",children:[Gn(W)," 針"]}),W.roundNumber===n.currentRound&&f.jsx("div",{className:"px-2 py-1 bg-primary text-white text-xs rounded-full",children:"目前"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("button",{onClick:()=>T(W.roundNumber),className:"btn btn-ghost text-sm",children:"新增針法"}),f.jsx("button",{onClick:()=>L(W.roundNumber),className:"btn btn-ghost text-sm",children:"新增群組"}),f.jsx("button",{onClick:()=>Va(W.roundNumber),className:"text-text-tertiary hover:text-red-500 transition-colors",children:"刪除"})]})]}),(B==null?void 0:B.id)===W.id?f.jsx("div",{className:"mb-4",children:f.jsx("input",{type:"text",defaultValue:W.notes||"",className:"input text-sm",placeholder:"輸入備註...",onBlur:F=>Bi(W,F.target.value),onKeyDown:F=>{F.key==="Enter"&&Bi(W,F.currentTarget.value),F.key==="Escape"&&I(null)},autoFocus:!0})}):f.jsx("div",{className:"mb-4",children:W.notes?f.jsxs("div",{className:"text-sm text-text-secondary cursor-pointer hover:text-text-primary",onClick:()=>I(W),children:["備註: ",W.notes]}):f.jsx("div",{className:"text-sm text-text-tertiary cursor-pointer hover:text-text-secondary",onClick:()=>I(W),children:"點擊新增備註..."})}),W.stitches.length>0&&f.jsxs("div",{className:"mb-4",children:[f.jsx("h4",{className:"font-medium text-text-primary mb-2",children:"針法"}),f.jsx("div",{className:"space-y-2",children:W.stitches.map((F,le)=>{var de,An;return f.jsxs("div",{className:"flex items-center gap-3 p-2 bg-background-tertiary rounded cursor-move",draggable:!0,onDragStart:_t=>qr(_t,F,le,"stitch"),onDragOver:Gi,onDrop:_t=>Wi(_t,le,W.roundNumber,"stitch"),children:[f.jsx("div",{className:"text-lg",children:((de=Ot[F.type])==null?void 0:de.symbol)||"○"}),f.jsx("div",{className:"flex-1",children:(_==null?void 0:_.stitchId)===F.id?f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("select",{value:De,onChange:_t=>Be(_t.target.value),className:"input text-sm",children:Object.entries(Ot).map(([_t,La])=>f.jsxs("option",{value:_t,children:[La.symbol," ",La.rawValue]},_t))}),f.jsx("input",{type:"number",min:"1",value:je,onChange:_t=>Xe(parseInt(_t.target.value)||1),className:"input text-sm w-16"}),f.jsx("button",{onClick:()=>zi(W.roundNumber,F.id),className:"text-green-500 hover:text-green-600 text-sm",children:"✓"}),f.jsx("button",{onClick:()=>S(null),className:"text-text-tertiary hover:text-text-secondary text-sm",children:"✕"})]}):f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"font-medium text-text-primary",children:((An=Ot[F.type])==null?void 0:An.rawValue)||F.type}),f.jsxs("span",{className:"text-sm text-text-secondary",children:["×",F.count]}),f.jsxs("div",{className:"flex items-center gap-1 ml-auto",children:[f.jsx("button",{onClick:()=>Sc(W.roundNumber,F),className:"text-text-tertiary hover:text-primary text-sm",children:"編輯"}),f.jsx("button",{onClick:()=>$i(W.roundNumber,F.id),className:"text-text-tertiary hover:text-red-500 text-sm",children:"刪除"})]})]})})]},F.id)})})]}),W.stitchGroups.length>0&&f.jsxs("div",{className:"mb-4",children:[f.jsx("h4",{className:"font-medium text-text-primary mb-2",children:"針目群組"}),f.jsx("div",{className:"space-y-3",children:W.stitchGroups.map((F,le)=>f.jsxs("div",{className:"border border-border rounded-lg p-3 cursor-move",draggable:!0,onDragStart:de=>qr(de,F,le,"group"),onDragOver:Gi,onDrop:de=>Wi(de,le,W.roundNumber,"group"),children:[f.jsx("div",{className:"flex items-center justify-between mb-2",children:(w==null?void 0:w.groupId)===F.id?f.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[f.jsx("input",{type:"text",value:Zn,onChange:de=>Da(de.target.value),className:"input text-sm flex-1",placeholder:"群組名稱"}),f.jsx("input",{type:"number",min:"1",value:Gr,onChange:de=>Wr(parseInt(de.target.value)||1),className:"input text-sm w-20"}),f.jsx("span",{className:"text-sm text-text-secondary",children:"次"}),f.jsx("button",{onClick:()=>Ge(W.roundNumber,F.id,F),className:"text-green-500 hover:text-green-600 text-sm",children:"✓"}),f.jsx("button",{onClick:()=>P(null),className:"text-text-tertiary hover:text-text-secondary text-sm",children:"✕"})]}):f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"font-medium text-text-primary",children:F.name}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("div",{className:"text-sm text-text-secondary",children:["重複 ",F.repeatCount," 次 (共 ",vw(F)," 針)"]}),f.jsx("button",{onClick:()=>Hi(W.roundNumber,F),className:"text-text-tertiary hover:text-primary text-sm",children:"編輯"}),f.jsx("button",{onClick:()=>Ze(W.roundNumber,F.id),className:"text-text-tertiary hover:text-red-500 text-sm",children:"刪除"})]})]})}),f.jsx("div",{className:"space-y-2",children:F.stitches.map(de=>{var An,_t;return f.jsxs("div",{className:"flex items-center gap-3 p-2 bg-background-tertiary rounded ml-4",children:[f.jsx("div",{className:"text-lg",children:((An=Ot[de.type])==null?void 0:An.symbol)||"○"}),f.jsxs("div",{className:"flex-1",children:[f.jsx("span",{className:"font-medium text-text-primary",children:((_t=Ot[de.type])==null?void 0:_t.rawValue)||de.type}),f.jsxs("span",{className:"text-sm text-text-secondary ml-2",children:["×",de.count]})]})]},de.id)})})]},F.id))})]}),v===W.roundNumber&&f.jsxs("div",{className:"bg-background-tertiary rounded-lg p-4 mb-4",children:[f.jsx("h4",{className:"font-medium text-text-primary mb-3",children:"新增針法"}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"針法類型"}),f.jsx("select",{value:Ue,onChange:F=>Gt(F.target.value),className:"input",children:Object.entries(Ot).map(([F,le])=>f.jsxs("option",{value:F,children:[le.symbol," ",le.rawValue]},F))})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"數量"}),f.jsx("input",{type:"number",min:"1",value:jt,onChange:F=>Je(parseInt(F.target.value)||1),className:"input"})]})]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{onClick:()=>Ic(W.roundNumber),className:"btn btn-primary",children:"新增"}),f.jsx("button",{onClick:()=>T(null),className:"btn btn-secondary",children:"取消"})]})]}),D===W.roundNumber&&f.jsxs("div",{className:"bg-background-tertiary rounded-lg p-4 mb-4",children:[f.jsx("h4",{className:"font-medium text-text-primary mb-3",children:"新增針目群組"}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"群組名稱"}),f.jsx("input",{type:"text",value:H,onChange:F=>$(F.target.value),className:"input",placeholder:"針目群組"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"重複次數"}),f.jsx("input",{type:"number",min:"1",value:q,onChange:F=>ne(parseInt(F.target.value)||1),className:"input"})]})]}),f.jsxs("div",{className:"mb-4",children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsx("label",{className:"block text-sm font-medium text-text-secondary",children:"群組針法"}),f.jsx("button",{onClick:Ma,className:"btn btn-ghost text-sm",children:"新增針法"})]}),f.jsx("div",{className:"space-y-2 mb-4",children:te.map(F=>{var le,de;return f.jsxs("div",{className:"flex items-center gap-3 p-2 bg-background-secondary rounded",children:[f.jsx("div",{className:"text-lg",children:((le=Ot[F.type])==null?void 0:le.symbol)||"○"}),f.jsxs("div",{className:"flex-1",children:[f.jsx("span",{className:"font-medium text-text-primary",children:((de=Ot[F.type])==null?void 0:de.rawValue)||F.type}),f.jsxs("span",{className:"text-sm text-text-secondary ml-2",children:["×",F.count]})]}),f.jsx("button",{onClick:()=>Ui(F.id),className:"text-text-tertiary hover:text-red-500 transition-colors",children:"✕"})]},F.id)})}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4",children:[f.jsx("select",{value:Ue,onChange:F=>Gt(F.target.value),className:"input",children:Object.entries(Ot).map(([F,le])=>f.jsxs("option",{value:F,children:[le.symbol," ",le.rawValue]},F))}),f.jsx("input",{type:"number",min:"1",value:jt,onChange:F=>Je(parseInt(F.target.value)||1),className:"input",placeholder:"數量"})]})]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{onClick:()=>Oa(W.roundNumber),className:"btn btn-primary",disabled:te.length===0,children:"新增群組"}),f.jsx("button",{onClick:()=>{L(null),se([]),$(""),ne(1)},className:"btn btn-secondary",children:"取消"})]})]})]},W.id))})]}),N&&f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:f.jsxs("div",{className:"bg-background-secondary rounded-xl p-6 w-full max-w-md",children:[f.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-4",children:"新增圈數"}),f.jsxs("div",{className:"mb-4",children:[f.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"備註（選填）"}),f.jsx("input",{type:"text",value:b,onChange:W=>R(W.target.value),className:"input",placeholder:"輸入備註..."})]}),f.jsxs("div",{className:"flex gap-3",children:[f.jsx("button",{onClick:()=>x(!1),className:"btn btn-secondary flex-1",children:"取消"}),f.jsx("button",{onClick:ja,className:"btn btn-primary flex-1",children:"新增"})]})]})})]})}function P2(){const{projectId:t}=Ea(),e=Pi(),{currentProject:n,setCurrentProject:r,projects:s,nextStitch:i,previousStitch:o,setCurrentRound:l,startSession:u,endSession:c,updateProject:d}=Lt(),[m,g]=M.useState(!1),[E,A]=M.useState(null),[C,N]=M.useState(0),[x,v]=M.useState(null);if(M.useEffect(()=>{t&&(s.find(q=>q.id===t)?r(t):e("/404"))},[t,r,s,e]),M.useEffect(()=>{let $;return m&&E&&($=setInterval(()=>{N(Math.floor((Date.now()-E.getTime())/1e3))},1e3)),()=>clearInterval($)},[m,E]),!n)return f.jsx("div",{className:"min-h-screen bg-background-primary flex items-center justify-center",children:f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),f.jsx("p",{className:"text-text-secondary",children:"載入中..."})]})});const T=x!==null&&x!==n.currentRound,D=x??n.currentRound,L=n.pattern.find($=>$.roundNumber===D),B=Pd(n),I=T?0:n.currentStitch,_=L?Gn(L):0,S=()=>{u(),g(!0),A(new Date),N(0)},w=()=>{c(),g(!1),A(null),N(0)},P=()=>{i()},b=()=>{o()},R=$=>{$===n.currentRound?v(null):v($)},Ue=()=>{if(!L)return;const $=Math.max(...n.pattern.map(q=>q.roundNumber));if(D>=$){const q={...n,isCompleted:!0,currentStitch:Gn(L),lastModified:new Date};d(q)}else{const q=D+1;l(q)}v(null)},Gt=()=>{v(null)},jt=$=>{const q=n.yarns.find(ne=>ne.id===$);return(q==null?void 0:q.color.hex)||"#000000"},Je=$=>{const q=$.replace("#",""),ne=parseInt(q.substring(0,2),16),te=parseInt(q.substring(2,4),16),se=parseInt(q.substring(4,6),16);return(ne*299+te*587+se*114)/1e3>200},H=()=>{if(!L||_===0)return f.jsx("div",{className:"text-center py-8",children:f.jsx("p",{className:"text-text-tertiary",children:"當前圈數沒有針法資料"})});const $=[];let q=0;return L.stitches.forEach(ne=>{var se;const te=jt(ne.yarnId);for(let De=0;De<ne.count;De++){const Be=q<I,je=q===I;$.push(f.jsxs("div",{className:"flex flex-col items-center justify-center w-12 h-12 transition-all duration-300",children:[f.jsx("div",{className:`text-lg font-bold transition-colors duration-300 ${Be?"text-text-primary":je?"text-primary":"text-text-tertiary/50"}`,children:((se=Ot[ne.type])==null?void 0:se.symbol)||"○"}),f.jsx("div",{className:`w-1.5 h-1.5 rounded-full transition-all duration-300 ${(Be||je)&&Je(te)?"border border-gray-400":""}`,style:{backgroundColor:Be||je?te:"#f3f4f6"}})]},`${ne.id}-${De}`)),q++}}),L.stitchGroups.forEach(ne=>{for(let te=0;te<ne.repeatCount;te++)ne.stitches.forEach(se=>{var Be;const De=jt(se.yarnId);for(let je=0;je<se.count;je++){const Xe=q<I,Zn=q===I;$.push(f.jsxs("div",{className:"flex flex-col items-center justify-center w-12 h-12 transition-all duration-300",children:[f.jsx("div",{className:`text-lg font-bold transition-colors duration-300 ${Xe?"text-text-primary":Zn?"text-primary":"text-text-tertiary/50"}`,children:((Be=Ot[se.type])==null?void 0:Be.symbol)||"○"}),f.jsx("div",{className:`w-1.5 h-1.5 rounded-full transition-all duration-300 ${(Xe||Zn)&&Je(De)?"border border-gray-400":""}`,style:{backgroundColor:Xe||Zn?De:"#f3f4f6"}})]},`${ne.id}-${te}-${se.id}-${je}`)),q++}})}),f.jsx("div",{className:"grid grid-cols-6 sm:grid-cols-8 md:grid-cols-10 lg:grid-cols-12 gap-2",children:$})};return f.jsxs("div",{className:"min-h-screen bg-background-primary safe-top safe-bottom",children:[f.jsx("div",{className:"bg-background-secondary border-b border-border sticky top-0 z-10",children:f.jsx("div",{className:"w-full px-3 sm:px-4 lg:px-6 py-3 sm:py-4",children:f.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[f.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[f.jsx(xt,{to:`/project/${t}`,className:"text-text-secondary hover:text-text-primary transition-colors text-sm sm:text-base",children:"← 返回"}),f.jsx("h1",{className:"text-base sm:text-xl font-semibold text-text-primary truncate",children:n.name})]}),f.jsx("div",{className:"flex items-center gap-2",children:m?f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"text-sm text-text-secondary hidden sm:block",children:gR(C)}),f.jsx("button",{onClick:w,className:"btn btn-secondary text-sm",children:"結束"})]}):f.jsxs("button",{onClick:S,className:"btn btn-primary text-sm",children:[f.jsx("span",{className:"hidden sm:inline",children:"開始計時"}),f.jsx("span",{className:"sm:hidden",children:"計時"})]})})]})})}),f.jsxs("div",{className:"w-full px-3 sm:px-4 lg:px-6 py-4 sm:py-6 space-y-4 sm:space-y-6",children:[f.jsxs("div",{className:"card",children:[f.jsxs("div",{className:"flex items-center justify-between mb-3",children:[f.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:"總體進度"}),f.jsxs("span",{className:"text-sm text-text-secondary font-medium",children:[Math.round(B*100),"%"]})]}),f.jsx("div",{className:"w-full bg-background-tertiary rounded-full h-3 mb-4",children:f.jsx("div",{className:"bg-primary h-3 rounded-full transition-all duration-500",style:{width:`${B*100}%`}})}),f.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[f.jsxs("div",{children:[f.jsx("div",{className:"text-text-secondary",children:"圈數進度"}),f.jsxs("div",{className:"font-semibold text-text-primary",children:[Math.max(0,n.currentRound-1)," / ",wu(n)," 圈"]})]}),f.jsxs("div",{children:[f.jsx("div",{className:"text-text-secondary",children:"針數進度"}),f.jsxs("div",{className:"font-semibold text-text-primary",children:[np(n)," / ",ia(n)," 針"]})]})]})]}),f.jsxs("div",{className:"card",children:[f.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-3",children:"快速跳轉"}),f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx("label",{className:"text-sm text-text-secondary",children:"跳轉到第"}),f.jsx("select",{value:D,onChange:$=>R(parseInt($.target.value)),className:"input w-auto min-w-0 flex-shrink-0",children:Array.from({length:wu(n)},($,q)=>q+1).map($=>f.jsx("option",{value:$,children:$},$))}),f.jsx("label",{className:"text-sm text-text-secondary",children:"圈"}),T&&f.jsx("span",{className:"text-sm",style:{color:"rgb(217, 115, 152)"},children:"查看模式"})]})]}),f.jsxs("div",{className:"card",children:[f.jsxs("div",{className:"mb-6",children:[f.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-3",children:"本圈織圖"}),f.jsx("div",{className:"mb-3",children:f.jsxs("span",{className:"text-base text-text-primary",children:["第 ",D," 圈",T&&f.jsx("span",{className:"text-sm ml-2",style:{color:"rgb(217, 115, 152)"},children:"（查看中）"})]})}),(L==null?void 0:L.notes)&&f.jsxs("div",{className:"text-text-primary mb-4",children:[f.jsx("span",{className:"text-text-secondary",children:"備註："}),L.notes]})]}),f.jsx("div",{className:"mb-6",children:H()}),T?f.jsxs("div",{className:"text-center py-4",children:[f.jsx("p",{className:"mb-4",style:{color:"rgb(217, 115, 152)"},children:"此為查看模式，無法編輯進度"}),f.jsx("button",{onClick:Gt,className:"btn btn-primary",children:"返回編織進度"})]}):n.isCompleted?f.jsxs("div",{className:"text-center py-8",children:[f.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:"編織完成！"}),f.jsxs("p",{className:"text-text-secondary mb-6",children:["恭喜您完成了「",n.name,"」的編織！"]}),f.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[f.jsx("button",{onClick:()=>{const $={...n,isCompleted:!1,currentRound:1,currentStitch:0,lastModified:new Date};d($)},className:"btn btn-secondary",children:"重新編織"}),f.jsx("button",{onClick:()=>{var $;($=navigator.share)==null||$.call(navigator,{title:`我完成了編織作品：${n.name}`,text:`使用編織計數器完成了「${n.name}」的編織！`}).catch(()=>{alert("編織完成！")})},className:"btn btn-primary",children:"分享成果"})]})]}):f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center justify-between gap-4",children:[f.jsxs("button",{onClick:b,disabled:n.currentRound===1&&n.currentStitch===0,className:"btn btn-secondary disabled:opacity-50 disabled:cursor-not-allowed text-lg py-4 flex items-center justify-center gap-2 flex-1",children:[f.jsx("span",{children:"←"}),"上一針"]}),f.jsxs("div",{className:"flex items-baseline px-6",children:[f.jsx("span",{className:"text-4xl font-bold text-primary",children:I}),f.jsxs("span",{className:"text-xl text-text-secondary",children:["/",_]})]}),f.jsxs("button",{onClick:P,className:"btn btn-primary text-lg py-4 flex items-center justify-center gap-2 flex-1",children:["下一針",f.jsx("span",{children:"→"})]})]}),D===n.currentRound&&f.jsxs("button",{onClick:Ue,className:"w-full bg-gray-500 hover:bg-gray-600 text-white font-medium py-3 px-4 rounded-lg transition-colors",children:["完成第 ",D," 圈"]})]})]})]})]})}const mo=[{name:"白色",hex:"#FFFFFF"},{name:"黑色",hex:"#000000"},{name:"紅色",hex:"#FF0000"},{name:"藍色",hex:"#0066CC"},{name:"綠色",hex:"#00AA00"},{name:"黃色",hex:"#FFD700"},{name:"紫色",hex:"#8A2BE2"},{name:"橙色",hex:"#FF8C00"},{name:"粉紅色",hex:"#FF69B4"},{name:"棕色",hex:"#A0522D"},{name:"灰色",hex:"#808080"},{name:"米色",hex:"#F5F5DC"}];function N2(){const{projectId:t}=Ea(),e=Pi(),{currentProject:n,setCurrentProject:r,projects:s,addYarn:i,updateYarn:o,deleteYarn:l}=Lt(),[u,c]=M.useState(!1),[d,m]=M.useState(null),[g,E]=M.useState(""),[A,C]=M.useState(""),[N,x]=M.useState(mo[0]),[v,T]=M.useState("");if(M.useEffect(()=>{t&&(s.find(P=>P.id===t)?r(t):e("/404"))},[t,r,s,e]),!n)return f.jsx("div",{className:"min-h-screen bg-background-primary flex items-center justify-center",children:f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),f.jsx("p",{className:"text-text-secondary",children:"載入中..."})]})});const D=()=>{m(null),E(mo[0].name+"毛線"),C(""),x(mo[0]),T(""),c(!0)},L=w=>{m(w),E(w.name),C(w.brand||""),x(w.color),T(w.color.hex),c(!0)},B=()=>{if(!g.trim())return;const w=v?{name:"自定義",hex:v}:N,P={id:(d==null?void 0:d.id)||Ke(),name:g.trim(),brand:A.trim()||void 0,color:w};d?o(P):i(P),c(!1),_()},I=w=>{confirm("確定要刪除這個毛線嗎？")&&l(w)},_=()=>{E(""),C(""),x(mo[0]),T(""),m(null)},S=()=>{c(!1),_()};return f.jsxs("div",{className:"min-h-screen bg-background-primary safe-top safe-bottom",children:[f.jsx("div",{className:"bg-background-secondary border-b border-border",children:f.jsx("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-3 sm:py-4",children:f.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[f.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[f.jsx(xt,{to:`/project/${t}`,className:"text-text-secondary hover:text-text-primary transition-colors text-sm sm:text-base",children:"← 返回"}),f.jsx("h1",{className:"text-base sm:text-xl font-semibold text-text-primary",children:"毛線管理"})]}),f.jsx("button",{onClick:D,className:"btn btn-primary w-full sm:w-auto",children:"+ 新增毛線"})]})})}),f.jsxs("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-4 sm:py-6 space-y-4 sm:space-y-6",children:[n.yarns.length===0?f.jsxs("div",{className:"text-center py-12",children:[f.jsx("div",{className:"text-6xl mb-4",children:"🧶"}),f.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-2",children:"還沒有毛線"}),f.jsx("p",{className:"text-text-secondary mb-4",children:"點擊上方「新增毛線」按鈕來添加第一個毛線"}),f.jsx("button",{onClick:D,className:"btn btn-primary",children:"新增毛線"})]}):f.jsx("div",{className:"grid gap-4",children:n.yarns.map(w=>f.jsx("div",{className:"card",children:f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx("div",{className:"w-12 h-12 rounded-full border-2 border-border flex-shrink-0",style:{backgroundColor:w.color.hex}}),f.jsxs("div",{className:"flex-1",children:[f.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:w.name}),w.brand&&f.jsx("p",{className:"text-text-secondary",children:w.brand}),f.jsxs("p",{className:"text-sm text-text-tertiary",children:[w.color.name," (",w.color.hex,")"]})]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{onClick:()=>L(w),className:"btn btn-secondary text-sm",children:"編輯"}),f.jsx("button",{onClick:()=>I(w.id),className:"btn bg-red-500 hover:bg-red-600 text-white text-sm",children:"刪除"})]})]})},w.id))}),u&&f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:f.jsx("div",{className:"bg-background-primary rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:f.jsxs("div",{className:"p-6",children:[f.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-4",children:d?"編輯毛線":"新增毛線"}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"毛線名稱 *"}),f.jsx("input",{type:"text",value:g,onChange:w=>E(w.target.value),className:"w-full p-3 border border-border rounded-lg bg-background-secondary text-text-primary",placeholder:"例如：4號線"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"品牌（選填）"}),f.jsx("input",{type:"text",value:A,onChange:w=>C(w.target.value),className:"w-full p-3 border border-border rounded-lg bg-background-secondary text-text-primary",placeholder:"例如：台灣製"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"顏色"}),f.jsx("div",{className:"grid grid-cols-6 gap-2 mb-3",children:mo.map(w=>f.jsx("button",{onClick:()=>{x(w),T(""),!d&&(g===""||g.endsWith("毛線"))&&E(w.name+"毛線")},className:`w-10 h-10 rounded-full border-2 ${N.hex===w.hex&&!v?"border-primary ring-2 ring-primary/20":"border-border"}`,style:{backgroundColor:w.hex},title:w.name},w.hex))}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs text-text-secondary mb-1",children:"或輸入自定義顏色"}),f.jsx("input",{type:"color",value:v||N.hex,onChange:w=>{T(w.target.value),!d&&(g===""||g.endsWith("毛線"))&&E("自定義毛線")},className:"w-full h-10 border border-border rounded cursor-pointer"})]})]}),f.jsxs("div",{className:"border border-border rounded-lg p-3",children:[f.jsx("p",{className:"text-sm text-text-secondary mb-2",children:"預覽"}),f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"w-8 h-8 rounded-full border border-border",style:{backgroundColor:v||N.hex}}),f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-text-primary",children:g||"毛線名稱"}),A&&f.jsx("p",{className:"text-sm text-text-secondary",children:A})]})]})]})]}),f.jsxs("div",{className:"flex gap-3 mt-6",children:[f.jsx("button",{onClick:S,className:"flex-1 btn btn-secondary",children:"取消"}),f.jsx("button",{onClick:B,disabled:!g.trim(),className:"flex-1 btn btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:d?"更新":"新增"})]})]})})})]})]})}function k2(){const{projectId:t}=Ea();return f.jsxs("div",{className:"min-h-screen bg-background-primary safe-top safe-bottom",children:[f.jsx("div",{className:"bg-background-secondary border-b border-border",children:f.jsx("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-3 sm:py-4",children:f.jsxs("div",{className:"flex items-center gap-3 sm:gap-4",children:[f.jsx(xt,{to:`/project/${t}`,className:"text-text-secondary hover:text-text-primary transition-colors text-sm sm:text-base",children:"← 返回"}),f.jsx("h1",{className:"text-lg sm:text-xl font-semibold text-text-primary",children:"匯入匯出"})]})})}),f.jsx("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-4 sm:py-6",children:f.jsxs("div",{className:"text-center py-12",children:[f.jsx("div",{className:"text-6xl mb-4",children:"🚧"}),f.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-2",children:"匯入匯出"}),f.jsx("p",{className:"text-text-secondary",children:"此功能正在開發中..."})]})})]})}function b2(){return f.jsx("div",{className:"min-h-screen bg-background-primary flex items-center justify-center px-4",children:f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"text-6xl mb-6",children:"🧶"}),f.jsx("h1",{className:"text-4xl font-bold text-text-primary mb-4",children:"404"}),f.jsx("h2",{className:"text-xl font-semibold text-text-secondary mb-6",children:"找不到頁面"}),f.jsx("p",{className:"text-text-tertiary mb-8",children:"您要查找的頁面不存在或已被移動"}),f.jsx(xt,{to:"/",className:"btn btn-primary",children:"回到首頁"})]})})}function D2(){const{signInWithGoogle:t,isLoading:e,error:n}=ft();return f.jsx("div",{className:"min-h-screen bg-background-primary flex items-center justify-center px-4",children:f.jsxs("div",{className:"card max-w-sm sm:max-w-md w-full",children:[f.jsxs("div",{className:"text-center mb-6",children:[f.jsx("div",{className:"text-3xl sm:text-4xl mb-3",children:"🧶"}),f.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-text-primary mb-2",children:"編織計數器"}),f.jsx("p",{className:"text-sm sm:text-base text-text-secondary",children:"使用 Google 帳戶登入以同步您的編織專案"})]}),n&&f.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:n}),f.jsx("button",{onClick:t,disabled:e,className:"w-full flex items-center justify-center gap-3 px-4 py-3 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:e?f.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-gray-600"}):f.jsxs(f.Fragment,{children:[f.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[f.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),f.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),f.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),f.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"使用 Google 登入"]})}),f.jsx("div",{className:"mt-4 text-center",children:f.jsx("p",{className:"text-xs text-text-tertiary",children:"登入即表示您同意我們的服務條款和隱私政策"})})]})})}function j2(){const{isSyncing:t,lastSyncTime:e,error:n,setError:r}=Lt(),s=async()=>{try{await ql.forceSync()}catch(i){console.error("Manual sync failed:",i),r("手動同步失敗")}};return f.jsx("div",{className:"fixed bottom-4 right-4 z-50",children:f.jsxs("div",{className:"bg-white rounded-lg shadow-lg border p-3 max-w-xs",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[f.jsx("div",{className:`w-2 h-2 rounded-full ${t?"bg-yellow-500 animate-pulse":n?"bg-red-500":"bg-green-500"}`}),f.jsx("span",{className:"text-sm font-medium",children:t?"同步中...":n?"同步錯誤":"已同步"})]}),e&&f.jsxs("div",{className:"text-xs text-gray-600 mb-2",children:["最後同步: ",e.toLocaleTimeString()]}),n&&f.jsx("div",{className:"text-xs text-red-600 mb-2 break-words",children:n}),f.jsx("button",{onClick:s,disabled:t,className:`w-full text-xs px-2 py-1 rounded ${t?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-500 text-white hover:bg-blue-600"}`,children:t?"同步中...":"手動同步"})]})})}function V2(){const{setError:t,error:e,isSyncing:n,isLoading:r}=Lt(),{user:s,isLoading:i,initialize:o}=ft();return M.useEffect(()=>{const l=o(),u=ql.setupAuthStateListener();return()=>{l(),u&&u()}},[o]),M.useEffect(()=>{s?(console.log(`使用者已登入 (${s.uid})，開始同步...`),ql.handleUserLogin(s).catch(l=>{console.error("處理用戶登入錯誤:",l),t("登入處理失敗")})):(console.log("使用者已登出，清空數據..."),ql.handleUserLogout())},[s,t]),i||r?f.jsx("div",{className:"min-h-screen bg-background-primary flex items-center justify-center",children:f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),f.jsx("p",{className:"text-text-secondary",children:i?"驗證中...":"載入數據中..."}),n&&f.jsx("p",{className:"text-text-secondary text-sm mt-2",children:"正在同步跨裝置數據..."})]})}):s?f.jsxs("div",{className:"min-h-screen bg-background-primary",children:[e&&f.jsx("div",{className:"fixed top-4 left-4 right-4 z-50 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{children:e}),f.jsx("button",{onClick:()=>t(null),className:"text-red-500 hover:text-red-700 ml-4",children:"✕"})]})}),f.jsx(j2,{}),f.jsxs(NS,{children:[f.jsx(kn,{path:"/",element:f.jsx(R2,{})}),f.jsx(kn,{path:"/project/:projectId",element:f.jsx(A2,{})}),f.jsx(kn,{path:"/project/:projectId/pattern",element:f.jsx(C2,{})}),f.jsx(kn,{path:"/project/:projectId/progress",element:f.jsx(P2,{})}),f.jsx(kn,{path:"/project/:projectId/yarns",element:f.jsx(N2,{})}),f.jsx(kn,{path:"/project/:projectId/import-export",element:f.jsx(k2,{})}),f.jsx(kn,{path:"/404",element:f.jsx(b2,{})}),f.jsx(kn,{path:"*",element:f.jsx(CS,{to:"/404",replace:!0})})]})]}):f.jsx(D2,{})}"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(t=>{console.log("SW registered: ",t)}).catch(t=>{console.log("SW registration failed: ",t)})});bh.createRoot(document.getElementById("root")).render(f.jsx(af.StrictMode,{children:f.jsx(MS,{children:f.jsx(V2,{})})}));
