var Dx=Object.defineProperty;var jx=(t,e,n)=>e in t?Dx(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Do=(t,e,n)=>(jx(t,typeof e!="symbol"?e+"":e,n),n);function Ox(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function f_(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var p_={exports:{}},gu={},m_={exports:{}},oe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ga=Symbol.for("react.element"),Vx=Symbol.for("react.portal"),Lx=Symbol.for("react.fragment"),Mx=Symbol.for("react.strict_mode"),Ux=Symbol.for("react.profiler"),Fx=Symbol.for("react.provider"),Bx=Symbol.for("react.context"),zx=Symbol.for("react.forward_ref"),$x=Symbol.for("react.suspense"),Gx=Symbol.for("react.memo"),Hx=Symbol.for("react.lazy"),gg=Symbol.iterator;function Wx(t){return t===null||typeof t!="object"?null:(t=gg&&t[gg]||t["@@iterator"],typeof t=="function"?t:null)}var g_={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y_=Object.assign,v_={};function Yi(t,e,n){this.props=t,this.context=e,this.refs=v_,this.updater=n||g_}Yi.prototype.isReactComponent={};Yi.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Yi.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function __(){}__.prototype=Yi.prototype;function kf(t,e,n){this.props=t,this.context=e,this.refs=v_,this.updater=n||g_}var bf=kf.prototype=new __;bf.constructor=kf;y_(bf,Yi.prototype);bf.isPureReactComponent=!0;var yg=Array.isArray,w_=Object.prototype.hasOwnProperty,Df={current:null},E_={key:!0,ref:!0,__self:!0,__source:!0};function x_(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)w_.call(e,r)&&!E_.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:Ga,type:t,key:i,ref:o,props:s,_owner:Df.current}}function qx(t,e){return{$$typeof:Ga,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function jf(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ga}function Kx(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var vg=/\/+/g;function hd(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Kx(""+t.key):e.toString(36)}function Jl(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Ga:case Vx:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+hd(o,0):r,yg(s)?(n="",t!=null&&(n=t.replace(vg,"$&/")+"/"),Jl(s,e,n,"",function(u){return u})):s!=null&&(jf(s)&&(s=qx(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(vg,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",yg(t))for(var l=0;l<t.length;l++){i=t[l];var c=r+hd(i,l);o+=Jl(i,e,n,c,s)}else if(c=Wx(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=r+hd(i,l++),o+=Jl(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Il(t,e,n){if(t==null)return t;var r=[],s=0;return Jl(t,r,"","",function(i){return e.call(n,i,s++)}),r}function Qx(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Nt={current:null},Xl={transition:null},Yx={ReactCurrentDispatcher:Nt,ReactCurrentBatchConfig:Xl,ReactCurrentOwner:Df};function T_(){throw Error("act(...) is not supported in production builds of React.")}oe.Children={map:Il,forEach:function(t,e,n){Il(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Il(t,function(){e++}),e},toArray:function(t){return Il(t,function(e){return e})||[]},only:function(t){if(!jf(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};oe.Component=Yi;oe.Fragment=Lx;oe.Profiler=Ux;oe.PureComponent=kf;oe.StrictMode=Mx;oe.Suspense=$x;oe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Yx;oe.act=T_;oe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=y_({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Df.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)w_.call(e,c)&&!E_.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:Ga,type:t.type,key:s,ref:i,props:r,_owner:o}};oe.createContext=function(t){return t={$$typeof:Bx,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Fx,_context:t},t.Consumer=t};oe.createElement=x_;oe.createFactory=function(t){var e=x_.bind(null,t);return e.type=t,e};oe.createRef=function(){return{current:null}};oe.forwardRef=function(t){return{$$typeof:zx,render:t}};oe.isValidElement=jf;oe.lazy=function(t){return{$$typeof:Hx,_payload:{_status:-1,_result:t},_init:Qx}};oe.memo=function(t,e){return{$$typeof:Gx,type:t,compare:e===void 0?null:e}};oe.startTransition=function(t){var e=Xl.transition;Xl.transition={};try{t()}finally{Xl.transition=e}};oe.unstable_act=T_;oe.useCallback=function(t,e){return Nt.current.useCallback(t,e)};oe.useContext=function(t){return Nt.current.useContext(t)};oe.useDebugValue=function(){};oe.useDeferredValue=function(t){return Nt.current.useDeferredValue(t)};oe.useEffect=function(t,e){return Nt.current.useEffect(t,e)};oe.useId=function(){return Nt.current.useId()};oe.useImperativeHandle=function(t,e,n){return Nt.current.useImperativeHandle(t,e,n)};oe.useInsertionEffect=function(t,e){return Nt.current.useInsertionEffect(t,e)};oe.useLayoutEffect=function(t,e){return Nt.current.useLayoutEffect(t,e)};oe.useMemo=function(t,e){return Nt.current.useMemo(t,e)};oe.useReducer=function(t,e,n){return Nt.current.useReducer(t,e,n)};oe.useRef=function(t){return Nt.current.useRef(t)};oe.useState=function(t){return Nt.current.useState(t)};oe.useSyncExternalStore=function(t,e,n){return Nt.current.useSyncExternalStore(t,e,n)};oe.useTransition=function(){return Nt.current.useTransition()};oe.version="18.3.1";m_.exports=oe;var M=m_.exports;const Sn=f_(M),Jx=Ox({__proto__:null,default:Sn},[M]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xx=M,Zx=Symbol.for("react.element"),eT=Symbol.for("react.fragment"),tT=Object.prototype.hasOwnProperty,nT=Xx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,rT={key:!0,ref:!0,__self:!0,__source:!0};function S_(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)tT.call(e,r)&&!rT.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:Zx,type:t,key:i,ref:o,props:s,_owner:nT.current}}gu.Fragment=eT;gu.jsx=S_;gu.jsxs=S_;p_.exports=gu;var h=p_.exports,th={},I_={exports:{}},Wt={},R_={exports:{}},C_={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(H,G){var q=H.length;H.push(G);e:for(;0<q;){var se=q-1>>>1,ie=H[se];if(0<s(ie,G))H[se]=G,H[q]=ie,q=se;else break e}}function n(H){return H.length===0?null:H[0]}function r(H){if(H.length===0)return null;var G=H[0],q=H.pop();if(q!==G){H[0]=q;e:for(var se=0,ie=H.length,ue=ie>>>1;se<ue;){var Be=2*(se+1)-1,ze=H[Be],Ie=Be+1,Qe=H[Ie];if(0>s(ze,q))Ie<ie&&0>s(Qe,ze)?(H[se]=Qe,H[Ie]=q,se=Ie):(H[se]=ze,H[Be]=q,se=Be);else if(Ie<ie&&0>s(Qe,q))H[se]=Qe,H[Ie]=q,se=Ie;else break e}}return G}function s(H,G){var q=H.sortIndex-G.sortIndex;return q!==0?q:H.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],f=1,p=null,g=3,w=!1,R=!1,N=!1,P=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(H){for(var G=n(u);G!==null;){if(G.callback===null)r(u);else if(G.startTime<=H)r(u),G.sortIndex=G.expirationTime,e(c,G);else break;G=n(u)}}function D(H){if(N=!1,T(H),!R)if(n(c)!==null)R=!0,rn(F);else{var G=n(u);G!==null&&Tt(D,G.startTime-H)}}function F(H,G){R=!1,N&&(N=!1,x(_),_=-1),w=!0;var q=g;try{for(T(G),p=n(c);p!==null&&(!(p.expirationTime>G)||H&&!A());){var se=p.callback;if(typeof se=="function"){p.callback=null,g=p.priorityLevel;var ie=se(p.expirationTime<=G);G=t.unstable_now(),typeof ie=="function"?p.callback=ie:p===n(c)&&r(c),T(G)}else r(c);p=n(c)}if(p!==null)var ue=!0;else{var Be=n(u);Be!==null&&Tt(D,Be.startTime-G),ue=!1}return ue}finally{p=null,g=q,w=!1}}var z=!1,S=null,_=-1,I=5,E=-1;function A(){return!(t.unstable_now()-E<I)}function k(){if(S!==null){var H=t.unstable_now();E=H;var G=!0;try{G=S(!0,H)}finally{G?C():(z=!1,S=null)}}else z=!1}var C;if(typeof v=="function")C=function(){v(k)};else if(typeof MessageChannel<"u"){var we=new MessageChannel,Pt=we.port2;we.port1.onmessage=k,C=function(){Pt.postMessage(null)}}else C=function(){P(k,0)};function rn(H){S=H,z||(z=!0,C())}function Tt(H,G){_=P(function(){H(t.unstable_now())},G)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(H){H.callback=null},t.unstable_continueExecution=function(){R||w||(R=!0,rn(F))},t.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<H?Math.floor(1e3/H):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(H){switch(g){case 1:case 2:case 3:var G=3;break;default:G=g}var q=g;g=G;try{return H()}finally{g=q}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(H,G){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var q=g;g=H;try{return G()}finally{g=q}},t.unstable_scheduleCallback=function(H,G,q){var se=t.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?se+q:se):q=se,H){case 1:var ie=-1;break;case 2:ie=250;break;case 5:ie=1073741823;break;case 4:ie=1e4;break;default:ie=5e3}return ie=q+ie,H={id:f++,callback:G,priorityLevel:H,startTime:q,expirationTime:ie,sortIndex:-1},q>se?(H.sortIndex=q,e(u,H),n(c)===null&&H===n(u)&&(N?(x(_),_=-1):N=!0,Tt(D,q-se))):(H.sortIndex=ie,e(c,H),R||w||(R=!0,rn(F))),H},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(H){var G=g;return function(){var q=g;g=G;try{return H.apply(this,arguments)}finally{g=q}}}})(C_);R_.exports=C_;var sT=R_.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iT=M,Ht=sT;function B(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var N_=new Set,fa={};function Fs(t,e){ji(t,e),ji(t+"Capture",e)}function ji(t,e){for(fa[t]=e,t=0;t<e.length;t++)N_.add(e[t])}var Kn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),nh=Object.prototype.hasOwnProperty,oT=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,_g={},wg={};function aT(t){return nh.call(wg,t)?!0:nh.call(_g,t)?!1:oT.test(t)?wg[t]=!0:(_g[t]=!0,!1)}function lT(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function cT(t,e,n,r){if(e===null||typeof e>"u"||lT(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function At(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var dt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){dt[t]=new At(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];dt[e]=new At(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){dt[t]=new At(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){dt[t]=new At(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){dt[t]=new At(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){dt[t]=new At(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){dt[t]=new At(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){dt[t]=new At(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){dt[t]=new At(t,5,!1,t.toLowerCase(),null,!1,!1)});var Of=/[\-:]([a-z])/g;function Vf(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Of,Vf);dt[e]=new At(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Of,Vf);dt[e]=new At(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Of,Vf);dt[e]=new At(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){dt[t]=new At(t,1,!1,t.toLowerCase(),null,!1,!1)});dt.xlinkHref=new At("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){dt[t]=new At(t,1,!1,t.toLowerCase(),null,!0,!0)});function Lf(t,e,n,r){var s=dt.hasOwnProperty(e)?dt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(cT(e,n,s,r)&&(n=null),r||s===null?aT(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var nr=iT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Rl=Symbol.for("react.element"),hi=Symbol.for("react.portal"),fi=Symbol.for("react.fragment"),Mf=Symbol.for("react.strict_mode"),rh=Symbol.for("react.profiler"),A_=Symbol.for("react.provider"),P_=Symbol.for("react.context"),Uf=Symbol.for("react.forward_ref"),sh=Symbol.for("react.suspense"),ih=Symbol.for("react.suspense_list"),Ff=Symbol.for("react.memo"),yr=Symbol.for("react.lazy"),k_=Symbol.for("react.offscreen"),Eg=Symbol.iterator;function jo(t){return t===null||typeof t!="object"?null:(t=Eg&&t[Eg]||t["@@iterator"],typeof t=="function"?t:null)}var Pe=Object.assign,fd;function $o(t){if(fd===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);fd=e&&e[1]||""}return`
`+fd+t}var pd=!1;function md(t,e){if(!t||pd)return"";pd=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{pd=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?$o(t):""}function uT(t){switch(t.tag){case 5:return $o(t.type);case 16:return $o("Lazy");case 13:return $o("Suspense");case 19:return $o("SuspenseList");case 0:case 2:case 15:return t=md(t.type,!1),t;case 11:return t=md(t.type.render,!1),t;case 1:return t=md(t.type,!0),t;default:return""}}function oh(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case fi:return"Fragment";case hi:return"Portal";case rh:return"Profiler";case Mf:return"StrictMode";case sh:return"Suspense";case ih:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case P_:return(t.displayName||"Context")+".Consumer";case A_:return(t._context.displayName||"Context")+".Provider";case Uf:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Ff:return e=t.displayName||null,e!==null?e:oh(t.type)||"Memo";case yr:e=t._payload,t=t._init;try{return oh(t(e))}catch{}}return null}function dT(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return oh(e);case 8:return e===Mf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function $r(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function b_(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function hT(t){var e=b_(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Cl(t){t._valueTracker||(t._valueTracker=hT(t))}function D_(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=b_(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function xc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function ah(t,e){var n=e.checked;return Pe({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function xg(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=$r(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function j_(t,e){e=e.checked,e!=null&&Lf(t,"checked",e,!1)}function lh(t,e){j_(t,e);var n=$r(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?ch(t,e.type,n):e.hasOwnProperty("defaultValue")&&ch(t,e.type,$r(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Tg(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function ch(t,e,n){(e!=="number"||xc(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Go=Array.isArray;function Si(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+$r(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function uh(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(B(91));return Pe({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Sg(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(B(92));if(Go(n)){if(1<n.length)throw Error(B(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:$r(n)}}function O_(t,e){var n=$r(e.value),r=$r(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Ig(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function V_(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function dh(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?V_(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Nl,L_=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Nl=Nl||document.createElement("div"),Nl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Nl.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function pa(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Jo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fT=["Webkit","ms","Moz","O"];Object.keys(Jo).forEach(function(t){fT.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Jo[e]=Jo[t]})});function M_(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Jo.hasOwnProperty(t)&&Jo[t]?(""+e).trim():e+"px"}function U_(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=M_(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var pT=Pe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function hh(t,e){if(e){if(pT[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(B(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(B(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(B(61))}if(e.style!=null&&typeof e.style!="object")throw Error(B(62))}}function fh(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ph=null;function Bf(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var mh=null,Ii=null,Ri=null;function Rg(t){if(t=qa(t)){if(typeof mh!="function")throw Error(B(280));var e=t.stateNode;e&&(e=Eu(e),mh(t.stateNode,t.type,e))}}function F_(t){Ii?Ri?Ri.push(t):Ri=[t]:Ii=t}function B_(){if(Ii){var t=Ii,e=Ri;if(Ri=Ii=null,Rg(t),e)for(t=0;t<e.length;t++)Rg(e[t])}}function z_(t,e){return t(e)}function $_(){}var gd=!1;function G_(t,e,n){if(gd)return t(e,n);gd=!0;try{return z_(t,e,n)}finally{gd=!1,(Ii!==null||Ri!==null)&&($_(),B_())}}function ma(t,e){var n=t.stateNode;if(n===null)return null;var r=Eu(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(B(231,e,typeof n));return n}var gh=!1;if(Kn)try{var Oo={};Object.defineProperty(Oo,"passive",{get:function(){gh=!0}}),window.addEventListener("test",Oo,Oo),window.removeEventListener("test",Oo,Oo)}catch{gh=!1}function mT(t,e,n,r,s,i,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(f){this.onError(f)}}var Xo=!1,Tc=null,Sc=!1,yh=null,gT={onError:function(t){Xo=!0,Tc=t}};function yT(t,e,n,r,s,i,o,l,c){Xo=!1,Tc=null,mT.apply(gT,arguments)}function vT(t,e,n,r,s,i,o,l,c){if(yT.apply(this,arguments),Xo){if(Xo){var u=Tc;Xo=!1,Tc=null}else throw Error(B(198));Sc||(Sc=!0,yh=u)}}function Bs(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function H_(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Cg(t){if(Bs(t)!==t)throw Error(B(188))}function _T(t){var e=t.alternate;if(!e){if(e=Bs(t),e===null)throw Error(B(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Cg(s),t;if(i===r)return Cg(s),e;i=i.sibling}throw Error(B(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(B(189))}}if(n.alternate!==r)throw Error(B(190))}if(n.tag!==3)throw Error(B(188));return n.stateNode.current===n?t:e}function W_(t){return t=_T(t),t!==null?q_(t):null}function q_(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=q_(t);if(e!==null)return e;t=t.sibling}return null}var K_=Ht.unstable_scheduleCallback,Ng=Ht.unstable_cancelCallback,wT=Ht.unstable_shouldYield,ET=Ht.unstable_requestPaint,Ue=Ht.unstable_now,xT=Ht.unstable_getCurrentPriorityLevel,zf=Ht.unstable_ImmediatePriority,Q_=Ht.unstable_UserBlockingPriority,Ic=Ht.unstable_NormalPriority,TT=Ht.unstable_LowPriority,Y_=Ht.unstable_IdlePriority,yu=null,In=null;function ST(t){if(In&&typeof In.onCommitFiberRoot=="function")try{In.onCommitFiberRoot(yu,t,void 0,(t.current.flags&128)===128)}catch{}}var fn=Math.clz32?Math.clz32:CT,IT=Math.log,RT=Math.LN2;function CT(t){return t>>>=0,t===0?32:31-(IT(t)/RT|0)|0}var Al=64,Pl=4194304;function Ho(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Rc(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=Ho(l):(i&=o,i!==0&&(r=Ho(i)))}else o=n&~s,o!==0?r=Ho(o):i!==0&&(r=Ho(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-fn(e),s=1<<n,r|=t[n],e&=~s;return r}function NT(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function AT(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-fn(i),l=1<<o,c=s[o];c===-1?(!(l&n)||l&r)&&(s[o]=NT(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function vh(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function J_(){var t=Al;return Al<<=1,!(Al&4194240)&&(Al=64),t}function yd(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Ha(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-fn(e),t[e]=n}function PT(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-fn(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function $f(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-fn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var ge=0;function X_(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Z_,Gf,e1,t1,n1,_h=!1,kl=[],Ar=null,Pr=null,kr=null,ga=new Map,ya=new Map,_r=[],kT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ag(t,e){switch(t){case"focusin":case"focusout":Ar=null;break;case"dragenter":case"dragleave":Pr=null;break;case"mouseover":case"mouseout":kr=null;break;case"pointerover":case"pointerout":ga.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ya.delete(e.pointerId)}}function Vo(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=qa(e),e!==null&&Gf(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function bT(t,e,n,r,s){switch(e){case"focusin":return Ar=Vo(Ar,t,e,n,r,s),!0;case"dragenter":return Pr=Vo(Pr,t,e,n,r,s),!0;case"mouseover":return kr=Vo(kr,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return ga.set(i,Vo(ga.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,ya.set(i,Vo(ya.get(i)||null,t,e,n,r,s)),!0}return!1}function r1(t){var e=Es(t.target);if(e!==null){var n=Bs(e);if(n!==null){if(e=n.tag,e===13){if(e=H_(n),e!==null){t.blockedOn=e,n1(t.priority,function(){e1(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Zl(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=wh(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);ph=r,n.target.dispatchEvent(r),ph=null}else return e=qa(n),e!==null&&Gf(e),t.blockedOn=n,!1;e.shift()}return!0}function Pg(t,e,n){Zl(t)&&n.delete(e)}function DT(){_h=!1,Ar!==null&&Zl(Ar)&&(Ar=null),Pr!==null&&Zl(Pr)&&(Pr=null),kr!==null&&Zl(kr)&&(kr=null),ga.forEach(Pg),ya.forEach(Pg)}function Lo(t,e){t.blockedOn===e&&(t.blockedOn=null,_h||(_h=!0,Ht.unstable_scheduleCallback(Ht.unstable_NormalPriority,DT)))}function va(t){function e(s){return Lo(s,t)}if(0<kl.length){Lo(kl[0],t);for(var n=1;n<kl.length;n++){var r=kl[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ar!==null&&Lo(Ar,t),Pr!==null&&Lo(Pr,t),kr!==null&&Lo(kr,t),ga.forEach(e),ya.forEach(e),n=0;n<_r.length;n++)r=_r[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<_r.length&&(n=_r[0],n.blockedOn===null);)r1(n),n.blockedOn===null&&_r.shift()}var Ci=nr.ReactCurrentBatchConfig,Cc=!0;function jT(t,e,n,r){var s=ge,i=Ci.transition;Ci.transition=null;try{ge=1,Hf(t,e,n,r)}finally{ge=s,Ci.transition=i}}function OT(t,e,n,r){var s=ge,i=Ci.transition;Ci.transition=null;try{ge=4,Hf(t,e,n,r)}finally{ge=s,Ci.transition=i}}function Hf(t,e,n,r){if(Cc){var s=wh(t,e,n,r);if(s===null)Cd(t,e,r,Nc,n),Ag(t,r);else if(bT(s,t,e,n,r))r.stopPropagation();else if(Ag(t,r),e&4&&-1<kT.indexOf(t)){for(;s!==null;){var i=qa(s);if(i!==null&&Z_(i),i=wh(t,e,n,r),i===null&&Cd(t,e,r,Nc,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Cd(t,e,r,null,n)}}var Nc=null;function wh(t,e,n,r){if(Nc=null,t=Bf(r),t=Es(t),t!==null)if(e=Bs(t),e===null)t=null;else if(n=e.tag,n===13){if(t=H_(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Nc=t,null}function s1(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(xT()){case zf:return 1;case Q_:return 4;case Ic:case TT:return 16;case Y_:return 536870912;default:return 16}default:return 16}}var Sr=null,Wf=null,ec=null;function i1(){if(ec)return ec;var t,e=Wf,n=e.length,r,s="value"in Sr?Sr.value:Sr.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return ec=s.slice(t,1<r?1-r:void 0)}function tc(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function bl(){return!0}function kg(){return!1}function qt(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?bl:kg,this.isPropagationStopped=kg,this}return Pe(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=bl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=bl)},persist:function(){},isPersistent:bl}),e}var Ji={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},qf=qt(Ji),Wa=Pe({},Ji,{view:0,detail:0}),VT=qt(Wa),vd,_d,Mo,vu=Pe({},Wa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Kf,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Mo&&(Mo&&t.type==="mousemove"?(vd=t.screenX-Mo.screenX,_d=t.screenY-Mo.screenY):_d=vd=0,Mo=t),vd)},movementY:function(t){return"movementY"in t?t.movementY:_d}}),bg=qt(vu),LT=Pe({},vu,{dataTransfer:0}),MT=qt(LT),UT=Pe({},Wa,{relatedTarget:0}),wd=qt(UT),FT=Pe({},Ji,{animationName:0,elapsedTime:0,pseudoElement:0}),BT=qt(FT),zT=Pe({},Ji,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),$T=qt(zT),GT=Pe({},Ji,{data:0}),Dg=qt(GT),HT={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},WT={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},qT={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function KT(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=qT[t])?!!e[t]:!1}function Kf(){return KT}var QT=Pe({},Wa,{key:function(t){if(t.key){var e=HT[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=tc(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?WT[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Kf,charCode:function(t){return t.type==="keypress"?tc(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?tc(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),YT=qt(QT),JT=Pe({},vu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),jg=qt(JT),XT=Pe({},Wa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Kf}),ZT=qt(XT),eS=Pe({},Ji,{propertyName:0,elapsedTime:0,pseudoElement:0}),tS=qt(eS),nS=Pe({},vu,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),rS=qt(nS),sS=[9,13,27,32],Qf=Kn&&"CompositionEvent"in window,Zo=null;Kn&&"documentMode"in document&&(Zo=document.documentMode);var iS=Kn&&"TextEvent"in window&&!Zo,o1=Kn&&(!Qf||Zo&&8<Zo&&11>=Zo),Og=String.fromCharCode(32),Vg=!1;function a1(t,e){switch(t){case"keyup":return sS.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function l1(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var pi=!1;function oS(t,e){switch(t){case"compositionend":return l1(e);case"keypress":return e.which!==32?null:(Vg=!0,Og);case"textInput":return t=e.data,t===Og&&Vg?null:t;default:return null}}function aS(t,e){if(pi)return t==="compositionend"||!Qf&&a1(t,e)?(t=i1(),ec=Wf=Sr=null,pi=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return o1&&e.locale!=="ko"?null:e.data;default:return null}}var lS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Lg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!lS[t.type]:e==="textarea"}function c1(t,e,n,r){F_(r),e=Ac(e,"onChange"),0<e.length&&(n=new qf("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var ea=null,_a=null;function cS(t){w1(t,0)}function _u(t){var e=yi(t);if(D_(e))return t}function uS(t,e){if(t==="change")return e}var u1=!1;if(Kn){var Ed;if(Kn){var xd="oninput"in document;if(!xd){var Mg=document.createElement("div");Mg.setAttribute("oninput","return;"),xd=typeof Mg.oninput=="function"}Ed=xd}else Ed=!1;u1=Ed&&(!document.documentMode||9<document.documentMode)}function Ug(){ea&&(ea.detachEvent("onpropertychange",d1),_a=ea=null)}function d1(t){if(t.propertyName==="value"&&_u(_a)){var e=[];c1(e,_a,t,Bf(t)),G_(cS,e)}}function dS(t,e,n){t==="focusin"?(Ug(),ea=e,_a=n,ea.attachEvent("onpropertychange",d1)):t==="focusout"&&Ug()}function hS(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return _u(_a)}function fS(t,e){if(t==="click")return _u(e)}function pS(t,e){if(t==="input"||t==="change")return _u(e)}function mS(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var yn=typeof Object.is=="function"?Object.is:mS;function wa(t,e){if(yn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!nh.call(e,s)||!yn(t[s],e[s]))return!1}return!0}function Fg(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Bg(t,e){var n=Fg(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Fg(n)}}function h1(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?h1(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function f1(){for(var t=window,e=xc();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=xc(t.document)}return e}function Yf(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function gS(t){var e=f1(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&h1(n.ownerDocument.documentElement,n)){if(r!==null&&Yf(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=Bg(n,i);var o=Bg(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var yS=Kn&&"documentMode"in document&&11>=document.documentMode,mi=null,Eh=null,ta=null,xh=!1;function zg(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;xh||mi==null||mi!==xc(r)||(r=mi,"selectionStart"in r&&Yf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ta&&wa(ta,r)||(ta=r,r=Ac(Eh,"onSelect"),0<r.length&&(e=new qf("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=mi)))}function Dl(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var gi={animationend:Dl("Animation","AnimationEnd"),animationiteration:Dl("Animation","AnimationIteration"),animationstart:Dl("Animation","AnimationStart"),transitionend:Dl("Transition","TransitionEnd")},Td={},p1={};Kn&&(p1=document.createElement("div").style,"AnimationEvent"in window||(delete gi.animationend.animation,delete gi.animationiteration.animation,delete gi.animationstart.animation),"TransitionEvent"in window||delete gi.transitionend.transition);function wu(t){if(Td[t])return Td[t];if(!gi[t])return t;var e=gi[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in p1)return Td[t]=e[n];return t}var m1=wu("animationend"),g1=wu("animationiteration"),y1=wu("animationstart"),v1=wu("transitionend"),_1=new Map,$g="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Xr(t,e){_1.set(t,e),Fs(e,[t])}for(var Sd=0;Sd<$g.length;Sd++){var Id=$g[Sd],vS=Id.toLowerCase(),_S=Id[0].toUpperCase()+Id.slice(1);Xr(vS,"on"+_S)}Xr(m1,"onAnimationEnd");Xr(g1,"onAnimationIteration");Xr(y1,"onAnimationStart");Xr("dblclick","onDoubleClick");Xr("focusin","onFocus");Xr("focusout","onBlur");Xr(v1,"onTransitionEnd");ji("onMouseEnter",["mouseout","mouseover"]);ji("onMouseLeave",["mouseout","mouseover"]);ji("onPointerEnter",["pointerout","pointerover"]);ji("onPointerLeave",["pointerout","pointerover"]);Fs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Fs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Fs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Fs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Fs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Fs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),wS=new Set("cancel close invalid load scroll toggle".split(" ").concat(Wo));function Gg(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,vT(r,e,void 0,t),t.currentTarget=null}function w1(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;Gg(s,l,u),i=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;Gg(s,l,u),i=c}}}if(Sc)throw t=yh,Sc=!1,yh=null,t}function Te(t,e){var n=e[Ch];n===void 0&&(n=e[Ch]=new Set);var r=t+"__bubble";n.has(r)||(E1(e,t,2,!1),n.add(r))}function Rd(t,e,n){var r=0;e&&(r|=4),E1(n,t,r,e)}var jl="_reactListening"+Math.random().toString(36).slice(2);function Ea(t){if(!t[jl]){t[jl]=!0,N_.forEach(function(n){n!=="selectionchange"&&(wS.has(n)||Rd(n,!1,t),Rd(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[jl]||(e[jl]=!0,Rd("selectionchange",!1,e))}}function E1(t,e,n,r){switch(s1(e)){case 1:var s=jT;break;case 4:s=OT;break;default:s=Hf}n=s.bind(null,e,n,t),s=void 0,!gh||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Cd(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=Es(l),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}l=l.parentNode}}r=r.return}G_(function(){var u=i,f=Bf(n),p=[];e:{var g=_1.get(t);if(g!==void 0){var w=qf,R=t;switch(t){case"keypress":if(tc(n)===0)break e;case"keydown":case"keyup":w=YT;break;case"focusin":R="focus",w=wd;break;case"focusout":R="blur",w=wd;break;case"beforeblur":case"afterblur":w=wd;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":w=bg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":w=MT;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":w=ZT;break;case m1:case g1:case y1:w=BT;break;case v1:w=tS;break;case"scroll":w=VT;break;case"wheel":w=rS;break;case"copy":case"cut":case"paste":w=$T;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":w=jg}var N=(e&4)!==0,P=!N&&t==="scroll",x=N?g!==null?g+"Capture":null:g;N=[];for(var v=u,T;v!==null;){T=v;var D=T.stateNode;if(T.tag===5&&D!==null&&(T=D,x!==null&&(D=ma(v,x),D!=null&&N.push(xa(v,D,T)))),P)break;v=v.return}0<N.length&&(g=new w(g,R,null,n,f),p.push({event:g,listeners:N}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",w=t==="mouseout"||t==="pointerout",g&&n!==ph&&(R=n.relatedTarget||n.fromElement)&&(Es(R)||R[Qn]))break e;if((w||g)&&(g=f.window===f?f:(g=f.ownerDocument)?g.defaultView||g.parentWindow:window,w?(R=n.relatedTarget||n.toElement,w=u,R=R?Es(R):null,R!==null&&(P=Bs(R),R!==P||R.tag!==5&&R.tag!==6)&&(R=null)):(w=null,R=u),w!==R)){if(N=bg,D="onMouseLeave",x="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(N=jg,D="onPointerLeave",x="onPointerEnter",v="pointer"),P=w==null?g:yi(w),T=R==null?g:yi(R),g=new N(D,v+"leave",w,n,f),g.target=P,g.relatedTarget=T,D=null,Es(f)===u&&(N=new N(x,v+"enter",R,n,f),N.target=T,N.relatedTarget=P,D=N),P=D,w&&R)t:{for(N=w,x=R,v=0,T=N;T;T=ri(T))v++;for(T=0,D=x;D;D=ri(D))T++;for(;0<v-T;)N=ri(N),v--;for(;0<T-v;)x=ri(x),T--;for(;v--;){if(N===x||x!==null&&N===x.alternate)break t;N=ri(N),x=ri(x)}N=null}else N=null;w!==null&&Hg(p,g,w,N,!1),R!==null&&P!==null&&Hg(p,P,R,N,!0)}}e:{if(g=u?yi(u):window,w=g.nodeName&&g.nodeName.toLowerCase(),w==="select"||w==="input"&&g.type==="file")var F=uS;else if(Lg(g))if(u1)F=pS;else{F=hS;var z=dS}else(w=g.nodeName)&&w.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(F=fS);if(F&&(F=F(t,u))){c1(p,F,n,f);break e}z&&z(t,g,u),t==="focusout"&&(z=g._wrapperState)&&z.controlled&&g.type==="number"&&ch(g,"number",g.value)}switch(z=u?yi(u):window,t){case"focusin":(Lg(z)||z.contentEditable==="true")&&(mi=z,Eh=u,ta=null);break;case"focusout":ta=Eh=mi=null;break;case"mousedown":xh=!0;break;case"contextmenu":case"mouseup":case"dragend":xh=!1,zg(p,n,f);break;case"selectionchange":if(yS)break;case"keydown":case"keyup":zg(p,n,f)}var S;if(Qf)e:{switch(t){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else pi?a1(t,n)&&(_="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(_="onCompositionStart");_&&(o1&&n.locale!=="ko"&&(pi||_!=="onCompositionStart"?_==="onCompositionEnd"&&pi&&(S=i1()):(Sr=f,Wf="value"in Sr?Sr.value:Sr.textContent,pi=!0)),z=Ac(u,_),0<z.length&&(_=new Dg(_,t,null,n,f),p.push({event:_,listeners:z}),S?_.data=S:(S=l1(n),S!==null&&(_.data=S)))),(S=iS?oS(t,n):aS(t,n))&&(u=Ac(u,"onBeforeInput"),0<u.length&&(f=new Dg("onBeforeInput","beforeinput",null,n,f),p.push({event:f,listeners:u}),f.data=S))}w1(p,e)})}function xa(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Ac(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=ma(t,n),i!=null&&r.unshift(xa(t,i,s)),i=ma(t,e),i!=null&&r.push(xa(t,i,s))),t=t.return}return r}function ri(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Hg(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,s?(c=ma(n,i),c!=null&&o.unshift(xa(n,c,l))):s||(c=ma(n,i),c!=null&&o.push(xa(n,c,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var ES=/\r\n?/g,xS=/\u0000|\uFFFD/g;function Wg(t){return(typeof t=="string"?t:""+t).replace(ES,`
`).replace(xS,"")}function Ol(t,e,n){if(e=Wg(e),Wg(t)!==e&&n)throw Error(B(425))}function Pc(){}var Th=null,Sh=null;function Ih(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Rh=typeof setTimeout=="function"?setTimeout:void 0,TS=typeof clearTimeout=="function"?clearTimeout:void 0,qg=typeof Promise=="function"?Promise:void 0,SS=typeof queueMicrotask=="function"?queueMicrotask:typeof qg<"u"?function(t){return qg.resolve(null).then(t).catch(IS)}:Rh;function IS(t){setTimeout(function(){throw t})}function Nd(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),va(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);va(e)}function br(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Kg(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Xi=Math.random().toString(36).slice(2),Tn="__reactFiber$"+Xi,Ta="__reactProps$"+Xi,Qn="__reactContainer$"+Xi,Ch="__reactEvents$"+Xi,RS="__reactListeners$"+Xi,CS="__reactHandles$"+Xi;function Es(t){var e=t[Tn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Qn]||n[Tn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Kg(t);t!==null;){if(n=t[Tn])return n;t=Kg(t)}return e}t=n,n=t.parentNode}return null}function qa(t){return t=t[Tn]||t[Qn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function yi(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(B(33))}function Eu(t){return t[Ta]||null}var Nh=[],vi=-1;function Zr(t){return{current:t}}function Se(t){0>vi||(t.current=Nh[vi],Nh[vi]=null,vi--)}function _e(t,e){vi++,Nh[vi]=t.current,t.current=e}var Gr={},Et=Zr(Gr),Ot=Zr(!1),ks=Gr;function Oi(t,e){var n=t.type.contextTypes;if(!n)return Gr;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Vt(t){return t=t.childContextTypes,t!=null}function kc(){Se(Ot),Se(Et)}function Qg(t,e,n){if(Et.current!==Gr)throw Error(B(168));_e(Et,e),_e(Ot,n)}function x1(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(B(108,dT(t)||"Unknown",s));return Pe({},n,r)}function bc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Gr,ks=Et.current,_e(Et,t),_e(Ot,Ot.current),!0}function Yg(t,e,n){var r=t.stateNode;if(!r)throw Error(B(169));n?(t=x1(t,e,ks),r.__reactInternalMemoizedMergedChildContext=t,Se(Ot),Se(Et),_e(Et,t)):Se(Ot),_e(Ot,n)}var Fn=null,xu=!1,Ad=!1;function T1(t){Fn===null?Fn=[t]:Fn.push(t)}function NS(t){xu=!0,T1(t)}function es(){if(!Ad&&Fn!==null){Ad=!0;var t=0,e=ge;try{var n=Fn;for(ge=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Fn=null,xu=!1}catch(s){throw Fn!==null&&(Fn=Fn.slice(t+1)),K_(zf,es),s}finally{ge=e,Ad=!1}}return null}var _i=[],wi=0,Dc=null,jc=0,Qt=[],Yt=0,bs=null,zn=1,$n="";function ys(t,e){_i[wi++]=jc,_i[wi++]=Dc,Dc=t,jc=e}function S1(t,e,n){Qt[Yt++]=zn,Qt[Yt++]=$n,Qt[Yt++]=bs,bs=t;var r=zn;t=$n;var s=32-fn(r)-1;r&=~(1<<s),n+=1;var i=32-fn(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,zn=1<<32-fn(e)+s|n<<s|r,$n=i+t}else zn=1<<i|n<<s|r,$n=t}function Jf(t){t.return!==null&&(ys(t,1),S1(t,1,0))}function Xf(t){for(;t===Dc;)Dc=_i[--wi],_i[wi]=null,jc=_i[--wi],_i[wi]=null;for(;t===bs;)bs=Qt[--Yt],Qt[Yt]=null,$n=Qt[--Yt],Qt[Yt]=null,zn=Qt[--Yt],Qt[Yt]=null}var Gt=null,zt=null,Ce=!1,un=null;function I1(t,e){var n=Xt(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Jg(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Gt=t,zt=br(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Gt=t,zt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=bs!==null?{id:zn,overflow:$n}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Xt(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Gt=t,zt=null,!0):!1;default:return!1}}function Ah(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Ph(t){if(Ce){var e=zt;if(e){var n=e;if(!Jg(t,e)){if(Ah(t))throw Error(B(418));e=br(n.nextSibling);var r=Gt;e&&Jg(t,e)?I1(r,n):(t.flags=t.flags&-4097|2,Ce=!1,Gt=t)}}else{if(Ah(t))throw Error(B(418));t.flags=t.flags&-4097|2,Ce=!1,Gt=t}}}function Xg(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Gt=t}function Vl(t){if(t!==Gt)return!1;if(!Ce)return Xg(t),Ce=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Ih(t.type,t.memoizedProps)),e&&(e=zt)){if(Ah(t))throw R1(),Error(B(418));for(;e;)I1(t,e),e=br(e.nextSibling)}if(Xg(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(B(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){zt=br(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}zt=null}}else zt=Gt?br(t.stateNode.nextSibling):null;return!0}function R1(){for(var t=zt;t;)t=br(t.nextSibling)}function Vi(){zt=Gt=null,Ce=!1}function Zf(t){un===null?un=[t]:un.push(t)}var AS=nr.ReactCurrentBatchConfig;function Uo(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(B(309));var r=n.stateNode}if(!r)throw Error(B(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(B(284));if(!n._owner)throw Error(B(290,t))}return t}function Ll(t,e){throw t=Object.prototype.toString.call(e),Error(B(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Zg(t){var e=t._init;return e(t._payload)}function C1(t){function e(x,v){if(t){var T=x.deletions;T===null?(x.deletions=[v],x.flags|=16):T.push(v)}}function n(x,v){if(!t)return null;for(;v!==null;)e(x,v),v=v.sibling;return null}function r(x,v){for(x=new Map;v!==null;)v.key!==null?x.set(v.key,v):x.set(v.index,v),v=v.sibling;return x}function s(x,v){return x=Vr(x,v),x.index=0,x.sibling=null,x}function i(x,v,T){return x.index=T,t?(T=x.alternate,T!==null?(T=T.index,T<v?(x.flags|=2,v):T):(x.flags|=2,v)):(x.flags|=1048576,v)}function o(x){return t&&x.alternate===null&&(x.flags|=2),x}function l(x,v,T,D){return v===null||v.tag!==6?(v=Vd(T,x.mode,D),v.return=x,v):(v=s(v,T),v.return=x,v)}function c(x,v,T,D){var F=T.type;return F===fi?f(x,v,T.props.children,D,T.key):v!==null&&(v.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===yr&&Zg(F)===v.type)?(D=s(v,T.props),D.ref=Uo(x,v,T),D.return=x,D):(D=lc(T.type,T.key,T.props,null,x.mode,D),D.ref=Uo(x,v,T),D.return=x,D)}function u(x,v,T,D){return v===null||v.tag!==4||v.stateNode.containerInfo!==T.containerInfo||v.stateNode.implementation!==T.implementation?(v=Ld(T,x.mode,D),v.return=x,v):(v=s(v,T.children||[]),v.return=x,v)}function f(x,v,T,D,F){return v===null||v.tag!==7?(v=Cs(T,x.mode,D,F),v.return=x,v):(v=s(v,T),v.return=x,v)}function p(x,v,T){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Vd(""+v,x.mode,T),v.return=x,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Rl:return T=lc(v.type,v.key,v.props,null,x.mode,T),T.ref=Uo(x,null,v),T.return=x,T;case hi:return v=Ld(v,x.mode,T),v.return=x,v;case yr:var D=v._init;return p(x,D(v._payload),T)}if(Go(v)||jo(v))return v=Cs(v,x.mode,T,null),v.return=x,v;Ll(x,v)}return null}function g(x,v,T,D){var F=v!==null?v.key:null;if(typeof T=="string"&&T!==""||typeof T=="number")return F!==null?null:l(x,v,""+T,D);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Rl:return T.key===F?c(x,v,T,D):null;case hi:return T.key===F?u(x,v,T,D):null;case yr:return F=T._init,g(x,v,F(T._payload),D)}if(Go(T)||jo(T))return F!==null?null:f(x,v,T,D,null);Ll(x,T)}return null}function w(x,v,T,D,F){if(typeof D=="string"&&D!==""||typeof D=="number")return x=x.get(T)||null,l(v,x,""+D,F);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case Rl:return x=x.get(D.key===null?T:D.key)||null,c(v,x,D,F);case hi:return x=x.get(D.key===null?T:D.key)||null,u(v,x,D,F);case yr:var z=D._init;return w(x,v,T,z(D._payload),F)}if(Go(D)||jo(D))return x=x.get(T)||null,f(v,x,D,F,null);Ll(v,D)}return null}function R(x,v,T,D){for(var F=null,z=null,S=v,_=v=0,I=null;S!==null&&_<T.length;_++){S.index>_?(I=S,S=null):I=S.sibling;var E=g(x,S,T[_],D);if(E===null){S===null&&(S=I);break}t&&S&&E.alternate===null&&e(x,S),v=i(E,v,_),z===null?F=E:z.sibling=E,z=E,S=I}if(_===T.length)return n(x,S),Ce&&ys(x,_),F;if(S===null){for(;_<T.length;_++)S=p(x,T[_],D),S!==null&&(v=i(S,v,_),z===null?F=S:z.sibling=S,z=S);return Ce&&ys(x,_),F}for(S=r(x,S);_<T.length;_++)I=w(S,x,_,T[_],D),I!==null&&(t&&I.alternate!==null&&S.delete(I.key===null?_:I.key),v=i(I,v,_),z===null?F=I:z.sibling=I,z=I);return t&&S.forEach(function(A){return e(x,A)}),Ce&&ys(x,_),F}function N(x,v,T,D){var F=jo(T);if(typeof F!="function")throw Error(B(150));if(T=F.call(T),T==null)throw Error(B(151));for(var z=F=null,S=v,_=v=0,I=null,E=T.next();S!==null&&!E.done;_++,E=T.next()){S.index>_?(I=S,S=null):I=S.sibling;var A=g(x,S,E.value,D);if(A===null){S===null&&(S=I);break}t&&S&&A.alternate===null&&e(x,S),v=i(A,v,_),z===null?F=A:z.sibling=A,z=A,S=I}if(E.done)return n(x,S),Ce&&ys(x,_),F;if(S===null){for(;!E.done;_++,E=T.next())E=p(x,E.value,D),E!==null&&(v=i(E,v,_),z===null?F=E:z.sibling=E,z=E);return Ce&&ys(x,_),F}for(S=r(x,S);!E.done;_++,E=T.next())E=w(S,x,_,E.value,D),E!==null&&(t&&E.alternate!==null&&S.delete(E.key===null?_:E.key),v=i(E,v,_),z===null?F=E:z.sibling=E,z=E);return t&&S.forEach(function(k){return e(x,k)}),Ce&&ys(x,_),F}function P(x,v,T,D){if(typeof T=="object"&&T!==null&&T.type===fi&&T.key===null&&(T=T.props.children),typeof T=="object"&&T!==null){switch(T.$$typeof){case Rl:e:{for(var F=T.key,z=v;z!==null;){if(z.key===F){if(F=T.type,F===fi){if(z.tag===7){n(x,z.sibling),v=s(z,T.props.children),v.return=x,x=v;break e}}else if(z.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===yr&&Zg(F)===z.type){n(x,z.sibling),v=s(z,T.props),v.ref=Uo(x,z,T),v.return=x,x=v;break e}n(x,z);break}else e(x,z);z=z.sibling}T.type===fi?(v=Cs(T.props.children,x.mode,D,T.key),v.return=x,x=v):(D=lc(T.type,T.key,T.props,null,x.mode,D),D.ref=Uo(x,v,T),D.return=x,x=D)}return o(x);case hi:e:{for(z=T.key;v!==null;){if(v.key===z)if(v.tag===4&&v.stateNode.containerInfo===T.containerInfo&&v.stateNode.implementation===T.implementation){n(x,v.sibling),v=s(v,T.children||[]),v.return=x,x=v;break e}else{n(x,v);break}else e(x,v);v=v.sibling}v=Ld(T,x.mode,D),v.return=x,x=v}return o(x);case yr:return z=T._init,P(x,v,z(T._payload),D)}if(Go(T))return R(x,v,T,D);if(jo(T))return N(x,v,T,D);Ll(x,T)}return typeof T=="string"&&T!==""||typeof T=="number"?(T=""+T,v!==null&&v.tag===6?(n(x,v.sibling),v=s(v,T),v.return=x,x=v):(n(x,v),v=Vd(T,x.mode,D),v.return=x,x=v),o(x)):n(x,v)}return P}var Li=C1(!0),N1=C1(!1),Oc=Zr(null),Vc=null,Ei=null,ep=null;function tp(){ep=Ei=Vc=null}function np(t){var e=Oc.current;Se(Oc),t._currentValue=e}function kh(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Ni(t,e){Vc=t,ep=Ei=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(jt=!0),t.firstContext=null)}function en(t){var e=t._currentValue;if(ep!==t)if(t={context:t,memoizedValue:e,next:null},Ei===null){if(Vc===null)throw Error(B(308));Ei=t,Vc.dependencies={lanes:0,firstContext:t}}else Ei=Ei.next=t;return e}var xs=null;function rp(t){xs===null?xs=[t]:xs.push(t)}function A1(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,rp(e)):(n.next=s.next,s.next=n),e.interleaved=n,Yn(t,r)}function Yn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var vr=!1;function sp(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function P1(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Wn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Dr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,fe&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Yn(t,n)}return s=r.interleaved,s===null?(e.next=e,rp(r)):(e.next=s.next,s.next=e),r.interleaved=e,Yn(t,n)}function nc(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,$f(t,n)}}function ey(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Lc(t,e,n,r){var s=t.updateQueue;vr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?i=u:o.next=u,o=c;var f=t.alternate;f!==null&&(f=f.updateQueue,l=f.lastBaseUpdate,l!==o&&(l===null?f.firstBaseUpdate=u:l.next=u,f.lastBaseUpdate=c))}if(i!==null){var p=s.baseState;o=0,f=u=c=null,l=i;do{var g=l.lane,w=l.eventTime;if((r&g)===g){f!==null&&(f=f.next={eventTime:w,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var R=t,N=l;switch(g=e,w=n,N.tag){case 1:if(R=N.payload,typeof R=="function"){p=R.call(w,p,g);break e}p=R;break e;case 3:R.flags=R.flags&-65537|128;case 0:if(R=N.payload,g=typeof R=="function"?R.call(w,p,g):R,g==null)break e;p=Pe({},p,g);break e;case 2:vr=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,g=s.effects,g===null?s.effects=[l]:g.push(l))}else w={eventTime:w,lane:g,tag:l.tag,payload:l.payload,callback:l.callback,next:null},f===null?(u=f=w,c=p):f=f.next=w,o|=g;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;g=l,l=g.next,g.next=null,s.lastBaseUpdate=g,s.shared.pending=null}}while(1);if(f===null&&(c=p),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=f,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);js|=o,t.lanes=o,t.memoizedState=p}}function ty(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(B(191,s));s.call(r)}}}var Ka={},Rn=Zr(Ka),Sa=Zr(Ka),Ia=Zr(Ka);function Ts(t){if(t===Ka)throw Error(B(174));return t}function ip(t,e){switch(_e(Ia,e),_e(Sa,t),_e(Rn,Ka),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:dh(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=dh(e,t)}Se(Rn),_e(Rn,e)}function Mi(){Se(Rn),Se(Sa),Se(Ia)}function k1(t){Ts(Ia.current);var e=Ts(Rn.current),n=dh(e,t.type);e!==n&&(_e(Sa,t),_e(Rn,n))}function op(t){Sa.current===t&&(Se(Rn),Se(Sa))}var Ne=Zr(0);function Mc(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Pd=[];function ap(){for(var t=0;t<Pd.length;t++)Pd[t]._workInProgressVersionPrimary=null;Pd.length=0}var rc=nr.ReactCurrentDispatcher,kd=nr.ReactCurrentBatchConfig,Ds=0,Ae=null,Ye=null,tt=null,Uc=!1,na=!1,Ra=0,PS=0;function mt(){throw Error(B(321))}function lp(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!yn(t[n],e[n]))return!1;return!0}function cp(t,e,n,r,s,i){if(Ds=i,Ae=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,rc.current=t===null||t.memoizedState===null?jS:OS,t=n(r,s),na){i=0;do{if(na=!1,Ra=0,25<=i)throw Error(B(301));i+=1,tt=Ye=null,e.updateQueue=null,rc.current=VS,t=n(r,s)}while(na)}if(rc.current=Fc,e=Ye!==null&&Ye.next!==null,Ds=0,tt=Ye=Ae=null,Uc=!1,e)throw Error(B(300));return t}function up(){var t=Ra!==0;return Ra=0,t}function En(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return tt===null?Ae.memoizedState=tt=t:tt=tt.next=t,tt}function tn(){if(Ye===null){var t=Ae.alternate;t=t!==null?t.memoizedState:null}else t=Ye.next;var e=tt===null?Ae.memoizedState:tt.next;if(e!==null)tt=e,Ye=t;else{if(t===null)throw Error(B(310));Ye=t,t={memoizedState:Ye.memoizedState,baseState:Ye.baseState,baseQueue:Ye.baseQueue,queue:Ye.queue,next:null},tt===null?Ae.memoizedState=tt=t:tt=tt.next=t}return tt}function Ca(t,e){return typeof e=="function"?e(t):e}function bd(t){var e=tn(),n=e.queue;if(n===null)throw Error(B(311));n.lastRenderedReducer=t;var r=Ye,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,c=null,u=i;do{var f=u.lane;if((Ds&f)===f)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var p={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=p,o=r):c=c.next=p,Ae.lanes|=f,js|=f}u=u.next}while(u!==null&&u!==i);c===null?o=r:c.next=l,yn(r,e.memoizedState)||(jt=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,Ae.lanes|=i,js|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Dd(t){var e=tn(),n=e.queue;if(n===null)throw Error(B(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);yn(i,e.memoizedState)||(jt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function b1(){}function D1(t,e){var n=Ae,r=tn(),s=e(),i=!yn(r.memoizedState,s);if(i&&(r.memoizedState=s,jt=!0),r=r.queue,dp(V1.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||tt!==null&&tt.memoizedState.tag&1){if(n.flags|=2048,Na(9,O1.bind(null,n,r,s,e),void 0,null),nt===null)throw Error(B(349));Ds&30||j1(n,e,s)}return s}function j1(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Ae.updateQueue,e===null?(e={lastEffect:null,stores:null},Ae.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function O1(t,e,n,r){e.value=n,e.getSnapshot=r,L1(e)&&M1(t)}function V1(t,e,n){return n(function(){L1(e)&&M1(t)})}function L1(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!yn(t,n)}catch{return!0}}function M1(t){var e=Yn(t,1);e!==null&&pn(e,t,1,-1)}function ny(t){var e=En();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ca,lastRenderedState:t},e.queue=t,t=t.dispatch=DS.bind(null,Ae,t),[e.memoizedState,t]}function Na(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Ae.updateQueue,e===null?(e={lastEffect:null,stores:null},Ae.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function U1(){return tn().memoizedState}function sc(t,e,n,r){var s=En();Ae.flags|=t,s.memoizedState=Na(1|e,n,void 0,r===void 0?null:r)}function Tu(t,e,n,r){var s=tn();r=r===void 0?null:r;var i=void 0;if(Ye!==null){var o=Ye.memoizedState;if(i=o.destroy,r!==null&&lp(r,o.deps)){s.memoizedState=Na(e,n,i,r);return}}Ae.flags|=t,s.memoizedState=Na(1|e,n,i,r)}function ry(t,e){return sc(8390656,8,t,e)}function dp(t,e){return Tu(2048,8,t,e)}function F1(t,e){return Tu(4,2,t,e)}function B1(t,e){return Tu(4,4,t,e)}function z1(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function $1(t,e,n){return n=n!=null?n.concat([t]):null,Tu(4,4,z1.bind(null,e,t),n)}function hp(){}function G1(t,e){var n=tn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&lp(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function H1(t,e){var n=tn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&lp(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function W1(t,e,n){return Ds&21?(yn(n,e)||(n=J_(),Ae.lanes|=n,js|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,jt=!0),t.memoizedState=n)}function kS(t,e){var n=ge;ge=n!==0&&4>n?n:4,t(!0);var r=kd.transition;kd.transition={};try{t(!1),e()}finally{ge=n,kd.transition=r}}function q1(){return tn().memoizedState}function bS(t,e,n){var r=Or(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},K1(t))Q1(e,n);else if(n=A1(t,e,n,r),n!==null){var s=Rt();pn(n,t,r,s),Y1(n,e,r)}}function DS(t,e,n){var r=Or(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(K1(t))Q1(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,yn(l,o)){var c=e.interleaved;c===null?(s.next=s,rp(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=A1(t,e,s,r),n!==null&&(s=Rt(),pn(n,t,r,s),Y1(n,e,r))}}function K1(t){var e=t.alternate;return t===Ae||e!==null&&e===Ae}function Q1(t,e){na=Uc=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Y1(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,$f(t,n)}}var Fc={readContext:en,useCallback:mt,useContext:mt,useEffect:mt,useImperativeHandle:mt,useInsertionEffect:mt,useLayoutEffect:mt,useMemo:mt,useReducer:mt,useRef:mt,useState:mt,useDebugValue:mt,useDeferredValue:mt,useTransition:mt,useMutableSource:mt,useSyncExternalStore:mt,useId:mt,unstable_isNewReconciler:!1},jS={readContext:en,useCallback:function(t,e){return En().memoizedState=[t,e===void 0?null:e],t},useContext:en,useEffect:ry,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,sc(4194308,4,z1.bind(null,e,t),n)},useLayoutEffect:function(t,e){return sc(4194308,4,t,e)},useInsertionEffect:function(t,e){return sc(4,2,t,e)},useMemo:function(t,e){var n=En();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=En();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=bS.bind(null,Ae,t),[r.memoizedState,t]},useRef:function(t){var e=En();return t={current:t},e.memoizedState=t},useState:ny,useDebugValue:hp,useDeferredValue:function(t){return En().memoizedState=t},useTransition:function(){var t=ny(!1),e=t[0];return t=kS.bind(null,t[1]),En().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Ae,s=En();if(Ce){if(n===void 0)throw Error(B(407));n=n()}else{if(n=e(),nt===null)throw Error(B(349));Ds&30||j1(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,ry(V1.bind(null,r,i,t),[t]),r.flags|=2048,Na(9,O1.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=En(),e=nt.identifierPrefix;if(Ce){var n=$n,r=zn;n=(r&~(1<<32-fn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Ra++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=PS++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},OS={readContext:en,useCallback:G1,useContext:en,useEffect:dp,useImperativeHandle:$1,useInsertionEffect:F1,useLayoutEffect:B1,useMemo:H1,useReducer:bd,useRef:U1,useState:function(){return bd(Ca)},useDebugValue:hp,useDeferredValue:function(t){var e=tn();return W1(e,Ye.memoizedState,t)},useTransition:function(){var t=bd(Ca)[0],e=tn().memoizedState;return[t,e]},useMutableSource:b1,useSyncExternalStore:D1,useId:q1,unstable_isNewReconciler:!1},VS={readContext:en,useCallback:G1,useContext:en,useEffect:dp,useImperativeHandle:$1,useInsertionEffect:F1,useLayoutEffect:B1,useMemo:H1,useReducer:Dd,useRef:U1,useState:function(){return Dd(Ca)},useDebugValue:hp,useDeferredValue:function(t){var e=tn();return Ye===null?e.memoizedState=t:W1(e,Ye.memoizedState,t)},useTransition:function(){var t=Dd(Ca)[0],e=tn().memoizedState;return[t,e]},useMutableSource:b1,useSyncExternalStore:D1,useId:q1,unstable_isNewReconciler:!1};function ln(t,e){if(t&&t.defaultProps){e=Pe({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function bh(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Pe({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Su={isMounted:function(t){return(t=t._reactInternals)?Bs(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Rt(),s=Or(t),i=Wn(r,s);i.payload=e,n!=null&&(i.callback=n),e=Dr(t,i,s),e!==null&&(pn(e,t,s,r),nc(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Rt(),s=Or(t),i=Wn(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Dr(t,i,s),e!==null&&(pn(e,t,s,r),nc(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Rt(),r=Or(t),s=Wn(n,r);s.tag=2,e!=null&&(s.callback=e),e=Dr(t,s,r),e!==null&&(pn(e,t,r,n),nc(e,t,r))}};function sy(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!wa(n,r)||!wa(s,i):!0}function J1(t,e,n){var r=!1,s=Gr,i=e.contextType;return typeof i=="object"&&i!==null?i=en(i):(s=Vt(e)?ks:Et.current,r=e.contextTypes,i=(r=r!=null)?Oi(t,s):Gr),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Su,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function iy(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Su.enqueueReplaceState(e,e.state,null)}function Dh(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},sp(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=en(i):(i=Vt(e)?ks:Et.current,s.context=Oi(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(bh(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Su.enqueueReplaceState(s,s.state,null),Lc(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Ui(t,e){try{var n="",r=e;do n+=uT(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function jd(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function jh(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var LS=typeof WeakMap=="function"?WeakMap:Map;function X1(t,e,n){n=Wn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){zc||(zc=!0,Gh=r),jh(t,e)},n}function Z1(t,e,n){n=Wn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){jh(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){jh(t,e),typeof r!="function"&&(jr===null?jr=new Set([this]):jr.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function oy(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new LS;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=JS.bind(null,t,e,n),e.then(t,t))}function ay(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function ly(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Wn(-1,1),e.tag=2,Dr(n,e,1))),n.lanes|=1),t)}var MS=nr.ReactCurrentOwner,jt=!1;function St(t,e,n,r){e.child=t===null?N1(e,null,n,r):Li(e,t.child,n,r)}function cy(t,e,n,r,s){n=n.render;var i=e.ref;return Ni(e,s),r=cp(t,e,n,r,i,s),n=up(),t!==null&&!jt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Jn(t,e,s)):(Ce&&n&&Jf(e),e.flags|=1,St(t,e,r,s),e.child)}function uy(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!wp(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,e0(t,e,i,r,s)):(t=lc(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:wa,n(o,r)&&t.ref===e.ref)return Jn(t,e,s)}return e.flags|=1,t=Vr(i,r),t.ref=e.ref,t.return=e,e.child=t}function e0(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(wa(i,r)&&t.ref===e.ref)if(jt=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(jt=!0);else return e.lanes=t.lanes,Jn(t,e,s)}return Oh(t,e,n,r,s)}function t0(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},_e(Ti,Ut),Ut|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,_e(Ti,Ut),Ut|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,_e(Ti,Ut),Ut|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,_e(Ti,Ut),Ut|=r;return St(t,e,s,n),e.child}function n0(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Oh(t,e,n,r,s){var i=Vt(n)?ks:Et.current;return i=Oi(e,i),Ni(e,s),n=cp(t,e,n,r,i,s),r=up(),t!==null&&!jt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Jn(t,e,s)):(Ce&&r&&Jf(e),e.flags|=1,St(t,e,n,s),e.child)}function dy(t,e,n,r,s){if(Vt(n)){var i=!0;bc(e)}else i=!1;if(Ni(e,s),e.stateNode===null)ic(t,e),J1(e,n,r),Dh(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=en(u):(u=Vt(n)?ks:Et.current,u=Oi(e,u));var f=n.getDerivedStateFromProps,p=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==u)&&iy(e,o,r,u),vr=!1;var g=e.memoizedState;o.state=g,Lc(e,r,o,s),c=e.memoizedState,l!==r||g!==c||Ot.current||vr?(typeof f=="function"&&(bh(e,n,f,r),c=e.memoizedState),(l=vr||sy(e,n,l,r,g,c,u))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=u,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,P1(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:ln(e.type,l),o.props=u,p=e.pendingProps,g=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=en(c):(c=Vt(n)?ks:Et.current,c=Oi(e,c));var w=n.getDerivedStateFromProps;(f=typeof w=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==p||g!==c)&&iy(e,o,r,c),vr=!1,g=e.memoizedState,o.state=g,Lc(e,r,o,s);var R=e.memoizedState;l!==p||g!==R||Ot.current||vr?(typeof w=="function"&&(bh(e,n,w,r),R=e.memoizedState),(u=vr||sy(e,n,u,r,g,R,c)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,R,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,R,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=R),o.props=r,o.state=R,o.context=c,r=u):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),r=!1)}return Vh(t,e,n,r,i,s)}function Vh(t,e,n,r,s,i){n0(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&Yg(e,n,!1),Jn(t,e,i);r=e.stateNode,MS.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Li(e,t.child,null,i),e.child=Li(e,null,l,i)):St(t,e,l,i),e.memoizedState=r.state,s&&Yg(e,n,!0),e.child}function r0(t){var e=t.stateNode;e.pendingContext?Qg(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Qg(t,e.context,!1),ip(t,e.containerInfo)}function hy(t,e,n,r,s){return Vi(),Zf(s),e.flags|=256,St(t,e,n,r),e.child}var Lh={dehydrated:null,treeContext:null,retryLane:0};function Mh(t){return{baseLanes:t,cachePool:null,transitions:null}}function s0(t,e,n){var r=e.pendingProps,s=Ne.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),_e(Ne,s&1),t===null)return Ph(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Cu(o,r,0,null),t=Cs(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Mh(n),e.memoizedState=Lh,t):fp(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return US(t,e,o,r,l,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=Vr(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Vr(l,i):(i=Cs(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?Mh(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=Lh,r}return i=t.child,t=i.sibling,r=Vr(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function fp(t,e){return e=Cu({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Ml(t,e,n,r){return r!==null&&Zf(r),Li(e,t.child,null,n),t=fp(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function US(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=jd(Error(B(422))),Ml(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Cu({mode:"visible",children:r.children},s,0,null),i=Cs(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Li(e,t.child,null,o),e.child.memoizedState=Mh(o),e.memoizedState=Lh,i);if(!(e.mode&1))return Ml(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(B(419)),r=jd(i,r,void 0),Ml(t,e,o,r)}if(l=(o&t.childLanes)!==0,jt||l){if(r=nt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Yn(t,s),pn(r,t,s,-1))}return _p(),r=jd(Error(B(421))),Ml(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=XS.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,zt=br(s.nextSibling),Gt=e,Ce=!0,un=null,t!==null&&(Qt[Yt++]=zn,Qt[Yt++]=$n,Qt[Yt++]=bs,zn=t.id,$n=t.overflow,bs=e),e=fp(e,r.children),e.flags|=4096,e)}function fy(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),kh(t.return,e,n)}function Od(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function i0(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(St(t,e,r.children,n),r=Ne.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&fy(t,n,e);else if(t.tag===19)fy(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(_e(Ne,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Mc(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Od(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Mc(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Od(e,!0,n,null,i);break;case"together":Od(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ic(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Jn(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),js|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(B(153));if(e.child!==null){for(t=e.child,n=Vr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Vr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function FS(t,e,n){switch(e.tag){case 3:r0(e),Vi();break;case 5:k1(e);break;case 1:Vt(e.type)&&bc(e);break;case 4:ip(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;_e(Oc,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(_e(Ne,Ne.current&1),e.flags|=128,null):n&e.child.childLanes?s0(t,e,n):(_e(Ne,Ne.current&1),t=Jn(t,e,n),t!==null?t.sibling:null);_e(Ne,Ne.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return i0(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),_e(Ne,Ne.current),r)break;return null;case 22:case 23:return e.lanes=0,t0(t,e,n)}return Jn(t,e,n)}var o0,Uh,a0,l0;o0=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Uh=function(){};a0=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Ts(Rn.current);var i=null;switch(n){case"input":s=ah(t,s),r=ah(t,r),i=[];break;case"select":s=Pe({},s,{value:void 0}),r=Pe({},r,{value:void 0}),i=[];break;case"textarea":s=uh(t,s),r=uh(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Pc)}hh(n,r);var o;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(fa.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var c=r[u];if(l=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(fa.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Te("scroll",t),i||l===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};l0=function(t,e,n,r){n!==r&&(e.flags|=4)};function Fo(t,e){if(!Ce)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function gt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function BS(t,e,n){var r=e.pendingProps;switch(Xf(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return gt(e),null;case 1:return Vt(e.type)&&kc(),gt(e),null;case 3:return r=e.stateNode,Mi(),Se(Ot),Se(Et),ap(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Vl(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,un!==null&&(qh(un),un=null))),Uh(t,e),gt(e),null;case 5:op(e);var s=Ts(Ia.current);if(n=e.type,t!==null&&e.stateNode!=null)a0(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(B(166));return gt(e),null}if(t=Ts(Rn.current),Vl(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Tn]=e,r[Ta]=i,t=(e.mode&1)!==0,n){case"dialog":Te("cancel",r),Te("close",r);break;case"iframe":case"object":case"embed":Te("load",r);break;case"video":case"audio":for(s=0;s<Wo.length;s++)Te(Wo[s],r);break;case"source":Te("error",r);break;case"img":case"image":case"link":Te("error",r),Te("load",r);break;case"details":Te("toggle",r);break;case"input":xg(r,i),Te("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Te("invalid",r);break;case"textarea":Sg(r,i),Te("invalid",r)}hh(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&Ol(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Ol(r.textContent,l,t),s=["children",""+l]):fa.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Te("scroll",r)}switch(n){case"input":Cl(r),Tg(r,i,!0);break;case"textarea":Cl(r),Ig(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Pc)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=V_(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Tn]=e,t[Ta]=r,o0(t,e,!1,!1),e.stateNode=t;e:{switch(o=fh(n,r),n){case"dialog":Te("cancel",t),Te("close",t),s=r;break;case"iframe":case"object":case"embed":Te("load",t),s=r;break;case"video":case"audio":for(s=0;s<Wo.length;s++)Te(Wo[s],t);s=r;break;case"source":Te("error",t),s=r;break;case"img":case"image":case"link":Te("error",t),Te("load",t),s=r;break;case"details":Te("toggle",t),s=r;break;case"input":xg(t,r),s=ah(t,r),Te("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Pe({},r,{value:void 0}),Te("invalid",t);break;case"textarea":Sg(t,r),s=uh(t,r),Te("invalid",t);break;default:s=r}hh(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?U_(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&L_(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&pa(t,c):typeof c=="number"&&pa(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(fa.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Te("scroll",t):c!=null&&Lf(t,i,c,o))}switch(n){case"input":Cl(t),Tg(t,r,!1);break;case"textarea":Cl(t),Ig(t);break;case"option":r.value!=null&&t.setAttribute("value",""+$r(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Si(t,!!r.multiple,i,!1):r.defaultValue!=null&&Si(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Pc)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return gt(e),null;case 6:if(t&&e.stateNode!=null)l0(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(B(166));if(n=Ts(Ia.current),Ts(Rn.current),Vl(e)){if(r=e.stateNode,n=e.memoizedProps,r[Tn]=e,(i=r.nodeValue!==n)&&(t=Gt,t!==null))switch(t.tag){case 3:Ol(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Ol(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Tn]=e,e.stateNode=r}return gt(e),null;case 13:if(Se(Ne),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ce&&zt!==null&&e.mode&1&&!(e.flags&128))R1(),Vi(),e.flags|=98560,i=!1;else if(i=Vl(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(B(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(B(317));i[Tn]=e}else Vi(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;gt(e),i=!1}else un!==null&&(qh(un),un=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Ne.current&1?Je===0&&(Je=3):_p())),e.updateQueue!==null&&(e.flags|=4),gt(e),null);case 4:return Mi(),Uh(t,e),t===null&&Ea(e.stateNode.containerInfo),gt(e),null;case 10:return np(e.type._context),gt(e),null;case 17:return Vt(e.type)&&kc(),gt(e),null;case 19:if(Se(Ne),i=e.memoizedState,i===null)return gt(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Fo(i,!1);else{if(Je!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Mc(t),o!==null){for(e.flags|=128,Fo(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return _e(Ne,Ne.current&1|2),e.child}t=t.sibling}i.tail!==null&&Ue()>Fi&&(e.flags|=128,r=!0,Fo(i,!1),e.lanes=4194304)}else{if(!r)if(t=Mc(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Fo(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Ce)return gt(e),null}else 2*Ue()-i.renderingStartTime>Fi&&n!==1073741824&&(e.flags|=128,r=!0,Fo(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Ue(),e.sibling=null,n=Ne.current,_e(Ne,r?n&1|2:n&1),e):(gt(e),null);case 22:case 23:return vp(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Ut&1073741824&&(gt(e),e.subtreeFlags&6&&(e.flags|=8192)):gt(e),null;case 24:return null;case 25:return null}throw Error(B(156,e.tag))}function zS(t,e){switch(Xf(e),e.tag){case 1:return Vt(e.type)&&kc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Mi(),Se(Ot),Se(Et),ap(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return op(e),null;case 13:if(Se(Ne),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(B(340));Vi()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Se(Ne),null;case 4:return Mi(),null;case 10:return np(e.type._context),null;case 22:case 23:return vp(),null;case 24:return null;default:return null}}var Ul=!1,_t=!1,$S=typeof WeakSet=="function"?WeakSet:Set,Q=null;function xi(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){je(t,e,r)}else n.current=null}function Fh(t,e,n){try{n()}catch(r){je(t,e,r)}}var py=!1;function GS(t,e){if(Th=Cc,t=f1(),Yf(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,u=0,f=0,p=t,g=null;t:for(;;){for(var w;p!==n||s!==0&&p.nodeType!==3||(l=o+s),p!==i||r!==0&&p.nodeType!==3||(c=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(w=p.firstChild)!==null;)g=p,p=w;for(;;){if(p===t)break t;if(g===n&&++u===s&&(l=o),g===i&&++f===r&&(c=o),(w=p.nextSibling)!==null)break;p=g,g=p.parentNode}p=w}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Sh={focusedElem:t,selectionRange:n},Cc=!1,Q=e;Q!==null;)if(e=Q,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Q=t;else for(;Q!==null;){e=Q;try{var R=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(R!==null){var N=R.memoizedProps,P=R.memoizedState,x=e.stateNode,v=x.getSnapshotBeforeUpdate(e.elementType===e.type?N:ln(e.type,N),P);x.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var T=e.stateNode.containerInfo;T.nodeType===1?T.textContent="":T.nodeType===9&&T.documentElement&&T.removeChild(T.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(B(163))}}catch(D){je(e,e.return,D)}if(t=e.sibling,t!==null){t.return=e.return,Q=t;break}Q=e.return}return R=py,py=!1,R}function ra(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Fh(e,n,i)}s=s.next}while(s!==r)}}function Iu(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Bh(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function c0(t){var e=t.alternate;e!==null&&(t.alternate=null,c0(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Tn],delete e[Ta],delete e[Ch],delete e[RS],delete e[CS])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function u0(t){return t.tag===5||t.tag===3||t.tag===4}function my(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||u0(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function zh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Pc));else if(r!==4&&(t=t.child,t!==null))for(zh(t,e,n),t=t.sibling;t!==null;)zh(t,e,n),t=t.sibling}function $h(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for($h(t,e,n),t=t.sibling;t!==null;)$h(t,e,n),t=t.sibling}var ot=null,cn=!1;function pr(t,e,n){for(n=n.child;n!==null;)d0(t,e,n),n=n.sibling}function d0(t,e,n){if(In&&typeof In.onCommitFiberUnmount=="function")try{In.onCommitFiberUnmount(yu,n)}catch{}switch(n.tag){case 5:_t||xi(n,e);case 6:var r=ot,s=cn;ot=null,pr(t,e,n),ot=r,cn=s,ot!==null&&(cn?(t=ot,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):ot.removeChild(n.stateNode));break;case 18:ot!==null&&(cn?(t=ot,n=n.stateNode,t.nodeType===8?Nd(t.parentNode,n):t.nodeType===1&&Nd(t,n),va(t)):Nd(ot,n.stateNode));break;case 4:r=ot,s=cn,ot=n.stateNode.containerInfo,cn=!0,pr(t,e,n),ot=r,cn=s;break;case 0:case 11:case 14:case 15:if(!_t&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Fh(n,e,o),s=s.next}while(s!==r)}pr(t,e,n);break;case 1:if(!_t&&(xi(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){je(n,e,l)}pr(t,e,n);break;case 21:pr(t,e,n);break;case 22:n.mode&1?(_t=(r=_t)||n.memoizedState!==null,pr(t,e,n),_t=r):pr(t,e,n);break;default:pr(t,e,n)}}function gy(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new $S),e.forEach(function(r){var s=ZS.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function on(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:ot=l.stateNode,cn=!1;break e;case 3:ot=l.stateNode.containerInfo,cn=!0;break e;case 4:ot=l.stateNode.containerInfo,cn=!0;break e}l=l.return}if(ot===null)throw Error(B(160));d0(i,o,s),ot=null,cn=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){je(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)h0(e,t),e=e.sibling}function h0(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(on(e,t),wn(t),r&4){try{ra(3,t,t.return),Iu(3,t)}catch(N){je(t,t.return,N)}try{ra(5,t,t.return)}catch(N){je(t,t.return,N)}}break;case 1:on(e,t),wn(t),r&512&&n!==null&&xi(n,n.return);break;case 5:if(on(e,t),wn(t),r&512&&n!==null&&xi(n,n.return),t.flags&32){var s=t.stateNode;try{pa(s,"")}catch(N){je(t,t.return,N)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&j_(s,i),fh(l,o);var u=fh(l,i);for(o=0;o<c.length;o+=2){var f=c[o],p=c[o+1];f==="style"?U_(s,p):f==="dangerouslySetInnerHTML"?L_(s,p):f==="children"?pa(s,p):Lf(s,f,p,u)}switch(l){case"input":lh(s,i);break;case"textarea":O_(s,i);break;case"select":var g=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var w=i.value;w!=null?Si(s,!!i.multiple,w,!1):g!==!!i.multiple&&(i.defaultValue!=null?Si(s,!!i.multiple,i.defaultValue,!0):Si(s,!!i.multiple,i.multiple?[]:"",!1))}s[Ta]=i}catch(N){je(t,t.return,N)}}break;case 6:if(on(e,t),wn(t),r&4){if(t.stateNode===null)throw Error(B(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(N){je(t,t.return,N)}}break;case 3:if(on(e,t),wn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{va(e.containerInfo)}catch(N){je(t,t.return,N)}break;case 4:on(e,t),wn(t);break;case 13:on(e,t),wn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(gp=Ue())),r&4&&gy(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(_t=(u=_t)||f,on(e,t),_t=u):on(e,t),wn(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!f&&t.mode&1)for(Q=t,f=t.child;f!==null;){for(p=Q=f;Q!==null;){switch(g=Q,w=g.child,g.tag){case 0:case 11:case 14:case 15:ra(4,g,g.return);break;case 1:xi(g,g.return);var R=g.stateNode;if(typeof R.componentWillUnmount=="function"){r=g,n=g.return;try{e=r,R.props=e.memoizedProps,R.state=e.memoizedState,R.componentWillUnmount()}catch(N){je(r,n,N)}}break;case 5:xi(g,g.return);break;case 22:if(g.memoizedState!==null){vy(p);continue}}w!==null?(w.return=g,Q=w):vy(p)}f=f.sibling}e:for(f=null,p=t;;){if(p.tag===5){if(f===null){f=p;try{s=p.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=p.stateNode,c=p.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=M_("display",o))}catch(N){je(t,t.return,N)}}}else if(p.tag===6){if(f===null)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(N){je(t,t.return,N)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;f===p&&(f=null),p=p.return}f===p&&(f=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:on(e,t),wn(t),r&4&&gy(t);break;case 21:break;default:on(e,t),wn(t)}}function wn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(u0(n)){var r=n;break e}n=n.return}throw Error(B(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(pa(s,""),r.flags&=-33);var i=my(t);$h(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=my(t);zh(t,l,o);break;default:throw Error(B(161))}}catch(c){je(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function HS(t,e,n){Q=t,f0(t)}function f0(t,e,n){for(var r=(t.mode&1)!==0;Q!==null;){var s=Q,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Ul;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||_t;l=Ul;var u=_t;if(Ul=o,(_t=c)&&!u)for(Q=s;Q!==null;)o=Q,c=o.child,o.tag===22&&o.memoizedState!==null?_y(s):c!==null?(c.return=o,Q=c):_y(s);for(;i!==null;)Q=i,f0(i),i=i.sibling;Q=s,Ul=l,_t=u}yy(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Q=i):yy(t)}}function yy(t){for(;Q!==null;){var e=Q;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:_t||Iu(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!_t)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:ln(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&ty(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}ty(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var p=f.dehydrated;p!==null&&va(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(B(163))}_t||e.flags&512&&Bh(e)}catch(g){je(e,e.return,g)}}if(e===t){Q=null;break}if(n=e.sibling,n!==null){n.return=e.return,Q=n;break}Q=e.return}}function vy(t){for(;Q!==null;){var e=Q;if(e===t){Q=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Q=n;break}Q=e.return}}function _y(t){for(;Q!==null;){var e=Q;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Iu(4,e)}catch(c){je(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){je(e,s,c)}}var i=e.return;try{Bh(e)}catch(c){je(e,i,c)}break;case 5:var o=e.return;try{Bh(e)}catch(c){je(e,o,c)}}}catch(c){je(e,e.return,c)}if(e===t){Q=null;break}var l=e.sibling;if(l!==null){l.return=e.return,Q=l;break}Q=e.return}}var WS=Math.ceil,Bc=nr.ReactCurrentDispatcher,pp=nr.ReactCurrentOwner,Zt=nr.ReactCurrentBatchConfig,fe=0,nt=null,We=null,ut=0,Ut=0,Ti=Zr(0),Je=0,Aa=null,js=0,Ru=0,mp=0,sa=null,bt=null,gp=0,Fi=1/0,Un=null,zc=!1,Gh=null,jr=null,Fl=!1,Ir=null,$c=0,ia=0,Hh=null,oc=-1,ac=0;function Rt(){return fe&6?Ue():oc!==-1?oc:oc=Ue()}function Or(t){return t.mode&1?fe&2&&ut!==0?ut&-ut:AS.transition!==null?(ac===0&&(ac=J_()),ac):(t=ge,t!==0||(t=window.event,t=t===void 0?16:s1(t.type)),t):1}function pn(t,e,n,r){if(50<ia)throw ia=0,Hh=null,Error(B(185));Ha(t,n,r),(!(fe&2)||t!==nt)&&(t===nt&&(!(fe&2)&&(Ru|=n),Je===4&&wr(t,ut)),Lt(t,r),n===1&&fe===0&&!(e.mode&1)&&(Fi=Ue()+500,xu&&es()))}function Lt(t,e){var n=t.callbackNode;AT(t,e);var r=Rc(t,t===nt?ut:0);if(r===0)n!==null&&Ng(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Ng(n),e===1)t.tag===0?NS(wy.bind(null,t)):T1(wy.bind(null,t)),SS(function(){!(fe&6)&&es()}),n=null;else{switch(X_(r)){case 1:n=zf;break;case 4:n=Q_;break;case 16:n=Ic;break;case 536870912:n=Y_;break;default:n=Ic}n=E0(n,p0.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function p0(t,e){if(oc=-1,ac=0,fe&6)throw Error(B(327));var n=t.callbackNode;if(Ai()&&t.callbackNode!==n)return null;var r=Rc(t,t===nt?ut:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Gc(t,r);else{e=r;var s=fe;fe|=2;var i=g0();(nt!==t||ut!==e)&&(Un=null,Fi=Ue()+500,Rs(t,e));do try{QS();break}catch(l){m0(t,l)}while(1);tp(),Bc.current=i,fe=s,We!==null?e=0:(nt=null,ut=0,e=Je)}if(e!==0){if(e===2&&(s=vh(t),s!==0&&(r=s,e=Wh(t,s))),e===1)throw n=Aa,Rs(t,0),wr(t,r),Lt(t,Ue()),n;if(e===6)wr(t,r);else{if(s=t.current.alternate,!(r&30)&&!qS(s)&&(e=Gc(t,r),e===2&&(i=vh(t),i!==0&&(r=i,e=Wh(t,i))),e===1))throw n=Aa,Rs(t,0),wr(t,r),Lt(t,Ue()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(B(345));case 2:vs(t,bt,Un);break;case 3:if(wr(t,r),(r&130023424)===r&&(e=gp+500-Ue(),10<e)){if(Rc(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Rt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Rh(vs.bind(null,t,bt,Un),e);break}vs(t,bt,Un);break;case 4:if(wr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-fn(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Ue()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*WS(r/1960))-r,10<r){t.timeoutHandle=Rh(vs.bind(null,t,bt,Un),r);break}vs(t,bt,Un);break;case 5:vs(t,bt,Un);break;default:throw Error(B(329))}}}return Lt(t,Ue()),t.callbackNode===n?p0.bind(null,t):null}function Wh(t,e){var n=sa;return t.current.memoizedState.isDehydrated&&(Rs(t,e).flags|=256),t=Gc(t,e),t!==2&&(e=bt,bt=n,e!==null&&qh(e)),t}function qh(t){bt===null?bt=t:bt.push.apply(bt,t)}function qS(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!yn(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function wr(t,e){for(e&=~mp,e&=~Ru,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-fn(e),r=1<<n;t[n]=-1,e&=~r}}function wy(t){if(fe&6)throw Error(B(327));Ai();var e=Rc(t,0);if(!(e&1))return Lt(t,Ue()),null;var n=Gc(t,e);if(t.tag!==0&&n===2){var r=vh(t);r!==0&&(e=r,n=Wh(t,r))}if(n===1)throw n=Aa,Rs(t,0),wr(t,e),Lt(t,Ue()),n;if(n===6)throw Error(B(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,vs(t,bt,Un),Lt(t,Ue()),null}function yp(t,e){var n=fe;fe|=1;try{return t(e)}finally{fe=n,fe===0&&(Fi=Ue()+500,xu&&es())}}function Os(t){Ir!==null&&Ir.tag===0&&!(fe&6)&&Ai();var e=fe;fe|=1;var n=Zt.transition,r=ge;try{if(Zt.transition=null,ge=1,t)return t()}finally{ge=r,Zt.transition=n,fe=e,!(fe&6)&&es()}}function vp(){Ut=Ti.current,Se(Ti)}function Rs(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,TS(n)),We!==null)for(n=We.return;n!==null;){var r=n;switch(Xf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&kc();break;case 3:Mi(),Se(Ot),Se(Et),ap();break;case 5:op(r);break;case 4:Mi();break;case 13:Se(Ne);break;case 19:Se(Ne);break;case 10:np(r.type._context);break;case 22:case 23:vp()}n=n.return}if(nt=t,We=t=Vr(t.current,null),ut=Ut=e,Je=0,Aa=null,mp=Ru=js=0,bt=sa=null,xs!==null){for(e=0;e<xs.length;e++)if(n=xs[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}xs=null}return t}function m0(t,e){do{var n=We;try{if(tp(),rc.current=Fc,Uc){for(var r=Ae.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Uc=!1}if(Ds=0,tt=Ye=Ae=null,na=!1,Ra=0,pp.current=null,n===null||n.return===null){Je=1,Aa=e,We=null;break}e:{var i=t,o=n.return,l=n,c=e;if(e=ut,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,f=l,p=f.tag;if(!(f.mode&1)&&(p===0||p===11||p===15)){var g=f.alternate;g?(f.updateQueue=g.updateQueue,f.memoizedState=g.memoizedState,f.lanes=g.lanes):(f.updateQueue=null,f.memoizedState=null)}var w=ay(o);if(w!==null){w.flags&=-257,ly(w,o,l,i,e),w.mode&1&&oy(i,u,e),e=w,c=u;var R=e.updateQueue;if(R===null){var N=new Set;N.add(c),e.updateQueue=N}else R.add(c);break e}else{if(!(e&1)){oy(i,u,e),_p();break e}c=Error(B(426))}}else if(Ce&&l.mode&1){var P=ay(o);if(P!==null){!(P.flags&65536)&&(P.flags|=256),ly(P,o,l,i,e),Zf(Ui(c,l));break e}}i=c=Ui(c,l),Je!==4&&(Je=2),sa===null?sa=[i]:sa.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var x=X1(i,c,e);ey(i,x);break e;case 1:l=c;var v=i.type,T=i.stateNode;if(!(i.flags&128)&&(typeof v.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(jr===null||!jr.has(T)))){i.flags|=65536,e&=-e,i.lanes|=e;var D=Z1(i,l,e);ey(i,D);break e}}i=i.return}while(i!==null)}v0(n)}catch(F){e=F,We===n&&n!==null&&(We=n=n.return);continue}break}while(1)}function g0(){var t=Bc.current;return Bc.current=Fc,t===null?Fc:t}function _p(){(Je===0||Je===3||Je===2)&&(Je=4),nt===null||!(js&268435455)&&!(Ru&268435455)||wr(nt,ut)}function Gc(t,e){var n=fe;fe|=2;var r=g0();(nt!==t||ut!==e)&&(Un=null,Rs(t,e));do try{KS();break}catch(s){m0(t,s)}while(1);if(tp(),fe=n,Bc.current=r,We!==null)throw Error(B(261));return nt=null,ut=0,Je}function KS(){for(;We!==null;)y0(We)}function QS(){for(;We!==null&&!wT();)y0(We)}function y0(t){var e=w0(t.alternate,t,Ut);t.memoizedProps=t.pendingProps,e===null?v0(t):We=e,pp.current=null}function v0(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=zS(n,e),n!==null){n.flags&=32767,We=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Je=6,We=null;return}}else if(n=BS(n,e,Ut),n!==null){We=n;return}if(e=e.sibling,e!==null){We=e;return}We=e=t}while(e!==null);Je===0&&(Je=5)}function vs(t,e,n){var r=ge,s=Zt.transition;try{Zt.transition=null,ge=1,YS(t,e,n,r)}finally{Zt.transition=s,ge=r}return null}function YS(t,e,n,r){do Ai();while(Ir!==null);if(fe&6)throw Error(B(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(B(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(PT(t,i),t===nt&&(We=nt=null,ut=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Fl||(Fl=!0,E0(Ic,function(){return Ai(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Zt.transition,Zt.transition=null;var o=ge;ge=1;var l=fe;fe|=4,pp.current=null,GS(t,n),h0(n,t),gS(Sh),Cc=!!Th,Sh=Th=null,t.current=n,HS(n),ET(),fe=l,ge=o,Zt.transition=i}else t.current=n;if(Fl&&(Fl=!1,Ir=t,$c=s),i=t.pendingLanes,i===0&&(jr=null),ST(n.stateNode),Lt(t,Ue()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(zc)throw zc=!1,t=Gh,Gh=null,t;return $c&1&&t.tag!==0&&Ai(),i=t.pendingLanes,i&1?t===Hh?ia++:(ia=0,Hh=t):ia=0,es(),null}function Ai(){if(Ir!==null){var t=X_($c),e=Zt.transition,n=ge;try{if(Zt.transition=null,ge=16>t?16:t,Ir===null)var r=!1;else{if(t=Ir,Ir=null,$c=0,fe&6)throw Error(B(331));var s=fe;for(fe|=4,Q=t.current;Q!==null;){var i=Q,o=i.child;if(Q.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(Q=u;Q!==null;){var f=Q;switch(f.tag){case 0:case 11:case 15:ra(8,f,i)}var p=f.child;if(p!==null)p.return=f,Q=p;else for(;Q!==null;){f=Q;var g=f.sibling,w=f.return;if(c0(f),f===u){Q=null;break}if(g!==null){g.return=w,Q=g;break}Q=w}}}var R=i.alternate;if(R!==null){var N=R.child;if(N!==null){R.child=null;do{var P=N.sibling;N.sibling=null,N=P}while(N!==null)}}Q=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Q=o;else e:for(;Q!==null;){if(i=Q,i.flags&2048)switch(i.tag){case 0:case 11:case 15:ra(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,Q=x;break e}Q=i.return}}var v=t.current;for(Q=v;Q!==null;){o=Q;var T=o.child;if(o.subtreeFlags&2064&&T!==null)T.return=o,Q=T;else e:for(o=v;Q!==null;){if(l=Q,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Iu(9,l)}}catch(F){je(l,l.return,F)}if(l===o){Q=null;break e}var D=l.sibling;if(D!==null){D.return=l.return,Q=D;break e}Q=l.return}}if(fe=s,es(),In&&typeof In.onPostCommitFiberRoot=="function")try{In.onPostCommitFiberRoot(yu,t)}catch{}r=!0}return r}finally{ge=n,Zt.transition=e}}return!1}function Ey(t,e,n){e=Ui(n,e),e=X1(t,e,1),t=Dr(t,e,1),e=Rt(),t!==null&&(Ha(t,1,e),Lt(t,e))}function je(t,e,n){if(t.tag===3)Ey(t,t,n);else for(;e!==null;){if(e.tag===3){Ey(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(jr===null||!jr.has(r))){t=Ui(n,t),t=Z1(e,t,1),e=Dr(e,t,1),t=Rt(),e!==null&&(Ha(e,1,t),Lt(e,t));break}}e=e.return}}function JS(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Rt(),t.pingedLanes|=t.suspendedLanes&n,nt===t&&(ut&n)===n&&(Je===4||Je===3&&(ut&130023424)===ut&&500>Ue()-gp?Rs(t,0):mp|=n),Lt(t,e)}function _0(t,e){e===0&&(t.mode&1?(e=Pl,Pl<<=1,!(Pl&130023424)&&(Pl=4194304)):e=1);var n=Rt();t=Yn(t,e),t!==null&&(Ha(t,e,n),Lt(t,n))}function XS(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),_0(t,n)}function ZS(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(B(314))}r!==null&&r.delete(e),_0(t,n)}var w0;w0=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ot.current)jt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return jt=!1,FS(t,e,n);jt=!!(t.flags&131072)}else jt=!1,Ce&&e.flags&1048576&&S1(e,jc,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;ic(t,e),t=e.pendingProps;var s=Oi(e,Et.current);Ni(e,n),s=cp(null,e,r,t,s,n);var i=up();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Vt(r)?(i=!0,bc(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,sp(e),s.updater=Su,e.stateNode=s,s._reactInternals=e,Dh(e,r,t,n),e=Vh(null,e,r,!0,i,n)):(e.tag=0,Ce&&i&&Jf(e),St(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(ic(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=tI(r),t=ln(r,t),s){case 0:e=Oh(null,e,r,t,n);break e;case 1:e=dy(null,e,r,t,n);break e;case 11:e=cy(null,e,r,t,n);break e;case 14:e=uy(null,e,r,ln(r.type,t),n);break e}throw Error(B(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:ln(r,s),Oh(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:ln(r,s),dy(t,e,r,s,n);case 3:e:{if(r0(e),t===null)throw Error(B(387));r=e.pendingProps,i=e.memoizedState,s=i.element,P1(t,e),Lc(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Ui(Error(B(423)),e),e=hy(t,e,r,n,s);break e}else if(r!==s){s=Ui(Error(B(424)),e),e=hy(t,e,r,n,s);break e}else for(zt=br(e.stateNode.containerInfo.firstChild),Gt=e,Ce=!0,un=null,n=N1(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Vi(),r===s){e=Jn(t,e,n);break e}St(t,e,r,n)}e=e.child}return e;case 5:return k1(e),t===null&&Ph(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,Ih(r,s)?o=null:i!==null&&Ih(r,i)&&(e.flags|=32),n0(t,e),St(t,e,o,n),e.child;case 6:return t===null&&Ph(e),null;case 13:return s0(t,e,n);case 4:return ip(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Li(e,null,r,n):St(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:ln(r,s),cy(t,e,r,s,n);case 7:return St(t,e,e.pendingProps,n),e.child;case 8:return St(t,e,e.pendingProps.children,n),e.child;case 12:return St(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,_e(Oc,r._currentValue),r._currentValue=o,i!==null)if(yn(i.value,o)){if(i.children===s.children&&!Ot.current){e=Jn(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=Wn(-1,n&-n),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?c.next=c:(c.next=f.next,f.next=c),u.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),kh(i.return,n,e),l.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(B(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),kh(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}St(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Ni(e,n),s=en(s),r=r(s),e.flags|=1,St(t,e,r,n),e.child;case 14:return r=e.type,s=ln(r,e.pendingProps),s=ln(r.type,s),uy(t,e,r,s,n);case 15:return e0(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:ln(r,s),ic(t,e),e.tag=1,Vt(r)?(t=!0,bc(e)):t=!1,Ni(e,n),J1(e,r,s),Dh(e,r,s,n),Vh(null,e,r,!0,t,n);case 19:return i0(t,e,n);case 22:return t0(t,e,n)}throw Error(B(156,e.tag))};function E0(t,e){return K_(t,e)}function eI(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Xt(t,e,n,r){return new eI(t,e,n,r)}function wp(t){return t=t.prototype,!(!t||!t.isReactComponent)}function tI(t){if(typeof t=="function")return wp(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Uf)return 11;if(t===Ff)return 14}return 2}function Vr(t,e){var n=t.alternate;return n===null?(n=Xt(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function lc(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")wp(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case fi:return Cs(n.children,s,i,e);case Mf:o=8,s|=8;break;case rh:return t=Xt(12,n,e,s|2),t.elementType=rh,t.lanes=i,t;case sh:return t=Xt(13,n,e,s),t.elementType=sh,t.lanes=i,t;case ih:return t=Xt(19,n,e,s),t.elementType=ih,t.lanes=i,t;case k_:return Cu(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case A_:o=10;break e;case P_:o=9;break e;case Uf:o=11;break e;case Ff:o=14;break e;case yr:o=16,r=null;break e}throw Error(B(130,t==null?t:typeof t,""))}return e=Xt(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Cs(t,e,n,r){return t=Xt(7,t,r,e),t.lanes=n,t}function Cu(t,e,n,r){return t=Xt(22,t,r,e),t.elementType=k_,t.lanes=n,t.stateNode={isHidden:!1},t}function Vd(t,e,n){return t=Xt(6,t,null,e),t.lanes=n,t}function Ld(t,e,n){return e=Xt(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function nI(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=yd(0),this.expirationTimes=yd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yd(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Ep(t,e,n,r,s,i,o,l,c){return t=new nI(t,e,n,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Xt(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},sp(i),t}function rI(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:hi,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function x0(t){if(!t)return Gr;t=t._reactInternals;e:{if(Bs(t)!==t||t.tag!==1)throw Error(B(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Vt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(B(171))}if(t.tag===1){var n=t.type;if(Vt(n))return x1(t,n,e)}return e}function T0(t,e,n,r,s,i,o,l,c){return t=Ep(n,r,!0,t,s,i,o,l,c),t.context=x0(null),n=t.current,r=Rt(),s=Or(n),i=Wn(r,s),i.callback=e??null,Dr(n,i,s),t.current.lanes=s,Ha(t,s,r),Lt(t,r),t}function Nu(t,e,n,r){var s=e.current,i=Rt(),o=Or(s);return n=x0(n),e.context===null?e.context=n:e.pendingContext=n,e=Wn(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Dr(s,e,o),t!==null&&(pn(t,s,o,i),nc(t,s,o)),o}function Hc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function xy(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function xp(t,e){xy(t,e),(t=t.alternate)&&xy(t,e)}function sI(){return null}var S0=typeof reportError=="function"?reportError:function(t){console.error(t)};function Tp(t){this._internalRoot=t}Au.prototype.render=Tp.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(B(409));Nu(t,e,null,null)};Au.prototype.unmount=Tp.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Os(function(){Nu(null,t,null,null)}),e[Qn]=null}};function Au(t){this._internalRoot=t}Au.prototype.unstable_scheduleHydration=function(t){if(t){var e=t1();t={blockedOn:null,target:t,priority:e};for(var n=0;n<_r.length&&e!==0&&e<_r[n].priority;n++);_r.splice(n,0,t),n===0&&r1(t)}};function Sp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Pu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Ty(){}function iI(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var u=Hc(o);i.call(u)}}var o=T0(e,r,t,0,null,!1,!1,"",Ty);return t._reactRootContainer=o,t[Qn]=o.current,Ea(t.nodeType===8?t.parentNode:t),Os(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var u=Hc(c);l.call(u)}}var c=Ep(t,0,!1,null,null,!1,!1,"",Ty);return t._reactRootContainer=c,t[Qn]=c.current,Ea(t.nodeType===8?t.parentNode:t),Os(function(){Nu(e,c,n,r)}),c}function ku(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=Hc(o);l.call(c)}}Nu(e,o,t,s)}else o=iI(n,e,t,s,r);return Hc(o)}Z_=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ho(e.pendingLanes);n!==0&&($f(e,n|1),Lt(e,Ue()),!(fe&6)&&(Fi=Ue()+500,es()))}break;case 13:Os(function(){var r=Yn(t,1);if(r!==null){var s=Rt();pn(r,t,1,s)}}),xp(t,1)}};Gf=function(t){if(t.tag===13){var e=Yn(t,134217728);if(e!==null){var n=Rt();pn(e,t,134217728,n)}xp(t,134217728)}};e1=function(t){if(t.tag===13){var e=Or(t),n=Yn(t,e);if(n!==null){var r=Rt();pn(n,t,e,r)}xp(t,e)}};t1=function(){return ge};n1=function(t,e){var n=ge;try{return ge=t,e()}finally{ge=n}};mh=function(t,e,n){switch(e){case"input":if(lh(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Eu(r);if(!s)throw Error(B(90));D_(r),lh(r,s)}}}break;case"textarea":O_(t,n);break;case"select":e=n.value,e!=null&&Si(t,!!n.multiple,e,!1)}};z_=yp;$_=Os;var oI={usingClientEntryPoint:!1,Events:[qa,yi,Eu,F_,B_,yp]},Bo={findFiberByHostInstance:Es,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},aI={bundleType:Bo.bundleType,version:Bo.version,rendererPackageName:Bo.rendererPackageName,rendererConfig:Bo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:nr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=W_(t),t===null?null:t.stateNode},findFiberByHostInstance:Bo.findFiberByHostInstance||sI,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Bl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Bl.isDisabled&&Bl.supportsFiber)try{yu=Bl.inject(aI),In=Bl}catch{}}Wt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=oI;Wt.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Sp(e))throw Error(B(200));return rI(t,e,null,n)};Wt.createRoot=function(t,e){if(!Sp(t))throw Error(B(299));var n=!1,r="",s=S0;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Ep(t,1,!1,null,null,n,!1,r,s),t[Qn]=e.current,Ea(t.nodeType===8?t.parentNode:t),new Tp(e)};Wt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(B(188)):(t=Object.keys(t).join(","),Error(B(268,t)));return t=W_(e),t=t===null?null:t.stateNode,t};Wt.flushSync=function(t){return Os(t)};Wt.hydrate=function(t,e,n){if(!Pu(e))throw Error(B(200));return ku(null,t,e,!0,n)};Wt.hydrateRoot=function(t,e,n){if(!Sp(t))throw Error(B(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=S0;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=T0(e,null,t,1,n??null,s,!1,i,o),t[Qn]=e.current,Ea(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Au(e)};Wt.render=function(t,e,n){if(!Pu(e))throw Error(B(200));return ku(null,t,e,!1,n)};Wt.unmountComponentAtNode=function(t){if(!Pu(t))throw Error(B(40));return t._reactRootContainer?(Os(function(){ku(null,null,t,!1,function(){t._reactRootContainer=null,t[Qn]=null})}),!0):!1};Wt.unstable_batchedUpdates=yp;Wt.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Pu(n))throw Error(B(200));if(t==null||t._reactInternals===void 0)throw Error(B(38));return ku(t,e,n,!1,r)};Wt.version="18.3.1-next-f1338f8080-20240426";function I0(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(I0)}catch(t){console.error(t)}}I0(),I_.exports=Wt;var lI=I_.exports,Sy=lI;th.createRoot=Sy.createRoot,th.hydrateRoot=Sy.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Pa(){return Pa=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Pa.apply(this,arguments)}var Rr;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Rr||(Rr={}));const Iy="popstate";function cI(t){t===void 0&&(t={});function e(r,s){let{pathname:i,search:o,hash:l}=r.location;return Kh("",{pathname:i,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:Wc(s)}return dI(e,n,null,t)}function Fe(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function R0(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function uI(){return Math.random().toString(36).substr(2,8)}function Ry(t,e){return{usr:t.state,key:t.key,idx:e}}function Kh(t,e,n,r){return n===void 0&&(n=null),Pa({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Zi(e):e,{state:n,key:e&&e.key||r||uI()})}function Wc(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Zi(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function dI(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,l=Rr.Pop,c=null,u=f();u==null&&(u=0,o.replaceState(Pa({},o.state,{idx:u}),""));function f(){return(o.state||{idx:null}).idx}function p(){l=Rr.Pop;let P=f(),x=P==null?null:P-u;u=P,c&&c({action:l,location:N.location,delta:x})}function g(P,x){l=Rr.Push;let v=Kh(N.location,P,x);n&&n(v,P),u=f()+1;let T=Ry(v,u),D=N.createHref(v);try{o.pushState(T,"",D)}catch(F){if(F instanceof DOMException&&F.name==="DataCloneError")throw F;s.location.assign(D)}i&&c&&c({action:l,location:N.location,delta:1})}function w(P,x){l=Rr.Replace;let v=Kh(N.location,P,x);n&&n(v,P),u=f();let T=Ry(v,u),D=N.createHref(v);o.replaceState(T,"",D),i&&c&&c({action:l,location:N.location,delta:0})}function R(P){let x=s.location.origin!=="null"?s.location.origin:s.location.href,v=typeof P=="string"?P:Wc(P);return v=v.replace(/ $/,"%20"),Fe(x,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,x)}let N={get action(){return l},get location(){return t(s,o)},listen(P){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(Iy,p),c=P,()=>{s.removeEventListener(Iy,p),c=null}},createHref(P){return e(s,P)},createURL:R,encodeLocation(P){let x=R(P);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:g,replace:w,go(P){return o.go(P)}};return N}var Cy;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Cy||(Cy={}));function hI(t,e,n){return n===void 0&&(n="/"),fI(t,e,n,!1)}function fI(t,e,n,r){let s=typeof e=="string"?Zi(e):e,i=Ip(s.pathname||"/",n);if(i==null)return null;let o=C0(t);pI(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=II(i);l=TI(o[c],u,r)}return l}function C0(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};c.relativePath.startsWith("/")&&(Fe(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let u=Lr([r,c.relativePath]),f=n.concat(c);i.children&&i.children.length>0&&(Fe(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),C0(i.children,e,f,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:EI(u,i.index),routesMeta:f})};return t.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))s(i,o);else for(let c of N0(i.path))s(i,o,c)}),e}function N0(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=N0(r.join("/")),l=[];return l.push(...o.map(c=>c===""?i:[i,c].join("/"))),s&&l.push(...o),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function pI(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:xI(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const mI=/^:[\w-]+$/,gI=3,yI=2,vI=1,_I=10,wI=-2,Ny=t=>t==="*";function EI(t,e){let n=t.split("/"),r=n.length;return n.some(Ny)&&(r+=wI),e&&(r+=yI),n.filter(s=>!Ny(s)).reduce((s,i)=>s+(mI.test(i)?gI:i===""?vI:_I),r)}function xI(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function TI(t,e,n){n===void 0&&(n=!1);let{routesMeta:r}=t,s={},i="/",o=[];for(let l=0;l<r.length;++l){let c=r[l],u=l===r.length-1,f=i==="/"?e:e.slice(i.length)||"/",p=Ay({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},f),g=c.route;if(!p&&u&&n&&!r[r.length-1].route.index&&(p=Ay({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},f)),!p)return null;Object.assign(s,p.params),o.push({params:s,pathname:Lr([i,p.pathname]),pathnameBase:AI(Lr([i,p.pathnameBase])),route:g}),p.pathnameBase!=="/"&&(i=Lr([i,p.pathnameBase]))}return o}function Ay(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=SI(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((u,f,p)=>{let{paramName:g,isOptional:w}=f;if(g==="*"){let N=l[p]||"";o=i.slice(0,i.length-N.length).replace(/(.)\/+$/,"$1")}const R=l[p];return w&&!R?u[g]=void 0:u[g]=(R||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:o,pattern:t}}function SI(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),R0(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(r.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function II(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return R0(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Ip(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function RI(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?Zi(t):t;return{pathname:n?n.startsWith("/")?n:CI(n,e):e,search:PI(r),hash:kI(s)}}function CI(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function Md(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function NI(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Rp(t,e){let n=NI(t);return e?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function Cp(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=Zi(t):(s=Pa({},t),Fe(!s.pathname||!s.pathname.includes("?"),Md("?","pathname","search",s)),Fe(!s.pathname||!s.pathname.includes("#"),Md("#","pathname","hash",s)),Fe(!s.search||!s.search.includes("#"),Md("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,l;if(o==null)l=n;else{let p=e.length-1;if(!r&&o.startsWith("..")){let g=o.split("/");for(;g[0]==="..";)g.shift(),p-=1;s.pathname=g.join("/")}l=p>=0?e[p]:"/"}let c=RI(s,l),u=o&&o!=="/"&&o.endsWith("/"),f=(i||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||f)&&(c.pathname+="/"),c}const Lr=t=>t.join("/").replace(/\/\/+/g,"/"),AI=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),PI=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,kI=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function bI(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const A0=["post","put","patch","delete"];new Set(A0);const DI=["get",...A0];new Set(DI);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ka(){return ka=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ka.apply(this,arguments)}const Np=M.createContext(null),jI=M.createContext(null),ts=M.createContext(null),bu=M.createContext(null),rr=M.createContext({outlet:null,matches:[],isDataRoute:!1}),P0=M.createContext(null);function OI(t,e){let{relative:n}=e===void 0?{}:e;eo()||Fe(!1);let{basename:r,navigator:s}=M.useContext(ts),{hash:i,pathname:o,search:l}=b0(t,{relative:n}),c=o;return r!=="/"&&(c=o==="/"?r:Lr([r,o])),s.createHref({pathname:c,search:l,hash:i})}function eo(){return M.useContext(bu)!=null}function Qa(){return eo()||Fe(!1),M.useContext(bu).location}function k0(t){M.useContext(ts).static||M.useLayoutEffect(t)}function to(){let{isDataRoute:t}=M.useContext(rr);return t?KI():VI()}function VI(){eo()||Fe(!1);let t=M.useContext(Np),{basename:e,future:n,navigator:r}=M.useContext(ts),{matches:s}=M.useContext(rr),{pathname:i}=Qa(),o=JSON.stringify(Rp(s,n.v7_relativeSplatPath)),l=M.useRef(!1);return k0(()=>{l.current=!0}),M.useCallback(function(u,f){if(f===void 0&&(f={}),!l.current)return;if(typeof u=="number"){r.go(u);return}let p=Cp(u,JSON.parse(o),i,f.relative==="path");t==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:Lr([e,p.pathname])),(f.replace?r.replace:r.push)(p,f.state,f)},[e,r,o,i,t])}function Ya(){let{matches:t}=M.useContext(rr),e=t[t.length-1];return e?e.params:{}}function b0(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=M.useContext(ts),{matches:s}=M.useContext(rr),{pathname:i}=Qa(),o=JSON.stringify(Rp(s,r.v7_relativeSplatPath));return M.useMemo(()=>Cp(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function LI(t,e){return MI(t,e)}function MI(t,e,n,r){eo()||Fe(!1);let{navigator:s}=M.useContext(ts),{matches:i}=M.useContext(rr),o=i[i.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let u=Qa(),f;if(e){var p;let P=typeof e=="string"?Zi(e):e;c==="/"||(p=P.pathname)!=null&&p.startsWith(c)||Fe(!1),f=P}else f=u;let g=f.pathname||"/",w=g;if(c!=="/"){let P=c.replace(/^\//,"").split("/");w="/"+g.replace(/^\//,"").split("/").slice(P.length).join("/")}let R=hI(t,{pathname:w}),N=$I(R&&R.map(P=>Object.assign({},P,{params:Object.assign({},l,P.params),pathname:Lr([c,s.encodeLocation?s.encodeLocation(P.pathname).pathname:P.pathname]),pathnameBase:P.pathnameBase==="/"?c:Lr([c,s.encodeLocation?s.encodeLocation(P.pathnameBase).pathname:P.pathnameBase])})),i,n,r);return e&&N?M.createElement(bu.Provider,{value:{location:ka({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:Rr.Pop}},N):N}function UI(){let t=qI(),e=bI(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},i=null;return M.createElement(M.Fragment,null,M.createElement("h2",null,"Unexpected Application Error!"),M.createElement("h3",{style:{fontStyle:"italic"}},e),n?M.createElement("pre",{style:s},n):null,i)}const FI=M.createElement(UI,null);class BI extends M.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?M.createElement(rr.Provider,{value:this.props.routeContext},M.createElement(P0.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function zI(t){let{routeContext:e,match:n,children:r}=t,s=M.useContext(Np);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),M.createElement(rr.Provider,{value:e},r)}function $I(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,l=(s=n)==null?void 0:s.errors;if(l!=null){let f=o.findIndex(p=>p.route.id&&(l==null?void 0:l[p.route.id])!==void 0);f>=0||Fe(!1),o=o.slice(0,Math.min(o.length,f+1))}let c=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let f=0;f<o.length;f++){let p=o[f];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(u=f),p.route.id){let{loaderData:g,errors:w}=n,R=p.route.loader&&g[p.route.id]===void 0&&(!w||w[p.route.id]===void 0);if(p.route.lazy||R){c=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((f,p,g)=>{let w,R=!1,N=null,P=null;n&&(w=l&&p.route.id?l[p.route.id]:void 0,N=p.route.errorElement||FI,c&&(u<0&&g===0?(QI("route-fallback",!1),R=!0,P=null):u===g&&(R=!0,P=p.route.hydrateFallbackElement||null)));let x=e.concat(o.slice(0,g+1)),v=()=>{let T;return w?T=N:R?T=P:p.route.Component?T=M.createElement(p.route.Component,null):p.route.element?T=p.route.element:T=f,M.createElement(zI,{match:p,routeContext:{outlet:f,matches:x,isDataRoute:n!=null},children:T})};return n&&(p.route.ErrorBoundary||p.route.errorElement||g===0)?M.createElement(BI,{location:n.location,revalidation:n.revalidation,component:N,error:w,children:v(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):v()},null)}var D0=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(D0||{}),qc=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(qc||{});function GI(t){let e=M.useContext(Np);return e||Fe(!1),e}function HI(t){let e=M.useContext(jI);return e||Fe(!1),e}function WI(t){let e=M.useContext(rr);return e||Fe(!1),e}function j0(t){let e=WI(),n=e.matches[e.matches.length-1];return n.route.id||Fe(!1),n.route.id}function qI(){var t;let e=M.useContext(P0),n=HI(qc.UseRouteError),r=j0(qc.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function KI(){let{router:t}=GI(D0.UseNavigateStable),e=j0(qc.UseNavigateStable),n=M.useRef(!1);return k0(()=>{n.current=!0}),M.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,ka({fromRouteId:e},i)))},[t,e])}const Py={};function QI(t,e,n){!e&&!Py[t]&&(Py[t]=!0)}function YI(t,e){t==null||t.v7_startTransition,(t==null?void 0:t.v7_relativeSplatPath)===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function JI(t){let{to:e,replace:n,state:r,relative:s}=t;eo()||Fe(!1);let{future:i,static:o}=M.useContext(ts),{matches:l}=M.useContext(rr),{pathname:c}=Qa(),u=to(),f=Cp(e,Rp(l,i.v7_relativeSplatPath),c,s==="path"),p=JSON.stringify(f);return M.useEffect(()=>u(JSON.parse(p),{replace:n,state:r,relative:s}),[u,p,s,n,r]),null}function Mn(t){Fe(!1)}function XI(t){let{basename:e="/",children:n=null,location:r,navigationType:s=Rr.Pop,navigator:i,static:o=!1,future:l}=t;eo()&&Fe(!1);let c=e.replace(/^\/*/,"/"),u=M.useMemo(()=>({basename:c,navigator:i,static:o,future:ka({v7_relativeSplatPath:!1},l)}),[c,l,i,o]);typeof r=="string"&&(r=Zi(r));let{pathname:f="/",search:p="",hash:g="",state:w=null,key:R="default"}=r,N=M.useMemo(()=>{let P=Ip(f,c);return P==null?null:{location:{pathname:P,search:p,hash:g,state:w,key:R},navigationType:s}},[c,f,p,g,w,R,s]);return N==null?null:M.createElement(ts.Provider,{value:u},M.createElement(bu.Provider,{children:n,value:N}))}function ZI(t){let{children:e,location:n}=t;return LI(Qh(e),n)}new Promise(()=>{});function Qh(t,e){e===void 0&&(e=[]);let n=[];return M.Children.forEach(t,(r,s)=>{if(!M.isValidElement(r))return;let i=[...e,s];if(r.type===M.Fragment){n.push.apply(n,Qh(r.props.children,i));return}r.type!==Mn&&Fe(!1),!r.props.index||!r.props.children||Fe(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Qh(r.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Yh(){return Yh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Yh.apply(this,arguments)}function eR(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function tR(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function nR(t,e){return t.button===0&&(!e||e==="_self")&&!tR(t)}const rR=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],sR="6";try{window.__reactRouterVersion=sR}catch{}const iR="startTransition",ky=Jx[iR];function oR(t){let{basename:e,children:n,future:r,window:s}=t,i=M.useRef();i.current==null&&(i.current=cI({window:s,v5Compat:!0}));let o=i.current,[l,c]=M.useState({action:o.action,location:o.location}),{v7_startTransition:u}=r||{},f=M.useCallback(p=>{u&&ky?ky(()=>c(p)):c(p)},[c,u]);return M.useLayoutEffect(()=>o.listen(f),[o,f]),M.useEffect(()=>YI(r),[r]),M.createElement(XI,{basename:e,children:n,location:l.location,navigationType:l.action,navigator:o,future:r})}const aR=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",lR=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,It=M.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:i,replace:o,state:l,target:c,to:u,preventScrollReset:f,viewTransition:p}=e,g=eR(e,rR),{basename:w}=M.useContext(ts),R,N=!1;if(typeof u=="string"&&lR.test(u)&&(R=u,aR))try{let T=new URL(window.location.href),D=u.startsWith("//")?new URL(T.protocol+u):new URL(u),F=Ip(D.pathname,w);D.origin===T.origin&&F!=null?u=F+D.search+D.hash:N=!0}catch{}let P=OI(u,{relative:s}),x=cR(u,{replace:o,state:l,target:c,preventScrollReset:f,relative:s,viewTransition:p});function v(T){r&&r(T),T.defaultPrevented||x(T)}return M.createElement("a",Yh({},g,{href:R||P,onClick:N||i?r:v,ref:n,target:c}))});var by;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(by||(by={}));var Dy;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Dy||(Dy={}));function cR(t,e){let{target:n,replace:r,state:s,preventScrollReset:i,relative:o,viewTransition:l}=e===void 0?{}:e,c=to(),u=Qa(),f=b0(t,{relative:o});return M.useCallback(p=>{if(nR(p,n)){p.preventDefault();let g=r!==void 0?r:Wc(u)===Wc(f);c(t,{replace:g,state:s,preventScrollReset:i,relative:o,viewTransition:l})}},[u,c,f,r,s,n,t,i,o,l])}const jy=t=>{let e;const n=new Set,r=(f,p)=>{const g=typeof f=="function"?f(e):f;if(!Object.is(g,e)){const w=e;e=p??(typeof g!="object"||g===null)?g:Object.assign({},e,g),n.forEach(R=>R(e,w))}},s=()=>e,c={setState:r,getState:s,getInitialState:()=>u,subscribe:f=>(n.add(f),()=>n.delete(f)),destroy:()=>{n.clear()}},u=e=t(r,s,c);return c},uR=t=>t?jy(t):jy;var O0={exports:{}},V0={},L0={exports:{}},M0={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bi=M;function dR(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var hR=typeof Object.is=="function"?Object.is:dR,fR=Bi.useState,pR=Bi.useEffect,mR=Bi.useLayoutEffect,gR=Bi.useDebugValue;function yR(t,e){var n=e(),r=fR({inst:{value:n,getSnapshot:e}}),s=r[0].inst,i=r[1];return mR(function(){s.value=n,s.getSnapshot=e,Ud(s)&&i({inst:s})},[t,n,e]),pR(function(){return Ud(s)&&i({inst:s}),t(function(){Ud(s)&&i({inst:s})})},[t]),gR(n),n}function Ud(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!hR(t,n)}catch{return!0}}function vR(t,e){return e()}var _R=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?vR:yR;M0.useSyncExternalStore=Bi.useSyncExternalStore!==void 0?Bi.useSyncExternalStore:_R;L0.exports=M0;var wR=L0.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Du=M,ER=wR;function xR(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var TR=typeof Object.is=="function"?Object.is:xR,SR=ER.useSyncExternalStore,IR=Du.useRef,RR=Du.useEffect,CR=Du.useMemo,NR=Du.useDebugValue;V0.useSyncExternalStoreWithSelector=function(t,e,n,r,s){var i=IR(null);if(i.current===null){var o={hasValue:!1,value:null};i.current=o}else o=i.current;i=CR(function(){function c(w){if(!u){if(u=!0,f=w,w=r(w),s!==void 0&&o.hasValue){var R=o.value;if(s(R,w))return p=R}return p=w}if(R=p,TR(f,w))return R;var N=r(w);return s!==void 0&&s(R,N)?(f=w,R):(f=w,p=N)}var u=!1,f,p,g=n===void 0?null:n;return[function(){return c(e())},g===null?void 0:function(){return c(g())}]},[e,n,r,s]);var l=SR(t,i[0],i[1]);return RR(function(){o.hasValue=!0,o.value=l},[l]),NR(l),l};O0.exports=V0;var AR=O0.exports;const PR=f_(AR),{useDebugValue:kR}=Sn,{useSyncExternalStoreWithSelector:bR}=PR;const DR=t=>t;function jR(t,e=DR,n){const r=bR(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,n);return kR(r),r}const Oy=t=>{const e=typeof t=="function"?uR(t):t,n=(r,s)=>jR(e,r,s);return Object.assign(n,e),n},U0=t=>t?Oy(t):Oy;function OR(t,e){let n;try{n=t()}catch{return}return{getItem:s=>{var i;const o=c=>c===null?null:JSON.parse(c,e==null?void 0:e.reviver),l=(i=n.getItem(s))!=null?i:null;return l instanceof Promise?l.then(o):o(l)},setItem:(s,i)=>n.setItem(s,JSON.stringify(i,e==null?void 0:e.replacer)),removeItem:s=>n.removeItem(s)}}const ba=t=>e=>{try{const n=t(e);return n instanceof Promise?n:{then(r){return ba(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return ba(r)(n)}}}},VR=(t,e)=>(n,r,s)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:P=>P,version:0,merge:(P,x)=>({...x,...P}),...e},o=!1;const l=new Set,c=new Set;let u;try{u=i.getStorage()}catch{}if(!u)return t((...P)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...P)},r,s);const f=ba(i.serialize),p=()=>{const P=i.partialize({...r()});let x;const v=f({state:P,version:i.version}).then(T=>u.setItem(i.name,T)).catch(T=>{x=T});if(x)throw x;return v},g=s.setState;s.setState=(P,x)=>{g(P,x),p()};const w=t((...P)=>{n(...P),p()},r,s);let R;const N=()=>{var P;if(!u)return;o=!1,l.forEach(v=>v(r()));const x=((P=i.onRehydrateStorage)==null?void 0:P.call(i,r()))||void 0;return ba(u.getItem.bind(u))(i.name).then(v=>{if(v)return i.deserialize(v)}).then(v=>{if(v)if(typeof v.version=="number"&&v.version!==i.version){if(i.migrate)return i.migrate(v.state,v.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return v.state}).then(v=>{var T;return R=i.merge(v,(T=r())!=null?T:w),n(R,!0),p()}).then(()=>{x==null||x(R,void 0),o=!0,c.forEach(v=>v(R))}).catch(v=>{x==null||x(void 0,v)})};return s.persist={setOptions:P=>{i={...i,...P},P.getStorage&&(u=P.getStorage())},clearStorage:()=>{u==null||u.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>N(),hasHydrated:()=>o,onHydrate:P=>(l.add(P),()=>{l.delete(P)}),onFinishHydration:P=>(c.add(P),()=>{c.delete(P)})},N(),R||w},LR=(t,e)=>(n,r,s)=>{let i={storage:OR(()=>localStorage),partialize:N=>N,version:0,merge:(N,P)=>({...P,...N}),...e},o=!1;const l=new Set,c=new Set;let u=i.storage;if(!u)return t((...N)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...N)},r,s);const f=()=>{const N=i.partialize({...r()});return u.setItem(i.name,{state:N,version:i.version})},p=s.setState;s.setState=(N,P)=>{p(N,P),f()};const g=t((...N)=>{n(...N),f()},r,s);s.getInitialState=()=>g;let w;const R=()=>{var N,P;if(!u)return;o=!1,l.forEach(v=>{var T;return v((T=r())!=null?T:g)});const x=((P=i.onRehydrateStorage)==null?void 0:P.call(i,(N=r())!=null?N:g))||void 0;return ba(u.getItem.bind(u))(i.name).then(v=>{if(v)if(typeof v.version=="number"&&v.version!==i.version){if(i.migrate)return[!0,i.migrate(v.state,v.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,v.state];return[!1,void 0]}).then(v=>{var T;const[D,F]=v;if(w=i.merge(F,(T=r())!=null?T:g),n(w,!0),D)return f()}).then(()=>{x==null||x(w,void 0),w=r(),o=!0,c.forEach(v=>v(w))}).catch(v=>{x==null||x(void 0,v)})};return s.persist={setOptions:N=>{i={...i,...N},N.storage&&(u=N.storage)},clearStorage:()=>{u==null||u.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>R(),hasHydrated:()=>o,onHydrate:N=>(l.add(N),()=>{l.delete(N)}),onFinishHydration:N=>(c.add(N),()=>{c.delete(N)})},i.skipHydration||R(),w||g},MR=(t,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?VR(t,e):LR(t,e),F0=MR;var Cr=(t=>(t.SINGLE="single",t.DOUBLE="double",t.TRIPLE="triple",t.CHAIN="chain",t.SLIP="slip",t.INCREASE="increase",t.DECREASE="decrease",t.MAGIC_RING="magic_ring",t.FRONT_POST="front_post",t.BACK_POST="back_post",t))(Cr||{});const He={single:{rawValue:"短針",symbol:"×",englishName:"Single Crochet"},double:{rawValue:"長針",symbol:"↑",englishName:"Double Crochet"},triple:{rawValue:"長長針",symbol:"↟",englishName:"Triple Crochet"},chain:{rawValue:"鎖針",symbol:"○",englishName:"Chain"},slip:{rawValue:"引拔針",symbol:"•",englishName:"Slip Stitch"},increase:{rawValue:"加針",symbol:"▲",englishName:"Increase"},decrease:{rawValue:"減針",symbol:"▼",englishName:"Decrease"},magic_ring:{rawValue:"魔術環",symbol:"◉",englishName:"Magic Ring"},front_post:{rawValue:"前柱針",symbol:"⟨",englishName:"Front Post"},back_post:{rawValue:"後柱針",symbol:"⟩",englishName:"Back Post"}};var nn=(t=>(t.STITCH="stitch",t.GROUP="group",t))(nn||{});function Oe(){return crypto.randomUUID()}function UR(t){const e=Math.floor(t/3600),n=Math.floor(t%3600/60);return e>0?`${e}小時${n}分`:n>0?`${n}分鐘`:`${t}秒`}function Jh(t){let e;return t instanceof Date?e=t:e=new Date(t),isNaN(e.getTime())?"無效日期":new Intl.DateTimeFormat("zh-TW",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(e)}function FR(){return[{id:Oe(),name:"白色棉線",brand:"樣本品牌",color:{name:"白色",hex:"#FFFFFF"}},{id:Oe(),name:"粉色棉線",brand:"樣本品牌",color:{name:"粉色",hex:"#FFB3E6"}},{id:Oe(),name:"藍色棉線",brand:"樣本品牌",color:{name:"藍色",hex:"#87CEEB"}}]}function Fd(){const t=FR(),e={id:Oe(),roundNumber:1,stitches:[{id:Oe(),type:Cr.CHAIN,yarnId:t[0].id,count:4},{id:Oe(),type:Cr.SLIP,yarnId:t[0].id,count:1}],stitchGroups:[],notes:"起始魔術環"},n={id:Oe(),roundNumber:2,stitches:[{id:Oe(),type:Cr.SINGLE,yarnId:t[0].id,count:8}],stitchGroups:[],notes:"短針增加"},r={id:Oe(),roundNumber:3,stitches:[{id:Oe(),type:Cr.SINGLE,yarnId:t[1].id,count:16}],stitchGroups:[],notes:"換色，繼續增加"};return{id:Oe(),name:"範例杯墊",source:"https://www.youtube.com/watch?v=example",pattern:[e,n,r],currentRound:1,currentStitch:0,yarns:t,sessions:[],createdDate:new Date,lastModified:new Date,isCompleted:!1}}function BR(t,e){const n=[],r=t.stitches.map(i=>{var f;const o=e.find(p=>p.id===i.yarnId),l=(o==null?void 0:o.name)||"未知毛線",c=i.count>1?` ×${i.count}`:"";return`${((f=He[i.type])==null?void 0:f.rawValue)||i.type}(${l})${c}`});n.push(...r);const s=t.stitchGroups.map(i=>zR(i,e));return n.push(...s),n.join(", ")||"無針法"}function zR(t,e){const n=t.stitches.map(i=>{var f;const o=e.find(p=>p.id===i.yarnId),l=(o==null?void 0:o.name)||"未知毛線",c=i.count>1?` ×${i.count}`:"";return`${((f=He[i.type])==null?void 0:f.rawValue)||i.type}(${l})${c}`}),r=t.name||"針目群組",s=t.repeatCount>1?` 重複${t.repeatCount}次`:"";return`[${r}: ${n.join(", ")}]${s}`}function Xh(t){return t.stitches.reduce((e,n)=>e+n.count,0)*t.repeatCount}function Bt(t){const e=t.stitches.reduce((r,s)=>r+s.count,0),n=t.stitchGroups.reduce((r,s)=>r+Xh(s),0);return e+n}function Kc(t){return t.pattern.map(e=>e.roundNumber).reduce((e,n)=>Math.max(e,n),0)}function Da(t){return t.pattern.reduce((e,n)=>e+Bt(n),0)}function Ap(t){if(!t.pattern||t.pattern.length===0)return 0;let e=0;for(let r=1;r<t.currentRound;r++){const s=t.pattern.find(i=>i.roundNumber===r);s&&(e+=Bt(s))}const n=t.pattern.find(r=>r.roundNumber===t.currentRound);if(n){const r=Bt(n),s=Math.min(Math.max(0,t.currentStitch),r);e+=s}return e}function Zh(t){if(!t.pattern||t.pattern.length===0)return 0;const e=Da(t);if(e===0)return 0;const r=Ap(t)/e;return Math.min(Math.max(0,r),1)}function ns(t){if(t.patternItems)return t;const e=[];let n=0;return t.stitches.forEach(r=>{e.push({id:Oe(),type:nn.STITCH,order:n++,createdAt:new Date,data:r})}),t.stitchGroups.forEach(r=>{e.push({id:Oe(),type:nn.GROUP,order:n++,createdAt:new Date,data:r})}),{...t,patternItems:e.sort((r,s)=>r.order-s.order)}}function zs(t){if(!t.patternItems)return t;const e=[],n=[];return t.patternItems.sort((r,s)=>r.order-s.order||r.createdAt.getTime()-s.createdAt.getTime()).forEach(r=>{r.type===nn.STITCH?e.push(r.data):r.type===nn.GROUP&&n.push(r.data)}),{...t,stitches:e,stitchGroups:n}}function zl(t){var n;return((n=ns(t).patternItems)==null?void 0:n.sort((r,s)=>r.order-s.order||r.createdAt.getTime()-s.createdAt.getTime()))||[]}function $R(t,e){const n=ns(t),r=n.patternItems||[],s=r.length>0?Math.max(...r.map(l=>l.order)):-1,i={id:Oe(),type:nn.STITCH,order:s+1,createdAt:new Date,data:e},o={...n,patternItems:[...r,i]};return zs(o)}function GR(t,e){const n=ns(t),r=n.patternItems||[],s=r.length>0?Math.max(...r.map(l=>l.order)):-1,i={id:Oe(),type:nn.GROUP,order:s+1,createdAt:new Date,data:e},o={...n,patternItems:[...r,i]};return zs(o)}function HR(t,e,n){const r=ns(t),s=[...r.patternItems||[]];s.sort((l,c)=>l.order-c.order||l.createdAt.getTime()-c.createdAt.getTime());const[i]=s.splice(e,1);s.splice(n,0,i),s.forEach((l,c)=>{l.order=c});const o={...r,patternItems:s};return zs(o)}function WR(t,e,n){const r=ns(t),i=(r.patternItems||[]).map(l=>l.type===nn.STITCH&&l.data.id===e?{...l,data:n}:l),o={...r,patternItems:i};return zs(o)}function qR(t,e){const n=ns(t),s=(n.patternItems||[]).filter(o=>!(o.type===nn.STITCH&&o.data.id===e));s.forEach((o,l)=>{o.order=l});const i={...n,patternItems:s};return zs(i)}function KR(t,e,n){const r=ns(t),i=(r.patternItems||[]).map(l=>l.type===nn.GROUP&&l.data.id===e?{...l,data:n}:l),o={...r,patternItems:i};return zs(o)}function QR(t,e){const n=ns(t),s=(n.patternItems||[]).filter(o=>!(o.type===nn.GROUP&&o.data.id===e));s.forEach((o,l)=>{o.order=l});const i={...n,patternItems:s};return zs(i)}const YR=()=>{};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B0=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},JR=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},z0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,c=s+2<t.length,u=c?t[s+2]:0,f=i>>2,p=(i&3)<<4|l>>4;let g=(l&15)<<2|u>>6,w=u&63;c||(w=64,o||(g=64)),r.push(n[f],n[p],n[g],n[w])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(B0(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):JR(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const u=s<t.length?n[t.charAt(s)]:64;++s;const p=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||u==null||p==null)throw new XR;const g=i<<2|l>>4;if(r.push(g),u!==64){const w=l<<4&240|u>>2;if(r.push(w),p!==64){const R=u<<6&192|p;r.push(R)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class XR extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ZR=function(t){const e=B0(t);return z0.encodeByteArray(e,!0)},Qc=function(t){return ZR(t).replace(/\./g,"")},$0=function(t){try{return z0.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tC=()=>eC().__FIREBASE_DEFAULTS__,nC=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},rC=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&$0(t[1]);return e&&JSON.parse(e)},ju=()=>{try{return YR()||tC()||nC()||rC()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},G0=t=>{var e,n;return(n=(e=ju())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},sC=t=>{const e=G0(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},H0=()=>{var t;return(t=ju())==null?void 0:t.config},W0=t=>{var e;return(e=ju())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $s(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Pp(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oC(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t},l="";return[Qc(JSON.stringify(n)),Qc(JSON.stringify(o)),l].join(".")}const oa={};function aC(){const t={prod:[],emulator:[]};for(const e of Object.keys(oa))oa[e]?t.emulator.push(e):t.prod.push(e);return t}function lC(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let Vy=!1;function q0(t,e){if(typeof window>"u"||typeof document>"u"||!$s(window.location.host)||oa[t]===e||oa[t]||Vy)return;oa[t]=e;function n(g){return`__firebase__banner__${g}`}const r="__firebase__banner",i=aC().prod.length>0;function o(){const g=document.getElementById(r);g&&g.remove()}function l(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function c(g,w){g.setAttribute("width","24"),g.setAttribute("id",w),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function u(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{Vy=!0,o()},g}function f(g,w){g.setAttribute("id",w),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function p(){const g=lC(r),w=n("text"),R=document.getElementById(w)||document.createElement("span"),N=n("learnmore"),P=document.getElementById(N)||document.createElement("a"),x=n("preprendIcon"),v=document.getElementById(x)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const T=g.element;l(T),f(P,N);const D=u();c(v,x),T.append(v,R,P,D),document.body.appendChild(T)}i?(R.innerText="Preview backend disconnected.",v.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(v.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,R.innerText="Preview backend running in this workspace."),R.setAttribute("id",w)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function cC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(xt())}function uC(){var e;const t=(e=ju())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function dC(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function hC(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function fC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function pC(){const t=xt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function mC(){return!uC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function gC(){try{return typeof indexedDB=="object"}catch{return!1}}function yC(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vC="FirebaseError";class sr extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=vC,Object.setPrototypeOf(this,sr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ja.prototype.create)}}class Ja{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?_C(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new sr(s,l,r)}}function _C(t,e){return t.replace(wC,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const wC=/\{\$([^}]+)}/g;function EC(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Hr(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(Ly(i)&&Ly(o)){if(!Hr(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Ly(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xa(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function xC(t,e){const n=new TC(t,e);return n.subscribe.bind(n)}class TC{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");SC(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=Bd),s.error===void 0&&(s.error=Bd),s.complete===void 0&&(s.complete=Bd);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function SC(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Bd(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rt(t){return t&&t._delegate?t._delegate:t}class Vs{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _s="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IC{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new iC;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(CC(e))try{this.getOrInitializeService({instanceIdentifier:_s})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=_s){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=_s){return this.instances.has(e)}getOptions(e=_s){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&o.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:RC(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=_s){return this.component?this.component.multipleInstances?e:_s:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function RC(t){return t===_s?void 0:t}function CC(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NC{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new IC(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ae;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ae||(ae={}));const AC={debug:ae.DEBUG,verbose:ae.VERBOSE,info:ae.INFO,warn:ae.WARN,error:ae.ERROR,silent:ae.SILENT},PC=ae.INFO,kC={[ae.DEBUG]:"log",[ae.VERBOSE]:"log",[ae.INFO]:"info",[ae.WARN]:"warn",[ae.ERROR]:"error"},bC=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=kC[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class kp{constructor(e){this.name=e,this._logLevel=PC,this._logHandler=bC,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ae))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?AC[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ae.DEBUG,...e),this._logHandler(this,ae.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ae.VERBOSE,...e),this._logHandler(this,ae.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ae.INFO,...e),this._logHandler(this,ae.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ae.WARN,...e),this._logHandler(this,ae.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ae.ERROR,...e),this._logHandler(this,ae.ERROR,...e)}}const DC=(t,e)=>e.some(n=>t instanceof n);let My,Uy;function jC(){return My||(My=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function OC(){return Uy||(Uy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const K0=new WeakMap,ef=new WeakMap,Q0=new WeakMap,zd=new WeakMap,bp=new WeakMap;function VC(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Mr(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&K0.set(n,t)}).catch(()=>{}),bp.set(e,t),e}function LC(t){if(ef.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});ef.set(t,e)}let tf={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return ef.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Q0.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Mr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function MC(t){tf=t(tf)}function UC(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call($d(this),e,...n);return Q0.set(r,e.sort?e.sort():[e]),Mr(r)}:OC().includes(t)?function(...e){return t.apply($d(this),e),Mr(K0.get(this))}:function(...e){return Mr(t.apply($d(this),e))}}function FC(t){return typeof t=="function"?UC(t):(t instanceof IDBTransaction&&LC(t),DC(t,jC())?new Proxy(t,tf):t)}function Mr(t){if(t instanceof IDBRequest)return VC(t);if(zd.has(t))return zd.get(t);const e=FC(t);return e!==t&&(zd.set(t,e),bp.set(e,t)),e}const $d=t=>bp.get(t);function BC(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),l=Mr(o);return r&&o.addEventListener("upgradeneeded",c=>{r(Mr(o.result),c.oldVersion,c.newVersion,Mr(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const zC=["get","getKey","getAll","getAllKeys","count"],$C=["put","add","delete","clear"],Gd=new Map;function Fy(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Gd.get(e))return Gd.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=$C.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||zC.includes(n)))return;const i=async function(o,...l){const c=this.transaction(o,s?"readwrite":"readonly");let u=c.store;return r&&(u=u.index(l.shift())),(await Promise.all([u[n](...l),s&&c.done]))[0]};return Gd.set(e,i),i}MC(t=>({...t,get:(e,n,r)=>Fy(e,n)||t.get(e,n,r),has:(e,n)=>!!Fy(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GC{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(HC(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function HC(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const nf="@firebase/app",By="0.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xn=new kp("@firebase/app"),WC="@firebase/app-compat",qC="@firebase/analytics-compat",KC="@firebase/analytics",QC="@firebase/app-check-compat",YC="@firebase/app-check",JC="@firebase/auth",XC="@firebase/auth-compat",ZC="@firebase/database",eN="@firebase/data-connect",tN="@firebase/database-compat",nN="@firebase/functions",rN="@firebase/functions-compat",sN="@firebase/installations",iN="@firebase/installations-compat",oN="@firebase/messaging",aN="@firebase/messaging-compat",lN="@firebase/performance",cN="@firebase/performance-compat",uN="@firebase/remote-config",dN="@firebase/remote-config-compat",hN="@firebase/storage",fN="@firebase/storage-compat",pN="@firebase/firestore",mN="@firebase/ai",gN="@firebase/firestore-compat",yN="firebase",vN="12.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rf="[DEFAULT]",_N={[nf]:"fire-core",[WC]:"fire-core-compat",[KC]:"fire-analytics",[qC]:"fire-analytics-compat",[YC]:"fire-app-check",[QC]:"fire-app-check-compat",[JC]:"fire-auth",[XC]:"fire-auth-compat",[ZC]:"fire-rtdb",[eN]:"fire-data-connect",[tN]:"fire-rtdb-compat",[nN]:"fire-fn",[rN]:"fire-fn-compat",[sN]:"fire-iid",[iN]:"fire-iid-compat",[oN]:"fire-fcm",[aN]:"fire-fcm-compat",[lN]:"fire-perf",[cN]:"fire-perf-compat",[uN]:"fire-rc",[dN]:"fire-rc-compat",[hN]:"fire-gcs",[fN]:"fire-gcs-compat",[pN]:"fire-fst",[gN]:"fire-fst-compat",[mN]:"fire-vertex","fire-js":"fire-js",[yN]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yc=new Map,wN=new Map,sf=new Map;function zy(t,e){try{t.container.addComponent(e)}catch(n){Xn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function zi(t){const e=t.name;if(sf.has(e))return Xn.debug(`There were multiple attempts to register component ${e}.`),!1;sf.set(e,t);for(const n of Yc.values())zy(n,t);for(const n of wN.values())zy(n,t);return!0}function Ou(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function dn(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EN={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ur=new Ja("app","Firebase",EN);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xN{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Vs("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ur.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const no=vN;function Y0(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:rf,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw Ur.create("bad-app-name",{appName:String(s)});if(n||(n=H0()),!n)throw Ur.create("no-options");const i=Yc.get(s);if(i){if(Hr(n,i.options)&&Hr(r,i.config))return i;throw Ur.create("duplicate-app",{appName:s})}const o=new NC(s);for(const c of sf.values())o.addComponent(c);const l=new xN(n,r,o);return Yc.set(s,l),l}function J0(t=rf){const e=Yc.get(t);if(!e&&t===rf&&H0())return Y0();if(!e)throw Ur.create("no-app",{appName:t});return e}function Fr(t,e,n){let r=_N[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${r}" with version "${e}":`];s&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Xn.warn(o.join(" "));return}zi(new Vs(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TN="firebase-heartbeat-database",SN=1,ja="firebase-heartbeat-store";let Hd=null;function X0(){return Hd||(Hd=BC(TN,SN,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(ja)}catch(n){console.warn(n)}}}}).catch(t=>{throw Ur.create("idb-open",{originalErrorMessage:t.message})})),Hd}async function IN(t){try{const n=(await X0()).transaction(ja),r=await n.objectStore(ja).get(Z0(t));return await n.done,r}catch(e){if(e instanceof sr)Xn.warn(e.message);else{const n=Ur.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Xn.warn(n.message)}}}async function $y(t,e){try{const r=(await X0()).transaction(ja,"readwrite");await r.objectStore(ja).put(e,Z0(t)),await r.done}catch(n){if(n instanceof sr)Xn.warn(n.message);else{const r=Ur.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Xn.warn(r.message)}}}function Z0(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RN=1024,CN=30;class NN{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new PN(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Gy();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>CN){const o=kN(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Xn.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Gy(),{heartbeatsToSend:r,unsentEntries:s}=AN(this._heartbeatsCache.heartbeats),i=Qc(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Xn.warn(n),""}}}function Gy(){return new Date().toISOString().substring(0,10)}function AN(t,e=RN){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Hy(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Hy(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class PN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return gC()?yC().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await IN(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return $y(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return $y(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Hy(t){return Qc(JSON.stringify({version:2,heartbeats:t})).length}function kN(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bN(t){zi(new Vs("platform-logger",e=>new GC(e),"PRIVATE")),zi(new Vs("heartbeat",e=>new NN(e),"PRIVATE")),Fr(nf,By,t),Fr(nf,By,"esm2020"),Fr("fire-js","")}bN("");function ew(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const DN=ew,tw=new Ja("auth","Firebase",ew());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jc=new kp("@firebase/auth");function jN(t,...e){Jc.logLevel<=ae.WARN&&Jc.warn(`Auth (${no}): ${t}`,...e)}function cc(t,...e){Jc.logLevel<=ae.ERROR&&Jc.error(`Auth (${no}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bn(t,...e){throw jp(t,...e)}function mn(t,...e){return jp(t,...e)}function Dp(t,e,n){const r={...DN(),[e]:n};return new Ja("auth","Firebase",r).create(e,{appName:t.name})}function Ns(t){return Dp(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function ON(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&bn(t,"argument-error"),Dp(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function jp(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return tw.create(t,...e)}function Z(t,e,...n){if(!t)throw jp(e,...n)}function Gn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw cc(e),new Error(e)}function Zn(t,e){t||Gn(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function of(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function VN(){return Wy()==="http:"||Wy()==="https:"}function Wy(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LN(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(VN()||hC()||"connection"in navigator)?navigator.onLine:!0}function MN(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Za{constructor(e,n){this.shortDelay=e,this.longDelay=n,Zn(n>e,"Short delay should be less than long delay!"),this.isMobile=cC()||fC()}get(){return LN()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Op(t,e){Zn(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nw{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Gn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Gn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Gn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UN={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FN=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],BN=new Za(3e4,6e4);function Vp(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function ro(t,e,n,r,s={}){return rw(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const l=Xa({key:t.config.apiKey,...o}).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u={method:e,headers:c,...i};return dC()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&$s(t.emulatorConfig.host)&&(u.credentials="include"),nw.fetch()(await sw(t,t.config.apiHost,n,l),u)})}async function rw(t,e,n){t._canInitEmulator=!1;const r={...UN,...e};try{const s=new $N(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw $l(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw $l(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw $l(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw $l(t,"user-disabled",o);const f=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw Dp(t,f,u);bn(t,f)}}catch(s){if(s instanceof sr)throw s;bn(t,"network-request-failed",{message:String(s)})}}async function zN(t,e,n,r,s={}){const i=await ro(t,e,n,r,s);return"mfaPendingCredential"in i&&bn(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function sw(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?Op(t.config,s):`${t.config.apiScheme}://${s}`;return FN.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}class $N{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(mn(this.auth,"network-request-failed")),BN.get())})}}function $l(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=mn(t,e,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GN(t,e){return ro(t,"POST","/v1/accounts:delete",e)}async function Xc(t,e){return ro(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aa(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function HN(t,e=!1){const n=rt(t),r=await n.getIdToken(e),s=Lp(r);Z(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:aa(Wd(s.auth_time)),issuedAtTime:aa(Wd(s.iat)),expirationTime:aa(Wd(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Wd(t){return Number(t)*1e3}function Lp(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return cc("JWT malformed, contained fewer than 3 sections"),null;try{const s=$0(n);return s?JSON.parse(s):(cc("Failed to decode base64 JWT payload"),null)}catch(s){return cc("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function qy(t){const e=Lp(t);return Z(e,"internal-error"),Z(typeof e.exp<"u","internal-error"),Z(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Oa(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof sr&&WN(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function WN({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qN{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class af{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=aa(this.lastLoginAt),this.creationTime=aa(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zc(t){var p;const e=t.auth,n=await t.getIdToken(),r=await Oa(t,Xc(e,{idToken:n}));Z(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const i=(p=s.providerUserInfo)!=null&&p.length?iw(s.providerUserInfo):[],o=QN(t.providerData,i),l=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),u=l?c:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new af(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(t,f)}async function KN(t){const e=rt(t);await Zc(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function QN(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function iw(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YN(t,e){const n=await rw(t,{},async()=>{const r=Xa({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await sw(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:l,body:r};return t.emulatorConfig&&$s(t.emulatorConfig.host)&&(c.credentials="include"),nw.fetch()(o,c)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function JN(t,e){return ro(t,"POST","/v2/accounts:revokeToken",Vp(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pi{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Z(e.idToken,"internal-error"),Z(typeof e.idToken<"u","internal-error"),Z(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):qy(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Z(e.length!==0,"internal-error");const n=qy(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Z(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await YN(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new Pi;return r&&(Z(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(Z(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(Z(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Pi,this.toJSON())}_performRefresh(){return Gn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mr(t,e){Z(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class hn{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new qN(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new af(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await Oa(this,this.stsTokenManager.getToken(this.auth,e));return Z(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return HN(this,e)}reload(){return KN(this)}_assign(e){this!==e&&(Z(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new hn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){Z(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Zc(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(dn(this.auth.app))return Promise.reject(Ns(this.auth));const e=await this.getIdToken();return await Oa(this,GN(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,i=n.phoneNumber??void 0,o=n.photoURL??void 0,l=n.tenantId??void 0,c=n._redirectEventId??void 0,u=n.createdAt??void 0,f=n.lastLoginAt??void 0,{uid:p,emailVerified:g,isAnonymous:w,providerData:R,stsTokenManager:N}=n;Z(p&&N,e,"internal-error");const P=Pi.fromJSON(this.name,N);Z(typeof p=="string",e,"internal-error"),mr(r,e.name),mr(s,e.name),Z(typeof g=="boolean",e,"internal-error"),Z(typeof w=="boolean",e,"internal-error"),mr(i,e.name),mr(o,e.name),mr(l,e.name),mr(c,e.name),mr(u,e.name),mr(f,e.name);const x=new hn({uid:p,auth:e,email:s,emailVerified:g,displayName:r,isAnonymous:w,photoURL:o,phoneNumber:i,tenantId:l,stsTokenManager:P,createdAt:u,lastLoginAt:f});return R&&Array.isArray(R)&&(x.providerData=R.map(v=>({...v}))),c&&(x._redirectEventId=c),x}static async _fromIdTokenResponse(e,n,r=!1){const s=new Pi;s.updateFromServerResponse(n);const i=new hn({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Zc(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];Z(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?iw(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),l=new Pi;l.updateFromIdToken(r);const c=new hn({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:o}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new af(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ky=new Map;function Hn(t){Zn(t instanceof Function,"Expected a class definition");let e=Ky.get(t);return e?(Zn(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Ky.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ow{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}ow.type="NONE";const Qy=ow;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uc(t,e,n){return`firebase:${t}:${e}:${n}`}class ki{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=uc(this.userKey,s.apiKey,i),this.fullPersistenceKey=uc("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Xc(this.auth,{idToken:e}).catch(()=>{});return n?hn._fromGetAccountInfoResponse(this.auth,n,e):null}return hn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new ki(Hn(Qy),e,r);const s=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=s[0]||Hn(Qy);const o=uc(r,e.config.apiKey,e.name);let l=null;for(const u of n)try{const f=await u._get(o);if(f){let p;if(typeof f=="string"){const g=await Xc(e,{idToken:f}).catch(()=>{});if(!g)break;p=await hn._fromGetAccountInfoResponse(e,g,f)}else p=hn._fromJSON(e,f);u!==i&&(l=p),i=u;break}}catch{}const c=s.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new ki(i,e,r):(i=c[0],l&&await i._set(o,l.toJSON()),await Promise.all(n.map(async u=>{if(u!==i)try{await u._remove(o)}catch{}})),new ki(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yy(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(uw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(aw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(hw(e))return"Blackberry";if(fw(e))return"Webos";if(lw(e))return"Safari";if((e.includes("chrome/")||cw(e))&&!e.includes("edge/"))return"Chrome";if(dw(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function aw(t=xt()){return/firefox\//i.test(t)}function lw(t=xt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function cw(t=xt()){return/crios\//i.test(t)}function uw(t=xt()){return/iemobile/i.test(t)}function dw(t=xt()){return/android/i.test(t)}function hw(t=xt()){return/blackberry/i.test(t)}function fw(t=xt()){return/webos/i.test(t)}function Mp(t=xt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function XN(t=xt()){var e;return Mp(t)&&!!((e=window.navigator)!=null&&e.standalone)}function ZN(){return pC()&&document.documentMode===10}function pw(t=xt()){return Mp(t)||dw(t)||fw(t)||hw(t)||/windows phone/i.test(t)||uw(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mw(t,e=[]){let n;switch(t){case"Browser":n=Yy(xt());break;case"Worker":n=`${Yy(xt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${no}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e2{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,l)=>{try{const c=e(i);o(c)}catch(c){l(c)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function t2(t,e={}){return ro(t,"GET","/v2/passwordPolicy",Vp(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n2=6;class r2{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??n2,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s2{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Jy(this),this.idTokenSubscription=new Jy(this),this.beforeStateQueue=new e2(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=tw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Hn(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await ki.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Xc(this,{idToken:e}),r=await hn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(dn(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,l=r==null?void 0:r._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(r=c.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Z(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Zc(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=MN()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(dn(this.app))return Promise.reject(Ns(this));const n=e?rt(e):null;return n&&Z(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Z(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return dn(this.app)?Promise.reject(Ns(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return dn(this.app)?Promise.reject(Ns(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Hn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await t2(this),n=new r2(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ja("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await JN(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Hn(e)||this._popupRedirectResolver;Z(n,this,"argument-error"),this.redirectPersistenceManager=await ki.create(this,[Hn(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Z(l,this,"internal-error"),l.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,s);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Z(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=mw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(dn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&jN(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Vu(t){return rt(t)}class Jy{constructor(e){this.auth=e,this.observer=null,this.addObserver=xC(n=>this.observer=n)}get next(){return Z(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Up={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function i2(t){Up=t}function o2(t){return Up.loadJS(t)}function a2(){return Up.gapiScript}function l2(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c2(t,e){const n=Ou(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(Hr(i,e??{}))return s;bn(s,"already-initialized")}return n.initialize({options:e})}function u2(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Hn);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function d2(t,e,n){const r=Vu(t);Z(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!(n!=null&&n.disableWarnings),i=gw(e),{host:o,port:l}=h2(e),c=l===null?"":`:${l}`,u={url:`${i}//${o}${c}/`},f=Object.freeze({host:o,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){Z(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Z(Hr(u,r.config.emulator)&&Hr(f,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=u,r.emulatorConfig=f,r.settings.appVerificationDisabledForTesting=!0,$s(o)?(Pp(`${i}//${o}${c}`),q0("Auth",!0)):s||f2()}function gw(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function h2(t){const e=gw(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Xy(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:Xy(o)}}}function Xy(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function f2(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yw{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Gn("not implemented")}_getIdTokenResponse(e){return Gn("not implemented")}_linkToIdToken(e,n){return Gn("not implemented")}_getReauthenticationResolver(e){return Gn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bi(t,e){return zN(t,"POST","/v1/accounts:signInWithIdp",Vp(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p2="http://localhost";class Ls extends yw{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Ls(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):bn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=n;if(!r||!s)return null;const o=new Ls(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return bi(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,bi(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,bi(e,n)}buildRequest(){const e={requestUri:p2,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Xa(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fp{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class el extends Fp{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Er extends el{constructor(){super("facebook.com")}static credential(e){return Ls._fromParams({providerId:Er.PROVIDER_ID,signInMethod:Er.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Er.credentialFromTaggedObject(e)}static credentialFromError(e){return Er.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Er.credential(e.oauthAccessToken)}catch{return null}}}Er.FACEBOOK_SIGN_IN_METHOD="facebook.com";Er.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bn extends el{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Ls._fromParams({providerId:Bn.PROVIDER_ID,signInMethod:Bn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Bn.credentialFromTaggedObject(e)}static credentialFromError(e){return Bn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Bn.credential(n,r)}catch{return null}}}Bn.GOOGLE_SIGN_IN_METHOD="google.com";Bn.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xr extends el{constructor(){super("github.com")}static credential(e){return Ls._fromParams({providerId:xr.PROVIDER_ID,signInMethod:xr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return xr.credentialFromTaggedObject(e)}static credentialFromError(e){return xr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return xr.credential(e.oauthAccessToken)}catch{return null}}}xr.GITHUB_SIGN_IN_METHOD="github.com";xr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr extends el{constructor(){super("twitter.com")}static credential(e,n){return Ls._fromParams({providerId:Tr.PROVIDER_ID,signInMethod:Tr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Tr.credentialFromTaggedObject(e)}static credentialFromError(e){return Tr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Tr.credential(n,r)}catch{return null}}}Tr.TWITTER_SIGN_IN_METHOD="twitter.com";Tr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $i{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await hn._fromIdTokenResponse(e,r,s),o=Zy(r);return new $i({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=Zy(r);return new $i({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function Zy(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eu extends sr{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,eu.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new eu(e,n,r,s)}}function vw(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?eu._fromErrorAndOperation(t,i,e,r):i})}async function m2(t,e,n=!1){const r=await Oa(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return $i._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function g2(t,e,n=!1){const{auth:r}=t;if(dn(r.app))return Promise.reject(Ns(r));const s="reauthenticate";try{const i=await Oa(t,vw(r,s,e,t),n);Z(i.idToken,r,"internal-error");const o=Lp(i.idToken);Z(o,r,"internal-error");const{sub:l}=o;return Z(t.uid===l,r,"user-mismatch"),$i._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&bn(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function y2(t,e,n=!1){if(dn(t.app))return Promise.reject(Ns(t));const r="signIn",s=await vw(t,r,e),i=await $i._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}function v2(t,e,n,r){return rt(t).onIdTokenChanged(e,n,r)}function _2(t,e,n){return rt(t).beforeAuthStateChanged(e,n)}function w2(t,e,n,r){return rt(t).onAuthStateChanged(e,n,r)}function E2(t){return rt(t).signOut()}const tu="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _w{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(tu,"1"),this.storage.removeItem(tu),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x2=1e3,T2=10;class ww extends _w{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=pw(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);ZN()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,T2):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},x2)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}ww.type="LOCAL";const S2=ww;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ew extends _w{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}Ew.type="SESSION";const xw=Ew;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I2(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lu{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Lu(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(o).map(async u=>u(n.origin,i)),c=await I2(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Lu.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bp(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R2{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((l,c)=>{const u=Bp("",20);s.port1.start();const f=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(p){const g=p;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(f),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(g.data.response);break;default:clearTimeout(f),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cn(){return window}function C2(t){Cn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tw(){return typeof Cn().WorkerGlobalScope<"u"&&typeof Cn().importScripts=="function"}async function N2(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function A2(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function P2(){return Tw()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sw="firebaseLocalStorageDb",k2=1,nu="firebaseLocalStorage",Iw="fbase_key";class tl{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Mu(t,e){return t.transaction([nu],e?"readwrite":"readonly").objectStore(nu)}function b2(){const t=indexedDB.deleteDatabase(Sw);return new tl(t).toPromise()}function lf(){const t=indexedDB.open(Sw,k2);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(nu,{keyPath:Iw})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(nu)?e(r):(r.close(),await b2(),e(await lf()))})})}async function ev(t,e,n){const r=Mu(t,!0).put({[Iw]:e,value:n});return new tl(r).toPromise()}async function D2(t,e){const n=Mu(t,!1).get(e),r=await new tl(n).toPromise();return r===void 0?null:r.value}function tv(t,e){const n=Mu(t,!0).delete(e);return new tl(n).toPromise()}const j2=800,O2=3;class Rw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await lf(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>O2)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Tw()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Lu._getInstance(P2()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await N2(),!this.activeServiceWorker)return;this.sender=new R2(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||A2()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await lf();return await ev(e,tu,"1"),await tv(e,tu),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>ev(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>D2(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>tv(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Mu(s,!1).getAll();return new tl(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),j2)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Rw.type="LOCAL";const V2=Rw;new Za(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cw(t,e){return e?Hn(e):(Z(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zp extends yw{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return bi(e,this._buildIdpRequest())}_linkToIdToken(e,n){return bi(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return bi(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function L2(t){return y2(t.auth,new zp(t),t.bypassAuthState)}function M2(t){const{auth:e,user:n}=t;return Z(n,e,"internal-error"),g2(n,new zp(t),t.bypassAuthState)}async function U2(t){const{auth:e,user:n}=t;return Z(n,e,"internal-error"),m2(n,new zp(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nw{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return L2;case"linkViaPopup":case"linkViaRedirect":return U2;case"reauthViaPopup":case"reauthViaRedirect":return M2;default:bn(this.auth,"internal-error")}}resolve(e){Zn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Zn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F2=new Za(2e3,1e4);async function B2(t,e,n){if(dn(t.app))return Promise.reject(mn(t,"operation-not-supported-in-this-environment"));const r=Vu(t);ON(t,e,Fp);const s=Cw(r,n);return new Ss(r,"signInViaPopup",e,s).executeNotNull()}class Ss extends Nw{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Ss.currentPopupAction&&Ss.currentPopupAction.cancel(),Ss.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Z(e,this.auth,"internal-error"),e}async onExecution(){Zn(this.filter.length===1,"Popup operations only handle one event");const e=Bp();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(mn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(mn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ss.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(mn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,F2.get())};e()}}Ss.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z2="pendingRedirect",dc=new Map;class $2 extends Nw{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=dc.get(this.auth._key());if(!e){try{const r=await G2(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}dc.set(this.auth._key(),e)}return this.bypassAuthState||dc.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function G2(t,e){const n=q2(e),r=W2(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function H2(t,e){dc.set(t._key(),e)}function W2(t){return Hn(t._redirectPersistence)}function q2(t){return uc(z2,t.config.apiKey,t.name)}async function K2(t,e,n=!1){if(dn(t.app))return Promise.reject(Ns(t));const r=Vu(t),s=Cw(r,e),o=await new $2(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q2=10*60*1e3;class Y2{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!J2(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!Aw(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(mn(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Q2&&this.cachedEventUids.clear(),this.cachedEventUids.has(nv(e))}saveEventToCache(e){this.cachedEventUids.add(nv(e)),this.lastProcessedEventTime=Date.now()}}function nv(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Aw({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function J2(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Aw(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function X2(t,e={}){return ro(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z2=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,eA=/^https?/;async function tA(t){if(t.config.emulator)return;const{authorizedDomains:e}=await X2(t);for(const n of e)try{if(nA(n))return}catch{}bn(t,"unauthorized-domain")}function nA(t){const e=of(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!eA.test(n))return!1;if(Z2.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rA=new Za(3e4,6e4);function rv(){const t=Cn().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function sA(t){return new Promise((e,n)=>{var s,i,o;function r(){rv(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{rv(),n(mn(t,"network-request-failed"))},timeout:rA.get()})}if((i=(s=Cn().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=Cn().gapi)!=null&&o.load)r();else{const l=l2("iframefcb");return Cn()[l]=()=>{gapi.load?r():n(mn(t,"network-request-failed"))},o2(`${a2()}?onload=${l}`).catch(c=>n(c))}}).catch(e=>{throw hc=null,e})}let hc=null;function iA(t){return hc=hc||sA(t),hc}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oA=new Za(5e3,15e3),aA="__/auth/iframe",lA="emulator/auth/iframe",cA={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},uA=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function dA(t){const e=t.config;Z(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Op(e,lA):`https://${t.config.authDomain}/${aA}`,r={apiKey:e.apiKey,appName:t.name,v:no},s=uA.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Xa(r).slice(1)}`}async function hA(t){const e=await iA(t),n=Cn().gapi;return Z(n,t,"internal-error"),e.open({where:document.body,url:dA(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:cA,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=mn(t,"network-request-failed"),l=Cn().setTimeout(()=>{i(o)},oA.get());function c(){Cn().clearTimeout(l),s(r)}r.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fA={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},pA=500,mA=600,gA="_blank",yA="http://localhost";class sv{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function vA(t,e,n,r=pA,s=mA){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const c={...fA,width:r.toString(),height:s.toString(),top:i,left:o},u=xt().toLowerCase();n&&(l=cw(u)?gA:n),aw(u)&&(e=e||yA,c.scrollbars="yes");const f=Object.entries(c).reduce((g,[w,R])=>`${g}${w}=${R},`,"");if(XN(u)&&l!=="_self")return _A(e||"",l),new sv(null);const p=window.open(e||"",l,f);Z(p,t,"popup-blocked");try{p.focus()}catch{}return new sv(p)}function _A(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wA="__/auth/handler",EA="emulator/auth/handler",xA=encodeURIComponent("fac");async function iv(t,e,n,r,s,i){Z(t.config.authDomain,t,"auth-domain-config-required"),Z(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:no,eventId:s};if(e instanceof Fp){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",EC(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,p]of Object.entries(i||{}))o[f]=p}if(e instanceof el){const f=e.getScopes().filter(p=>p!=="");f.length>0&&(o.scopes=f.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const f of Object.keys(l))l[f]===void 0&&delete l[f];const c=await t._getAppCheckToken(),u=c?`#${xA}=${encodeURIComponent(c)}`:"";return`${TA(t)}?${Xa(l).slice(1)}${u}`}function TA({config:t}){return t.emulator?Op(t,EA):`https://${t.authDomain}/${wA}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qd="webStorageSupport";class SA{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=xw,this._completeRedirectFn=K2,this._overrideRedirectResult=H2}async _openPopup(e,n,r,s){var o;Zn((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await iv(e,n,r,of(),s);return vA(e,i,Bp())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await iv(e,n,r,of(),s);return C2(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Zn(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await hA(e),r=new Y2(e);return n.register("authEvent",s=>(Z(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(qd,{type:qd},s=>{var o;const i=(o=s==null?void 0:s[0])==null?void 0:o[qd];i!==void 0&&n(!!i),bn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=tA(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return pw()||lw()||Mp()}}const IA=SA;var ov="@firebase/auth",av="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RA{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Z(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CA(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function NA(t){zi(new Vs("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;Z(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:mw(t)},u=new s2(r,s,i,c);return u2(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),zi(new Vs("auth-internal",e=>{const n=Vu(e.getProvider("auth").getImmediate());return(r=>new RA(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Fr(ov,av,CA(t)),Fr(ov,av,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AA=5*60,PA=W0("authIdTokenMaxAge")||AA;let lv=null;const kA=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>PA)return;const s=n==null?void 0:n.token;lv!==s&&(lv=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function bA(t=J0()){const e=Ou(t,"auth");if(e.isInitialized())return e.getImmediate();const n=c2(t,{popupRedirectResolver:IA,persistence:[V2,S2,xw]}),r=W0("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=kA(i.toString());_2(n,o,()=>o(n.currentUser)),v2(n,l=>o(l))}}const s=G0("auth");return s&&d2(n,`http://${s}`),n}function DA(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}i2({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=mn("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",DA().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});NA("Browser");var jA="firebase",OA="12.1.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Fr(jA,OA,"app");var cv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Br,Pw;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(S,_){function I(){}I.prototype=_.prototype,S.D=_.prototype,S.prototype=new I,S.prototype.constructor=S,S.C=function(E,A,k){for(var C=Array(arguments.length-2),we=2;we<arguments.length;we++)C[we-2]=arguments[we];return _.prototype[A].apply(E,C)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(S,_,I){I||(I=0);var E=Array(16);if(typeof _=="string")for(var A=0;16>A;++A)E[A]=_.charCodeAt(I++)|_.charCodeAt(I++)<<8|_.charCodeAt(I++)<<16|_.charCodeAt(I++)<<24;else for(A=0;16>A;++A)E[A]=_[I++]|_[I++]<<8|_[I++]<<16|_[I++]<<24;_=S.g[0],I=S.g[1],A=S.g[2];var k=S.g[3],C=_+(k^I&(A^k))+E[0]+3614090360&4294967295;_=I+(C<<7&4294967295|C>>>25),C=k+(A^_&(I^A))+E[1]+3905402710&4294967295,k=_+(C<<12&4294967295|C>>>20),C=A+(I^k&(_^I))+E[2]+606105819&4294967295,A=k+(C<<17&4294967295|C>>>15),C=I+(_^A&(k^_))+E[3]+3250441966&4294967295,I=A+(C<<22&4294967295|C>>>10),C=_+(k^I&(A^k))+E[4]+4118548399&4294967295,_=I+(C<<7&4294967295|C>>>25),C=k+(A^_&(I^A))+E[5]+1200080426&4294967295,k=_+(C<<12&4294967295|C>>>20),C=A+(I^k&(_^I))+E[6]+2821735955&4294967295,A=k+(C<<17&4294967295|C>>>15),C=I+(_^A&(k^_))+E[7]+4249261313&4294967295,I=A+(C<<22&4294967295|C>>>10),C=_+(k^I&(A^k))+E[8]+1770035416&4294967295,_=I+(C<<7&4294967295|C>>>25),C=k+(A^_&(I^A))+E[9]+2336552879&4294967295,k=_+(C<<12&4294967295|C>>>20),C=A+(I^k&(_^I))+E[10]+4294925233&4294967295,A=k+(C<<17&4294967295|C>>>15),C=I+(_^A&(k^_))+E[11]+2304563134&4294967295,I=A+(C<<22&4294967295|C>>>10),C=_+(k^I&(A^k))+E[12]+1804603682&4294967295,_=I+(C<<7&4294967295|C>>>25),C=k+(A^_&(I^A))+E[13]+4254626195&4294967295,k=_+(C<<12&4294967295|C>>>20),C=A+(I^k&(_^I))+E[14]+2792965006&4294967295,A=k+(C<<17&4294967295|C>>>15),C=I+(_^A&(k^_))+E[15]+1236535329&4294967295,I=A+(C<<22&4294967295|C>>>10),C=_+(A^k&(I^A))+E[1]+4129170786&4294967295,_=I+(C<<5&4294967295|C>>>27),C=k+(I^A&(_^I))+E[6]+3225465664&4294967295,k=_+(C<<9&4294967295|C>>>23),C=A+(_^I&(k^_))+E[11]+643717713&4294967295,A=k+(C<<14&4294967295|C>>>18),C=I+(k^_&(A^k))+E[0]+3921069994&4294967295,I=A+(C<<20&4294967295|C>>>12),C=_+(A^k&(I^A))+E[5]+3593408605&4294967295,_=I+(C<<5&4294967295|C>>>27),C=k+(I^A&(_^I))+E[10]+38016083&4294967295,k=_+(C<<9&4294967295|C>>>23),C=A+(_^I&(k^_))+E[15]+3634488961&4294967295,A=k+(C<<14&4294967295|C>>>18),C=I+(k^_&(A^k))+E[4]+3889429448&4294967295,I=A+(C<<20&4294967295|C>>>12),C=_+(A^k&(I^A))+E[9]+568446438&4294967295,_=I+(C<<5&4294967295|C>>>27),C=k+(I^A&(_^I))+E[14]+3275163606&4294967295,k=_+(C<<9&4294967295|C>>>23),C=A+(_^I&(k^_))+E[3]+4107603335&4294967295,A=k+(C<<14&4294967295|C>>>18),C=I+(k^_&(A^k))+E[8]+1163531501&4294967295,I=A+(C<<20&4294967295|C>>>12),C=_+(A^k&(I^A))+E[13]+2850285829&4294967295,_=I+(C<<5&4294967295|C>>>27),C=k+(I^A&(_^I))+E[2]+4243563512&4294967295,k=_+(C<<9&4294967295|C>>>23),C=A+(_^I&(k^_))+E[7]+1735328473&4294967295,A=k+(C<<14&4294967295|C>>>18),C=I+(k^_&(A^k))+E[12]+2368359562&4294967295,I=A+(C<<20&4294967295|C>>>12),C=_+(I^A^k)+E[5]+4294588738&4294967295,_=I+(C<<4&4294967295|C>>>28),C=k+(_^I^A)+E[8]+2272392833&4294967295,k=_+(C<<11&4294967295|C>>>21),C=A+(k^_^I)+E[11]+1839030562&4294967295,A=k+(C<<16&4294967295|C>>>16),C=I+(A^k^_)+E[14]+4259657740&4294967295,I=A+(C<<23&4294967295|C>>>9),C=_+(I^A^k)+E[1]+2763975236&4294967295,_=I+(C<<4&4294967295|C>>>28),C=k+(_^I^A)+E[4]+1272893353&4294967295,k=_+(C<<11&4294967295|C>>>21),C=A+(k^_^I)+E[7]+4139469664&4294967295,A=k+(C<<16&4294967295|C>>>16),C=I+(A^k^_)+E[10]+3200236656&4294967295,I=A+(C<<23&4294967295|C>>>9),C=_+(I^A^k)+E[13]+681279174&4294967295,_=I+(C<<4&4294967295|C>>>28),C=k+(_^I^A)+E[0]+3936430074&4294967295,k=_+(C<<11&4294967295|C>>>21),C=A+(k^_^I)+E[3]+3572445317&4294967295,A=k+(C<<16&4294967295|C>>>16),C=I+(A^k^_)+E[6]+76029189&4294967295,I=A+(C<<23&4294967295|C>>>9),C=_+(I^A^k)+E[9]+3654602809&4294967295,_=I+(C<<4&4294967295|C>>>28),C=k+(_^I^A)+E[12]+3873151461&4294967295,k=_+(C<<11&4294967295|C>>>21),C=A+(k^_^I)+E[15]+530742520&4294967295,A=k+(C<<16&4294967295|C>>>16),C=I+(A^k^_)+E[2]+3299628645&4294967295,I=A+(C<<23&4294967295|C>>>9),C=_+(A^(I|~k))+E[0]+4096336452&4294967295,_=I+(C<<6&4294967295|C>>>26),C=k+(I^(_|~A))+E[7]+1126891415&4294967295,k=_+(C<<10&4294967295|C>>>22),C=A+(_^(k|~I))+E[14]+2878612391&4294967295,A=k+(C<<15&4294967295|C>>>17),C=I+(k^(A|~_))+E[5]+4237533241&4294967295,I=A+(C<<21&4294967295|C>>>11),C=_+(A^(I|~k))+E[12]+1700485571&4294967295,_=I+(C<<6&4294967295|C>>>26),C=k+(I^(_|~A))+E[3]+2399980690&4294967295,k=_+(C<<10&4294967295|C>>>22),C=A+(_^(k|~I))+E[10]+4293915773&4294967295,A=k+(C<<15&4294967295|C>>>17),C=I+(k^(A|~_))+E[1]+2240044497&4294967295,I=A+(C<<21&4294967295|C>>>11),C=_+(A^(I|~k))+E[8]+1873313359&4294967295,_=I+(C<<6&4294967295|C>>>26),C=k+(I^(_|~A))+E[15]+4264355552&4294967295,k=_+(C<<10&4294967295|C>>>22),C=A+(_^(k|~I))+E[6]+2734768916&4294967295,A=k+(C<<15&4294967295|C>>>17),C=I+(k^(A|~_))+E[13]+1309151649&4294967295,I=A+(C<<21&4294967295|C>>>11),C=_+(A^(I|~k))+E[4]+4149444226&4294967295,_=I+(C<<6&4294967295|C>>>26),C=k+(I^(_|~A))+E[11]+3174756917&4294967295,k=_+(C<<10&4294967295|C>>>22),C=A+(_^(k|~I))+E[2]+718787259&4294967295,A=k+(C<<15&4294967295|C>>>17),C=I+(k^(A|~_))+E[9]+3951481745&4294967295,S.g[0]=S.g[0]+_&4294967295,S.g[1]=S.g[1]+(A+(C<<21&4294967295|C>>>11))&4294967295,S.g[2]=S.g[2]+A&4294967295,S.g[3]=S.g[3]+k&4294967295}r.prototype.u=function(S,_){_===void 0&&(_=S.length);for(var I=_-this.blockSize,E=this.B,A=this.h,k=0;k<_;){if(A==0)for(;k<=I;)s(this,S,k),k+=this.blockSize;if(typeof S=="string"){for(;k<_;)if(E[A++]=S.charCodeAt(k++),A==this.blockSize){s(this,E),A=0;break}}else for(;k<_;)if(E[A++]=S[k++],A==this.blockSize){s(this,E),A=0;break}}this.h=A,this.o+=_},r.prototype.v=function(){var S=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);S[0]=128;for(var _=1;_<S.length-8;++_)S[_]=0;var I=8*this.o;for(_=S.length-8;_<S.length;++_)S[_]=I&255,I/=256;for(this.u(S),S=Array(16),_=I=0;4>_;++_)for(var E=0;32>E;E+=8)S[I++]=this.g[_]>>>E&255;return S};function i(S,_){var I=l;return Object.prototype.hasOwnProperty.call(I,S)?I[S]:I[S]=_(S)}function o(S,_){this.h=_;for(var I=[],E=!0,A=S.length-1;0<=A;A--){var k=S[A]|0;E&&k==_||(I[A]=k,E=!1)}this.g=I}var l={};function c(S){return-128<=S&&128>S?i(S,function(_){return new o([_|0],0>_?-1:0)}):new o([S|0],0>S?-1:0)}function u(S){if(isNaN(S)||!isFinite(S))return p;if(0>S)return P(u(-S));for(var _=[],I=1,E=0;S>=I;E++)_[E]=S/I|0,I*=4294967296;return new o(_,0)}function f(S,_){if(S.length==0)throw Error("number format error: empty string");if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(S.charAt(0)=="-")return P(f(S.substring(1),_));if(0<=S.indexOf("-"))throw Error('number format error: interior "-" character');for(var I=u(Math.pow(_,8)),E=p,A=0;A<S.length;A+=8){var k=Math.min(8,S.length-A),C=parseInt(S.substring(A,A+k),_);8>k?(k=u(Math.pow(_,k)),E=E.j(k).add(u(C))):(E=E.j(I),E=E.add(u(C)))}return E}var p=c(0),g=c(1),w=c(16777216);t=o.prototype,t.m=function(){if(N(this))return-P(this).m();for(var S=0,_=1,I=0;I<this.g.length;I++){var E=this.i(I);S+=(0<=E?E:4294967296+E)*_,_*=4294967296}return S},t.toString=function(S){if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(R(this))return"0";if(N(this))return"-"+P(this).toString(S);for(var _=u(Math.pow(S,6)),I=this,E="";;){var A=D(I,_).g;I=x(I,A.j(_));var k=((0<I.g.length?I.g[0]:I.h)>>>0).toString(S);if(I=A,R(I))return k+E;for(;6>k.length;)k="0"+k;E=k+E}},t.i=function(S){return 0>S?0:S<this.g.length?this.g[S]:this.h};function R(S){if(S.h!=0)return!1;for(var _=0;_<S.g.length;_++)if(S.g[_]!=0)return!1;return!0}function N(S){return S.h==-1}t.l=function(S){return S=x(this,S),N(S)?-1:R(S)?0:1};function P(S){for(var _=S.g.length,I=[],E=0;E<_;E++)I[E]=~S.g[E];return new o(I,~S.h).add(g)}t.abs=function(){return N(this)?P(this):this},t.add=function(S){for(var _=Math.max(this.g.length,S.g.length),I=[],E=0,A=0;A<=_;A++){var k=E+(this.i(A)&65535)+(S.i(A)&65535),C=(k>>>16)+(this.i(A)>>>16)+(S.i(A)>>>16);E=C>>>16,k&=65535,C&=65535,I[A]=C<<16|k}return new o(I,I[I.length-1]&-2147483648?-1:0)};function x(S,_){return S.add(P(_))}t.j=function(S){if(R(this)||R(S))return p;if(N(this))return N(S)?P(this).j(P(S)):P(P(this).j(S));if(N(S))return P(this.j(P(S)));if(0>this.l(w)&&0>S.l(w))return u(this.m()*S.m());for(var _=this.g.length+S.g.length,I=[],E=0;E<2*_;E++)I[E]=0;for(E=0;E<this.g.length;E++)for(var A=0;A<S.g.length;A++){var k=this.i(E)>>>16,C=this.i(E)&65535,we=S.i(A)>>>16,Pt=S.i(A)&65535;I[2*E+2*A]+=C*Pt,v(I,2*E+2*A),I[2*E+2*A+1]+=k*Pt,v(I,2*E+2*A+1),I[2*E+2*A+1]+=C*we,v(I,2*E+2*A+1),I[2*E+2*A+2]+=k*we,v(I,2*E+2*A+2)}for(E=0;E<_;E++)I[E]=I[2*E+1]<<16|I[2*E];for(E=_;E<2*_;E++)I[E]=0;return new o(I,0)};function v(S,_){for(;(S[_]&65535)!=S[_];)S[_+1]+=S[_]>>>16,S[_]&=65535,_++}function T(S,_){this.g=S,this.h=_}function D(S,_){if(R(_))throw Error("division by zero");if(R(S))return new T(p,p);if(N(S))return _=D(P(S),_),new T(P(_.g),P(_.h));if(N(_))return _=D(S,P(_)),new T(P(_.g),_.h);if(30<S.g.length){if(N(S)||N(_))throw Error("slowDivide_ only works with positive integers.");for(var I=g,E=_;0>=E.l(S);)I=F(I),E=F(E);var A=z(I,1),k=z(E,1);for(E=z(E,2),I=z(I,2);!R(E);){var C=k.add(E);0>=C.l(S)&&(A=A.add(I),k=C),E=z(E,1),I=z(I,1)}return _=x(S,A.j(_)),new T(A,_)}for(A=p;0<=S.l(_);){for(I=Math.max(1,Math.floor(S.m()/_.m())),E=Math.ceil(Math.log(I)/Math.LN2),E=48>=E?1:Math.pow(2,E-48),k=u(I),C=k.j(_);N(C)||0<C.l(S);)I-=E,k=u(I),C=k.j(_);R(k)&&(k=g),A=A.add(k),S=x(S,C)}return new T(A,S)}t.A=function(S){return D(this,S).h},t.and=function(S){for(var _=Math.max(this.g.length,S.g.length),I=[],E=0;E<_;E++)I[E]=this.i(E)&S.i(E);return new o(I,this.h&S.h)},t.or=function(S){for(var _=Math.max(this.g.length,S.g.length),I=[],E=0;E<_;E++)I[E]=this.i(E)|S.i(E);return new o(I,this.h|S.h)},t.xor=function(S){for(var _=Math.max(this.g.length,S.g.length),I=[],E=0;E<_;E++)I[E]=this.i(E)^S.i(E);return new o(I,this.h^S.h)};function F(S){for(var _=S.g.length+1,I=[],E=0;E<_;E++)I[E]=S.i(E)<<1|S.i(E-1)>>>31;return new o(I,S.h)}function z(S,_){var I=_>>5;_%=32;for(var E=S.g.length-I,A=[],k=0;k<E;k++)A[k]=0<_?S.i(k+I)>>>_|S.i(k+I+1)<<32-_:S.i(k+I);return new o(A,S.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Pw=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=f,Br=o}).apply(typeof cv<"u"?cv:typeof self<"u"?self:typeof window<"u"?window:{});var Gl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var kw,qo,bw,fc,cf,Dw,jw,Ow;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,d,m){return a==Array.prototype||a==Object.prototype||(a[d]=m.value),a};function n(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof Gl=="object"&&Gl];for(var d=0;d<a.length;++d){var m=a[d];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var r=n(this);function s(a,d){if(d)e:{var m=r;a=a.split(".");for(var y=0;y<a.length-1;y++){var b=a[y];if(!(b in m))break e;m=m[b]}a=a[a.length-1],y=m[a],d=d(y),d!=y&&d!=null&&e(m,a,{configurable:!0,writable:!0,value:d})}}function i(a,d){a instanceof String&&(a+="");var m=0,y=!1,b={next:function(){if(!y&&m<a.length){var j=m++;return{value:d(j,a[j]),done:!1}}return y=!0,{done:!0,value:void 0}}};return b[Symbol.iterator]=function(){return b},b}s("Array.prototype.values",function(a){return a||function(){return i(this,function(d,m){return m})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(a){var d=typeof a;return d=d!="object"?d:a?Array.isArray(a)?"array":d:"null",d=="array"||d=="object"&&typeof a.length=="number"}function u(a){var d=typeof a;return d=="object"&&a!=null||d=="function"}function f(a,d,m){return a.call.apply(a.bind,arguments)}function p(a,d,m){if(!a)throw Error();if(2<arguments.length){var y=Array.prototype.slice.call(arguments,2);return function(){var b=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(b,y),a.apply(d,b)}}return function(){return a.apply(d,arguments)}}function g(a,d,m){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:p,g.apply(null,arguments)}function w(a,d){var m=Array.prototype.slice.call(arguments,1);return function(){var y=m.slice();return y.push.apply(y,arguments),a.apply(this,y)}}function R(a,d){function m(){}m.prototype=d.prototype,a.aa=d.prototype,a.prototype=new m,a.prototype.constructor=a,a.Qb=function(y,b,j){for(var $=Array(arguments.length-2),ye=2;ye<arguments.length;ye++)$[ye-2]=arguments[ye];return d.prototype[b].apply(y,$)}}function N(a){const d=a.length;if(0<d){const m=Array(d);for(let y=0;y<d;y++)m[y]=a[y];return m}return[]}function P(a,d){for(let m=1;m<arguments.length;m++){const y=arguments[m];if(c(y)){const b=a.length||0,j=y.length||0;a.length=b+j;for(let $=0;$<j;$++)a[b+$]=y[$]}else a.push(y)}}class x{constructor(d,m){this.i=d,this.j=m,this.h=0,this.g=null}get(){let d;return 0<this.h?(this.h--,d=this.g,this.g=d.next,d.next=null):d=this.i(),d}}function v(a){return/^[\s\xa0]*$/.test(a)}function T(){var a=l.navigator;return a&&(a=a.userAgent)?a:""}function D(a){return D[" "](a),a}D[" "]=function(){};var F=T().indexOf("Gecko")!=-1&&!(T().toLowerCase().indexOf("webkit")!=-1&&T().indexOf("Edge")==-1)&&!(T().indexOf("Trident")!=-1||T().indexOf("MSIE")!=-1)&&T().indexOf("Edge")==-1;function z(a,d,m){for(const y in a)d.call(m,a[y],y,a)}function S(a,d){for(const m in a)d.call(void 0,a[m],m,a)}function _(a){const d={};for(const m in a)d[m]=a[m];return d}const I="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function E(a,d){let m,y;for(let b=1;b<arguments.length;b++){y=arguments[b];for(m in y)a[m]=y[m];for(let j=0;j<I.length;j++)m=I[j],Object.prototype.hasOwnProperty.call(y,m)&&(a[m]=y[m])}}function A(a){var d=1;a=a.split(":");const m=[];for(;0<d&&a.length;)m.push(a.shift()),d--;return a.length&&m.push(a.join(":")),m}function k(a){l.setTimeout(()=>{throw a},0)}function C(){var a=G;let d=null;return a.g&&(d=a.g,a.g=a.g.next,a.g||(a.h=null),d.next=null),d}class we{constructor(){this.h=this.g=null}add(d,m){const y=Pt.get();y.set(d,m),this.h?this.h.next=y:this.g=y,this.h=y}}var Pt=new x(()=>new rn,a=>a.reset());class rn{constructor(){this.next=this.g=this.h=null}set(d,m){this.h=d,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let Tt,H=!1,G=new we,q=()=>{const a=l.Promise.resolve(void 0);Tt=()=>{a.then(se)}};var se=()=>{for(var a;a=C();){try{a.h.call(a.g)}catch(m){k(m)}var d=Pt;d.j(a),100>d.h&&(d.h++,a.next=d.g,d.g=a)}H=!1};function ie(){this.s=this.s,this.C=this.C}ie.prototype.s=!1,ie.prototype.ma=function(){this.s||(this.s=!0,this.N())},ie.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ue(a,d){this.type=a,this.g=this.target=d,this.defaultPrevented=!1}ue.prototype.h=function(){this.defaultPrevented=!0};var Be=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var a=!1,d=Object.defineProperty({},"passive",{get:function(){a=!0}});try{const m=()=>{};l.addEventListener("test",m,d),l.removeEventListener("test",m,d)}catch{}return a}();function ze(a,d){if(ue.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var m=this.type=a.type,y=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=d,d=a.relatedTarget){if(F){e:{try{D(d.nodeName);var b=!0;break e}catch{}b=!1}b||(d=null)}}else m=="mouseover"?d=a.fromElement:m=="mouseout"&&(d=a.toElement);this.relatedTarget=d,y?(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:Ie[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&ze.aa.h.call(this)}}R(ze,ue);var Ie={2:"touch",3:"pen",4:"mouse"};ze.prototype.h=function(){ze.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var Qe="closure_listenable_"+(1e6*Math.random()|0),On=0;function fo(a,d,m,y,b){this.listener=a,this.proxy=null,this.src=d,this.type=m,this.capture=!!y,this.ha=b,this.key=++On,this.da=this.fa=!1}function ir(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function or(a){this.src=a,this.g={},this.h=0}or.prototype.add=function(a,d,m,y,b){var j=a.toString();a=this.g[j],a||(a=this.g[j]=[],this.h++);var $=ls(a,d,y,b);return-1<$?(d=a[$],m||(d.fa=!1)):(d=new fo(d,this.src,j,!!y,b),d.fa=m,a.push(d)),d};function as(a,d){var m=d.type;if(m in a.g){var y=a.g[m],b=Array.prototype.indexOf.call(y,d,void 0),j;(j=0<=b)&&Array.prototype.splice.call(y,b,1),j&&(ir(d),a.g[m].length==0&&(delete a.g[m],a.h--))}}function ls(a,d,m,y){for(var b=0;b<a.length;++b){var j=a[b];if(!j.da&&j.listener==d&&j.capture==!!m&&j.ha==y)return b}return-1}var cs="closure_lm_"+(1e6*Math.random()|0),us={};function Ws(a,d,m,y,b){if(y&&y.once)return Ks(a,d,m,y,b);if(Array.isArray(d)){for(var j=0;j<d.length;j++)Ws(a,d[j],m,y,b);return null}return m=yo(m),a&&a[Qe]?a.K(d,m,u(y)?!!y.capture:!!y,b):qs(a,d,m,!1,y,b)}function qs(a,d,m,y,b,j){if(!d)throw Error("Invalid event type");var $=u(b)?!!b.capture:!!b,ye=mo(a);if(ye||(a[cs]=ye=new or(a)),m=ye.add(d,m,y,$,j),m.proxy)return m;if(y=po(),m.proxy=y,y.src=a,y.listener=m,a.addEventListener)Be||(b=$),b===void 0&&(b=!1),a.addEventListener(d.toString(),y,b);else if(a.attachEvent)a.attachEvent(Kt(d.toString()),y);else if(a.addListener&&a.removeListener)a.addListener(y);else throw Error("addEventListener and attachEvent are unavailable.");return m}function po(){function a(m){return d.call(a.src,a.listener,m)}const d=lr;return a}function Ks(a,d,m,y,b){if(Array.isArray(d)){for(var j=0;j<d.length;j++)Ks(a,d[j],m,y,b);return null}return m=yo(m),a&&a[Qe]?a.L(d,m,u(y)?!!y.capture:!!y,b):qs(a,d,m,!0,y,b)}function ar(a,d,m,y,b){if(Array.isArray(d))for(var j=0;j<d.length;j++)ar(a,d[j],m,y,b);else y=u(y)?!!y.capture:!!y,m=yo(m),a&&a[Qe]?(a=a.i,d=String(d).toString(),d in a.g&&(j=a.g[d],m=ls(j,m,y,b),-1<m&&(ir(j[m]),Array.prototype.splice.call(j,m,1),j.length==0&&(delete a.g[d],a.h--)))):a&&(a=mo(a))&&(d=a.g[d.toString()],a=-1,d&&(a=ls(d,m,y,b)),(m=-1<a?d[a]:null)&&Qs(m))}function Qs(a){if(typeof a!="number"&&a&&!a.da){var d=a.src;if(d&&d[Qe])as(d.i,a);else{var m=a.type,y=a.proxy;d.removeEventListener?d.removeEventListener(m,y,a.capture):d.detachEvent?d.detachEvent(Kt(m),y):d.addListener&&d.removeListener&&d.removeListener(y),(m=mo(d))?(as(m,a),m.h==0&&(m.src=null,d[cs]=null)):ir(a)}}}function Kt(a){return a in us?us[a]:us[a]="on"+a}function lr(a,d){if(a.da)a=!0;else{d=new ze(d,this);var m=a.listener,y=a.ha||a.src;a.fa&&Qs(a),a=m.call(y,d)}return a}function mo(a){return a=a[cs],a instanceof or?a:null}var go="__closure_events_fn_"+(1e9*Math.random()>>>0);function yo(a){return typeof a=="function"?a:(a[go]||(a[go]=function(d){return a.handleEvent(d)}),a[go])}function Ze(){ie.call(this),this.i=new or(this),this.M=this,this.F=null}R(Ze,ie),Ze.prototype[Qe]=!0,Ze.prototype.removeEventListener=function(a,d,m,y){ar(this,a,d,m,y)};function st(a,d){var m,y=a.F;if(y)for(m=[];y;y=y.F)m.push(y);if(a=a.M,y=d.type||d,typeof d=="string")d=new ue(d,a);else if(d instanceof ue)d.target=d.target||a;else{var b=d;d=new ue(y,a),E(d,b)}if(b=!0,m)for(var j=m.length-1;0<=j;j--){var $=d.g=m[j];b=Ys($,y,!0,d)&&b}if($=d.g=a,b=Ys($,y,!0,d)&&b,b=Ys($,y,!1,d)&&b,m)for(j=0;j<m.length;j++)$=d.g=m[j],b=Ys($,y,!1,d)&&b}Ze.prototype.N=function(){if(Ze.aa.N.call(this),this.i){var a=this.i,d;for(d in a.g){for(var m=a.g[d],y=0;y<m.length;y++)ir(m[y]);delete a.g[d],a.h--}}this.F=null},Ze.prototype.K=function(a,d,m,y){return this.i.add(String(a),d,!1,m,y)},Ze.prototype.L=function(a,d,m,y){return this.i.add(String(a),d,!0,m,y)};function Ys(a,d,m,y){if(d=a.i.g[String(d)],!d)return!0;d=d.concat();for(var b=!0,j=0;j<d.length;++j){var $=d[j];if($&&!$.da&&$.capture==m){var ye=$.listener,it=$.ha||$.src;$.fa&&as(a.i,$),b=ye.call(it,y)!==!1&&b}}return b&&!y.defaultPrevented}function vo(a,d,m){if(typeof a=="function")m&&(a=g(a,m));else if(a&&typeof a.handleEvent=="function")a=g(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(d)?-1:l.setTimeout(a,d||0)}function _o(a){a.g=vo(()=>{a.g=null,a.i&&(a.i=!1,_o(a))},a.l);const d=a.h;a.h=null,a.m.apply(null,d)}class ll extends ie{constructor(d,m){super(),this.m=d,this.l=m,this.h=null,this.i=!1,this.g=null}j(d){this.h=arguments,this.g?this.i=!0:_o(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function cr(a){ie.call(this),this.h=a,this.g={}}R(cr,ie);var wo=[];function Eo(a){z(a.g,function(d,m){this.g.hasOwnProperty(m)&&Qs(d)},a),a.g={}}cr.prototype.N=function(){cr.aa.N.call(this),Eo(this)},cr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Js=l.JSON.stringify,cl=l.JSON.parse,ul=class{stringify(a){return l.JSON.stringify(a,void 0)}parse(a){return l.JSON.parse(a,void 0)}};function Xs(){}Xs.prototype.h=null;function ds(a){return a.h||(a.h=a.i())}function hs(){}var _n={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function L(){ue.call(this,"d")}R(L,ue);function O(){ue.call(this,"c")}R(O,ue);var Y={},re=null;function Ee(){return re=re||new Ze}Y.La="serverreachability";function te(a){ue.call(this,Y.La,a)}R(te,ue);function Le(a){const d=Ee();st(d,new te(d))}Y.STAT_EVENT="statevent";function ur(a,d){ue.call(this,Y.STAT_EVENT,a),this.stat=d}R(ur,ue);function $e(a){const d=Ee();st(d,new ur(d,a))}Y.Ma="timingevent";function xo(a,d){ue.call(this,Y.Ma,a),this.size=d}R(xo,ue);function To(a,d){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){a()},d)}function So(){this.g=!0}So.prototype.xa=function(){this.g=!1};function ux(a,d,m,y,b,j){a.info(function(){if(a.g)if(j)for(var $="",ye=j.split("&"),it=0;it<ye.length;it++){var pe=ye[it].split("=");if(1<pe.length){var ft=pe[0];pe=pe[1];var pt=ft.split("_");$=2<=pt.length&&pt[1]=="type"?$+(ft+"="+pe+"&"):$+(ft+"=redacted&")}}else $=null;else $=j;return"XMLHTTP REQ ("+y+") [attempt "+b+"]: "+d+`
`+m+`
`+$})}function dx(a,d,m,y,b,j,$){a.info(function(){return"XMLHTTP RESP ("+y+") [ attempt "+b+"]: "+d+`
`+m+`
`+j+" "+$})}function Zs(a,d,m,y){a.info(function(){return"XMLHTTP TEXT ("+d+"): "+fx(a,m)+(y?" "+y:"")})}function hx(a,d){a.info(function(){return"TIMEOUT: "+d})}So.prototype.info=function(){};function fx(a,d){if(!a.g)return d;if(!d)return null;try{var m=JSON.parse(d);if(m){for(a=0;a<m.length;a++)if(Array.isArray(m[a])){var y=m[a];if(!(2>y.length)){var b=y[1];if(Array.isArray(b)&&!(1>b.length)){var j=b[0];if(j!="noop"&&j!="stop"&&j!="close")for(var $=1;$<b.length;$++)b[$]=""}}}}return Js(m)}catch{return d}}var dl={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},km={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ed;function hl(){}R(hl,Xs),hl.prototype.g=function(){return new XMLHttpRequest},hl.prototype.i=function(){return{}},ed=new hl;function dr(a,d,m,y){this.j=a,this.i=d,this.l=m,this.R=y||1,this.U=new cr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new bm}function bm(){this.i=null,this.g="",this.h=!1}var Dm={},td={};function nd(a,d,m){a.L=1,a.v=gl(Vn(d)),a.m=m,a.P=!0,jm(a,null)}function jm(a,d){a.F=Date.now(),fl(a),a.A=Vn(a.v);var m=a.A,y=a.R;Array.isArray(y)||(y=[String(y)]),Km(m.i,"t",y),a.C=0,m=a.j.J,a.h=new bm,a.g=hg(a.j,m?d:null,!a.m),0<a.O&&(a.M=new ll(g(a.Y,a,a.g),a.O)),d=a.U,m=a.g,y=a.ca;var b="readystatechange";Array.isArray(b)||(b&&(wo[0]=b.toString()),b=wo);for(var j=0;j<b.length;j++){var $=Ws(m,b[j],y||d.handleEvent,!1,d.h||d);if(!$)break;d.g[$.key]=$}d=a.H?_(a.H):{},a.m?(a.u||(a.u="POST"),d["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,d)):(a.u="GET",a.g.ea(a.A,a.u,null,d)),Le(),ux(a.i,a.u,a.A,a.l,a.R,a.m)}dr.prototype.ca=function(a){a=a.target;const d=this.M;d&&Ln(a)==3?d.j():this.Y(a)},dr.prototype.Y=function(a){try{if(a==this.g)e:{const pt=Ln(this.g);var d=this.g.Ba();const ni=this.g.Z();if(!(3>pt)&&(pt!=3||this.g&&(this.h.h||this.g.oa()||tg(this.g)))){this.J||pt!=4||d==7||(d==8||0>=ni?Le(3):Le(2)),rd(this);var m=this.g.Z();this.X=m;t:if(Om(this)){var y=tg(this.g);a="";var b=y.length,j=Ln(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){fs(this),Io(this);var $="";break t}this.h.i=new l.TextDecoder}for(d=0;d<b;d++)this.h.h=!0,a+=this.h.i.decode(y[d],{stream:!(j&&d==b-1)});y.length=0,this.h.g+=a,this.C=0,$=this.h.g}else $=this.g.oa();if(this.o=m==200,dx(this.i,this.u,this.A,this.l,this.R,pt,m),this.o){if(this.T&&!this.K){t:{if(this.g){var ye,it=this.g;if((ye=it.g?it.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!v(ye)){var pe=ye;break t}}pe=null}if(m=pe)Zs(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,sd(this,m);else{this.o=!1,this.s=3,$e(12),fs(this),Io(this);break e}}if(this.P){m=!0;let sn;for(;!this.J&&this.C<$.length;)if(sn=px(this,$),sn==td){pt==4&&(this.s=4,$e(14),m=!1),Zs(this.i,this.l,null,"[Incomplete Response]");break}else if(sn==Dm){this.s=4,$e(15),Zs(this.i,this.l,$,"[Invalid Chunk]"),m=!1;break}else Zs(this.i,this.l,sn,null),sd(this,sn);if(Om(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),pt!=4||$.length!=0||this.h.h||(this.s=1,$e(16),m=!1),this.o=this.o&&m,!m)Zs(this.i,this.l,$,"[Invalid Chunked Response]"),fs(this),Io(this);else if(0<$.length&&!this.W){this.W=!0;var ft=this.j;ft.g==this&&ft.ba&&!ft.M&&(ft.j.info("Great, no buffering proxy detected. Bytes received: "+$.length),ud(ft),ft.M=!0,$e(11))}}else Zs(this.i,this.l,$,null),sd(this,$);pt==4&&fs(this),this.o&&!this.J&&(pt==4?lg(this.j,this):(this.o=!1,fl(this)))}else kx(this.g),m==400&&0<$.indexOf("Unknown SID")?(this.s=3,$e(12)):(this.s=0,$e(13)),fs(this),Io(this)}}}catch{}finally{}};function Om(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function px(a,d){var m=a.C,y=d.indexOf(`
`,m);return y==-1?td:(m=Number(d.substring(m,y)),isNaN(m)?Dm:(y+=1,y+m>d.length?td:(d=d.slice(y,y+m),a.C=y+m,d)))}dr.prototype.cancel=function(){this.J=!0,fs(this)};function fl(a){a.S=Date.now()+a.I,Vm(a,a.I)}function Vm(a,d){if(a.B!=null)throw Error("WatchDog timer not null");a.B=To(g(a.ba,a),d)}function rd(a){a.B&&(l.clearTimeout(a.B),a.B=null)}dr.prototype.ba=function(){this.B=null;const a=Date.now();0<=a-this.S?(hx(this.i,this.A),this.L!=2&&(Le(),$e(17)),fs(this),this.s=2,Io(this)):Vm(this,this.S-a)};function Io(a){a.j.G==0||a.J||lg(a.j,a)}function fs(a){rd(a);var d=a.M;d&&typeof d.ma=="function"&&d.ma(),a.M=null,Eo(a.U),a.g&&(d=a.g,a.g=null,d.abort(),d.ma())}function sd(a,d){try{var m=a.j;if(m.G!=0&&(m.g==a||id(m.h,a))){if(!a.K&&id(m.h,a)&&m.G==3){try{var y=m.Da.g.parse(d)}catch{y=null}if(Array.isArray(y)&&y.length==3){var b=y;if(b[0]==0){e:if(!m.u){if(m.g)if(m.g.F+3e3<a.F)xl(m),wl(m);else break e;cd(m),$e(18)}}else m.za=b[1],0<m.za-m.T&&37500>b[2]&&m.F&&m.v==0&&!m.C&&(m.C=To(g(m.Za,m),6e3));if(1>=Um(m.h)&&m.ca){try{m.ca()}catch{}m.ca=void 0}}else ms(m,11)}else if((a.K||m.g==a)&&xl(m),!v(d))for(b=m.Da.g.parse(d),d=0;d<b.length;d++){let pe=b[d];if(m.T=pe[0],pe=pe[1],m.G==2)if(pe[0]=="c"){m.K=pe[1],m.ia=pe[2];const ft=pe[3];ft!=null&&(m.la=ft,m.j.info("VER="+m.la));const pt=pe[4];pt!=null&&(m.Aa=pt,m.j.info("SVER="+m.Aa));const ni=pe[5];ni!=null&&typeof ni=="number"&&0<ni&&(y=1.5*ni,m.L=y,m.j.info("backChannelRequestTimeoutMs_="+y)),y=m;const sn=a.g;if(sn){const Sl=sn.g?sn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Sl){var j=y.h;j.g||Sl.indexOf("spdy")==-1&&Sl.indexOf("quic")==-1&&Sl.indexOf("h2")==-1||(j.j=j.l,j.g=new Set,j.h&&(od(j,j.h),j.h=null))}if(y.D){const dd=sn.g?sn.g.getResponseHeader("X-HTTP-Session-Id"):null;dd&&(y.ya=dd,xe(y.I,y.D,dd))}}m.G=3,m.l&&m.l.ua(),m.ba&&(m.R=Date.now()-a.F,m.j.info("Handshake RTT: "+m.R+"ms")),y=m;var $=a;if(y.qa=dg(y,y.J?y.ia:null,y.W),$.K){Fm(y.h,$);var ye=$,it=y.L;it&&(ye.I=it),ye.B&&(rd(ye),fl(ye)),y.g=$}else og(y);0<m.i.length&&El(m)}else pe[0]!="stop"&&pe[0]!="close"||ms(m,7);else m.G==3&&(pe[0]=="stop"||pe[0]=="close"?pe[0]=="stop"?ms(m,7):ld(m):pe[0]!="noop"&&m.l&&m.l.ta(pe),m.v=0)}}Le(4)}catch{}}var mx=class{constructor(a,d){this.g=a,this.map=d}};function Lm(a){this.l=a||10,l.PerformanceNavigationTiming?(a=l.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Mm(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function Um(a){return a.h?1:a.g?a.g.size:0}function id(a,d){return a.h?a.h==d:a.g?a.g.has(d):!1}function od(a,d){a.g?a.g.add(d):a.h=d}function Fm(a,d){a.h&&a.h==d?a.h=null:a.g&&a.g.has(d)&&a.g.delete(d)}Lm.prototype.cancel=function(){if(this.i=Bm(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const a of this.g.values())a.cancel();this.g.clear()}};function Bm(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let d=a.i;for(const m of a.g.values())d=d.concat(m.D);return d}return N(a.i)}function gx(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(c(a)){for(var d=[],m=a.length,y=0;y<m;y++)d.push(a[y]);return d}d=[],m=0;for(y in a)d[m++]=a[y];return d}function yx(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(c(a)||typeof a=="string"){var d=[];a=a.length;for(var m=0;m<a;m++)d.push(m);return d}d=[],m=0;for(const y in a)d[m++]=y;return d}}}function zm(a,d){if(a.forEach&&typeof a.forEach=="function")a.forEach(d,void 0);else if(c(a)||typeof a=="string")Array.prototype.forEach.call(a,d,void 0);else for(var m=yx(a),y=gx(a),b=y.length,j=0;j<b;j++)d.call(void 0,y[j],m&&m[j],a)}var $m=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function vx(a,d){if(a){a=a.split("&");for(var m=0;m<a.length;m++){var y=a[m].indexOf("="),b=null;if(0<=y){var j=a[m].substring(0,y);b=a[m].substring(y+1)}else j=a[m];d(j,b?decodeURIComponent(b.replace(/\+/g," ")):"")}}}function ps(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof ps){this.h=a.h,pl(this,a.j),this.o=a.o,this.g=a.g,ml(this,a.s),this.l=a.l;var d=a.i,m=new No;m.i=d.i,d.g&&(m.g=new Map(d.g),m.h=d.h),Gm(this,m),this.m=a.m}else a&&(d=String(a).match($m))?(this.h=!1,pl(this,d[1]||"",!0),this.o=Ro(d[2]||""),this.g=Ro(d[3]||"",!0),ml(this,d[4]),this.l=Ro(d[5]||"",!0),Gm(this,d[6]||"",!0),this.m=Ro(d[7]||"")):(this.h=!1,this.i=new No(null,this.h))}ps.prototype.toString=function(){var a=[],d=this.j;d&&a.push(Co(d,Hm,!0),":");var m=this.g;return(m||d=="file")&&(a.push("//"),(d=this.o)&&a.push(Co(d,Hm,!0),"@"),a.push(encodeURIComponent(String(m)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.s,m!=null&&a.push(":",String(m))),(m=this.l)&&(this.g&&m.charAt(0)!="/"&&a.push("/"),a.push(Co(m,m.charAt(0)=="/"?Ex:wx,!0))),(m=this.i.toString())&&a.push("?",m),(m=this.m)&&a.push("#",Co(m,Tx)),a.join("")};function Vn(a){return new ps(a)}function pl(a,d,m){a.j=m?Ro(d,!0):d,a.j&&(a.j=a.j.replace(/:$/,""))}function ml(a,d){if(d){if(d=Number(d),isNaN(d)||0>d)throw Error("Bad port number "+d);a.s=d}else a.s=null}function Gm(a,d,m){d instanceof No?(a.i=d,Sx(a.i,a.h)):(m||(d=Co(d,xx)),a.i=new No(d,a.h))}function xe(a,d,m){a.i.set(d,m)}function gl(a){return xe(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function Ro(a,d){return a?d?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function Co(a,d,m){return typeof a=="string"?(a=encodeURI(a).replace(d,_x),m&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function _x(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Hm=/[#\/\?@]/g,wx=/[#\?:]/g,Ex=/[#\?]/g,xx=/[#\?@]/g,Tx=/#/g;function No(a,d){this.h=this.g=null,this.i=a||null,this.j=!!d}function hr(a){a.g||(a.g=new Map,a.h=0,a.i&&vx(a.i,function(d,m){a.add(decodeURIComponent(d.replace(/\+/g," ")),m)}))}t=No.prototype,t.add=function(a,d){hr(this),this.i=null,a=ei(this,a);var m=this.g.get(a);return m||this.g.set(a,m=[]),m.push(d),this.h+=1,this};function Wm(a,d){hr(a),d=ei(a,d),a.g.has(d)&&(a.i=null,a.h-=a.g.get(d).length,a.g.delete(d))}function qm(a,d){return hr(a),d=ei(a,d),a.g.has(d)}t.forEach=function(a,d){hr(this),this.g.forEach(function(m,y){m.forEach(function(b){a.call(d,b,y,this)},this)},this)},t.na=function(){hr(this);const a=Array.from(this.g.values()),d=Array.from(this.g.keys()),m=[];for(let y=0;y<d.length;y++){const b=a[y];for(let j=0;j<b.length;j++)m.push(d[y])}return m},t.V=function(a){hr(this);let d=[];if(typeof a=="string")qm(this,a)&&(d=d.concat(this.g.get(ei(this,a))));else{a=Array.from(this.g.values());for(let m=0;m<a.length;m++)d=d.concat(a[m])}return d},t.set=function(a,d){return hr(this),this.i=null,a=ei(this,a),qm(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[d]),this.h+=1,this},t.get=function(a,d){return a?(a=this.V(a),0<a.length?String(a[0]):d):d};function Km(a,d,m){Wm(a,d),0<m.length&&(a.i=null,a.g.set(ei(a,d),N(m)),a.h+=m.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const a=[],d=Array.from(this.g.keys());for(var m=0;m<d.length;m++){var y=d[m];const j=encodeURIComponent(String(y)),$=this.V(y);for(y=0;y<$.length;y++){var b=j;$[y]!==""&&(b+="="+encodeURIComponent(String($[y]))),a.push(b)}}return this.i=a.join("&")};function ei(a,d){return d=String(d),a.j&&(d=d.toLowerCase()),d}function Sx(a,d){d&&!a.j&&(hr(a),a.i=null,a.g.forEach(function(m,y){var b=y.toLowerCase();y!=b&&(Wm(this,y),Km(this,b,m))},a)),a.j=d}function Ix(a,d){const m=new So;if(l.Image){const y=new Image;y.onload=w(fr,m,"TestLoadImage: loaded",!0,d,y),y.onerror=w(fr,m,"TestLoadImage: error",!1,d,y),y.onabort=w(fr,m,"TestLoadImage: abort",!1,d,y),y.ontimeout=w(fr,m,"TestLoadImage: timeout",!1,d,y),l.setTimeout(function(){y.ontimeout&&y.ontimeout()},1e4),y.src=a}else d(!1)}function Rx(a,d){const m=new So,y=new AbortController,b=setTimeout(()=>{y.abort(),fr(m,"TestPingServer: timeout",!1,d)},1e4);fetch(a,{signal:y.signal}).then(j=>{clearTimeout(b),j.ok?fr(m,"TestPingServer: ok",!0,d):fr(m,"TestPingServer: server error",!1,d)}).catch(()=>{clearTimeout(b),fr(m,"TestPingServer: error",!1,d)})}function fr(a,d,m,y,b){try{b&&(b.onload=null,b.onerror=null,b.onabort=null,b.ontimeout=null),y(m)}catch{}}function Cx(){this.g=new ul}function Nx(a,d,m){const y=m||"";try{zm(a,function(b,j){let $=b;u(b)&&($=Js(b)),d.push(y+j+"="+encodeURIComponent($))})}catch(b){throw d.push(y+"type="+encodeURIComponent("_badmap")),b}}function yl(a){this.l=a.Ub||null,this.j=a.eb||!1}R(yl,Xs),yl.prototype.g=function(){return new vl(this.l,this.j)},yl.prototype.i=function(a){return function(){return a}}({});function vl(a,d){Ze.call(this),this.D=a,this.o=d,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}R(vl,Ze),t=vl.prototype,t.open=function(a,d){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=d,this.readyState=1,Po(this)},t.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const d={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(d.body=a),(this.D||l).fetch(new Request(this.A,d)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ao(this)),this.readyState=0},t.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,Po(this)),this.g&&(this.readyState=3,Po(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Qm(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function Qm(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}t.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var d=a.value?a.value:new Uint8Array(0);(d=this.v.decode(d,{stream:!a.done}))&&(this.response=this.responseText+=d)}a.done?Ao(this):Po(this),this.readyState==3&&Qm(this)}},t.Ra=function(a){this.g&&(this.response=this.responseText=a,Ao(this))},t.Qa=function(a){this.g&&(this.response=a,Ao(this))},t.ga=function(){this.g&&Ao(this)};function Ao(a){a.readyState=4,a.l=null,a.j=null,a.v=null,Po(a)}t.setRequestHeader=function(a,d){this.u.append(a,d)},t.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const a=[],d=this.h.entries();for(var m=d.next();!m.done;)m=m.value,a.push(m[0]+": "+m[1]),m=d.next();return a.join(`\r
`)};function Po(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(vl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function Ym(a){let d="";return z(a,function(m,y){d+=y,d+=":",d+=m,d+=`\r
`}),d}function ad(a,d,m){e:{for(y in m){var y=!1;break e}y=!0}y||(m=Ym(m),typeof a=="string"?m!=null&&encodeURIComponent(String(m)):xe(a,d,m))}function be(a){Ze.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}R(be,Ze);var Ax=/^https?$/i,Px=["POST","PUT"];t=be.prototype,t.Ha=function(a){this.J=a},t.ea=function(a,d,m,y){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);d=d?d.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ed.g(),this.v=this.o?ds(this.o):ds(ed),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(d,String(a),!0),this.B=!1}catch(j){Jm(this,j);return}if(a=m||"",m=new Map(this.headers),y)if(Object.getPrototypeOf(y)===Object.prototype)for(var b in y)m.set(b,y[b]);else if(typeof y.keys=="function"&&typeof y.get=="function")for(const j of y.keys())m.set(j,y.get(j));else throw Error("Unknown input type for opt_headers: "+String(y));y=Array.from(m.keys()).find(j=>j.toLowerCase()=="content-type"),b=l.FormData&&a instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Px,d,void 0))||y||b||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[j,$]of m)this.g.setRequestHeader(j,$);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{eg(this),this.u=!0,this.g.send(a),this.u=!1}catch(j){Jm(this,j)}};function Jm(a,d){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=d,a.m=5,Xm(a),_l(a)}function Xm(a){a.A||(a.A=!0,st(a,"complete"),st(a,"error"))}t.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,st(this,"complete"),st(this,"abort"),_l(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),_l(this,!0)),be.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Zm(this):this.bb())},t.bb=function(){Zm(this)};function Zm(a){if(a.h&&typeof o<"u"&&(!a.v[1]||Ln(a)!=4||a.Z()!=2)){if(a.u&&Ln(a)==4)vo(a.Ea,0,a);else if(st(a,"readystatechange"),Ln(a)==4){a.h=!1;try{const $=a.Z();e:switch($){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var d=!0;break e;default:d=!1}var m;if(!(m=d)){var y;if(y=$===0){var b=String(a.D).match($m)[1]||null;!b&&l.self&&l.self.location&&(b=l.self.location.protocol.slice(0,-1)),y=!Ax.test(b?b.toLowerCase():"")}m=y}if(m)st(a,"complete"),st(a,"success");else{a.m=6;try{var j=2<Ln(a)?a.g.statusText:""}catch{j=""}a.l=j+" ["+a.Z()+"]",Xm(a)}}finally{_l(a)}}}}function _l(a,d){if(a.g){eg(a);const m=a.g,y=a.v[0]?()=>{}:null;a.g=null,a.v=null,d||st(a,"ready");try{m.onreadystatechange=y}catch{}}}function eg(a){a.I&&(l.clearTimeout(a.I),a.I=null)}t.isActive=function(){return!!this.g};function Ln(a){return a.g?a.g.readyState:0}t.Z=function(){try{return 2<Ln(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(a){if(this.g){var d=this.g.responseText;return a&&d.indexOf(a)==0&&(d=d.substring(a.length)),cl(d)}};function tg(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function kx(a){const d={};a=(a.g&&2<=Ln(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let y=0;y<a.length;y++){if(v(a[y]))continue;var m=A(a[y]);const b=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();const j=d[b]||[];d[b]=j,j.push(m)}S(d,function(y){return y.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ko(a,d,m){return m&&m.internalChannelParams&&m.internalChannelParams[a]||d}function ng(a){this.Aa=0,this.i=[],this.j=new So,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ko("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ko("baseRetryDelayMs",5e3,a),this.cb=ko("retryDelaySeedMs",1e4,a),this.Wa=ko("forwardChannelMaxRetries",2,a),this.wa=ko("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new Lm(a&&a.concurrentRequestLimit),this.Da=new Cx,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=ng.prototype,t.la=8,t.G=1,t.connect=function(a,d,m,y){$e(0),this.W=a,this.H=d||{},m&&y!==void 0&&(this.H.OSID=m,this.H.OAID=y),this.F=this.X,this.I=dg(this,null,this.W),El(this)};function ld(a){if(rg(a),a.G==3){var d=a.U++,m=Vn(a.I);if(xe(m,"SID",a.K),xe(m,"RID",d),xe(m,"TYPE","terminate"),bo(a,m),d=new dr(a,a.j,d),d.L=2,d.v=gl(Vn(m)),m=!1,l.navigator&&l.navigator.sendBeacon)try{m=l.navigator.sendBeacon(d.v.toString(),"")}catch{}!m&&l.Image&&(new Image().src=d.v,m=!0),m||(d.g=hg(d.j,null),d.g.ea(d.v)),d.F=Date.now(),fl(d)}ug(a)}function wl(a){a.g&&(ud(a),a.g.cancel(),a.g=null)}function rg(a){wl(a),a.u&&(l.clearTimeout(a.u),a.u=null),xl(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&l.clearTimeout(a.s),a.s=null)}function El(a){if(!Mm(a.h)&&!a.s){a.s=!0;var d=a.Ga;Tt||q(),H||(Tt(),H=!0),G.add(d,a),a.B=0}}function bx(a,d){return Um(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=d.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=To(g(a.Ga,a,d),cg(a,a.B)),a.B++,!0)}t.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;const b=new dr(this,this.j,a);let j=this.o;if(this.S&&(j?(j=_(j),E(j,this.S)):j=this.S),this.m!==null||this.O||(b.H=j,j=null),this.P)e:{for(var d=0,m=0;m<this.i.length;m++){t:{var y=this.i[m];if("__data__"in y.map&&(y=y.map.__data__,typeof y=="string")){y=y.length;break t}y=void 0}if(y===void 0)break;if(d+=y,4096<d){d=m;break e}if(d===4096||m===this.i.length-1){d=m+1;break e}}d=1e3}else d=1e3;d=ig(this,b,d),m=Vn(this.I),xe(m,"RID",a),xe(m,"CVER",22),this.D&&xe(m,"X-HTTP-Session-Id",this.D),bo(this,m),j&&(this.O?d="headers="+encodeURIComponent(String(Ym(j)))+"&"+d:this.m&&ad(m,this.m,j)),od(this.h,b),this.Ua&&xe(m,"TYPE","init"),this.P?(xe(m,"$req",d),xe(m,"SID","null"),b.T=!0,nd(b,m,null)):nd(b,m,d),this.G=2}}else this.G==3&&(a?sg(this,a):this.i.length==0||Mm(this.h)||sg(this))};function sg(a,d){var m;d?m=d.l:m=a.U++;const y=Vn(a.I);xe(y,"SID",a.K),xe(y,"RID",m),xe(y,"AID",a.T),bo(a,y),a.m&&a.o&&ad(y,a.m,a.o),m=new dr(a,a.j,m,a.B+1),a.m===null&&(m.H=a.o),d&&(a.i=d.D.concat(a.i)),d=ig(a,m,1e3),m.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),od(a.h,m),nd(m,y,d)}function bo(a,d){a.H&&z(a.H,function(m,y){xe(d,y,m)}),a.l&&zm({},function(m,y){xe(d,y,m)})}function ig(a,d,m){m=Math.min(a.i.length,m);var y=a.l?g(a.l.Na,a.l,a):null;e:{var b=a.i;let j=-1;for(;;){const $=["count="+m];j==-1?0<m?(j=b[0].g,$.push("ofs="+j)):j=0:$.push("ofs="+j);let ye=!0;for(let it=0;it<m;it++){let pe=b[it].g;const ft=b[it].map;if(pe-=j,0>pe)j=Math.max(0,b[it].g-100),ye=!1;else try{Nx(ft,$,"req"+pe+"_")}catch{y&&y(ft)}}if(ye){y=$.join("&");break e}}}return a=a.i.splice(0,m),d.D=a,y}function og(a){if(!a.g&&!a.u){a.Y=1;var d=a.Fa;Tt||q(),H||(Tt(),H=!0),G.add(d,a),a.v=0}}function cd(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=To(g(a.Fa,a),cg(a,a.v)),a.v++,!0)}t.Fa=function(){if(this.u=null,ag(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=To(g(this.ab,this),a)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,$e(10),wl(this),ag(this))};function ud(a){a.A!=null&&(l.clearTimeout(a.A),a.A=null)}function ag(a){a.g=new dr(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var d=Vn(a.qa);xe(d,"RID","rpc"),xe(d,"SID",a.K),xe(d,"AID",a.T),xe(d,"CI",a.F?"0":"1"),!a.F&&a.ja&&xe(d,"TO",a.ja),xe(d,"TYPE","xmlhttp"),bo(a,d),a.m&&a.o&&ad(d,a.m,a.o),a.L&&(a.g.I=a.L);var m=a.g;a=a.ia,m.L=1,m.v=gl(Vn(d)),m.m=null,m.P=!0,jm(m,a)}t.Za=function(){this.C!=null&&(this.C=null,wl(this),cd(this),$e(19))};function xl(a){a.C!=null&&(l.clearTimeout(a.C),a.C=null)}function lg(a,d){var m=null;if(a.g==d){xl(a),ud(a),a.g=null;var y=2}else if(id(a.h,d))m=d.D,Fm(a.h,d),y=1;else return;if(a.G!=0){if(d.o)if(y==1){m=d.m?d.m.length:0,d=Date.now()-d.F;var b=a.B;y=Ee(),st(y,new xo(y,m)),El(a)}else og(a);else if(b=d.s,b==3||b==0&&0<d.X||!(y==1&&bx(a,d)||y==2&&cd(a)))switch(m&&0<m.length&&(d=a.h,d.i=d.i.concat(m)),b){case 1:ms(a,5);break;case 4:ms(a,10);break;case 3:ms(a,6);break;default:ms(a,2)}}}function cg(a,d){let m=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(m*=2),m*d}function ms(a,d){if(a.j.info("Error code "+d),d==2){var m=g(a.fb,a),y=a.Xa;const b=!y;y=new ps(y||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||pl(y,"https"),gl(y),b?Ix(y.toString(),m):Rx(y.toString(),m)}else $e(2);a.G=0,a.l&&a.l.sa(d),ug(a),rg(a)}t.fb=function(a){a?(this.j.info("Successfully pinged google.com"),$e(2)):(this.j.info("Failed to ping google.com"),$e(1))};function ug(a){if(a.G=0,a.ka=[],a.l){const d=Bm(a.h);(d.length!=0||a.i.length!=0)&&(P(a.ka,d),P(a.ka,a.i),a.h.i.length=0,N(a.i),a.i.length=0),a.l.ra()}}function dg(a,d,m){var y=m instanceof ps?Vn(m):new ps(m);if(y.g!="")d&&(y.g=d+"."+y.g),ml(y,y.s);else{var b=l.location;y=b.protocol,d=d?d+"."+b.hostname:b.hostname,b=+b.port;var j=new ps(null);y&&pl(j,y),d&&(j.g=d),b&&ml(j,b),m&&(j.l=m),y=j}return m=a.D,d=a.ya,m&&d&&xe(y,m,d),xe(y,"VER",a.la),bo(a,y),y}function hg(a,d,m){if(d&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return d=a.Ca&&!a.pa?new be(new yl({eb:m})):new be(a.pa),d.Ha(a.J),d}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function fg(){}t=fg.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Tl(){}Tl.prototype.g=function(a,d){return new Mt(a,d)};function Mt(a,d){Ze.call(this),this.g=new ng(d),this.l=a,this.h=d&&d.messageUrlParams||null,a=d&&d.messageHeaders||null,d&&d.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=d&&d.initMessageHeaders||null,d&&d.messageContentType&&(a?a["X-WebChannel-Content-Type"]=d.messageContentType:a={"X-WebChannel-Content-Type":d.messageContentType}),d&&d.va&&(a?a["X-WebChannel-Client-Profile"]=d.va:a={"X-WebChannel-Client-Profile":d.va}),this.g.S=a,(a=d&&d.Sb)&&!v(a)&&(this.g.m=a),this.v=d&&d.supportsCrossDomainXhr||!1,this.u=d&&d.sendRawJson||!1,(d=d&&d.httpSessionIdParam)&&!v(d)&&(this.g.D=d,a=this.h,a!==null&&d in a&&(a=this.h,d in a&&delete a[d])),this.j=new ti(this)}R(Mt,Ze),Mt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Mt.prototype.close=function(){ld(this.g)},Mt.prototype.o=function(a){var d=this.g;if(typeof a=="string"){var m={};m.__data__=a,a=m}else this.u&&(m={},m.__data__=Js(a),a=m);d.i.push(new mx(d.Ya++,a)),d.G==3&&El(d)},Mt.prototype.N=function(){this.g.l=null,delete this.j,ld(this.g),delete this.g,Mt.aa.N.call(this)};function pg(a){L.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var d=a.__sm__;if(d){e:{for(const m in d){a=m;break e}a=void 0}(this.i=a)&&(a=this.i,d=d!==null&&a in d?d[a]:void 0),this.data=d}else this.data=a}R(pg,L);function mg(){O.call(this),this.status=1}R(mg,O);function ti(a){this.g=a}R(ti,fg),ti.prototype.ua=function(){st(this.g,"a")},ti.prototype.ta=function(a){st(this.g,new pg(a))},ti.prototype.sa=function(a){st(this.g,new mg)},ti.prototype.ra=function(){st(this.g,"b")},Tl.prototype.createWebChannel=Tl.prototype.g,Mt.prototype.send=Mt.prototype.o,Mt.prototype.open=Mt.prototype.m,Mt.prototype.close=Mt.prototype.close,Ow=function(){return new Tl},jw=function(){return Ee()},Dw=Y,cf={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},dl.NO_ERROR=0,dl.TIMEOUT=8,dl.HTTP_ERROR=6,fc=dl,km.COMPLETE="complete",bw=km,hs.EventType=_n,_n.OPEN="a",_n.CLOSE="b",_n.ERROR="c",_n.MESSAGE="d",Ze.prototype.listen=Ze.prototype.K,qo=hs,be.prototype.listenOnce=be.prototype.L,be.prototype.getLastError=be.prototype.Ka,be.prototype.getLastErrorCode=be.prototype.Ba,be.prototype.getStatus=be.prototype.Z,be.prototype.getResponseJson=be.prototype.Oa,be.prototype.getResponseText=be.prototype.oa,be.prototype.send=be.prototype.ea,be.prototype.setWithCredentials=be.prototype.Ha,kw=be}).apply(typeof Gl<"u"?Gl:typeof self<"u"?self:typeof window<"u"?window:{});const uv="@firebase/firestore",dv="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}vt.UNAUTHENTICATED=new vt(null),vt.GOOGLE_CREDENTIALS=new vt("google-credentials-uid"),vt.FIRST_PARTY=new vt("first-party-uid"),vt.MOCK_USER=new vt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let so="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ms=new kp("@firebase/firestore");function li(){return Ms.logLevel}function K(t,...e){if(Ms.logLevel<=ae.DEBUG){const n=e.map($p);Ms.debug(`Firestore (${so}): ${t}`,...n)}}function er(t,...e){if(Ms.logLevel<=ae.ERROR){const n=e.map($p);Ms.error(`Firestore (${so}): ${t}`,...n)}}function Gi(t,...e){if(Ms.logLevel<=ae.WARN){const n=e.map($p);Ms.warn(`Firestore (${so}): ${t}`,...n)}}function $p(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,Vw(t,r,n)}function Vw(t,e,n){let r=`FIRESTORE (${so}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw er(r),new Error(r)}function me(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||Vw(e,s,r)}function ee(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class W extends sr{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lw{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class VA{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(vt.UNAUTHENTICATED))}shutdown(){}}class LA{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class MA{constructor(e){this.t=e,this.currentUser=vt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){me(this.o===void 0,42304);let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new qn;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new qn,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},l=c=>{K("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(K("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new qn)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(K("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(me(typeof r.accessToken=="string",31837,{l:r}),new Lw(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return me(e===null||typeof e=="string",2055,{h:e}),new vt(e)}}class UA{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=vt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class FA{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new UA(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(vt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class hv{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class BA{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,dn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){me(this.o===void 0,3512);const r=i=>{i.error!=null&&K("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,K("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{K("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):K("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new hv(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(me(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new hv(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zA(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gp{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=zA(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function le(t,e){return t<e?-1:t>e?1:0}function uf(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const s=t.charAt(r),i=e.charAt(r);if(s!==i)return Kd(s)===Kd(i)?le(s,i):Kd(s)?1:-1}return le(t.length,e.length)}const $A=55296,GA=57343;function Kd(t){const e=t.charCodeAt(0);return e>=$A&&e<=GA}function Hi(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fv="__name__";class xn{constructor(e,n,r){n===void 0?n=0:n>e.length&&X(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&X(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return xn.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof xn?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=xn.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return le(e.length,n.length)}static compareSegments(e,n){const r=xn.isNumericId(e),s=xn.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?xn.extractNumericId(e).compare(xn.extractNumericId(n)):uf(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Br.fromString(e.substring(4,e.length-2))}}class ve extends xn{construct(e,n,r){return new ve(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new W(V.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new ve(n)}static emptyPath(){return new ve([])}}const HA=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ct extends xn{construct(e,n,r){return new ct(e,n,r)}static isValidIdentifier(e){return HA.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ct.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===fv}static keyField(){return new ct([fv])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new W(V.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new W(V.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new W(V.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(r+=l,s++):(i(),s++)}if(i(),o)throw new W(V.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ct(n)}static emptyPath(){return new ct([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J{constructor(e){this.path=e}static fromPath(e){return new J(ve.fromString(e))}static fromName(e){return new J(ve.fromString(e).popFirst(5))}static empty(){return new J(ve.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ve.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ve.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new J(new ve(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mw(t,e,n){if(!n)throw new W(V.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function WA(t,e,n,r){if(e===!0&&r===!0)throw new W(V.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function pv(t){if(!J.isDocumentKey(t))throw new W(V.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function mv(t){if(J.isDocumentKey(t))throw new W(V.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Uw(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Uu(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":X(12329,{type:typeof t})}function Ct(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new W(V.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Uu(t);throw new W(V.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ke(t,e){const n={typeString:t};return e&&(n.value=e),n}function nl(t,e){if(!Uw(t))throw new W(V.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(s&&typeof o!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new W(V.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gv=-62135596800,yv=1e6;class he{static now(){return he.fromMillis(Date.now())}static fromDate(e){return he.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*yv);return new he(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new W(V.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new W(V.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<gv)throw new W(V.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new W(V.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/yv}_compareTo(e){return this.seconds===e.seconds?le(this.nanoseconds,e.nanoseconds):le(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:he._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(nl(e,he._jsonSchema))return new he(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-gv;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}he._jsonSchemaVersion="firestore/timestamp/1.0",he._jsonSchema={type:Ke("string",he._jsonSchemaVersion),seconds:Ke("number"),nanoseconds:Ke("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ne{static fromTimestamp(e){return new ne(e)}static min(){return new ne(new he(0,0))}static max(){return new ne(new he(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Va=-1;function qA(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=ne.fromTimestamp(r===1e9?new he(n+1,0):new he(n,r));return new Wr(s,J.empty(),e)}function KA(t){return new Wr(t.readTime,t.key,Va)}class Wr{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Wr(ne.min(),J.empty(),Va)}static max(){return new Wr(ne.max(),J.empty(),Va)}}function QA(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=J.comparator(t.documentKey,e.documentKey),n!==0?n:le(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YA="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class JA{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function io(t){if(t.code!==V.FAILED_PRECONDITION||t.message!==YA)throw t;K("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&X(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new U((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof U?n:U.resolve(n)}catch(n){return U.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):U.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):U.reject(n)}static resolve(e){return new U((n,r)=>{n(e)})}static reject(e){return new U((n,r)=>{r(e)})}static waitFor(e){return new U((n,r)=>{let s=0,i=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++i,o&&i===s&&n()},c=>r(c))}),o=!0,i===s&&n()})}static or(e){let n=U.resolve(!1);for(const r of e)n=n.next(s=>s?U.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new U((r,s)=>{const i=e.length,o=new Array(i);let l=0;for(let c=0;c<i;c++){const u=c;n(e[u]).next(f=>{o[u]=f,++l,l===i&&r(o)},f=>s(f))}})}static doWhile(e,n){return new U((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function XA(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function oo(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fu{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Fu.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hp=-1;function Bu(t){return t==null}function ru(t){return t===0&&1/t==-1/0}function ZA(t){return typeof t=="number"&&Number.isInteger(t)&&!ru(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fw="";function eP(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=vv(e)),e=tP(t.get(n),e);return vv(e)}function tP(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case Fw:n+="";break;default:n+=i}}return n}function vv(t){return t+Fw+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _v(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function rs(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Bw(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ke{constructor(e,n){this.comparator=e,this.root=n||lt.EMPTY}insert(e,n){return new ke(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,lt.BLACK,null,null))}remove(e){return new ke(this.comparator,this.root.remove(e,this.comparator).copy(null,null,lt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Hl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Hl(this.root,e,this.comparator,!1)}getReverseIterator(){return new Hl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Hl(this.root,e,this.comparator,!0)}}class Hl{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class lt{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??lt.RED,this.left=s??lt.EMPTY,this.right=i??lt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new lt(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return lt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return lt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,lt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,lt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw X(43730,{key:this.key,value:this.value});if(this.right.isRed())throw X(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw X(27949);return e+(this.isRed()?0:1)}}lt.EMPTY=null,lt.RED=!0,lt.BLACK=!1;lt.EMPTY=new class{constructor(){this.size=0}get key(){throw X(57766)}get value(){throw X(16141)}get color(){throw X(16727)}get left(){throw X(29726)}get right(){throw X(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new lt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xe{constructor(e){this.comparator=e,this.data=new ke(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new wv(this.data.getIterator())}getIteratorFrom(e){return new wv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Xe)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Xe(this.comparator);return n.data=e,n}}class wv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $t{constructor(e){this.fields=e,e.sort(ct.comparator)}static empty(){return new $t([])}unionWith(e){let n=new Xe(ct.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new $t(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Hi(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zw extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new zw("Invalid base64 string: "+i):i}}(e);return new ht(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new ht(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return le(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ht.EMPTY_BYTE_STRING=new ht("");const nP=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function qr(t){if(me(!!t,39018),typeof t=="string"){let e=0;const n=nP.exec(t);if(me(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Me(t.seconds),nanos:Me(t.nanos)}}function Me(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Kr(t){return typeof t=="string"?ht.fromBase64String(t):ht.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $w="server_timestamp",Gw="__type__",Hw="__previous_value__",Ww="__local_write_time__";function Wp(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[Gw])==null?void 0:r.stringValue)===$w}function zu(t){const e=t.mapValue.fields[Hw];return Wp(e)?zu(e):e}function La(t){const e=qr(t.mapValue.fields[Ww].timestampValue);return new he(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rP{constructor(e,n,r,s,i,o,l,c,u,f){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u,this.isUsingEmulator=f}}const Ma="(default)";class Ua{constructor(e,n){this.projectId=e,this.database=n||Ma}static empty(){return new Ua("","")}get isDefaultDatabase(){return this.database===Ma}isEqual(e){return e instanceof Ua&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qw="__type__",Kw="__max__",Wl={mapValue:{fields:{__type__:{stringValue:Kw}}}},Qw="__vector__",su="value";function Qr(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Wp(t)?4:iP(t)?9007199254740991:sP(t)?10:11:X(28295,{value:t})}function Dn(t,e){if(t===e)return!0;const n=Qr(t);if(n!==Qr(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return La(t).isEqual(La(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=qr(s.timestampValue),l=qr(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Kr(s.bytesValue).isEqual(Kr(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Me(s.geoPointValue.latitude)===Me(i.geoPointValue.latitude)&&Me(s.geoPointValue.longitude)===Me(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Me(s.integerValue)===Me(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Me(s.doubleValue),l=Me(i.doubleValue);return o===l?ru(o)===ru(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return Hi(t.arrayValue.values||[],e.arrayValue.values||[],Dn);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},l=i.mapValue.fields||{};if(_v(o)!==_v(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!Dn(o[c],l[c])))return!1;return!0}(t,e);default:return X(52216,{left:t})}}function Fa(t,e){return(t.values||[]).find(n=>Dn(n,e))!==void 0}function Wi(t,e){if(t===e)return 0;const n=Qr(t),r=Qr(e);if(n!==r)return le(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return le(t.booleanValue,e.booleanValue);case 2:return function(i,o){const l=Me(i.integerValue||i.doubleValue),c=Me(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return Ev(t.timestampValue,e.timestampValue);case 4:return Ev(La(t),La(e));case 5:return uf(t.stringValue,e.stringValue);case 6:return function(i,o){const l=Kr(i),c=Kr(o);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),c=o.split("/");for(let u=0;u<l.length&&u<c.length;u++){const f=le(l[u],c[u]);if(f!==0)return f}return le(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const l=le(Me(i.latitude),Me(o.latitude));return l!==0?l:le(Me(i.longitude),Me(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return xv(t.arrayValue,e.arrayValue);case 10:return function(i,o){var g,w,R,N;const l=i.fields||{},c=o.fields||{},u=(g=l[su])==null?void 0:g.arrayValue,f=(w=c[su])==null?void 0:w.arrayValue,p=le(((R=u==null?void 0:u.values)==null?void 0:R.length)||0,((N=f==null?void 0:f.values)==null?void 0:N.length)||0);return p!==0?p:xv(u,f)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===Wl.mapValue&&o===Wl.mapValue)return 0;if(i===Wl.mapValue)return 1;if(o===Wl.mapValue)return-1;const l=i.fields||{},c=Object.keys(l),u=o.fields||{},f=Object.keys(u);c.sort(),f.sort();for(let p=0;p<c.length&&p<f.length;++p){const g=uf(c[p],f[p]);if(g!==0)return g;const w=Wi(l[c[p]],u[f[p]]);if(w!==0)return w}return le(c.length,f.length)}(t.mapValue,e.mapValue);default:throw X(23264,{he:n})}}function Ev(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return le(t,e);const n=qr(t),r=qr(e),s=le(n.seconds,r.seconds);return s!==0?s:le(n.nanos,r.nanos)}function xv(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Wi(n[s],r[s]);if(i)return i}return le(n.length,r.length)}function qi(t){return df(t)}function df(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=qr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Kr(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return J.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=df(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${df(n.fields[o])}`;return s+"}"}(t.mapValue):X(61005,{value:t})}function pc(t){switch(Qr(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=zu(t);return e?16+pc(e):16;case 5:return 2*t.stringValue.length;case 6:return Kr(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+pc(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return rs(r.fields,(i,o)=>{s+=i.length+pc(o)}),s}(t.mapValue);default:throw X(13486,{value:t})}}function Tv(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function hf(t){return!!t&&"integerValue"in t}function qp(t){return!!t&&"arrayValue"in t}function Sv(t){return!!t&&"nullValue"in t}function Iv(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function mc(t){return!!t&&"mapValue"in t}function sP(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[qw])==null?void 0:r.stringValue)===Qw}function la(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return rs(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=la(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=la(t.arrayValue.values[n]);return e}return{...t}}function iP(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===Kw}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dt{constructor(e){this.value=e}static empty(){return new Dt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!mc(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=la(n)}setAll(e){let n=ct.emptyPath(),r={},s=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=l.popLast()}o?r[l.lastSegment()]=la(o):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());mc(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Dn(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];mc(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){rs(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Dt(la(this.value))}}function Yw(t){const e=[];return rs(t.fields,(n,r)=>{const s=new ct([n]);if(mc(r)){const i=Yw(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new $t(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wt{constructor(e,n,r,s,i,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new wt(e,0,ne.min(),ne.min(),ne.min(),Dt.empty(),0)}static newFoundDocument(e,n,r,s){return new wt(e,1,n,ne.min(),r,s,0)}static newNoDocument(e,n){return new wt(e,2,n,ne.min(),ne.min(),Dt.empty(),0)}static newUnknownDocument(e,n){return new wt(e,3,n,ne.min(),ne.min(),Dt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ne.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Dt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Dt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ne.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof wt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new wt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iu{constructor(e,n){this.position=e,this.inclusive=n}}function Rv(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=J.comparator(J.fromName(o.referenceValue),n.key):r=Wi(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Cv(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Dn(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ba{constructor(e,n="asc"){this.field=e,this.dir=n}}function oP(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jw{}class qe extends Jw{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new lP(e,n,r):n==="array-contains"?new dP(e,r):n==="in"?new hP(e,r):n==="not-in"?new fP(e,r):n==="array-contains-any"?new pP(e,r):new qe(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new cP(e,r):new uP(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Wi(n,this.value)):n!==null&&Qr(this.value)===Qr(n)&&this.matchesComparison(Wi(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return X(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class vn extends Jw{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new vn(e,n)}matches(e){return Xw(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Xw(t){return t.op==="and"}function Zw(t){return aP(t)&&Xw(t)}function aP(t){for(const e of t.filters)if(e instanceof vn)return!1;return!0}function ff(t){if(t instanceof qe)return t.field.canonicalString()+t.op.toString()+qi(t.value);if(Zw(t))return t.filters.map(e=>ff(e)).join(",");{const e=t.filters.map(n=>ff(n)).join(",");return`${t.op}(${e})`}}function eE(t,e){return t instanceof qe?function(r,s){return s instanceof qe&&r.op===s.op&&r.field.isEqual(s.field)&&Dn(r.value,s.value)}(t,e):t instanceof vn?function(r,s){return s instanceof vn&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,l)=>i&&eE(o,s.filters[l]),!0):!1}(t,e):void X(19439)}function tE(t){return t instanceof qe?function(n){return`${n.field.canonicalString()} ${n.op} ${qi(n.value)}`}(t):t instanceof vn?function(n){return n.op.toString()+" {"+n.getFilters().map(tE).join(" ,")+"}"}(t):"Filter"}class lP extends qe{constructor(e,n,r){super(e,n,r),this.key=J.fromName(r.referenceValue)}matches(e){const n=J.comparator(e.key,this.key);return this.matchesComparison(n)}}class cP extends qe{constructor(e,n){super(e,"in",n),this.keys=nE("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class uP extends qe{constructor(e,n){super(e,"not-in",n),this.keys=nE("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function nE(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>J.fromName(r.referenceValue))}class dP extends qe{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return qp(n)&&Fa(n.arrayValue,this.value)}}class hP extends qe{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Fa(this.value.arrayValue,n)}}class fP extends qe{constructor(e,n){super(e,"not-in",n)}matches(e){if(Fa(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Fa(this.value.arrayValue,n)}}class pP extends qe{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!qp(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Fa(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mP{constructor(e,n=null,r=[],s=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=l,this.Te=null}}function Nv(t,e=null,n=[],r=[],s=null,i=null,o=null){return new mP(t,e,n,r,s,i,o)}function Kp(t){const e=ee(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>ff(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Bu(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>qi(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>qi(r)).join(",")),e.Te=n}return e.Te}function Qp(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!oP(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!eE(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Cv(t.startAt,e.startAt)&&Cv(t.endAt,e.endAt)}function pf(t){return J.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ao{constructor(e,n=null,r=[],s=[],i=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=c,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function gP(t,e,n,r,s,i,o,l){return new ao(t,e,n,r,s,i,o,l)}function $u(t){return new ao(t)}function Av(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function rE(t){return t.collectionGroup!==null}function ca(t){const e=ee(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Xe(ct.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(l=l.add(u.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Ba(i,r))}),n.has(ct.keyField().canonicalString())||e.Ie.push(new Ba(ct.keyField(),r))}return e.Ie}function Nn(t){const e=ee(t);return e.Ee||(e.Ee=yP(e,ca(t))),e.Ee}function yP(t,e){if(t.limitType==="F")return Nv(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Ba(s.field,i)});const n=t.endAt?new iu(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new iu(t.startAt.position,t.startAt.inclusive):null;return Nv(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function mf(t,e){const n=t.filters.concat([e]);return new ao(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function gf(t,e,n){return new ao(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Gu(t,e){return Qp(Nn(t),Nn(e))&&t.limitType===e.limitType}function sE(t){return`${Kp(Nn(t))}|lt:${t.limitType}`}function ci(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>tE(s)).join(", ")}]`),Bu(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>qi(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>qi(s)).join(",")),`Target(${r})`}(Nn(t))}; limitType=${t.limitType})`}function Hu(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):J.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of ca(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,l,c){const u=Rv(o,l,c);return o.inclusive?u<=0:u<0}(r.startAt,ca(r),s)||r.endAt&&!function(o,l,c){const u=Rv(o,l,c);return o.inclusive?u>=0:u>0}(r.endAt,ca(r),s))}(t,e)}function vP(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function iE(t){return(e,n)=>{let r=!1;for(const s of ca(t)){const i=_P(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function _P(t,e,n){const r=t.field.isKeyField()?J.comparator(e.key,n.key):function(i,o,l){const c=o.data.field(i),u=l.data.field(i);return c!==null&&u!==null?Wi(c,u):X(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return X(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gs{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){rs(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return Bw(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wP=new ke(J.comparator);function tr(){return wP}const oE=new ke(J.comparator);function Ko(...t){let e=oE;for(const n of t)e=e.insert(n.key,n);return e}function aE(t){let e=oE;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Is(){return ua()}function lE(){return ua()}function ua(){return new Gs(t=>t.toString(),(t,e)=>t.isEqual(e))}const EP=new ke(J.comparator),xP=new Xe(J.comparator);function ce(...t){let e=xP;for(const n of t)e=e.add(n);return e}const TP=new Xe(le);function SP(){return TP}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yp(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ru(e)?"-0":e}}function cE(t){return{integerValue:""+t}}function IP(t,e){return ZA(e)?cE(e):Yp(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wu{constructor(){this._=void 0}}function RP(t,e,n){return t instanceof ou?function(s,i){const o={fields:{[Gw]:{stringValue:$w},[Ww]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Wp(i)&&(i=zu(i)),i&&(o.fields[Hw]=i),{mapValue:o}}(n,e):t instanceof za?dE(t,e):t instanceof $a?hE(t,e):function(s,i){const o=uE(s,i),l=Pv(o)+Pv(s.Ae);return hf(o)&&hf(s.Ae)?cE(l):Yp(s.serializer,l)}(t,e)}function CP(t,e,n){return t instanceof za?dE(t,e):t instanceof $a?hE(t,e):n}function uE(t,e){return t instanceof au?function(r){return hf(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class ou extends Wu{}class za extends Wu{constructor(e){super(),this.elements=e}}function dE(t,e){const n=fE(e);for(const r of t.elements)n.some(s=>Dn(s,r))||n.push(r);return{arrayValue:{values:n}}}class $a extends Wu{constructor(e){super(),this.elements=e}}function hE(t,e){let n=fE(e);for(const r of t.elements)n=n.filter(s=>!Dn(s,r));return{arrayValue:{values:n}}}class au extends Wu{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function Pv(t){return Me(t.integerValue||t.doubleValue)}function fE(t){return qp(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function NP(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof za&&s instanceof za||r instanceof $a&&s instanceof $a?Hi(r.elements,s.elements,Dn):r instanceof au&&s instanceof au?Dn(r.Ae,s.Ae):r instanceof ou&&s instanceof ou}(t.transform,e.transform)}class AP{constructor(e,n){this.version=e,this.transformResults=n}}class gn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new gn}static exists(e){return new gn(void 0,e)}static updateTime(e){return new gn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function gc(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class qu{}function pE(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Jp(t.key,gn.none()):new rl(t.key,t.data,gn.none());{const n=t.data,r=Dt.empty();let s=new Xe(ct.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new ss(t.key,r,new $t(s.toArray()),gn.none())}}function PP(t,e,n){t instanceof rl?function(s,i,o){const l=s.value.clone(),c=bv(s.fieldTransforms,i,o.transformResults);l.setAll(c),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof ss?function(s,i,o){if(!gc(s.precondition,i))return void i.convertToUnknownDocument(o.version);const l=bv(s.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(mE(s)),c.setAll(l),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function da(t,e,n,r){return t instanceof rl?function(i,o,l,c){if(!gc(i.precondition,o))return l;const u=i.value.clone(),f=Dv(i.fieldTransforms,c,o);return u.setAll(f),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof ss?function(i,o,l,c){if(!gc(i.precondition,o))return l;const u=Dv(i.fieldTransforms,c,o),f=o.data;return f.setAll(mE(i)),f.setAll(u),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(p=>p.field))}(t,e,n,r):function(i,o,l){return gc(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function kP(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=uE(r.transform,s||null);i!=null&&(n===null&&(n=Dt.empty()),n.set(r.field,i))}return n||null}function kv(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Hi(r,s,(i,o)=>NP(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class rl extends qu{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class ss extends qu{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function mE(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function bv(t,e,n){const r=new Map;me(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,l=e.data.field(i.field);r.set(i.field,CP(o,l,n[s]))}return r}function Dv(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,RP(i,o,e))}return r}class Jp extends qu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class bP extends qu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DP{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&PP(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=da(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=da(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=lE();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=n.has(s.key)?null:l;const c=pE(o,l);c!==null&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(ne.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ce())}isEqual(e){return this.batchId===e.batchId&&Hi(this.mutations,e.mutations,(n,r)=>kv(n,r))&&Hi(this.baseMutations,e.baseMutations,(n,r)=>kv(n,r))}}class Xp{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){me(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=function(){return EP}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Xp(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jP{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OP{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ge,de;function VP(t){switch(t){case V.OK:return X(64938);case V.CANCELLED:case V.UNKNOWN:case V.DEADLINE_EXCEEDED:case V.RESOURCE_EXHAUSTED:case V.INTERNAL:case V.UNAVAILABLE:case V.UNAUTHENTICATED:return!1;case V.INVALID_ARGUMENT:case V.NOT_FOUND:case V.ALREADY_EXISTS:case V.PERMISSION_DENIED:case V.FAILED_PRECONDITION:case V.ABORTED:case V.OUT_OF_RANGE:case V.UNIMPLEMENTED:case V.DATA_LOSS:return!0;default:return X(15467,{code:t})}}function gE(t){if(t===void 0)return er("GRPC error has no .code"),V.UNKNOWN;switch(t){case Ge.OK:return V.OK;case Ge.CANCELLED:return V.CANCELLED;case Ge.UNKNOWN:return V.UNKNOWN;case Ge.DEADLINE_EXCEEDED:return V.DEADLINE_EXCEEDED;case Ge.RESOURCE_EXHAUSTED:return V.RESOURCE_EXHAUSTED;case Ge.INTERNAL:return V.INTERNAL;case Ge.UNAVAILABLE:return V.UNAVAILABLE;case Ge.UNAUTHENTICATED:return V.UNAUTHENTICATED;case Ge.INVALID_ARGUMENT:return V.INVALID_ARGUMENT;case Ge.NOT_FOUND:return V.NOT_FOUND;case Ge.ALREADY_EXISTS:return V.ALREADY_EXISTS;case Ge.PERMISSION_DENIED:return V.PERMISSION_DENIED;case Ge.FAILED_PRECONDITION:return V.FAILED_PRECONDITION;case Ge.ABORTED:return V.ABORTED;case Ge.OUT_OF_RANGE:return V.OUT_OF_RANGE;case Ge.UNIMPLEMENTED:return V.UNIMPLEMENTED;case Ge.DATA_LOSS:return V.DATA_LOSS;default:return X(39323,{code:t})}}(de=Ge||(Ge={}))[de.OK=0]="OK",de[de.CANCELLED=1]="CANCELLED",de[de.UNKNOWN=2]="UNKNOWN",de[de.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",de[de.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",de[de.NOT_FOUND=5]="NOT_FOUND",de[de.ALREADY_EXISTS=6]="ALREADY_EXISTS",de[de.PERMISSION_DENIED=7]="PERMISSION_DENIED",de[de.UNAUTHENTICATED=16]="UNAUTHENTICATED",de[de.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",de[de.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",de[de.ABORTED=10]="ABORTED",de[de.OUT_OF_RANGE=11]="OUT_OF_RANGE",de[de.UNIMPLEMENTED=12]="UNIMPLEMENTED",de[de.INTERNAL=13]="INTERNAL",de[de.UNAVAILABLE=14]="UNAVAILABLE",de[de.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LP(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MP=new Br([4294967295,4294967295],0);function jv(t){const e=LP().encode(t),n=new Pw;return n.update(e),new Uint8Array(n.digest())}function Ov(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Br([n,r],0),new Br([s,i],0)]}class Zp{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Qo(`Invalid padding: ${n}`);if(r<0)throw new Qo(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Qo(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Qo(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Br.fromNumber(this.ge)}ye(e,n,r){let s=e.add(n.multiply(Br.fromNumber(r)));return s.compare(MP)===1&&(s=new Br([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=jv(e),[r,s]=Ov(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);if(!this.we(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Zp(i,s,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.ge===0)return;const n=jv(e),[r,s]=Ov(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Qo extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ku{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,sl.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Ku(ne.min(),s,new ke(le),tr(),ce())}}class sl{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new sl(r,n,ce(),ce(),ce())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yc{constructor(e,n,r,s){this.be=e,this.removedTargetIds=n,this.key=r,this.De=s}}class yE{constructor(e,n){this.targetId=e,this.Ce=n}}class vE{constructor(e,n,r=ht.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class Vv{constructor(){this.ve=0,this.Fe=Lv(),this.Me=ht.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=ce(),n=ce(),r=ce();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:X(38017,{changeType:i})}}),new sl(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=Lv()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,me(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class UP{constructor(e){this.Ge=e,this.ze=new Map,this.je=tr(),this.Je=ql(),this.He=ql(),this.Ye=new ke(le)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:X(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,s)=>{this.rt(s)&&n(s)})}st(e){const n=e.targetId,r=e.Ce.count,s=this.ot(n);if(s){const i=s.target;if(pf(i))if(r===0){const o=new J(i.path);this.et(n,o,wt.newNoDocument(o,ne.min()))}else me(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const l=this.ut(e),c=l?this.ct(l,e,o):1;if(c!==0){this.it(n);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,u)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,l;try{o=Kr(r).toUint8Array()}catch(c){if(c instanceof zw)return Gi("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new Zp(o,s,i)}catch(c){return Gi(c instanceof Qo?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.ge===0?null:l}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Ge.ht(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.et(n,i,null),s++)}),s}Tt(e){const n=new Map;this.ze.forEach((i,o)=>{const l=this.ot(o);if(l){if(i.current&&pf(l.target)){const c=new J(l.target.path);this.It(c).has(o)||this.Et(o,c)||this.et(o,c,wt.newNoDocument(c,e))}i.Be&&(n.set(o,i.ke()),i.qe())}});let r=ce();this.He.forEach((i,o)=>{let l=!0;o.forEachWhile(c=>{const u=this.ot(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const s=new Ku(e,n,this.Ye,this.je,r);return this.je=tr(),this.Je=ql(),this.He=ql(),this.Ye=new ke(le),s}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,n)?s.Qe(n,1):s.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new Vv,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Xe(le),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Xe(le),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||K("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Vv),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function ql(){return new ke(J.comparator)}function Lv(){return new ke(J.comparator)}const FP=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),BP=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),zP=(()=>({and:"AND",or:"OR"}))();class $P{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function yf(t,e){return t.useProto3Json||Bu(e)?e:{value:e}}function lu(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function _E(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function GP(t,e){return lu(t,e.toTimestamp())}function An(t){return me(!!t,49232),ne.fromTimestamp(function(n){const r=qr(n);return new he(r.seconds,r.nanos)}(t))}function em(t,e){return vf(t,e).canonicalString()}function vf(t,e){const n=function(s){return new ve(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function wE(t){const e=ve.fromString(t);return me(IE(e),10190,{key:e.toString()}),e}function _f(t,e){return em(t.databaseId,e.path)}function Qd(t,e){const n=wE(e);if(n.get(1)!==t.databaseId.projectId)throw new W(V.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new W(V.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new J(xE(n))}function EE(t,e){return em(t.databaseId,e)}function HP(t){const e=wE(t);return e.length===4?ve.emptyPath():xE(e)}function wf(t){return new ve(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function xE(t){return me(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Mv(t,e,n){return{name:_f(t,e),fields:n.value.mapValue.fields}}function WP(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:X(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(u,f){return u.useProto3Json?(me(f===void 0||typeof f=="string",58123),ht.fromBase64String(f||"")):(me(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),ht.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(u){const f=u.code===void 0?V.UNKNOWN:gE(u.code);return new W(f,u.message||"")}(o);n=new vE(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Qd(t,r.document.name),i=An(r.document.updateTime),o=r.document.createTime?An(r.document.createTime):ne.min(),l=new Dt({mapValue:{fields:r.document.fields}}),c=wt.newFoundDocument(s,i,o,l),u=r.targetIds||[],f=r.removedTargetIds||[];n=new yc(u,f,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Qd(t,r.document),i=r.readTime?An(r.readTime):ne.min(),o=wt.newNoDocument(s,i),l=r.removedTargetIds||[];n=new yc([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Qd(t,r.document),i=r.removedTargetIds||[];n=new yc([],i,s,null)}else{if(!("filter"in e))return X(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new OP(s,i),l=r.targetId;n=new yE(l,o)}}return n}function qP(t,e){let n;if(e instanceof rl)n={update:Mv(t,e.key,e.value)};else if(e instanceof Jp)n={delete:_f(t,e.key)};else if(e instanceof ss)n={update:Mv(t,e.key,e.data),updateMask:nk(e.fieldMask)};else{if(!(e instanceof bP))return X(16599,{Vt:e.type});n={verify:_f(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const l=o.transform;if(l instanceof ou)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof za)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof $a)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof au)return{fieldPath:o.field.canonicalString(),increment:l.Ae};throw X(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:GP(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:X(27497)}(t,e.precondition)),n}function KP(t,e){return t&&t.length>0?(me(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?An(s.updateTime):An(i);return o.isEqual(ne.min())&&(o=An(i)),new AP(o,s.transformResults||[])}(n,e))):[]}function QP(t,e){return{documents:[EE(t,e.path)]}}function YP(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=EE(t,s);const i=function(u){if(u.length!==0)return SE(vn.create(u,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(u){if(u.length!==0)return u.map(f=>function(g){return{field:ui(g.field),direction:ZP(g.dir)}}(f))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=yf(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ft:n,parent:s}}function JP(t){let e=HP(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){me(r===1,65062);const f=n.from[0];f.allDescendants?s=f.collectionId:e=e.child(f.collectionId)}let i=[];n.where&&(i=function(p){const g=TE(p);return g instanceof vn&&Zw(g)?g.getFilters():[g]}(n.where));let o=[];n.orderBy&&(o=function(p){return p.map(g=>function(R){return new Ba(di(R.field),function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(R.direction))}(g))}(n.orderBy));let l=null;n.limit&&(l=function(p){let g;return g=typeof p=="object"?p.value:p,Bu(g)?null:g}(n.limit));let c=null;n.startAt&&(c=function(p){const g=!!p.before,w=p.values||[];return new iu(w,g)}(n.startAt));let u=null;return n.endAt&&(u=function(p){const g=!p.before,w=p.values||[];return new iu(w,g)}(n.endAt)),gP(e,s,o,i,l,"F",c,u)}function XP(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return X(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function TE(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=di(n.unaryFilter.field);return qe.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=di(n.unaryFilter.field);return qe.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=di(n.unaryFilter.field);return qe.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=di(n.unaryFilter.field);return qe.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return X(61313);default:return X(60726)}}(t):t.fieldFilter!==void 0?function(n){return qe.create(di(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return X(58110);default:return X(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return vn.create(n.compositeFilter.filters.map(r=>TE(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return X(1026)}}(n.compositeFilter.op))}(t):X(30097,{filter:t})}function ZP(t){return FP[t]}function ek(t){return BP[t]}function tk(t){return zP[t]}function ui(t){return{fieldPath:t.canonicalString()}}function di(t){return ct.fromServerFormat(t.fieldPath)}function SE(t){return t instanceof qe?function(n){if(n.op==="=="){if(Iv(n.value))return{unaryFilter:{field:ui(n.field),op:"IS_NAN"}};if(Sv(n.value))return{unaryFilter:{field:ui(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Iv(n.value))return{unaryFilter:{field:ui(n.field),op:"IS_NOT_NAN"}};if(Sv(n.value))return{unaryFilter:{field:ui(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ui(n.field),op:ek(n.op),value:n.value}}}(t):t instanceof vn?function(n){const r=n.getFilters().map(s=>SE(s));return r.length===1?r[0]:{compositeFilter:{op:tk(n.op),filters:r}}}(t):X(54877,{filter:t})}function nk(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function IE(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nr{constructor(e,n,r,s,i=ne.min(),o=ne.min(),l=ht.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Nr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Nr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Nr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Nr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rk{constructor(e){this.yt=e}}function sk(t){const e=JP({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?gf(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ik{constructor(){this.Cn=new ok}addToCollectionParentIndex(e,n){return this.Cn.add(n),U.resolve()}getCollectionParents(e,n){return U.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return U.resolve()}deleteFieldIndex(e,n){return U.resolve()}deleteAllFieldIndexes(e){return U.resolve()}createTargetIndexes(e,n){return U.resolve()}getDocumentsMatchingTarget(e,n){return U.resolve(null)}getIndexType(e,n){return U.resolve(0)}getFieldIndexes(e,n){return U.resolve([])}getNextCollectionGroupToUpdate(e){return U.resolve(null)}getMinOffset(e,n){return U.resolve(Wr.min())}getMinOffsetFromCollectionGroup(e,n){return U.resolve(Wr.min())}updateCollectionGroup(e,n,r){return U.resolve()}updateIndexEntries(e,n){return U.resolve()}}class ok{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Xe(ve.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Xe(ve.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uv={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},RE=41943040;class kt{static withCacheSize(e){return new kt(e,kt.DEFAULT_COLLECTION_PERCENTILE,kt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */kt.DEFAULT_COLLECTION_PERCENTILE=10,kt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,kt.DEFAULT=new kt(RE,kt.DEFAULT_COLLECTION_PERCENTILE,kt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),kt.DISABLED=new kt(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Ki(0)}static cr(){return new Ki(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fv="LruGarbageCollector",CE=1048576;function Bv([t,e],[n,r]){const s=le(t,n);return s===0?le(e,r):s}class ak{constructor(e){this.Ir=e,this.buffer=new Xe(Bv),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Bv(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class lk{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){K(Fv,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){oo(n)?K(Fv,"Ignoring IndexedDB error during garbage collection: ",n):await io(n)}await this.Vr(3e5)})}}class ck{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return U.resolve(Fu.ce);const r=new ak(n);return this.mr.forEachTarget(e,s=>r.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>r.Ar(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(K("LruGarbageCollector","Garbage collection skipped; disabled"),U.resolve(Uv)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(K("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Uv):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,s,i,o,l,c,u;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(K("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),s=this.params.maximumSequenceNumbersToCollect):s=p,o=Date.now(),this.nthSequenceNumber(e,s))).next(p=>(r=p,l=Date.now(),this.removeTargets(e,r,n))).next(p=>(i=p,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(u=Date.now(),li()<=ae.DEBUG&&K("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${s} in `+(l-o)+`ms
	Removed ${i} targets in `+(c-l)+`ms
	Removed ${p} documents in `+(u-c)+`ms
Total Duration: ${u-f}ms`),U.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:p})))}}function uk(t,e){return new ck(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dk{constructor(){this.changes=new Gs(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,wt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?U.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hk{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fk{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&da(r.mutation,s,$t.empty(),he.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ce()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ce()){const s=Is();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=Ko();return i.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Is();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ce()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,s){let i=tr();const o=ua(),l=function(){return ua()}();return n.forEach((c,u)=>{const f=r.get(u.key);s.has(u.key)&&(f===void 0||f.mutation instanceof ss)?i=i.insert(u.key,u):f!==void 0?(o.set(u.key,f.mutation.getFieldMask()),da(f.mutation,u,f.mutation.getFieldMask(),he.now())):o.set(u.key,$t.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((u,f)=>o.set(u,f)),n.forEach((u,f)=>l.set(u,new hk(f,o.get(u)??null))),l))}recalculateAndSaveOverlays(e,n){const r=ua();let s=new ke((o,l)=>o-l),i=ce();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(c=>{const u=n.get(c);if(u===null)return;let f=r.get(c)||$t.empty();f=l.applyToLocalView(u,f),r.set(c,f);const p=(s.get(l.batchId)||ce()).add(c);s=s.insert(l.batchId,p)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,f=c.value,p=lE();f.forEach(g=>{if(!i.has(g)){const w=pE(n.get(g),r.get(g));w!==null&&p.set(g,w),i=i.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,p))}return U.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return J.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):rE(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):U.resolve(Is());let l=Va,c=i;return o.next(u=>U.forEach(u,(f,p)=>(l<p.largestBatchId&&(l=p.largestBatchId),i.get(f)?U.resolve():this.remoteDocumentCache.getEntry(e,f).next(g=>{c=c.insert(f,g)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,c,u,ce())).next(f=>({batchId:l,changes:aE(f)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new J(n)).next(r=>{let s=Ko();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=Ko();return this.indexManager.getCollectionParents(e,i).next(l=>U.forEach(l,c=>{const u=function(p,g){return new ao(g,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(n,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,u,r,s).next(f=>{f.forEach((p,g)=>{o=o.insert(p,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((c,u)=>{const f=u.getKey();o.get(f)===null&&(o=o.insert(f,wt.newInvalidDocument(f)))});let l=Ko();return o.forEach((c,u)=>{const f=i.get(c);f!==void 0&&da(f.mutation,u,$t.empty(),he.now()),Hu(n,u)&&(l=l.insert(c,u))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pk{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return U.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:An(s.createTime)}}(n)),U.resolve()}getNamedQuery(e,n){return U.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(s){return{name:s.name,query:sk(s.bundledQuery),readTime:An(s.readTime)}}(n)),U.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mk{constructor(){this.overlays=new ke(J.comparator),this.qr=new Map}getOverlay(e,n){return U.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Is();return U.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.St(e,n,i)}),U.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(r)),U.resolve()}getOverlaysForCollection(e,n,r){const s=Is(),i=n.length+1,o=new J(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return U.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new ke((u,f)=>u-f);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let f=i.get(u.largestBatchId);f===null&&(f=Is(),i=i.insert(u.largestBatchId,f)),f.set(u.getKey(),u)}}const l=Is(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,f)=>l.set(u,f)),!(l.size()>=s)););return U.resolve(l)}St(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new jP(n,r));let i=this.qr.get(n);i===void 0&&(i=ce(),this.qr.set(n,i)),this.qr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gk{constructor(){this.sessionToken=ht.EMPTY_BYTE_STRING}getSessionToken(e){return U.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,U.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tm{constructor(){this.Qr=new Xe(et.$r),this.Ur=new Xe(et.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new et(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new et(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new J(new ve([])),r=new et(n,e),s=new et(n,e+1),i=[];return this.Ur.forEachInRange([r,s],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new J(new ve([])),r=new et(n,e),s=new et(n,e+1);let i=ce();return this.Ur.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new et(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class et{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return J.comparator(e.key,n.key)||le(e.Yr,n.Yr)}static Kr(e,n){return le(e.Yr,n.Yr)||J.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yk{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Xe(et.$r)}checkEmpty(e){return U.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new DP(i,n,r,s);this.mutationQueue.push(o);for(const l of s)this.Zr=this.Zr.add(new et(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return U.resolve(o)}lookupMutationBatch(e,n){return U.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ei(r),i=s<0?0:s;return U.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return U.resolve(this.mutationQueue.length===0?Hp:this.tr-1)}getAllMutationBatches(e){return U.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new et(n,0),s=new et(n,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],o=>{const l=this.Xr(o.Yr);i.push(l)}),U.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Xe(le);return n.forEach(s=>{const i=new et(s,0),o=new et(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],l=>{r=r.add(l.Yr)})}),U.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;J.isDocumentKey(i)||(i=i.child(""));const o=new et(new J(i),0);let l=new Xe(le);return this.Zr.forEachWhile(c=>{const u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===s&&(l=l.add(c.Yr)),!0)},o),U.resolve(this.ti(l))}ti(e){const n=[];return e.forEach(r=>{const s=this.Xr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){me(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return U.forEach(n.mutations,s=>{const i=new et(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new et(n,0),s=this.Zr.firstAfterOrEqual(r);return U.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,U.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vk{constructor(e){this.ri=e,this.docs=function(){return new ke(J.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return U.resolve(r?r.document.mutableCopy():wt.newInvalidDocument(n))}getEntries(e,n){let r=tr();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():wt.newInvalidDocument(s))}),U.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=tr();const o=n.path,l=new J(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:f}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||QA(KA(f),r)<=0||(s.has(f.key)||Hu(n,f))&&(i=i.insert(f.key,f.mutableCopy()))}return U.resolve(i)}getAllFromCollectionGroup(e,n,r,s){X(9500)}ii(e,n){return U.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new _k(this)}getSize(e){return U.resolve(this.size)}}class _k extends dk{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)}),U.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wk{constructor(e){this.persistence=e,this.si=new Gs(n=>Kp(n),Qp),this.lastRemoteSnapshotVersion=ne.min(),this.highestTargetId=0,this.oi=0,this._i=new tm,this.targetCount=0,this.ai=Ki.ur()}forEachTarget(e,n){return this.si.forEach((r,s)=>n(s)),U.resolve()}getLastRemoteSnapshotVersion(e){return U.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return U.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),U.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),U.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new Ki(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,U.resolve()}updateTargetData(e,n){return this.Pr(n),U.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,U.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.si.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),U.waitFor(i).next(()=>s)}getTargetCount(e){return U.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return U.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),U.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),U.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),U.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return U.resolve(r)}containsKey(e,n){return U.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NE{constructor(e,n){this.ui={},this.overlays={},this.ci=new Fu(0),this.li=!1,this.li=!0,this.hi=new gk,this.referenceDelegate=e(this),this.Pi=new wk(this),this.indexManager=new ik,this.remoteDocumentCache=function(s){return new vk(s)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new rk(n),this.Ii=new pk(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new mk,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new yk(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){K("MemoryPersistence","Starting transaction:",e);const s=new Ek(this.ci.next());return this.referenceDelegate.Ei(),r(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ai(e,n){return U.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class Ek extends JA{constructor(e){super(),this.currentSequenceNumber=e}}class nm{constructor(e){this.persistence=e,this.Ri=new tm,this.Vi=null}static mi(e){return new nm(e)}get fi(){if(this.Vi)return this.Vi;throw X(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),U.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),U.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),U.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(s=>this.fi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.fi.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return U.forEach(this.fi,r=>{const s=J.fromPath(r);return this.gi(e,s).next(i=>{i||n.removeEntry(s,ne.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return U.or([()=>U.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class cu{constructor(e,n){this.persistence=e,this.pi=new Gs(r=>eP(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=uk(this,n)}static mi(e,n){return new cu(e,n)}Ei(){}di(e){return U.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return U.forEach(this.pi,(r,s)=>this.br(e,r,s).next(i=>i?U.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,o=>this.br(e,o,n).next(l=>{l||(r++,i.removeEntry(o,ne.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),U.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),U.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),U.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),U.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=pc(e.data.value)),n}br(e,n,r){return U.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.pi.get(n);return U.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rm{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=s}static As(e,n){let r=ce(),s=ce();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new rm(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xk{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tk{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return mC()?8:XA(xt())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.ys(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new xk;return this.Ss(e,n,o).next(l=>{if(i.result=l,this.Vs)return this.bs(e,n,o,l.size)})}).next(()=>i.result)}bs(e,n,r,s){return r.documentReadCount<this.fs?(li()<=ae.DEBUG&&K("QueryEngine","SDK will not create cache indexes for query:",ci(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),U.resolve()):(li()<=ae.DEBUG&&K("QueryEngine","Query:",ci(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(li()<=ae.DEBUG&&K("QueryEngine","The SDK decides to create cache indexes for query:",ci(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Nn(n))):U.resolve())}ys(e,n){if(Av(n))return U.resolve(null);let r=Nn(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=gf(n,null,"F"),r=Nn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=ce(...i);return this.ps.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(c=>{const u=this.Ds(n,l);return this.Cs(n,u,o,c.readTime)?this.ys(e,gf(n,null,"F")):this.vs(e,u,n,c)}))})))}ws(e,n,r,s){return Av(n)||s.isEqual(ne.min())?U.resolve(null):this.ps.getDocuments(e,r).next(i=>{const o=this.Ds(n,i);return this.Cs(n,o,r,s)?U.resolve(null):(li()<=ae.DEBUG&&K("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),ci(n)),this.vs(e,o,n,qA(s,Va)).next(l=>l))})}Ds(e,n){let r=new Xe(iE(e));return n.forEach((s,i)=>{Hu(e,i)&&(r=r.add(i))}),r}Cs(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,n,r){return li()<=ae.DEBUG&&K("QueryEngine","Using full collection scan to execute query:",ci(n)),this.ps.getDocumentsMatchingQuery(e,n,Wr.min(),r)}vs(e,n,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sm="LocalStore",Sk=3e8;class Ik{constructor(e,n,r,s){this.persistence=e,this.Fs=n,this.serializer=s,this.Ms=new ke(le),this.xs=new Gs(i=>Kp(i),Qp),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new fk(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function Rk(t,e,n,r){return new Ik(t,e,n,r)}async function AE(t,e){const n=ee(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],l=[];let c=ce();for(const u of s){o.push(u.batchId);for(const f of u.mutations)c=c.add(f.key)}for(const u of i){l.push(u.batchId);for(const f of u.mutations)c=c.add(f.key)}return n.localDocuments.getDocuments(r,c).next(u=>({Ls:u,removedBatchIds:o,addedBatchIds:l}))})})}function Ck(t,e){const n=ee(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(l,c,u,f){const p=u.batch,g=p.keys();let w=U.resolve();return g.forEach(R=>{w=w.next(()=>f.getEntry(c,R)).next(N=>{const P=u.docVersions.get(R);me(P!==null,48541),N.version.compareTo(P)<0&&(p.applyToRemoteDocument(N,u),N.isValidDocument()&&(N.setReadTime(u.commitVersion),f.addEntry(N)))})}),w.next(()=>l.mutationQueue.removeMutationBatch(c,p))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let c=ce();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function PE(t){const e=ee(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function Nk(t,e){const n=ee(t),r=e.snapshotVersion;let s=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});s=n.Ms;const l=[];e.targetChanges.forEach((f,p)=>{const g=s.get(p);if(!g)return;l.push(n.Pi.removeMatchingKeys(i,f.removedDocuments,p).next(()=>n.Pi.addMatchingKeys(i,f.addedDocuments,p)));let w=g.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(p)!==null?w=w.withResumeToken(ht.EMPTY_BYTE_STRING,ne.min()).withLastLimboFreeSnapshotVersion(ne.min()):f.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(f.resumeToken,r)),s=s.insert(p,w),function(N,P,x){return N.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-N.snapshotVersion.toMicroseconds()>=Sk?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0}(g,w,f)&&l.push(n.Pi.updateTargetData(i,w))});let c=tr(),u=ce();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,f))}),l.push(Ak(i,o,e.documentUpdates).next(f=>{c=f.ks,u=f.qs})),!r.isEqual(ne.min())){const f=n.Pi.getLastRemoteSnapshotVersion(i).next(p=>n.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(f)}return U.waitFor(l).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,u)).next(()=>c)}).then(i=>(n.Ms=s,i))}function Ak(t,e,n){let r=ce(),s=ce();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=tr();return n.forEach((l,c)=>{const u=i.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(l)),c.isNoDocument()&&c.version.isEqual(ne.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):K(sm,"Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)}),{ks:o,qs:s}})}function Pk(t,e){const n=ee(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Hp),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function kk(t,e){const n=ee(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Pi.getTargetData(r,e).next(i=>i?(s=i,U.resolve(s)):n.Pi.allocateTargetId(r).next(o=>(s=new Nr(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function Ef(t,e,n){const r=ee(t),s=r.Ms.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!oo(o))throw o;K(sm,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function zv(t,e,n){const r=ee(t);let s=ne.min(),i=ce();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,f){const p=ee(c),g=p.xs.get(f);return g!==void 0?U.resolve(p.Ms.get(g)):p.Pi.getTargetData(u,f)}(r,o,Nn(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,l.targetId).next(c=>{i=c})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?s:ne.min(),n?i:ce())).next(l=>(bk(r,vP(e),l),{documents:l,Qs:i})))}function bk(t,e,n){let r=t.Os.get(e)||ne.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Os.set(e,r)}class $v{constructor(){this.activeTargetIds=SP()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Dk{constructor(){this.Mo=new $v,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new $v,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jk{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gv="ConnectivityMonitor";class Hv{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){K(Gv,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){K(Gv,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Kl=null;function xf(){return Kl===null?Kl=function(){return 268435456+Math.round(2147483648*Math.random())}():Kl++,"0x"+Kl.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yd="RestConnection",Ok={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Vk{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===Ma?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,n,r,s,i){const o=xf(),l=this.zo(e,n.toUriEncodedString());K(Yd,`Sending RPC '${e}' ${o}:`,l,r);const c={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(c,s,i);const{host:u}=new URL(l),f=$s(u);return this.Jo(e,l,c,r,f).then(p=>(K(Yd,`Received RPC '${e}' ${o}: `,p),p),p=>{throw Gi(Yd,`RPC '${e}' ${o} failed with error: `,p,"url: ",l,"request:",r),p})}Ho(e,n,r,s,i,o){return this.Go(e,n,r,s,i)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+so}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}zo(e,n){const r=Ok[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lk{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yt="WebChannelConnection";class Mk extends Vk{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,s,i){const o=xf();return new Promise((l,c)=>{const u=new kw;u.setWithCredentials(!0),u.listenOnce(bw.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case fc.NO_ERROR:const p=u.getResponseJson();K(yt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),l(p);break;case fc.TIMEOUT:K(yt,`RPC '${e}' ${o} timed out`),c(new W(V.DEADLINE_EXCEEDED,"Request time out"));break;case fc.HTTP_ERROR:const g=u.getStatus();if(K(yt,`RPC '${e}' ${o} failed with status:`,g,"response text:",u.getResponseText()),g>0){let w=u.getResponseJson();Array.isArray(w)&&(w=w[0]);const R=w==null?void 0:w.error;if(R&&R.status&&R.message){const N=function(x){const v=x.toLowerCase().replace(/_/g,"-");return Object.values(V).indexOf(v)>=0?v:V.UNKNOWN}(R.status);c(new W(N,R.message))}else c(new W(V.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new W(V.UNAVAILABLE,"Connection failed."));break;default:X(9055,{l_:e,streamId:o,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{K(yt,`RPC '${e}' ${o} completed.`)}});const f=JSON.stringify(s);K(yt,`RPC '${e}' ${o} sending request:`,s),u.send(n,"POST",f,r,15)})}T_(e,n,r){const s=xf(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Ow(),l=jw(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.jo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const f=i.join("");K(yt,`Creating RPC '${e}' stream ${s}: ${f}`,c);const p=o.createWebChannel(f,c);this.I_(p);let g=!1,w=!1;const R=new Lk({Yo:P=>{w?K(yt,`Not sending because RPC '${e}' stream ${s} is closed:`,P):(g||(K(yt,`Opening RPC '${e}' stream ${s} transport.`),p.open(),g=!0),K(yt,`RPC '${e}' stream ${s} sending:`,P),p.send(P))},Zo:()=>p.close()}),N=(P,x,v)=>{P.listen(x,T=>{try{v(T)}catch(D){setTimeout(()=>{throw D},0)}})};return N(p,qo.EventType.OPEN,()=>{w||(K(yt,`RPC '${e}' stream ${s} transport opened.`),R.o_())}),N(p,qo.EventType.CLOSE,()=>{w||(w=!0,K(yt,`RPC '${e}' stream ${s} transport closed`),R.a_(),this.E_(p))}),N(p,qo.EventType.ERROR,P=>{w||(w=!0,Gi(yt,`RPC '${e}' stream ${s} transport errored. Name:`,P.name,"Message:",P.message),R.a_(new W(V.UNAVAILABLE,"The operation could not be completed")))}),N(p,qo.EventType.MESSAGE,P=>{var x;if(!w){const v=P.data[0];me(!!v,16349);const T=v,D=(T==null?void 0:T.error)||((x=T[0])==null?void 0:x.error);if(D){K(yt,`RPC '${e}' stream ${s} received error:`,D);const F=D.status;let z=function(I){const E=Ge[I];if(E!==void 0)return gE(E)}(F),S=D.message;z===void 0&&(z=V.INTERNAL,S="Unknown error status: "+F+" with message "+D.message),w=!0,R.a_(new W(z,S)),p.close()}else K(yt,`RPC '${e}' stream ${s} received:`,v),R.u_(v)}}),N(l,Dw.STAT_EVENT,P=>{P.stat===cf.PROXY?K(yt,`RPC '${e}' stream ${s} detected buffering proxy`):P.stat===cf.NOPROXY&&K(yt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{R.__()},0),R}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}function Jd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qu(t){return new $P(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kE{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,n-r);s>0&&K("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wv="PersistentStream";class bE{constructor(e,n,r,s,i,o,l,c){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new kE(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===V.RESOURCE_EXHAUSTED?(er(n.toString()),er("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===V.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.D_===n&&this.G_(r,s)},r=>{e(()=>{const s=new W(V.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{r(()=>this.z_(s))}),this.stream.onMessage(s=>{r(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return K(Wv,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(K(Wv,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Uk extends bE{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=WP(this.serializer,e),r=function(i){if(!("targetChange"in i))return ne.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?ne.min():o.readTime?An(o.readTime):ne.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=wf(this.serializer),n.addTarget=function(i,o){let l;const c=o.target;if(l=pf(c)?{documents:QP(i,c)}:{query:YP(i,c).ft},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=_E(i,o.resumeToken);const u=yf(i,o.expectedCount);u!==null&&(l.expectedCount=u)}else if(o.snapshotVersion.compareTo(ne.min())>0){l.readTime=lu(i,o.snapshotVersion.toTimestamp());const u=yf(i,o.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const r=XP(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=wf(this.serializer),n.removeTarget=e,this.q_(n)}}class Fk extends bE{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return me(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,me(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){me(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=KP(e.writeResults,e.commitTime),r=An(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=wf(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>qP(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bk{}class zk extends Bk{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new W(V.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,vf(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===V.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new W(V.UNKNOWN,i.toString())})}Ho(e,n,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Ho(e,vf(n,r),s,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===V.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new W(V.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class $k{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(er(n),this.aa=!1):K("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Us="RemoteStore";class Gk{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{Hs(this)&&(K(Us,"Restarting streams for network reachability change."),await async function(c){const u=ee(c);u.Ea.add(4),await lo(u),u.Ra.set("Unknown"),u.Ea.delete(4),await il(u)}(this))})}),this.Ra=new $k(r,s)}}async function il(t){if(Hs(t))for(const e of t.da)await e(!0)}async function lo(t){for(const e of t.da)await e(!1)}function DE(t,e){const n=ee(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),lm(n)?am(n):co(n).O_()&&om(n,e))}function im(t,e){const n=ee(t),r=co(n);n.Ia.delete(e),r.O_()&&jE(n,e),n.Ia.size===0&&(r.O_()?r.L_():Hs(n)&&n.Ra.set("Unknown"))}function om(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ne.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}co(t).Y_(e)}function jE(t,e){t.Va.Ue(e),co(t).Z_(e)}function am(t){t.Va=new UP({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),co(t).start(),t.Ra.ua()}function lm(t){return Hs(t)&&!co(t).x_()&&t.Ia.size>0}function Hs(t){return ee(t).Ea.size===0}function OE(t){t.Va=void 0}async function Hk(t){t.Ra.set("Online")}async function Wk(t){t.Ia.forEach((e,n)=>{om(t,e)})}async function qk(t,e){OE(t),lm(t)?(t.Ra.ha(e),am(t)):t.Ra.set("Unknown")}async function Kk(t,e,n){if(t.Ra.set("Online"),e instanceof vE&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const l of i.targetIds)s.Ia.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.Ia.delete(l),s.Va.removeTarget(l))}(t,e)}catch(r){K(Us,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await uu(t,r)}else if(e instanceof yc?t.Va.Ze(e):e instanceof yE?t.Va.st(e):t.Va.tt(e),!n.isEqual(ne.min()))try{const r=await PE(t.localStore);n.compareTo(r)>=0&&await function(i,o){const l=i.Va.Tt(o);return l.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const f=i.Ia.get(u);f&&i.Ia.set(u,f.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,u)=>{const f=i.Ia.get(c);if(!f)return;i.Ia.set(c,f.withResumeToken(ht.EMPTY_BYTE_STRING,f.snapshotVersion)),jE(i,c);const p=new Nr(f.target,c,u,f.sequenceNumber);om(i,p)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){K(Us,"Failed to raise snapshot:",r),await uu(t,r)}}async function uu(t,e,n){if(!oo(e))throw e;t.Ea.add(1),await lo(t),t.Ra.set("Offline"),n||(n=()=>PE(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{K(Us,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await il(t)})}function VE(t,e){return e().catch(n=>uu(t,n,e))}async function Yu(t){const e=ee(t),n=Yr(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Hp;for(;Qk(e);)try{const s=await Pk(e.localStore,r);if(s===null){e.Ta.length===0&&n.L_();break}r=s.batchId,Yk(e,s)}catch(s){await uu(e,s)}LE(e)&&ME(e)}function Qk(t){return Hs(t)&&t.Ta.length<10}function Yk(t,e){t.Ta.push(e);const n=Yr(t);n.O_()&&n.X_&&n.ea(e.mutations)}function LE(t){return Hs(t)&&!Yr(t).x_()&&t.Ta.length>0}function ME(t){Yr(t).start()}async function Jk(t){Yr(t).ra()}async function Xk(t){const e=Yr(t);for(const n of t.Ta)e.ea(n.mutations)}async function Zk(t,e,n){const r=t.Ta.shift(),s=Xp.from(r,e,n);await VE(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Yu(t)}async function eb(t,e){e&&Yr(t).X_&&await async function(r,s){if(function(o){return VP(o)&&o!==V.ABORTED}(s.code)){const i=r.Ta.shift();Yr(r).B_(),await VE(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Yu(r)}}(t,e),LE(t)&&ME(t)}async function qv(t,e){const n=ee(t);n.asyncQueue.verifyOperationInProgress(),K(Us,"RemoteStore received new credentials");const r=Hs(n);n.Ea.add(3),await lo(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await il(n)}async function tb(t,e){const n=ee(t);e?(n.Ea.delete(2),await il(n)):e||(n.Ea.add(2),await lo(n),n.Ra.set("Unknown"))}function co(t){return t.ma||(t.ma=function(n,r,s){const i=ee(n);return i.sa(),new Uk(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:Hk.bind(null,t),t_:Wk.bind(null,t),r_:qk.bind(null,t),H_:Kk.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),lm(t)?am(t):t.Ra.set("Unknown")):(await t.ma.stop(),OE(t))})),t.ma}function Yr(t){return t.fa||(t.fa=function(n,r,s){const i=ee(n);return i.sa(),new Fk(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:Jk.bind(null,t),r_:eb.bind(null,t),ta:Xk.bind(null,t),na:Zk.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Yu(t)):(await t.fa.stop(),t.Ta.length>0&&(K(Us,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cm{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new qn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,l=new cm(e,n,o,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new W(V.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function um(t,e){if(er("AsyncQueue",`${e}: ${t}`),oo(t))return new W(V.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Di{static emptySet(e){return new Di(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||J.comparator(n.key,r.key):(n,r)=>J.comparator(n.key,r.key),this.keyedMap=Ko(),this.sortedSet=new ke(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Di)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Di;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kv{constructor(){this.ga=new ke(J.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):X(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class Qi{constructor(e,n,r,s,i,o,l,c,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new Qi(e,n,Di.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Gu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nb{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class rb{constructor(){this.queries=Qv(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const s=ee(n),i=s.queries;s.queries=Qv(),i.forEach((o,l)=>{for(const c of l.Sa)c.onError(r)})})(this,new W(V.ABORTED,"Firestore shutting down"))}}function Qv(){return new Gs(t=>sE(t),Gu)}async function dm(t,e){const n=ee(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new nb,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await n.onListen(s,!0);break;case 1:i.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const l=um(o,`Initialization of query '${ci(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.Sa.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&fm(n)}async function hm(t,e){const n=ee(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function sb(t,e){const n=ee(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const l of o.Sa)l.Fa(s)&&(r=!0);o.wa=s}}r&&fm(n)}function ib(t,e,n){const r=ee(t),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(n);r.queries.delete(e)}function fm(t){t.Ca.forEach(e=>{e.next()})}var Tf,Yv;(Yv=Tf||(Tf={})).Ma="default",Yv.Cache="cache";class pm{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Qi(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Qi.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Tf.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UE{constructor(e){this.key=e}}class FE{constructor(e){this.key=e}}class ob{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=ce(),this.mutatedKeys=ce(),this.eu=iE(e),this.tu=new Di(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new Kv,s=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,l=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((f,p)=>{const g=s.get(f),w=Hu(this.query,p)?p:null,R=!!g&&this.mutatedKeys.has(g.key),N=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations);let P=!1;g&&w?g.data.isEqual(w.data)?R!==N&&(r.track({type:3,doc:w}),P=!0):this.su(g,w)||(r.track({type:2,doc:w}),P=!0,(c&&this.eu(w,c)>0||u&&this.eu(w,u)<0)&&(l=!0)):!g&&w?(r.track({type:0,doc:w}),P=!0):g&&!w&&(r.track({type:1,doc:g}),P=!0,(c||u)&&(l=!0)),P&&(w?(o=o.add(w),i=N?i.add(f):i.delete(f)):(o=o.delete(f),i=i.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),i=i.delete(f.key),r.track({type:1,doc:f})}return{tu:o,iu:r,Cs:l,mutatedKeys:i}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((f,p)=>function(w,R){const N=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return X(20277,{Rt:P})}};return N(w)-N(R)}(f.type,p.type)||this.eu(f.doc,p.doc)),this.ou(r),s=s??!1;const l=n&&!s?this._u():[],c=this.Xa.size===0&&this.current&&!s?1:0,u=c!==this.Za;return this.Za=c,o.length!==0||u?{snapshot:new Qi(this.query,e.tu,i,o,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:l}:{au:l}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Kv,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=ce(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new FE(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new UE(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=ce();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Qi.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const mm="SyncEngine";class ab{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class lb{constructor(e){this.key=e,this.hu=!1}}class cb{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Gs(l=>sE(l),Gu),this.Iu=new Map,this.Eu=new Set,this.du=new ke(J.comparator),this.Au=new Map,this.Ru=new tm,this.Vu={},this.mu=new Map,this.fu=Ki.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function ub(t,e,n=!0){const r=WE(t);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await BE(r,e,n,!0),s}async function db(t,e){const n=WE(t);await BE(n,e,!0,!1)}async function BE(t,e,n,r){const s=await kk(t.localStore,Nn(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await hb(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&DE(t.remoteStore,s),l}async function hb(t,e,n,r,s){t.pu=(p,g,w)=>async function(N,P,x,v){let T=P.view.ru(x);T.Cs&&(T=await zv(N.localStore,P.query,!1).then(({documents:S})=>P.view.ru(S,T)));const D=v&&v.targetChanges.get(P.targetId),F=v&&v.targetMismatches.get(P.targetId)!=null,z=P.view.applyChanges(T,N.isPrimaryClient,D,F);return Xv(N,P.targetId,z.au),z.snapshot}(t,p,g,w);const i=await zv(t.localStore,e,!0),o=new ob(e,i.Qs),l=o.ru(i.documents),c=sl.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),u=o.applyChanges(l,t.isPrimaryClient,c);Xv(t,n,u.au);const f=new ab(e,n,o);return t.Tu.set(e,f),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),u.snapshot}async function fb(t,e,n){const r=ee(t),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter(o=>!Gu(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Ef(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&im(r.remoteStore,s.targetId),Sf(r,s.targetId)}).catch(io)):(Sf(r,s.targetId),await Ef(r.localStore,s.targetId,!0))}async function pb(t,e){const n=ee(t),r=n.Tu.get(e),s=n.Iu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),im(n.remoteStore,r.targetId))}async function mb(t,e,n){const r=xb(t);try{const s=await function(o,l){const c=ee(o),u=he.now(),f=l.reduce((w,R)=>w.add(R.key),ce());let p,g;return c.persistence.runTransaction("Locally write mutations","readwrite",w=>{let R=tr(),N=ce();return c.Ns.getEntries(w,f).next(P=>{R=P,R.forEach((x,v)=>{v.isValidDocument()||(N=N.add(x))})}).next(()=>c.localDocuments.getOverlayedDocuments(w,R)).next(P=>{p=P;const x=[];for(const v of l){const T=kP(v,p.get(v.key).overlayedDocument);T!=null&&x.push(new ss(v.key,T,Yw(T.value.mapValue),gn.exists(!0)))}return c.mutationQueue.addMutationBatch(w,u,x,l)}).next(P=>{g=P;const x=P.applyToLocalDocumentSet(p,N);return c.documentOverlayCache.saveOverlays(w,P.batchId,x)})}).then(()=>({batchId:g.batchId,changes:aE(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,l,c){let u=o.Vu[o.currentUser.toKey()];u||(u=new ke(le)),u=u.insert(l,c),o.Vu[o.currentUser.toKey()]=u}(r,s.batchId,n),await ol(r,s.changes),await Yu(r.remoteStore)}catch(s){const i=um(s,"Failed to persist write");n.reject(i)}}async function zE(t,e){const n=ee(t);try{const r=await Nk(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Au.get(i);o&&(me(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?me(o.hu,14607):s.removedDocuments.size>0&&(me(o.hu,42227),o.hu=!1))}),await ol(n,r,e)}catch(r){await io(r)}}function Jv(t,e,n){const r=ee(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Tu.forEach((i,o)=>{const l=o.view.va(e);l.snapshot&&s.push(l.snapshot)}),function(o,l){const c=ee(o);c.onlineState=l;let u=!1;c.queries.forEach((f,p)=>{for(const g of p.Sa)g.va(l)&&(u=!0)}),u&&fm(c)}(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function gb(t,e,n){const r=ee(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Au.get(e),i=s&&s.key;if(i){let o=new ke(J.comparator);o=o.insert(i,wt.newNoDocument(i,ne.min()));const l=ce().add(i),c=new Ku(ne.min(),new Map,new ke(le),o,l);await zE(r,c),r.du=r.du.remove(i),r.Au.delete(e),gm(r)}else await Ef(r.localStore,e,!1).then(()=>Sf(r,e,n)).catch(io)}async function yb(t,e){const n=ee(t),r=e.batch.batchId;try{const s=await Ck(n.localStore,e);GE(n,r,null),$E(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await ol(n,s)}catch(s){await io(s)}}async function vb(t,e,n){const r=ee(t);try{const s=await function(o,l){const c=ee(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let f;return c.mutationQueue.lookupMutationBatch(u,l).next(p=>(me(p!==null,37113),f=p.keys(),c.mutationQueue.removeMutationBatch(u,p))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,f,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,f)).next(()=>c.localDocuments.getDocuments(u,f))})}(r.localStore,e);GE(r,e,n),$E(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await ol(r,s)}catch(s){await io(s)}}function $E(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function GE(t,e,n){const r=ee(t);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function Sf(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||HE(t,r)})}function HE(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(im(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),gm(t))}function Xv(t,e,n){for(const r of n)r instanceof UE?(t.Ru.addReference(r.key,e),_b(t,r)):r instanceof FE?(K(mm,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||HE(t,r.key)):X(19791,{wu:r})}function _b(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(K(mm,"New document in limbo: "+n),t.Eu.add(r),gm(t))}function gm(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new J(ve.fromString(e)),r=t.fu.next();t.Au.set(r,new lb(n)),t.du=t.du.insert(n,r),DE(t.remoteStore,new Nr(Nn($u(n.path)),r,"TargetPurposeLimboResolution",Fu.ce))}}async function ol(t,e,n){const r=ee(t),s=[],i=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((l,c)=>{o.push(r.pu(c,e,n).then(u=>{var f;if((u||n)&&r.isPrimaryClient){const p=u?!u.fromCache:(f=n==null?void 0:n.targetChanges.get(c.targetId))==null?void 0:f.current;r.sharedClientState.updateQueryState(c.targetId,p?"current":"not-current")}if(u){s.push(u);const p=rm.As(c.targetId,u);i.push(p)}}))}),await Promise.all(o),r.Pu.H_(s),await async function(c,u){const f=ee(c);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>U.forEach(u,g=>U.forEach(g.Es,w=>f.persistence.referenceDelegate.addReference(p,g.targetId,w)).next(()=>U.forEach(g.ds,w=>f.persistence.referenceDelegate.removeReference(p,g.targetId,w)))))}catch(p){if(!oo(p))throw p;K(sm,"Failed to update sequence numbers: "+p)}for(const p of u){const g=p.targetId;if(!p.fromCache){const w=f.Ms.get(g),R=w.snapshotVersion,N=w.withLastLimboFreeSnapshotVersion(R);f.Ms=f.Ms.insert(g,N)}}}(r.localStore,i))}async function wb(t,e){const n=ee(t);if(!n.currentUser.isEqual(e)){K(mm,"User change. New user:",e.toKey());const r=await AE(n.localStore,e);n.currentUser=e,function(i,o){i.mu.forEach(l=>{l.forEach(c=>{c.reject(new W(V.CANCELLED,o))})}),i.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ol(n,r.Ls)}}function Eb(t,e){const n=ee(t),r=n.Au.get(e);if(r&&r.hu)return ce().add(r.key);{let s=ce();const i=n.Iu.get(e);if(!i)return s;for(const o of i){const l=n.Tu.get(o);s=s.unionWith(l.view.nu)}return s}}function WE(t){const e=ee(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=zE.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Eb.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=gb.bind(null,e),e.Pu.H_=sb.bind(null,e.eventManager),e.Pu.yu=ib.bind(null,e.eventManager),e}function xb(t){const e=ee(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=yb.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=vb.bind(null,e),e}class du{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Qu(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return Rk(this.persistence,new Tk,e.initialUser,this.serializer)}Cu(e){return new NE(nm.mi,this.serializer)}Du(e){return new Dk}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}du.provider={build:()=>new du};class Tb extends du{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){me(this.persistence.referenceDelegate instanceof cu,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new lk(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?kt.withCacheSize(this.cacheSizeBytes):kt.DEFAULT;return new NE(r=>cu.mi(r,n),this.serializer)}}class If{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Jv(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=wb.bind(null,this.syncEngine),await tb(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new rb}()}createDatastore(e){const n=Qu(e.databaseInfo.databaseId),r=function(i){return new Mk(i)}(e.databaseInfo);return function(i,o,l,c){return new zk(i,o,l,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,l){return new Gk(r,s,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>Jv(this.syncEngine,n,0),function(){return Hv.v()?new Hv:new jk}())}createSyncEngine(e,n){return function(s,i,o,l,c,u,f){const p=new cb(s,i,o,l,c,u);return f&&(p.gu=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=ee(s);K(Us,"RemoteStore shutting down."),i.Ea.add(5),await lo(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}If.provider={build:()=>new If};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ym{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):er("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jr="FirestoreClient";class Sb{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=vt.UNAUTHENTICATED,this.clientId=Gp.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{K(Jr,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(K(Jr,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new qn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=um(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Xd(t,e){t.asyncQueue.verifyOperationInProgress(),K(Jr,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await AE(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Zv(t,e){t.asyncQueue.verifyOperationInProgress();const n=await qE(t);K(Jr,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>qv(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>qv(e.remoteStore,s)),t._onlineComponents=e}async function qE(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){K(Jr,"Using user provided OfflineComponentProvider");try{await Xd(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===V.FAILED_PRECONDITION||s.code===V.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Gi("Error using user provided cache. Falling back to memory cache: "+n),await Xd(t,new du)}}else K(Jr,"Using default OfflineComponentProvider"),await Xd(t,new Tb(void 0));return t._offlineComponents}async function vm(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(K(Jr,"Using user provided OnlineComponentProvider"),await Zv(t,t._uninitializedComponentsProvider._online)):(K(Jr,"Using default OnlineComponentProvider"),await Zv(t,new If))),t._onlineComponents}function KE(t){return qE(t).then(e=>e.persistence)}function QE(t){return vm(t).then(e=>e.remoteStore)}function Ib(t){return vm(t).then(e=>e.syncEngine)}async function hu(t){const e=await vm(t),n=e.eventManager;return n.onListen=ub.bind(null,e.syncEngine),n.onUnlisten=fb.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=db.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=pb.bind(null,e.syncEngine),n}function Rb(t){return t.asyncQueue.enqueue(async()=>{const e=await KE(t),n=await QE(t);return e.setNetworkEnabled(!0),function(s){const i=ee(s);return i.Ea.delete(0),il(i)}(n)})}function Cb(t){return t.asyncQueue.enqueue(async()=>{const e=await KE(t),n=await QE(t);return e.setNetworkEnabled(!1),async function(s){const i=ee(s);i.Ea.add(0),await lo(i),i.Ra.set("Offline")}(n)})}function Nb(t,e,n={}){const r=new qn;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,u){const f=new ym({next:g=>{f.Nu(),o.enqueueAndForget(()=>hm(i,p));const w=g.docs.has(l);!w&&g.fromCache?u.reject(new W(V.UNAVAILABLE,"Failed to get document because the client is offline.")):w&&g.fromCache&&c&&c.source==="server"?u.reject(new W(V.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(g)},error:g=>u.reject(g)}),p=new pm($u(l.path),f,{includeMetadataChanges:!0,qa:!0});return dm(i,p)}(await hu(t),t.asyncQueue,e,n,r)),r.promise}function Ab(t,e,n={}){const r=new qn;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,u){const f=new ym({next:g=>{f.Nu(),o.enqueueAndForget(()=>hm(i,p)),g.fromCache&&c.source==="server"?u.reject(new W(V.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(g)},error:g=>u.reject(g)}),p=new pm(l,f,{includeMetadataChanges:!0,qa:!0});return dm(i,p)}(await hu(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YE(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e_=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JE="firestore.googleapis.com",t_=!0;class n_{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new W(V.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=JE,this.ssl=t_}else this.host=e.host,this.ssl=e.ssl??t_;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=RE;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<CE)throw new W(V.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}WA("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=YE(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new W(V.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new W(V.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new W(V.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ju{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new n_({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new W(V.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new W(V.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new n_(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new VA;switch(r.type){case"firstParty":return new FA(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new W(V.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=e_.get(n);r&&(K("ComponentProvider","Removing Datastore"),e_.delete(n),r.terminate())}(this),Promise.resolve()}}function Pb(t,e,n,r={}){var u;t=Ct(t,Ju);const s=$s(e),i=t._getSettings(),o={...i,emulatorOptions:t._getEmulatorOptions()},l=`${e}:${n}`;s&&(Pp(`https://${l}`),q0("Firestore",!0)),i.host!==JE&&i.host!==l&&Gi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...i,host:l,ssl:s,emulatorOptions:r};if(!Hr(c,o)&&(t._setSettings(c),r.mockUserToken)){let f,p;if(typeof r.mockUserToken=="string")f=r.mockUserToken,p=vt.MOCK_USER;else{f=oC(r.mockUserToken,(u=t._app)==null?void 0:u.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new W(V.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new vt(g)}t._authCredentials=new LA(new Lw(f,p))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new is(this.firestore,e,this._query)}}class Ve{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new zr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ve(this.firestore,e,this._key)}toJSON(){return{type:Ve._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(nl(n,Ve._jsonSchema))return new Ve(e,r||null,new J(ve.fromString(n.referencePath)))}}Ve._jsonSchemaVersion="firestore/documentReference/1.0",Ve._jsonSchema={type:Ke("string",Ve._jsonSchemaVersion),referencePath:Ke("string")};class zr extends is{constructor(e,n,r){super(e,n,$u(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ve(this.firestore,null,new J(e))}withConverter(e){return new zr(this.firestore,e,this._path)}}function gs(t,e,...n){if(t=rt(t),Mw("collection","path",e),t instanceof Ju){const r=ve.fromString(e,...n);return mv(r),new zr(t,null,r)}{if(!(t instanceof Ve||t instanceof zr))throw new W(V.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ve.fromString(e,...n));return mv(r),new zr(t.firestore,null,r)}}function an(t,e,...n){if(t=rt(t),arguments.length===1&&(e=Gp.newId()),Mw("doc","path",e),t instanceof Ju){const r=ve.fromString(e,...n);return pv(r),new Ve(t,null,new J(r))}{if(!(t instanceof Ve||t instanceof zr))throw new W(V.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ve.fromString(e,...n));return pv(r),new Ve(t.firestore,t instanceof zr?t.converter:null,new J(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r_="AsyncQueue";class s_{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new kE(this,"async_queue_retry"),this._c=()=>{const r=Jd();r&&K(r_,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=Jd();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Jd();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new qn;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!oo(e))throw e;K(r_,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,er("INTERNAL UNHANDLED ERROR: ",i_(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const s=cm.createAndSchedule(this,e,n,r,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&X(47125,{Pc:i_(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function i_(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o_(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class jn extends Ju{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new s_,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new s_(e),this._firestoreClient=void 0,await e}}}function kb(t,e,n){n||(n=Ma);const r=Ou(t,"firestore");if(r.isInitialized(n)){const s=r.getImmediate({identifier:n}),i=r.getOptions(n);if(Hr(i,e))return s;throw new W(V.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new W(V.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<CE)throw new W(V.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&$s(e.host)&&Pp(e.host),r.initialize({options:e,instanceIdentifier:n})}function bb(t,e){const n=typeof t=="object"?t:J0(),r=typeof t=="string"?t:e||Ma,s=Ou(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=sC("firestore");i&&Pb(s,...i)}return s}function uo(t){if(t._terminated)throw new W(V.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||Db(t),t._firestoreClient}function Db(t){var r,s,i;const e=t._freezeSettings(),n=function(l,c,u,f){return new rP(l,c,u,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,YE(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new Sb(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}function jb(t){return Rb(uo(t=Ct(t,jn)))}function Ob(t){return Cb(uo(t=Ct(t,jn)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jt{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Jt(ht.fromBase64String(e))}catch(n){throw new W(V.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Jt(ht.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Jt._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(nl(e,Jt._jsonSchema))return Jt.fromBase64String(e.bytes)}}Jt._jsonSchemaVersion="firestore/bytes/1.0",Jt._jsonSchema={type:Ke("string",Jt._jsonSchemaVersion),bytes:Ke("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xu{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new W(V.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ct(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _m{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new W(V.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new W(V.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return le(this._lat,e._lat)||le(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Pn._jsonSchemaVersion}}static fromJSON(e){if(nl(e,Pn._jsonSchema))return new Pn(e.latitude,e.longitude)}}Pn._jsonSchemaVersion="firestore/geoPoint/1.0",Pn._jsonSchema={type:Ke("string",Pn._jsonSchemaVersion),latitude:Ke("number"),longitude:Ke("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kn{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:kn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(nl(e,kn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new kn(e.vectorValues);throw new W(V.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}kn._jsonSchemaVersion="firestore/vectorValue/1.0",kn._jsonSchema={type:Ke("string",kn._jsonSchemaVersion),vectorValues:Ke("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vb=/^__.*__$/;class Lb{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new ss(e,this.data,this.fieldMask,n,this.fieldTransforms):new rl(e,this.data,n,this.fieldTransforms)}}class XE{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new ss(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function ZE(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw X(40011,{Ac:t})}}class wm{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new wm({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return fu(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(ZE(this.Ac)&&Vb.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class Mb{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Qu(e)}Cc(e,n,r,s=!1){return new wm({Ac:e,methodName:n,Dc:r,path:ct.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Em(t){const e=t._freezeSettings(),n=Qu(t._databaseId);return new Mb(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Ub(t,e,n,r,s,i={}){const o=t.Cc(i.merge||i.mergeFields?2:0,e,n,s);xm("Data must be an object, but it was:",o,r);const l=ex(r,o);let c,u;if(i.merge)c=new $t(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){const f=[];for(const p of i.mergeFields){const g=Rf(e,p,n);if(!o.contains(g))throw new W(V.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);nx(f,g)||f.push(g)}c=new $t(f),u=o.fieldTransforms.filter(p=>c.covers(p.field))}else c=null,u=o.fieldTransforms;return new Lb(new Dt(l),c,u)}class Zu extends _m{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Zu}}function Fb(t,e,n,r){const s=t.Cc(1,e,n);xm("Data must be an object, but it was:",s,r);const i=[],o=Dt.empty();rs(r,(c,u)=>{const f=Tm(e,c,n);u=rt(u);const p=s.yc(f);if(u instanceof Zu)i.push(f);else{const g=al(u,p);g!=null&&(i.push(f),o.set(f,g))}});const l=new $t(i);return new XE(o,l,s.fieldTransforms)}function Bb(t,e,n,r,s,i){const o=t.Cc(1,e,n),l=[Rf(e,r,n)],c=[s];if(i.length%2!=0)throw new W(V.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<i.length;g+=2)l.push(Rf(e,i[g])),c.push(i[g+1]);const u=[],f=Dt.empty();for(let g=l.length-1;g>=0;--g)if(!nx(u,l[g])){const w=l[g];let R=c[g];R=rt(R);const N=o.yc(w);if(R instanceof Zu)u.push(w);else{const P=al(R,N);P!=null&&(u.push(w),f.set(w,P))}}const p=new $t(u);return new XE(f,p,o.fieldTransforms)}function zb(t,e,n,r=!1){return al(n,t.Cc(r?4:3,e))}function al(t,e){if(tx(t=rt(t)))return xm("Unsupported field value:",e,t),ex(t,e);if(t instanceof _m)return function(r,s){if(!ZE(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const l of r){let c=al(l,s.wc(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=rt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return IP(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=he.fromDate(r);return{timestampValue:lu(s.serializer,i)}}if(r instanceof he){const i=new he(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:lu(s.serializer,i)}}if(r instanceof Pn)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Jt)return{bytesValue:_E(s.serializer,r._byteString)};if(r instanceof Ve){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:em(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof kn)return function(o,l){return{mapValue:{fields:{[qw]:{stringValue:Qw},[su]:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw l.Sc("VectorValues must only contain numeric values.");return Yp(l.serializer,u)})}}}}}}(r,s);throw s.Sc(`Unsupported field value: ${Uu(r)}`)}(t,e)}function ex(t,e){const n={};return Bw(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):rs(t,(r,s)=>{const i=al(s,e.mc(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function tx(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof he||t instanceof Pn||t instanceof Jt||t instanceof Ve||t instanceof _m||t instanceof kn)}function xm(t,e,n){if(!tx(n)||!Uw(n)){const r=Uu(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function Rf(t,e,n){if((e=rt(e))instanceof Xu)return e._internalPath;if(typeof e=="string")return Tm(t,e);throw fu("Field path arguments must be of type string or ",t,!1,void 0,n)}const $b=new RegExp("[~\\*/\\[\\]]");function Tm(t,e,n){if(e.search($b)>=0)throw fu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Xu(...e.split("."))._internalPath}catch{throw fu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function fu(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new W(V.INVALID_ARGUMENT,l+t+c)}function nx(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rx{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Ve(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Gb(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Sm("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class Gb extends rx{data(){return super.data()}}function Sm(t,e){return typeof e=="string"?Tm(t,e):e instanceof Xu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sx(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new W(V.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Im{}class ix extends Im{}function Ql(t,e,...n){let r=[];e instanceof Im&&r.push(e),r=r.concat(n),function(i){const o=i.filter(c=>c instanceof Cm).length,l=i.filter(c=>c instanceof Rm).length;if(o>1||o>0&&l>0)throw new W(V.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Rm extends ix{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Rm(e,n,r)}_apply(e){const n=this._parse(e);return ox(e._query,n),new is(e.firestore,e.converter,mf(e._query,n))}_parse(e){const n=Em(e.firestore);return function(i,o,l,c,u,f,p){let g;if(u.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new W(V.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){l_(p,f);const R=[];for(const N of p)R.push(a_(c,i,N));g={arrayValue:{values:R}}}else g=a_(c,i,p)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||l_(p,f),g=zb(l,o,p,f==="in"||f==="not-in");return qe.create(u,f,g)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}class Cm extends Im{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Cm(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:vn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const l=i.getFlattenedFilters();for(const c of l)ox(o,c),o=mf(o,c)}(e._query,n),new is(e.firestore,e.converter,mf(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Nm extends ix{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Nm(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new W(V.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new W(V.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ba(i,o)}(e._query,this._field,this._direction);return new is(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new ao(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function Yl(t,e="asc"){const n=e,r=Sm("orderBy",t);return Nm._create(r,n)}function a_(t,e,n){if(typeof(n=rt(n))=="string"){if(n==="")throw new W(V.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!rE(e)&&n.indexOf("/")!==-1)throw new W(V.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(ve.fromString(n));if(!J.isDocumentKey(r))throw new W(V.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Tv(t,new J(r))}if(n instanceof Ve)return Tv(t,n._key);throw new W(V.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Uu(n)}.`)}function l_(t,e){if(!Array.isArray(t)||t.length===0)throw new W(V.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function ox(t,e){const n=function(s,i){for(const o of s)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new W(V.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new W(V.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class Hb{convertValue(e,n="none"){switch(Qr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Me(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Kr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw X(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return rs(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var r,s,i;const n=(i=(s=(r=e.fields)==null?void 0:r[su].arrayValue)==null?void 0:s.values)==null?void 0:i.map(o=>Me(o.doubleValue));return new kn(n)}convertGeoPoint(e){return new Pn(Me(e.latitude),Me(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=zu(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(La(e));default:return null}}convertTimestamp(e){const n=qr(e);return new he(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=ve.fromString(e);me(IE(r),9688,{name:e});const s=new Ua(r.get(1),r.get(3)),i=new J(r.popFirst(5));return s.isEqual(n)||er(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wb(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class Yo{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class As extends rx{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new vc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Sm("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new W(V.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=As._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}As._jsonSchemaVersion="firestore/documentSnapshot/1.0",As._jsonSchema={type:Ke("string",As._jsonSchemaVersion),bundleSource:Ke("string","DocumentSnapshot"),bundleName:Ke("string"),bundle:Ke("string")};class vc extends As{data(e={}){return super.data(e)}}class Ps{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Yo(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new vc(this._firestore,this._userDataWriter,r.key,r,new Yo(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new W(V.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(l=>{const c=new vc(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Yo(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const c=new vc(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Yo(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,f=-1;return l.type!==0&&(u=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),f=o.indexOf(l.doc.key)),{type:qb(l.type),doc:c,oldIndex:u,newIndex:f}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new W(V.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ps._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Gp.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function qb(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return X(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cf(t){t=Ct(t,Ve);const e=Ct(t.firestore,jn);return Nb(uo(e),t._key).then(n=>ax(e,t,n))}Ps._jsonSchemaVersion="firestore/querySnapshot/1.0",Ps._jsonSchema={type:Ke("string",Ps._jsonSchemaVersion),bundleSource:Ke("string","QuerySnapshot"),bundleName:Ke("string"),bundle:Ke("string")};class Am extends Hb{constructor(e){super(),this.firestore=e}convertBytes(e){return new Jt(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ve(this.firestore,null,n)}}function si(t){t=Ct(t,is);const e=Ct(t.firestore,jn),n=uo(e),r=new Am(e);return sx(t._query),Ab(n,t._query).then(s=>new Ps(e,r,t,s))}function _c(t,e,n){t=Ct(t,Ve);const r=Ct(t.firestore,jn),s=Wb(t.converter,e,n);return Pm(r,[Ub(Em(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,gn.none())])}function Zd(t,e,n,...r){t=Ct(t,Ve);const s=Ct(t.firestore,jn),i=Em(s);let o;return o=typeof(e=rt(e))=="string"||e instanceof Xu?Bb(i,"updateDoc",t._key,e,n,r):Fb(i,"updateDoc",t._key,e),Pm(s,[o.toMutation(t._key,gn.exists(!0))])}function eh(t){return Pm(Ct(t.firestore,jn),[new Jp(t._key,gn.none())])}function Kb(t,...e){var c,u,f;t=rt(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||o_(e[r])||(n=e[r++]);const s={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(o_(e[r])){const p=e[r];e[r]=(c=p.next)==null?void 0:c.bind(p),e[r+1]=(u=p.error)==null?void 0:u.bind(p),e[r+2]=(f=p.complete)==null?void 0:f.bind(p)}let i,o,l;if(t instanceof Ve)o=Ct(t.firestore,jn),l=$u(t._key.path),i={next:p=>{e[r]&&e[r](ax(o,t,p))},error:e[r+1],complete:e[r+2]};else{const p=Ct(t,is);o=Ct(p.firestore,jn),l=p._query;const g=new Am(o);i={next:w=>{e[r]&&e[r](new Ps(o,g,p,w))},error:e[r+1],complete:e[r+2]},sx(t._query)}return function(g,w,R,N){const P=new ym(N),x=new pm(w,P,R);return g.asyncQueue.enqueueAndForget(async()=>dm(await hu(g),x)),()=>{P.Nu(),g.asyncQueue.enqueueAndForget(async()=>hm(await hu(g),x))}}(uo(o),l,s,i)}function Pm(t,e){return function(r,s){const i=new qn;return r.asyncQueue.enqueueAndForget(async()=>mb(await Ib(r),s,i)),i.promise}(uo(t),e)}function ax(t,e,n){const r=n.docs.get(e._key),s=new Am(t);return new As(t,s,e._key,r,new Yo(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(s){so=s})(no),zi(new Vs("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),l=new jn(new MA(r.getProvider("auth-internal")),new BA(o,r.getProvider("app-check-internal")),function(u,f){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new W(V.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ua(u.options.projectId,f)}(o,s),o);return i={useFetchStreams:n,...i},l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),Fr(uv,dv,e),Fr(uv,dv,"esm2020")})();const Qb={apiKey:"AIzaSyBBJxbUabZm4ZKhDhIgbN4L3RzSHTB9HRs",authDomain:"knitting-counter-web.firebaseapp.com",projectId:"knitting-counter-web",storageBucket:"knitting-counter-web.firebasestorage.app",messagingSenderId:"991773187813",appId:"1:991773187813:web:97c6cd3d3e0add31213e0c",measurementId:"G-4T4J8NYV3D"},Nf=Y0(Qb),wc=bA(Nf),Yb=()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);let De;try{const t={ignoreUndefinedProperties:!0,cacheSizeBytes:41943040,localCache:{kind:"persistent"}};Yb()?(console.log("[FIREBASE] Mobile device detected, using optimized settings"),Object.assign(t,{experimentalForceLongPolling:!0,experimentalAutoDetectLongPolling:!1})):(console.log("[FIREBASE] Desktop device detected, using standard settings"),Object.assign(t,{experimentalForceLongPolling:!1,experimentalAutoDetectLongPolling:!0})),De=kb(Nf,t)}catch{console.log("[FIREBASE] Firestore already initialized, using existing instance"),De=bb(Nf)}const Jb=new Bn,at=U0()(F0((t,e)=>({user:null,isLoading:!1,error:null,setUser:n=>t({user:n}),setLoading:n=>t({isLoading:n}),setError:n=>t({error:n}),signInWithGoogle:async()=>{try{t({isLoading:!0,error:null});const n=await B2(wc,Jb);t({user:n.user,isLoading:!1})}catch(n){console.error("Google 登入失敗:",n),t({error:n.message||"登入失敗",isLoading:!1})}},signOut:async()=>{try{t({isLoading:!0,error:null}),await E2(wc),t({user:null,isLoading:!1})}catch(n){console.error("登出失敗:",n),t({error:n.message||"登出失敗",isLoading:!1})}},initialize:()=>w2(wc,n=>{t({user:n,isLoading:!1})})}),{name:"auth-storage",partialize:t=>({user:t.user})}));class Xb{async getUserProfile(e){try{const n=an(De,"users",e,"profile","info"),r=await Cf(n);if(r.exists()){const s=r.data();return{uid:s.uid,displayName:s.displayName,email:s.email,createdAt:s.createdAt.toDate(),lastLogin:s.lastLogin.toDate()}}return null}catch(n){throw console.error("Error getting user profile:",n),n}}async createUserProfile(e){try{const n=an(De,"users",e.uid,"profile","info");await _c(n,{uid:e.uid,displayName:e.displayName,email:e.email,createdAt:he.fromDate(e.createdAt),lastLogin:he.fromDate(e.lastLogin)})}catch(n){throw console.error("Error creating user profile:",n),n}}async updateUserLastLogin(e){try{const n=an(De,"users",e,"profile","info");await Zd(n,{lastLogin:he.fromDate(new Date)})}catch(n){throw console.error("Error updating last login:",n),n}}async getUserProjects(e){try{const n=gs(De,"users",e,"projects"),r=Ql(n,Yl("lastModified","desc")),s=await si(r),i=[];for(const o of s.docs){const l=o.data(),c=gs(De,"users",e,"projects",o.id,"rounds"),u=Ql(c,Yl("roundNumber")),p=(await si(u)).docs.map(g=>{const w=g.data();return{id:w.id,roundNumber:w.roundNumber,stitches:w.stitches,stitchGroups:w.stitchGroups,notes:w.notes}});i.push({id:l.id,name:l.name,source:l.source,pattern:p,currentRound:l.currentRound,currentStitch:l.currentStitch,yarns:l.yarns,sessions:l.sessions.map(g=>({...g,startTime:g.startTime instanceof Date?g.startTime:g.startTime.toDate()})),createdDate:l.createdDate instanceof Date?l.createdDate:l.createdDate.toDate(),lastModified:l.lastModified instanceof Date?l.lastModified:l.lastModified.toDate(),isCompleted:l.isCompleted})}return i}catch(n){throw console.error("Error getting user projects:",n),n}}async createProject(e,n){var r;try{const s=an(De,"users",e,"projects",n.id),i={id:n.id,name:n.name,source:n.source||"",currentRound:n.currentRound,currentStitch:n.currentStitch,yarns:n.yarns||[],sessions:((r=n.sessions)==null?void 0:r.map(o=>({...o,startTime:o.startTime})))||[],createdDate:n.createdDate,lastModified:n.lastModified,isCompleted:n.isCompleted??!1};await _c(s,{...i,createdDate:he.fromDate(i.createdDate),lastModified:he.fromDate(i.lastModified),sessions:i.sessions.map(o=>({...o,startTime:he.fromDate(o.startTime)}))});for(const o of n.pattern)await this.createRound(e,n.id,o)}catch(s){throw console.error("Error creating project:",s),s}}async updateProject(e,n){var r;try{console.log("[FIRESTORE] Updating project:",n.id,{currentRound:n.currentRound,currentStitch:n.currentStitch,isCompleted:n.isCompleted,patternLength:n.pattern.length}),console.log("[FIRESTORE] Syncing rounds first..."),await this.syncRounds(e,n.id,n.pattern),console.log("[FIRESTORE] Rounds synced successfully");const s=an(De,"users",e,"projects",n.id),i={name:n.name,source:n.source||"",currentRound:n.currentRound,currentStitch:n.currentStitch,yarns:n.yarns||[],sessions:((r=n.sessions)==null?void 0:r.map(c=>({...c,startTime:c.startTime})))||[],lastModified:n.lastModified,isCompleted:n.isCompleted??!1};console.log("[FIRESTORE] Updating project document..."),await Zd(s,{...i,lastModified:he.fromDate(i.lastModified),sessions:i.sessions.map(c=>({...c,startTime:he.fromDate(c.startTime)}))}),console.log("[FIRESTORE] Project sync completed successfully");const o=gs(De,"users",e,"projects",n.id,"rounds"),l=await si(o);console.log("[FIRESTORE] Verification - Local pattern length:",n.pattern.length,"Remote rounds count:",l.docs.length)}catch(s){if(console.error("[FIRESTORE] Error updating project:",s),s instanceof Error&&(s.message.includes("offline")||s.message.includes("network")||s.message.includes("fetch")||s.message.includes("unavailable")||s.message.includes("timeout")||s.name==="AbortError")&&(console.error("[FIRESTORE] Network connectivity issue detected:",s.message),s.message.includes("failed to connect")||s.message.includes("network-request-failed"))){console.log("[FIRESTORE] Attempting to restart Firestore connection...");try{await this.enableOfflineSupport(),setTimeout(async()=>{await this.disableOfflineSupport()},1e3)}catch(i){console.error("[FIRESTORE] Failed to restart connection:",i)}}throw s}}async deleteProject(e,n){try{const r=gs(De,"users",e,"projects",n,"rounds"),s=await si(r);for(const o of s.docs)await eh(o.ref);const i=an(De,"users",e,"projects",n);await eh(i)}catch(r){throw console.error("Error deleting project:",r),r}}async createRound(e,n,r){try{console.log("[FIRESTORE-CREATE-ROUND] Creating round:",{userId:e,projectId:n,roundId:r.id,roundNumber:r.roundNumber,stitchCount:r.stitches.length,groupCount:r.stitchGroups.length});const s=an(De,"users",e,"projects",n,"rounds",r.id),i={id:r.id,roundNumber:r.roundNumber,stitches:r.stitches,stitchGroups:r.stitchGroups};r.notes!==void 0&&r.notes!==null&&(i.notes=r.notes),await _c(s,i),console.log("[FIRESTORE-CREATE-ROUND] Round created successfully:",r.id)}catch(s){throw console.error("[FIRESTORE-CREATE-ROUND] Error creating round:",r.id,s),s}}async updateRound(e,n,r){try{console.log("[FIRESTORE-UPDATE-ROUND] Updating round:",{userId:e,projectId:n,roundId:r.id,roundNumber:r.roundNumber,stitchCount:r.stitches.length,groupCount:r.stitchGroups.length});const s=an(De,"users",e,"projects",n,"rounds",r.id),i={roundNumber:r.roundNumber,stitches:r.stitches,stitchGroups:r.stitchGroups};r.notes!==void 0&&r.notes!==null&&(i.notes=r.notes),await Zd(s,i),console.log("[FIRESTORE-UPDATE-ROUND] Round updated successfully:",r.id)}catch(s){throw console.error("[FIRESTORE-UPDATE-ROUND] Error updating round:",r.id,s),s}}async deleteRound(e,n,r){try{console.log("[FIRESTORE-DELETE-ROUND] Deleting round:",{userId:e,projectId:n,roundId:r});const s=an(De,"users",e,"projects",n,"rounds",r);await eh(s),console.log("[FIRESTORE-DELETE-ROUND] Round deleted successfully:",r)}catch(s){throw console.error("[FIRESTORE-DELETE-ROUND] Error deleting round:",r,s),s}}async syncRounds(e,n,r){try{console.log("[FIRESTORE-SYNC-ROUNDS] Starting sync for project:",n,{localRoundsCount:r.length,roundIds:r.map(u=>({id:u.id,roundNumber:u.roundNumber}))});const s=gs(De,"users",e,"projects",n,"rounds"),i=await si(s),o=new Set(i.docs.map(u=>u.id)),l=new Set(r.map(u=>u.id));console.log("[FIRESTORE-SYNC-ROUNDS] Round comparison:",{existingCount:o.size,currentCount:l.size,toDelete:Array.from(o).filter(u=>!l.has(u)),toCreateOrUpdate:r.map(u=>({id:u.id,action:o.has(u.id)?"update":"create"}))});const c=Array.from(o).filter(u=>!l.has(u));for(const u of c)console.log("[FIRESTORE-SYNC-ROUNDS] Deleting round:",u),await this.deleteRound(e,n,u);for(const u of r)o.has(u.id)?(console.log("[FIRESTORE-SYNC-ROUNDS] Updating round:",u.id,{roundNumber:u.roundNumber,stitchCount:u.stitches.length,groupCount:u.stitchGroups.length}),await this.updateRound(e,n,u)):(console.log("[FIRESTORE-SYNC-ROUNDS] Creating new round:",u.id,{roundNumber:u.roundNumber,stitchCount:u.stitches.length,groupCount:u.stitchGroups.length}),await this.createRound(e,n,u));console.log("[FIRESTORE-SYNC-ROUNDS] Sync completed successfully")}catch(s){throw console.error("Error syncing rounds:",s),s}}subscribeToUserProjects(e,n){const r=gs(De,"users",e,"projects"),s=Ql(r,Yl("lastModified","desc"));return Kb(s,async i=>{try{const o=[];for(const l of i.docs){const c=l.data(),u=gs(De,"users",e,"projects",l.id,"rounds"),f=Ql(u,Yl("roundNumber")),g=(await si(f)).docs.map(w=>{const R=w.data();return{id:R.id,roundNumber:R.roundNumber,stitches:R.stitches,stitchGroups:R.stitchGroups,notes:R.notes}});o.push({id:c.id,name:c.name,source:c.source,pattern:g,currentRound:c.currentRound,currentStitch:c.currentStitch,yarns:c.yarns,sessions:c.sessions.map(w=>({...w,startTime:w.startTime instanceof Date?w.startTime:w.startTime.toDate()})),createdDate:c.createdDate instanceof Date?c.createdDate:c.createdDate.toDate(),lastModified:c.lastModified instanceof Date?c.lastModified:c.lastModified.toDate(),isCompleted:c.isCompleted})}n(o)}catch(o){console.error("Error in projects subscription:",o)}})}async enableOfflineSupport(){try{await jb(De),console.log("[FIRESTORE] Network enabled successfully")}catch(e){console.error("[FIRESTORE] Error enabling network:",e)}}async disableOfflineSupport(){try{await Ob(De),console.log("[FIRESTORE] Network disabled successfully")}catch(e){console.error("[FIRESTORE] Error disabling network:",e)}}async testConnection(){try{const e=an(De,"test","connectivity");return await Cf(e),console.log("[FIRESTORE] Connection test completed successfully"),!0}catch(e){return console.error("[FIRESTORE] Connection test failed:",e),e instanceof Error?!(e.message.includes("offline")||e.message.includes("network")||e.message.includes("unavailable")||e.message.includes("failed to connect")):!1}}}const Re=new Xb,ws=class ws{constructor(){Do(this,"isOnline",navigator.onLine);Do(this,"listeners",[]);this.setupEventListeners()}static getInstance(){return ws.instance||(ws.instance=new ws),ws.instance}setupEventListeners(){window.addEventListener("online",()=>{console.log("[NETWORK] Connection restored"),this.isOnline=!0,this.notifyListeners()}),window.addEventListener("offline",()=>{console.log("[NETWORK] Connection lost"),this.isOnline=!1,this.notifyListeners()}),document.addEventListener("visibilitychange",()=>{document.hidden||this.checkConnectionStatus()})}async checkConnectionStatus(){try{if(!navigator.onLine){const s=this.isOnline;this.isOnline=!1,s&&(console.log("[NETWORK] Navigator reports offline"),this.notifyListeners());return}const e=["https://www.google.com/favicon.ico","https://httpbin.org/status/200","/favicon.ico"];let n=!1;for(const s of e)try{const i=new AbortController,o=setTimeout(()=>i.abort(),3e3),l=await fetch(s,{method:"HEAD",cache:"no-cache",signal:i.signal});if(clearTimeout(o),l.ok){n=!0;break}}catch{continue}const r=!this.isOnline;this.isOnline=n,r&&this.isOnline?(console.log("[NETWORK] Connection status verified: online"),this.notifyListeners()):!r&&!this.isOnline&&(console.log("[NETWORK] Connection status verified: offline"),this.notifyListeners())}catch(e){console.error("[NETWORK] Connection check failed:",e)}}notifyListeners(){this.listeners.forEach(e=>{try{e(this.isOnline)}catch(n){console.error("[NETWORK] Error in network status listener:",n)}})}getIsOnline(){return this.isOnline}addListener(e){return this.listeners.push(e),()=>{const n=this.listeners.indexOf(e);n>-1&&this.listeners.splice(n,1)}}async waitForConnection(e=1e4){return this.isOnline?!0:new Promise(n=>{const r=setTimeout(()=>{s(),n(!1)},e),s=this.addListener(i=>{i&&(clearTimeout(r),s(),n(!0))})})}};Do(ws,"instance");let Af=ws;const ha=Af.getInstance(),Ft=U0()(F0((t,e)=>({projects:[],currentProject:null,isLoading:!1,error:null,isSyncing:!1,lastSyncTime:null,isLocallyUpdating:!1,lastLocalUpdateTime:null,recentLocalChanges:new Set,networkStatusListener:null,setLoading:n=>t({isLoading:n}),setError:n=>t({error:n}),setSyncing:n=>t({isSyncing:n}),clearUserData:()=>{t({projects:[],currentProject:null,error:null,lastSyncTime:null})},clearUserDataSilently:()=>{const n=e();Object.assign(n,{projects:[],currentProject:null,error:null,lastSyncTime:null})},loadUserProjects:async()=>{const{user:n}=at.getState();if(!n){e().clearUserDataSilently();return}try{t({isLoading:!0,error:null});const r=await Re.getUserProjects(n.uid);if(r.length>0){console.log("Loaded projects from Firestore:",r.length),t({projects:r,currentProject:r[0]||null,lastSyncTime:new Date});return}const s=`user_${n.uid}_knitting-counter-storage`,i=localStorage.getItem(s);if(i)try{const l=JSON.parse(i),c=l.state||l;if(c.projects&&c.projects.length>0){const u=c.projects.map(f=>{var p;return{...f,createdDate:new Date(f.createdDate),lastModified:new Date(f.lastModified),sessions:((p=f.sessions)==null?void 0:p.map(g=>({...g,startTime:new Date(g.startTime)})))||[]}});console.log("Migrating local projects to Firestore:",u.length);for(const f of u)await Re.createProject(n.uid,f);t({projects:u,currentProject:u[0]||null,lastSyncTime:new Date});return}}catch(l){console.error("Error parsing saved data:",l)}console.log("No data found, creating sample project");const o=Fd();await Re.createProject(n.uid,o),t({projects:[o],currentProject:o,lastSyncTime:new Date})}catch(r){console.error("Error loading user projects:",r),t({error:"載入專案時發生錯誤"});const s=`user_${n.uid}_knitting-counter-storage`,i=localStorage.getItem(s);if(i)try{const o=JSON.parse(i),l=o.state||o;if(l.projects){const c=l.projects.map(u=>{var f;return{...u,createdDate:new Date(u.createdDate),lastModified:new Date(u.lastModified),sessions:((f=u.sessions)==null?void 0:f.map(p=>({...p,startTime:new Date(p.startTime)})))||[]}});t({projects:c,currentProject:c[0]||null})}}catch(o){console.error("Error loading from localStorage:",o);const l=Fd();t({projects:[l],currentProject:l})}}finally{t({isLoading:!1})}},syncWithFirestore:async()=>{const{user:n}=at.getState();if(n)try{t({isSyncing:!0,error:null});const r=await Re.getUserProjects(n.uid);t({projects:r,currentProject:r.find(s=>{var i;return s.id===((i=e().currentProject)==null?void 0:i.id)})||r[0]||null,lastSyncTime:new Date})}catch(r){console.error("Error syncing with Firestore:",r),t({error:"同步失敗"})}finally{t({isSyncing:!1})}},initializeUserProfile:async n=>{try{if(await Re.getUserProfile(n.uid))await Re.updateUserLastLogin(n.uid);else{const s={uid:n.uid,displayName:n.displayName,email:n.email,createdAt:new Date,lastLogin:new Date};await Re.createUserProfile(s)}}catch(r){console.error("Error initializing user profile:",r)}},subscribeToFirestoreChanges:()=>{const{user:n}=at.getState();return n?Re.subscribeToUserProjects(n.uid,r=>{var g;const s=e();console.log("[FIRESTORE-SUBSCRIPTION] Received update from Firestore:",{receivedProjectsCount:r.length,currentProjectsCount:s.projects.length,currentProjectId:(g=s.currentProject)==null?void 0:g.id,timestamp:new Date().toISOString()});const i=s.lastSyncTime?Date.now()-s.lastSyncTime.getTime():1/0,o=s.lastLocalUpdateTime?Date.now()-s.lastLocalUpdateTime.getTime():1/0,l=!s.isSyncing&&!s.isLocallyUpdating&&!s.error&&s.lastSyncTime&&i>15e3&&o>2e4,c=s.projects.length!==r.length||s.projects.some((w,R)=>{const N=r[R];return!N||w.lastModified.getTime()!==N.lastModified.getTime()}),u=s.currentProject,f=r.find(w=>w.id===(u==null?void 0:u.id));let p=!1;u&&(p=s.recentLocalChanges.has(u.id),console.log("[FIRESTORE-SUBSCRIPTION] Local change protection check:",{projectId:u.id,hasRecentLocalChanges:p,recentChangesSize:s.recentLocalChanges.size})),u&&f&&(console.log("[FIRESTORE-SUBSCRIPTION] Comparing current project data:",{localProjectId:u.id,remoteProjectId:f.id,localPatternLength:u.pattern.length,remotePatternLength:f.pattern.length,localLastModified:u.lastModified.getTime(),remoteLastModified:f.lastModified.getTime(),hasRecentLocalChanges:p}),u.pattern.forEach(w=>{const R=f.pattern.find(N=>N.roundNumber===w.roundNumber);R&&console.log("[FIRESTORE-SUBSCRIPTION] Round comparison:",{roundNumber:w.roundNumber,localStitchCount:w.stitches.length,remoteStitchCount:R.stitches.length})})),l&&c&&!p?(console.log("[FIRESTORE-SUBSCRIPTION] UPDATING local data from Firestore"),t({projects:r,currentProject:r.find(w=>{var R;return w.id===((R=s.currentProject)==null?void 0:R.id)})||r[0]||null,lastSyncTime:new Date})):console.log("[FIRESTORE-SUBSCRIPTION] Skipping update",{canUpdate:l,hasActualChanges:c,hasRecentLocalChanges:p,isSyncing:s.isSyncing,isLocallyUpdating:s.isLocallyUpdating,hasError:!!s.error,lastSync:s.lastSyncTime,lastLocalUpdate:s.lastLocalUpdateTime,timeSinceLastSync:i,timeSinceLastLocalUpdate:o})}):null},createProject:async(n,r)=>{const{user:s}=at.getState(),i={id:Oe(),name:n,source:r||"",pattern:[],currentRound:1,currentStitch:0,yarns:[],sessions:[],createdDate:new Date,lastModified:new Date,isCompleted:!1};if(t(o=>({projects:[...o.projects,i],currentProject:i})),s)try{await Re.createProject(s.uid,i),t({lastSyncTime:new Date})}catch(o){console.error("Error syncing new project to Firestore:",o)}},updateProject:async n=>{const{user:r}=at.getState(),s={...n,lastModified:new Date};if(t(i=>{var o;return{projects:i.projects.map(l=>l.id===n.id?s:l),currentProject:((o=i.currentProject)==null?void 0:o.id)===n.id?s:i.currentProject}}),r)try{await Re.updateProject(r.uid,s),t({lastSyncTime:new Date})}catch(i){console.error("Error syncing project update to Firestore:",i)}},deleteProject:async n=>{const{user:r}=at.getState();if(t(s=>{var i;return{projects:s.projects.filter(o=>o.id!==n),currentProject:((i=s.currentProject)==null?void 0:i.id)===n?null:s.currentProject}}),r)try{await Re.deleteProject(r.uid,n),t({lastSyncTime:new Date})}catch(s){console.error("Error syncing project deletion to Firestore:",s)}},setCurrentProject:n=>{const r=e().projects.find(s=>s.id===n);r&&t({currentProject:r})},loadProjects:async()=>{const{projects:n}=e();if(n.length===0){const r=Fd();t({projects:[r],currentProject:r})}},nextStitch:async()=>{const{currentProject:n}=e();if(!n||n.isCompleted){console.log("[DEBUG] nextStitch: No current project or already completed");return}if(!n.pattern||n.pattern.length===0){console.log("[DEBUG] nextStitch: No pattern available");return}const r=n.pattern.find(u=>u.roundNumber===n.currentRound);if(!r){console.log("[DEBUG] nextStitch: Current round not found",n.currentRound);const u=Math.min(...n.pattern.map(p=>p.roundNumber)),f={...n,currentRound:u,currentStitch:0,lastModified:new Date};await e().updateProjectLocally(f);return}const s=Bt(r);let i=n.currentStitch+1,o=n.currentRound,l=!1;if(i>=s){const u=Math.max(...n.pattern.map(f=>f.roundNumber));if(n.currentRound>=u)l=!0,i=s,o=n.currentRound;else{const f=n.currentRound+1;n.pattern.find(g=>g.roundNumber===f)?(i=0,o=f):(i=s,o=n.currentRound,l=!0)}}const c={...n,currentRound:o,currentStitch:i,isCompleted:l,lastModified:new Date};await e().updateProjectLocally(c)},previousStitch:async()=>{const{currentProject:n}=e();if(!n)return;if(!n.pattern||n.pattern.length===0){console.log("[DEBUG] previousStitch: No pattern available");return}let r=n.currentStitch-1,s=n.currentRound;if(r<0&&s>1){for(let l=n.currentRound-1;l>=1;l--){const c=n.pattern.find(u=>u.roundNumber===l);if(c){s=l,r=Bt(c)-1;break}}r<0&&(r=0,s=n.currentRound)}else r<0&&(r=0);n.pattern.find(l=>l.roundNumber===s)||(console.log("[DEBUG] previousStitch: Target round not found",s),s=Math.min(...n.pattern.map(c=>c.roundNumber)),r=0);const o={...n,currentRound:s,currentStitch:r,isCompleted:!1,lastModified:new Date};await e().updateProjectLocally(o)},setCurrentRound:async n=>{const{currentProject:r}=e();if(!r){console.log("[DEBUG] setCurrentRound: No current project");return}if(!r.pattern.find(o=>o.roundNumber===n)){console.error("[DEBUG] setCurrentRound: Invalid round number",n);return}console.log("[DEBUG] setCurrentRound: Updating from round",r.currentRound,"to",n);const i={...r,currentRound:n,currentStitch:0,isCompleted:!1,lastModified:new Date};await e().updateProjectLocally(i)},setCurrentStitch:async n=>{const{currentProject:r}=e();if(!r)return;const s={...r,currentStitch:n,lastModified:new Date};await e().updateProjectLocally(s)},startSession:async()=>{const{currentProject:n}=e();if(!n)return;const r={id:Oe(),startTime:new Date,duration:0,roundsCompleted:0,stitchesCompleted:0},s={...n,sessions:[...n.sessions,r],lastModified:new Date};await e().updateProjectLocally(s)},endSession:async()=>{const{currentProject:n}=e();if(!n||n.sessions.length===0)return;const r=n.sessions[n.sessions.length-1];if(r.duration>0)return;const i=Math.floor((new Date().getTime()-r.startTime.getTime())/1e3),o={...r,duration:i},l={...n,sessions:[...n.sessions.slice(0,-1),o],lastModified:new Date};await e().updateProjectLocally(l)},updateProjectLocally:async n=>{console.log("[SYNC] Starting local project update:",{projectId:n.id,lastModified:n.lastModified,userAgent:navigator.userAgent}),t(s=>{var o;const i=new Set(s.recentLocalChanges);return i.add(n.id),{isLocallyUpdating:!0,lastLocalUpdateTime:new Date,recentLocalChanges:i,projects:s.projects.map(l=>l.id===n.id?n:l),currentProject:((o=s.currentProject)==null?void 0:o.id)===n.id?n:s.currentProject}});const{user:r}=at.getState();if(r){let s=0;const i=3,o=async()=>{if(!ha.getIsOnline()&&(console.log("[SYNC] Device is offline, waiting for connection..."),!await ha.waitForConnection(5e3)))if(console.log("[SYNC] Still offline after waiting, will retry later"),s<i){s++;const c=Math.pow(2,s-1)*1e3;t({error:`設備離線，${Math.ceil(c/1e3)}秒後重試 (${s}/${i})`}),setTimeout(()=>{t({error:null}),o()},c);return}else{t({isLocallyUpdating:!1,error:"設備離線，無法同步數據"}),setTimeout(()=>t({error:null}),3e3);return}try{/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?console.log("[SYNC] Mobile device detected, skipping connection test"):!await Re.testConnection()&&s===0&&(console.log("[SYNC] Firestore connection test failed, attempting to restart connection..."),await Re.enableOfflineSupport(),await new Promise(u=>setTimeout(u,1e3)),await Re.disableOfflineSupport(),await new Promise(u=>setTimeout(u,1e3))),await Re.updateProject(r.uid,n),t(c=>{const u=new Set(c.recentLocalChanges);return u.delete(n.id),setTimeout(()=>{t(f=>{const p=new Set(f.recentLocalChanges);return p.delete(n.id),{recentLocalChanges:p}})},5e3),{lastSyncTime:new Date,isLocallyUpdating:!1,recentLocalChanges:u,error:null}}),console.log("[SYNC] Project synced successfully to Firestore:",n.id)}catch(l){console.error(`[SYNC] Error syncing project update to Firestore (attempt ${s+1}):`,l);const c=l instanceof Error&&(l.message.includes("offline")||l.message.includes("network")||l.message.includes("unavailable")||l.message.includes("timeout")||l.message.includes("failed to connect")||l.message.includes("network-request-failed")||l.message.includes("firebase")||l.message.includes("permission-denied")||l.message.includes("unauthenticated")),u=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);if(u?s<i:s<i&&c){s++;const p=u?1500:c?2e3:1e3,g=Math.pow(2,s-1)*p;console.log(`[SYNC] Retrying sync in ${g}ms... (Mobile: ${u}, Network error: ${c})`),t({error:`同步失敗，${Math.ceil(g/1e3)}秒後重試 (${s}/${i})`}),setTimeout(()=>{t({error:null}),o()},g)}else{console.error("[SYNC] Max retries reached, sync failed for project:",n.id);const p=u?"手機網路同步失敗，資料已保存在本地":c?"網路連接不穩定，同步失敗":"同步失敗，請檢查網絡連接";t(w=>{const R=new Set(w.recentLocalChanges);return{isLocallyUpdating:!1,error:p,recentLocalChanges:R}}),setTimeout(()=>{t({error:null})},u?5e3:3e3)}}};o()}else t({isLocallyUpdating:!1})},addRound:async n=>{var l,c;console.log("[ADD-ROUND] Starting addRound:",{round:n,timestamp:new Date().toISOString()});const r=e(),{currentProject:s}=r;if(!s){console.log("[ADD-ROUND] No current project found");return}console.log("[ADD-ROUND] Current state before update:",{projectId:s.id,projectName:s.name,currentPatternLength:s.pattern.length,isLocallyUpdating:r.isLocallyUpdating,isSyncing:r.isSyncing,error:r.error});const i={...s,pattern:[...s.pattern,n],lastModified:new Date};console.log("[ADD-ROUND] About to call updateProjectLocally with:",{projectId:i.id,newPatternLength:i.pattern.length,addedRound:n}),await e().updateProjectLocally(i);const o=e();console.log("[ADD-ROUND] State after updateProjectLocally:",{projectId:(l=o.currentProject)==null?void 0:l.id,patternLength:(c=o.currentProject)==null?void 0:c.pattern.length,isLocallyUpdating:o.isLocallyUpdating,isSyncing:o.isSyncing,error:o.error})},updateRound:async n=>{const{currentProject:r}=e();if(!r)return;const s={...r,pattern:r.pattern.map(i=>i.id===n.id?n:i),lastModified:new Date};await e().updateProjectLocally(s)},deleteRound:async n=>{const{currentProject:r}=e();if(!r)return;const i=r.pattern.filter(f=>f.roundNumber!==n).map(f=>f.roundNumber>n?{...f,roundNumber:f.roundNumber-1}:f);let o=r.currentRound,l=r.currentStitch;if(r.currentRound===n)if(n>1&&i.find(f=>f.roundNumber===n-1)){const f=i.find(p=>p.roundNumber===n-1);f&&(o=n-1,l=Bt(f))}else i.find(f=>f.roundNumber===n)?(o=n,l=0):(o=1,l=0);else r.currentRound>n&&(o=Math.max(1,r.currentRound-1));const c=Math.max(1,...i.map(f=>f.roundNumber));if(o>c){o=c;const f=i.find(p=>p.roundNumber===c);l=f?Bt(f):0}else{const f=i.find(p=>p.roundNumber===o);if(f){const p=Bt(f);l=Math.min(l,p)}}const u={...r,pattern:i,currentRound:o,currentStitch:l,lastModified:new Date};await e().updateProjectLocally(u)},addStitchToRound:async(n,r)=>{var u,f,p,g,w;console.log("[ADD-STITCH] Starting addStitchToRound:",{roundNumber:n,stitch:r,timestamp:new Date().toISOString()});const s=e(),{currentProject:i}=s;if(!i){console.log("[ADD-STITCH] No current project found");return}console.log("[ADD-STITCH] Current state before update:",{projectId:i.id,projectName:i.name,currentRoundInPattern:i.pattern.find(R=>R.roundNumber===n),patternLength:i.pattern.length,isLocallyUpdating:s.isLocallyUpdating,isSyncing:s.isSyncing,error:s.error});const o=i.pattern.map(R=>R.roundNumber===n?(console.log("[ADD-STITCH] Adding stitch to round:",{roundNumber:n,originalStitchCount:R.stitches.length,addedStitch:r}),$R(R,r)):R),l={...i,pattern:o,lastModified:new Date};console.log("[ADD-STITCH] About to call updateProjectLocally with:",{projectId:l.id,patternLength:l.pattern.length,targetRoundStitches:(u=l.pattern.find(R=>R.roundNumber===n))==null?void 0:u.stitches.length}),await e().updateProjectLocally(l);const c=e();console.log("[ADD-STITCH] State after updateProjectLocally:",{projectId:(f=c.currentProject)==null?void 0:f.id,patternLength:(p=c.currentProject)==null?void 0:p.pattern.length,targetRoundStitches:(w=(g=c.currentProject)==null?void 0:g.pattern.find(R=>R.roundNumber===n))==null?void 0:w.stitches.length,isLocallyUpdating:c.isLocallyUpdating,isSyncing:c.isSyncing,error:c.error})},addStitchGroupToRound:async(n,r)=>{console.log("[ADD-GROUP] Starting addStitchGroupToRound:",{roundNumber:n,group:r,timestamp:new Date().toISOString()});const{currentProject:s}=e();if(!s){console.log("[ADD-GROUP] No current project found");return}const i=s.pattern.map(l=>l.roundNumber===n?(console.log("[ADD-GROUP] Adding group to round:",{roundNumber:n,originalGroupCount:l.stitchGroups.length,addedGroup:r}),GR(l,r)):l),o={...s,pattern:i,lastModified:new Date};await e().updateProjectLocally(o)},updateStitchInRound:async(n,r,s)=>{console.log("[UPDATE-STITCH] Starting updateStitchInRound:",{roundNumber:n,stitchId:r,updatedStitch:s,timestamp:new Date().toISOString()});const{currentProject:i}=e();if(!i){console.log("[UPDATE-STITCH] No current project found");return}const o=i.pattern.map(c=>c.roundNumber===n?(console.log("[UPDATE-STITCH] Updating stitch in round:",{roundNumber:n,stitchId:r,updatedStitch:s}),WR(c,r,s)):c),l={...i,pattern:o,lastModified:new Date};await e().updateProjectLocally(l)},deleteStitchFromRound:async(n,r)=>{console.log("[DELETE-STITCH] Starting deleteStitchFromRound:",{roundNumber:n,stitchId:r,timestamp:new Date().toISOString()});const{currentProject:s}=e();if(!s){console.log("[DELETE-STITCH] No current project found");return}const i=s.pattern.map(l=>l.roundNumber===n?(console.log("[DELETE-STITCH] Deleting stitch from round:",{roundNumber:n,stitchId:r}),qR(l,r)):l),o={...s,pattern:i,lastModified:new Date};await e().updateProjectLocally(o)},reorderStitchesInRound:async(n,r,s)=>{const{currentProject:i}=e();if(!i)return;const o=i.pattern.map(c=>{if(c.roundNumber===n){const u=[...c.stitches],[f]=u.splice(r,1);return u.splice(s,0,f),{...c,stitches:u}}return c}),l={...i,pattern:o,lastModified:new Date};await e().updateProjectLocally(l)},updateStitchGroupInRound:async(n,r,s)=>{console.log("[UPDATE-GROUP] Starting updateStitchGroupInRound:",{roundNumber:n,groupId:r,updatedGroup:s,timestamp:new Date().toISOString()});const{currentProject:i}=e();if(!i){console.log("[UPDATE-GROUP] No current project found");return}const o=i.pattern.map(c=>c.roundNumber===n?(console.log("[UPDATE-GROUP] Updating group in round:",{roundNumber:n,groupId:r,updatedGroup:s}),KR(c,r,s)):c),l={...i,pattern:o,lastModified:new Date};await e().updateProjectLocally(l)},updateStitchInGroup:async(n,r,s,i)=>{const{currentProject:o}=e();if(!o)return;const l=o.pattern.map(u=>u.roundNumber===n?{...u,stitchGroups:u.stitchGroups.map(f=>f.id===r?{...f,stitches:f.stitches.map(p=>p.id===s?i:p)}:f)}:u),c={...o,pattern:l,lastModified:new Date};await e().updateProjectLocally(c)},deleteStitchGroupFromRound:async(n,r)=>{console.log("[DELETE-GROUP] Starting deleteStitchGroupFromRound:",{roundNumber:n,groupId:r,timestamp:new Date().toISOString()});const{currentProject:s}=e();if(!s){console.log("[DELETE-GROUP] No current project found");return}const i=s.pattern.map(l=>l.roundNumber===n?(console.log("[DELETE-GROUP] Deleting group from round:",{roundNumber:n,groupId:r}),QR(l,r)):l),o={...s,pattern:i,lastModified:new Date};await e().updateProjectLocally(o)},reorderStitchGroupsInRound:async(n,r,s)=>{const{currentProject:i}=e();if(!i)return;const o=i.pattern.map(c=>{if(c.roundNumber===n){const u=[...c.stitchGroups],[f]=u.splice(r,1);return u.splice(s,0,f),{...c,stitchGroups:u}}return c}),l={...i,pattern:o,lastModified:new Date};await e().updateProjectLocally(l)},reorderPatternItemsInRound:async(n,r,s)=>{console.log("[REORDER-PATTERN-ITEMS] Starting reorderPatternItemsInRound:",{roundNumber:n,fromIndex:r,toIndex:s,timestamp:new Date().toISOString()});const{currentProject:i}=e();if(!i){console.log("[REORDER-PATTERN-ITEMS] No current project found");return}const o=i.pattern.map(c=>c.roundNumber===n?(console.log("[REORDER-PATTERN-ITEMS] Reordering pattern items in round:",{roundNumber:n,fromIndex:r,toIndex:s,currentItemsCount:c.stitches.length+c.stitchGroups.length}),HR(c,r,s)):c),l={...i,pattern:o,lastModified:new Date};await e().updateProjectLocally(l)},addYarn:async n=>{const{currentProject:r}=e();if(!r)return;const s={...r,yarns:[...r.yarns,n],lastModified:new Date};await e().updateProjectLocally(s)},updateYarn:async n=>{const{currentProject:r}=e();if(!r)return;const s={...r,yarns:r.yarns.map(i=>i.id===n.id?n:i),lastModified:new Date};await e().updateProjectLocally(s)},deleteYarn:async n=>{const{currentProject:r}=e();if(!r)return;const s={...r,yarns:r.yarns.filter(i=>i.id!==n),lastModified:new Date};await e().updateProjectLocally(s)},initializeNetworkListener:()=>{const{networkStatusListener:n}=e();n&&n();const r=ha.addListener(s=>{if(console.log("[SYNC] Network status changed:",s?"online":"offline"),s){const{currentProject:i}=e();i&&(console.log("[SYNC] Network restored, attempting to sync current project..."),e().updateProjectLocally(i))}});t({networkStatusListener:r})},cleanupNetworkListener:()=>{const{networkStatusListener:n}=e();n&&(n(),t({networkStatusListener:null}))}}),{name:"synced-knitting-counter-storage",version:1,partialize:t=>({projects:t.projects,currentProject:t.currentProject,lastSyncTime:t.lastSyncTime}),storage:{getItem:t=>{var s;const{user:e}=at.getState();if(console.log("getItem called:",{name:t,user:e==null?void 0:e.uid}),!e)return console.log("No user - returning empty state"),JSON.stringify({state:{projects:[],currentProject:null,lastSyncTime:null},version:1});const n=`user_${e.uid}_${t}`,r=localStorage.getItem(n);if(console.log("Loading from storage:",{userStorageKey:n,hasData:!!r}),!r)return console.log("No data found - returning empty state"),JSON.stringify({state:{projects:[],currentProject:null,lastSyncTime:null},version:1});try{const i=JSON.parse(r);return i.state&&(i.state.projects&&(i.state.projects=i.state.projects.map(o=>{var l;return{...o,createdDate:new Date(o.createdDate),lastModified:new Date(o.lastModified),sessions:((l=o.sessions)==null?void 0:l.map(c=>({...c,startTime:new Date(c.startTime)})))||[]}})),i.state.currentProject&&(i.state.currentProject={...i.state.currentProject,createdDate:new Date(i.state.currentProject.createdDate),lastModified:new Date(i.state.currentProject.lastModified),sessions:((s=i.state.currentProject.sessions)==null?void 0:s.map(o=>({...o,startTime:new Date(o.startTime)})))||[]}),i.state.lastSyncTime&&(i.state.lastSyncTime=new Date(i.state.lastSyncTime))),i}catch{return null}},setItem:(t,e)=>{var s,i,o,l,c;const{user:n}=at.getState();if(!n){console.log("No user - skipping save to localStorage");return}const r=`user_${n.uid}_${t}`;console.log(`Saving to ${r}`,{projects:((i=(s=e==null?void 0:e.state)==null?void 0:s.projects)==null?void 0:i.length)||0,currentProject:((l=(o=e==null?void 0:e.state)==null?void 0:o.currentProject)==null?void 0:l.name)||"none",lastSyncTime:(c=e==null?void 0:e.state)==null?void 0:c.lastSyncTime}),localStorage.setItem(r,JSON.stringify(e))},removeItem:t=>{const{user:e}=at.getState();if(!e)return;const n=`user_${e.uid}_${t}`;localStorage.removeItem(n)}}}));class Zb{async mergeLocalAndRemoteData(e,n,r={strategy:"newest_wins",autoResolve:!0}){try{const s=await Re.getUserProjects(e);console.log("Merging data:",{localCount:n.length,remoteCount:s.length,strategy:r.strategy});const i={success:!0,merged:[],conflicts:[],errors:[]},o=new Map(n.map(u=>[u.id,u])),l=new Map(s.map(u=>[u.id,u])),c=new Set([...o.keys(),...l.keys()]);for(const u of c){const f=o.get(u),p=l.get(u);if(f&&!p){console.log(`Uploading local-only project: ${f.name}`);try{await Re.createProject(e,f),i.merged.push(f)}catch(g){console.error("Error uploading local project:",g),i.errors.push(`Failed to upload project ${f.name}`),i.merged.push(f)}}else if(!f&&p)console.log(`Adding remote-only project: ${p.name}`),i.merged.push(p);else if(f&&p){const g=await this.mergeProjects(e,f,p,r);g.conflict&&!r.autoResolve&&i.conflicts.push(g.conflict),i.merged.push(g.merged)}}return i.conflicts.length>0&&!r.autoResolve&&(i.success=!1),console.log("Merge completed:",{merged:i.merged.length,conflicts:i.conflicts.length,errors:i.errors.length}),i}catch(s){return console.error("Error in merge operation:",s),{success:!1,merged:n,conflicts:[],errors:[s instanceof Error?s.message:"Unknown error during merge"]}}}async mergeProjects(e,n,r,s){const i=n.lastModified.getTime(),o=r.lastModified.getTime();console.log(`Merging project ${n.name}:`,{localTime:new Date(i).toISOString(),remoteTime:new Date(o).toISOString(),timeDiff:i-o});let l,c;switch(Math.abs(i-o)<1e3?c={projectId:n.id,projectName:n.name,localVersion:n,remoteVersion:r,conflictType:"both_modified"}:i>o?c={projectId:n.id,projectName:n.name,localVersion:n,remoteVersion:r,conflictType:"local_newer"}:c={projectId:n.id,projectName:n.name,localVersion:n,remoteVersion:r,conflictType:"remote_newer"},s.strategy){case"local_wins":l=n;break;case"remote_wins":l=r;break;case"newest_wins":default:l=i>=o?n:r;break}if(s.autoResolve)try{await Re.updateProject(e,l),console.log(`Auto-resolved conflict for ${l.name}, chose ${i>=o?"local":"remote"} version`),c=void 0}catch(u){console.error("Error auto-resolving conflict:",u),l=n}return{merged:l,conflict:c}}async resolveConflict(e,n,r,s){try{let i;switch(r){case"use_local":i=n.localVersion;break;case"use_remote":i=n.remoteVersion;break;case"custom":if(!s)throw new Error("Custom project required for custom resolution");i=s;break;default:throw new Error(`Unknown resolution type: ${r}`)}return await Re.updateProject(e,i),console.log(`Conflict resolved for project ${n.projectName} using ${r}`),!0}catch(i){return console.error("Error resolving conflict:",i),!1}}async syncProjectChanges(e,n){try{const s=(await Re.getUserProjects(e)).find(i=>i.id===n.id);return s?s.lastModified.getTime()>n.lastModified.getTime()?(console.log(`Remote version is newer for ${n.name}, skipping sync`),!1):(await Re.updateProject(e,n),console.log(`Synced project changes: ${n.name}`),!0):(await Re.createProject(e,n),console.log(`Created new project in cloud: ${n.name}`),!0)}catch(r){return console.error("Error syncing project changes:",r),!1}}async performIncrementalSync(e,n,r){try{const s={updated:[],conflicts:[],errors:[]},i=await Re.getUserProjects(e),o=n?i.filter(l=>l.lastModified.getTime()>n.getTime()):i;console.log(`Incremental sync: ${o.length} changed remote projects`);for(const l of o){const c=r.find(u=>u.id===l.id);if(!c)s.updated.push(l);else{const u=c.lastModified.getTime(),f=l.lastModified.getTime();if(Math.abs(u-f)>1e3)if(f>u)s.updated.push(l);else try{await Re.updateProject(e,c),s.updated.push(c)}catch(p){s.errors.push(`Failed to sync ${c.name}: ${p}`)}}}return s}catch(s){return console.error("Error in incremental sync:",s),{updated:[],conflicts:[],errors:[s instanceof Error?s.message:"Unknown error"]}}}}const c_=new Zb;class e4{constructor(){Do(this,"unsubscribeFirestore",null)}async handleUserLogin(e){console.log("User logged in:",e.uid);try{const n=Ft.getState();await n.initializeUserProfile(e),await n.loadUserProjects(),this.unsubscribeFirestore=n.subscribeToFirestoreChanges(),console.log("User login handling completed")}catch(n){console.error("Error handling user login:",n),Ft.getState().setError("登入時載入數據失敗，請檢查網絡連接並重新整理頁面")}}async handleUserLogout(){console.log("User logged out");try{this.unsubscribeFirestore&&(this.unsubscribeFirestore(),this.unsubscribeFirestore=null),Ft.getState().clearUserData(),console.log("User logout handling completed")}catch(e){console.error("Error handling user logout:",e)}}async handleUserSwitch(e,n){console.log("User switched:",{from:(n==null?void 0:n.uid)||"none",to:e.uid});try{n&&await this.handleUserLogout(),await this.handleUserLogin(e),console.log("User switch handling completed")}catch(r){console.error("Error handling user switch:",r)}}async performCrossDeviceSync(e){console.log("Performing cross-device sync for user:",e.uid);try{const n=Ft.getState();n.setSyncing(!0);const r=n.projects,s=await c_.mergeLocalAndRemoteData(e.uid,r,{strategy:"newest_wins",autoResolve:!0});s.success?(n.projects=s.merged,n.currentProject=s.merged.find(i=>{var o;return i.id===((o=n.currentProject)==null?void 0:o.id)})||s.merged[0]||null,n.lastSyncTime=new Date,console.log("Cross-device sync completed successfully:",{merged:s.merged.length,conflicts:s.conflicts.length,errors:s.errors.length})):(console.warn("Cross-device sync completed with issues:",s.errors),n.setError("同步過程中發生問題"))}catch(n){console.error("Error in cross-device sync:",n),Ft.getState().setError("跨裝置同步失敗")}finally{Ft.getState().setSyncing(!1)}}setupAuthStateListener(){let e=null;const n=at.getState().initialize(),r=setInterval(()=>{const s=at.getState().user;(e==null?void 0:e.uid)!==(s==null?void 0:s.uid)&&(console.log("Auth state changed:",{previousUser:(e==null?void 0:e.uid)||"none",currentUser:(s==null?void 0:s.uid)||"none"}),!e&&s?this.handleUserLogin(s):e&&!s?this.handleUserLogout():e&&s&&e.uid!==s.uid?this.handleUserSwitch(s,e):s&&this.performCrossDeviceSync(s),e=s)},1e3);return()=>{n(),clearInterval(r)}}async forceSync(){const{user:e}=at.getState();e&&await this.performCrossDeviceSync(e)}async resolveConflicts(e,n){const{user:r}=at.getState();if(!r)return!1;try{for(const s of e){const i=n[s.projectId];i&&await c_.resolveConflict(r.uid,s,i==="local"?"use_local":"use_remote")}return await this.performCrossDeviceSync(r),!0}catch(s){return console.error("Error resolving conflicts:",s),!1}}}const Ec=new e4;async function t4(){try{console.log("Testing Firebase connection...");const t=an(De,"test","connection");await _c(t,{timestamp:new Date,test:"connection test"}),console.log("✅ Firebase write test successful");const e=await Cf(t);return e.exists()?console.log("✅ Firebase read test successful:",e.data()):console.log("❌ Firebase read test failed: document does not exist"),!0}catch(t){return console.error("❌ Firebase connection test failed:",t),!1}}async function n4(){var t;try{return console.log("Testing Auth connection..."),console.log("Current user:",((t=wc.currentUser)==null?void 0:t.uid)||"Not logged in"),!0}catch(e){return console.error("❌ Auth connection test failed:",e),!1}}function r4(){const{user:t,signOut:e,isLoading:n}=at(),r=async()=>{try{await e()}catch(s){console.error("登出失敗:",s)}};return t?h.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[t.photoURL&&h.jsx("img",{src:t.photoURL,alt:t.displayName||"使用者",className:"w-6 h-6 sm:w-8 sm:h-8 rounded-full"}),h.jsxs("div",{className:"hidden md:block",children:[h.jsx("p",{className:"text-xs sm:text-sm font-medium text-text-primary",children:t.displayName||"使用者"}),h.jsx("p",{className:"text-xs text-text-secondary",children:t.email})]})]}),h.jsx("button",{onClick:r,disabled:n,className:"text-xs sm:text-sm text-text-secondary hover:text-text-primary transition-colors disabled:opacity-50",title:"登出並清除當前用戶數據",children:n?"登出中...":"登出"})]}):null}function ho(){const{isSyncing:t,lastSyncTime:e,error:n,setError:r,isLocallyUpdating:s}=Ft(),[i,o]=M.useState(!1),[l,c]=M.useState(ha.getIsOnline());M.useEffect(()=>ha.addListener(p=>{c(p)}),[]);const u=async()=>{try{await Ec.forceSync()}catch(f){console.error("Manual sync failed:",f),r("手動同步失敗")}};return h.jsxs("div",{className:"relative",children:[h.jsx("button",{onClick:()=>o(!i),className:"w-2 h-2 rounded-full hover:scale-125 transition-transform",title:l?t||s?"同步中...":n?"同步錯誤":"已同步":"離線模式",children:h.jsx("div",{className:`w-2 h-2 rounded-full ${l?t||s?"bg-yellow-500 animate-pulse":n?"bg-red-500":"bg-green-500":"bg-gray-500"}`})}),i&&h.jsxs("div",{className:`absolute top-6 right-0 sm:right-0 bg-white rounded-lg shadow-lg border p-3 w-56 z-50 
                       translate-x-[-90%] sm:translate-x-0
                       max-w-[90vw] sm:max-w-none`,children:[h.jsxs("div",{className:"flex items-center justify-between mb-2",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("div",{className:`w-2 h-2 rounded-full ${l?t||s?"bg-yellow-500 animate-pulse":n?"bg-red-500":"bg-green-500":"bg-gray-500"}`}),h.jsx("span",{className:"text-sm font-medium",children:l?t||s?"同步中...":n?"同步錯誤":"已同步":"離線模式"})]}),h.jsx("button",{onClick:()=>o(!1),className:"text-text-tertiary hover:text-text-secondary text-sm",children:"✕"})]}),h.jsxs("div",{className:"text-xs text-text-secondary mb-2",children:["網絡狀態: ",l?"已連接":"離線"]}),e&&h.jsxs("div",{className:"text-xs text-text-secondary mb-2",children:["最後同步: ",e.toLocaleTimeString()]}),s&&h.jsx("div",{className:"text-xs text-yellow-600 mb-2",children:"正在同步本地更改..."}),n&&h.jsx("div",{className:`text-xs mb-2 break-words ${n.includes("重試")?"text-orange-600":"text-red-600"}`,children:n}),h.jsx("button",{onClick:u,disabled:t||s||!l,className:`w-full text-xs px-2 py-1 rounded ${t||s||!l?"bg-background-tertiary text-text-tertiary cursor-not-allowed":"bg-primary text-white hover:bg-primary-dark"}`,children:l?t||s?"同步中...":"手動同步":"離線中"})]})]})}function s4(){const{projects:t,createProject:e,deleteProject:n}=Ft(),[r,s]=M.useState(!1),[i,o]=M.useState(""),[l,c]=M.useState("");console.log("ProjectListView 渲染，專案數量:",t.length);const u=p=>{p.preventDefault(),i.trim()&&(e(i.trim(),l.trim()||void 0),o(""),c(""),s(!1))},f=(p,g)=>{confirm(`確定要刪除專案「${g}」嗎？此操作無法復原。`)&&n(p)};return h.jsxs("div",{className:"min-h-screen bg-background-primary safe-top safe-bottom",children:[h.jsx("div",{className:"bg-background-secondary border-b border-border",children:h.jsx("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-4 sm:py-6",children:h.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[h.jsx("h1",{className:"text-xl sm:text-2xl lg:text-3xl font-bold text-text-primary",children:"編織專案"}),h.jsxs("div",{className:"flex items-center gap-2 sm:gap-4 w-full sm:w-auto justify-between sm:justify-end",children:[h.jsx(r4,{}),h.jsx("button",{onClick:()=>s(!0),className:"btn btn-primary text-xs sm:text-sm",children:"新增專案"}),h.jsx(ho,{})]})]})})}),h.jsx("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-4 sm:py-6",children:t.length===0?h.jsxs("div",{className:"text-center py-8 sm:py-12",children:[h.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-text-primary mb-2",children:"還沒有編織專案"}),h.jsx("p",{className:"text-sm sm:text-base text-text-secondary mb-6",children:"建立你的第一個編織專案開始記錄進度"}),h.jsx("button",{onClick:()=>s(!0),className:"btn btn-primary text-sm sm:text-base",children:"建立新專案"})]}):h.jsx("div",{className:"grid gap-3 sm:gap-4 md:gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:t.map(p=>h.jsxs("div",{className:"card hover:shadow-md transition-shadow",children:[h.jsxs("div",{className:"flex items-start justify-between mb-3",children:[h.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[h.jsx("h3",{className:"text-base sm:text-lg font-semibold text-text-primary truncate",children:p.name}),p.isCompleted&&h.jsx("span",{className:"text-text-secondary text-sm font-medium",children:"完成"})]}),h.jsx("button",{onClick:()=>f(p.id,p.name),className:"text-text-tertiary hover:text-red-500 transition-colors text-sm sm:text-base ml-2",children:"刪除"})]}),h.jsxs("div",{className:"space-y-2 mb-4",children:[h.jsxs("div",{className:"flex justify-between text-xs sm:text-sm",children:[h.jsx("span",{className:"text-text-secondary",children:"進度"}),h.jsxs("span",{className:"text-text-primary",children:[p.isCompleted?"100":Math.round(Zh(p)*100),"%"]})]}),h.jsx("div",{className:"w-full bg-background-tertiary rounded-full h-1.5 sm:h-2",children:h.jsx("div",{className:"h-1.5 sm:h-2 rounded-full transition-all duration-300 bg-primary",style:{width:`${p.isCompleted?100:Zh(p)*100}%`}})})]}),h.jsxs("div",{className:"space-y-1 mb-4 text-xs sm:text-sm text-text-secondary",children:[h.jsxs("div",{children:["圈數: ",p.currentRound,"/",Kc(p)]}),h.jsxs("div",{children:["針數: ",Ap(p),"/",Da(p)]}),h.jsxs("div",{children:["更新: ",Jh(p.lastModified)]})]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx(It,{to:`/project/${p.id}/progress`,className:"btn btn-primary flex-1",children:"開始編織"}),h.jsx(It,{to:`/project/${p.id}`,className:"btn btn-secondary",children:"詳情"})]})]},p.id))})}),r&&h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:h.jsxs("div",{className:"bg-background-secondary rounded-xl p-6 w-full max-w-md",children:[h.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-4",children:"建立新專案"}),h.jsxs("form",{onSubmit:u,className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"專案名稱 *"}),h.jsx("input",{type:"text",value:i,onChange:p=>o(p.target.value),className:"input",placeholder:"輸入專案名稱",required:!0,autoFocus:!0})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"來源網址（選填）"}),h.jsx("input",{type:"url",value:l,onChange:p=>c(p.target.value),className:"input",placeholder:"https://..."})]}),h.jsxs("div",{className:"flex gap-3 pt-4",children:[h.jsx("button",{type:"button",onClick:()=>s(!1),className:"btn btn-secondary flex-1",children:"取消"}),h.jsx("button",{type:"submit",className:"btn btn-primary flex-1",children:"建立"})]})]})]})})]})}var lx={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},u_=Sn.createContext&&Sn.createContext(lx),i4=["attr","size","title"];function o4(t,e){if(t==null)return{};var n=a4(t,e),r,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function a4(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function pu(){return pu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},pu.apply(this,arguments)}function d_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function mu(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?d_(Object(n),!0).forEach(function(r){l4(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d_(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function l4(t,e,n){return e=c4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c4(t){var e=u4(t,"string");return typeof e=="symbol"?e:e+""}function u4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cx(t){return t&&t.map((e,n)=>Sn.createElement(e.tag,mu({key:n},e.attr),cx(e.child)))}function os(t){return e=>Sn.createElement(d4,pu({attr:mu({},t.attr)},e),cx(t.child))}function d4(t){var e=n=>{var{attr:r,size:s,title:i}=t,o=o4(t,i4),l=s||n.size||"1em",c;return n.className&&(c=n.className),t.className&&(c=(c?c+" ":"")+t.className),Sn.createElement("svg",pu({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,o,{className:c,style:mu(mu({color:t.color||n.color},n.style),t.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),i&&Sn.createElement("title",null,i),t.children)};return u_!==void 0?Sn.createElement(u_.Consumer,null,n=>e(n)):e(lx)}function h4(t){return os({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",strokeMiterlimit:"10",strokeWidth:"32",d:"M448 256c0-106-86-192-192-192S64 150 64 256s86 192 192 192 192-86 192-192z"},child:[]},{tag:"path",attr:{d:"m216.32 334.44 114.45-69.14a10.89 10.89 0 0 0 0-18.6l-114.45-69.14a10.78 10.78 0 0 0-16.32 9.31v138.26a10.78 10.78 0 0 0 16.32 9.31z"},child:[]}]})(t)}function Pf(t){return os({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M402.3 344.9l32-32c5-5 13.7-1.5 13.7 5.7V464c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h273.5c7.1 0 10.7 8.6 5.7 13.7l-32 32c-1.5 1.5-3.5 2.3-5.7 2.3H48v352h352V350.5c0-2.1.8-4.1 2.3-5.6zm156.6-201.8L296.3 405.7l-90.4 10c-26.2 2.9-48.5-19.2-45.6-45.6l10-90.4L432.9 17.1c22.9-22.9 59.9-22.9 82.7 0l43.2 43.2c22.9 22.9 22.9 60 .1 82.8zM460.1 174L402 115.9 216.2 301.8l-7.3 65.3 65.3-7.3L460.1 174zm64.8-79.7l-43.2-43.2c-4.1-4.1-10.8-4.1-14.8 0L436 82l58.1 58.1 30.9-30.9c4-4.2 4-10.8-.1-14.9z"},child:[]}]})(t)}function h_(t){return os({tag:"svg",attr:{viewBox:"0 0 32 32"},child:[{tag:"path",attr:{d:"M 16 3 C 8.855469 3 3 8.855469 3 16 C 3 23.144531 8.855469 29 16 29 C 23.144531 29 29 23.144531 29 16 C 29 8.855469 23.144531 3 16 3 Z M 16 5 C 18.355469 5 20.550781 5.757813 22.34375 7.03125 C 20.171875 6.496094 18.125 6.410156 16.40625 6.53125 C 15.101563 6.625 13.976563 6.820313 13.125 7.03125 C 12.851563 7.097656 12.675781 7.15625 12.46875 7.21875 C 12.347656 6.539063 12.3125 5.980469 12.3125 5.65625 C 13.46875 5.242188 14.703125 5 16 5 Z M 10.375 6.59375 C 10.429688 7.132813 10.542969 7.777344 10.71875 8.5 C 10.714844 8.699219 10.769531 8.894531 10.875 9.0625 C 11.203125 10.222656 11.703125 11.535156 12.5 12.90625 C 12.519531 12.9375 12.539063 12.96875 12.5625 13 C 13.175781 14.039063 13.933594 15.109375 14.90625 16.15625 C 14.652344 17.019531 14.339844 17.816406 14 18.53125 C 13.421875 18.003906 12.691406 17.226563 11.90625 16.09375 C 10.578125 14.179688 9.3125 11.421875 9.25 7.71875 C 9.25 7.601563 9.226563 7.484375 9.1875 7.375 C 9.554688 7.085938 9.972656 6.835938 10.375 6.59375 Z M 17.4375 8.46875 C 19.625 8.421875 22.261719 8.761719 24.90625 10.03125 C 25.027344 10.113281 25.167969 10.164063 25.3125 10.1875 C 25.632813 10.695313 25.921875 11.21875 26.15625 11.78125 C 23.042969 10.386719 20.15625 10.117188 17.875 10.28125 C 16.050781 10.410156 14.6875 10.808594 13.8125 11.125 C 13.46875 10.4375 13.207031 9.773438 13 9.15625 C 13.195313 9.097656 13.375 9.03125 13.625 8.96875 C 14.375 8.78125 15.359375 8.582031 16.53125 8.5 C 16.824219 8.480469 17.125 8.476563 17.4375 8.46875 Z M 7.34375 9.25 C 7.683594 12.660156 8.933594 15.320313 10.25 17.21875 C 11.277344 18.703125 12.328125 19.730469 13 20.3125 C 12.546875 21 12.058594 21.578125 11.59375 22.09375 C 10.976563 21.480469 10.101563 20.503906 9.25 19.1875 C 7.894531 17.089844 6.660156 14.195313 6.78125 10.71875 C 6.800781 10.535156 6.765625 10.351563 6.6875 10.1875 C 6.890625 9.867188 7.109375 9.546875 7.34375 9.25 Z M 18.9375 12.25 C 21.113281 12.222656 23.78125 12.652344 26.65625 14.25 C 26.714844 14.289063 26.777344 14.320313 26.84375 14.34375 C 26.917969 14.835938 26.992188 15.335938 27 15.84375 C 25.691406 15.257813 23.589844 14.554688 20.84375 14.5 C 20.65625 14.417969 20.449219 14.398438 20.25 14.4375 C 20.1875 14.453125 20.121094 14.472656 20.0625 14.5 C 20.042969 14.5 20.019531 14.5 20 14.5 C 18.921875 14.53125 17.753906 14.6875 16.53125 14.96875 C 15.871094 14.277344 15.316406 13.574219 14.84375 12.875 C 15.589844 12.640625 16.675781 12.378906 18.03125 12.28125 C 18.320313 12.261719 18.625 12.253906 18.9375 12.25 Z M 5.125 14.40625 C 5.617188 16.714844 6.5625 18.699219 7.5625 20.25 C 8.527344 21.746094 9.480469 22.808594 10.1875 23.5 C 9.699219 23.914063 9.289063 24.210938 8.96875 24.4375 C 6.542969 22.417969 5 19.390625 5 16 C 5 15.460938 5.050781 14.925781 5.125 14.40625 Z M 21.34375 16.53125 C 22.128906 16.574219 22.851563 16.648438 23.5 16.78125 C 23.476563 16.984375 23.453125 17.171875 23.40625 17.4375 C 23.269531 18.195313 23.023438 19.195313 22.59375 20.28125 C 21.734375 22.449219 20.171875 24.957031 17.25 26.6875 C 17.152344 26.753906 17.066406 26.839844 17 26.9375 C 16.671875 26.96875 16.335938 27 16 27 C 15.523438 27 15.054688 26.964844 14.59375 26.90625 C 17.382813 24.933594 19.066406 22.519531 20.0625 20.4375 C 20.636719 19.238281 20.980469 18.148438 21.1875 17.28125 C 21.257813 16.984375 21.300781 16.765625 21.34375 16.53125 Z M 19.1875 16.5625 C 19.230469 16.558594 19.273438 16.566406 19.3125 16.5625 C 19.292969 16.65625 19.273438 16.710938 19.25 16.8125 C 19.074219 17.554688 18.753906 18.507813 18.25 19.5625 C 17.242188 21.667969 15.46875 24.148438 12.25 26.03125 C 12.144531 26.078125 12.050781 26.140625 11.96875 26.21875 C 11.519531 26.039063 11.105469 25.828125 10.6875 25.59375 C 11.011719 25.34375 11.40625 25.023438 11.8125 24.65625 C 12.082031 24.664063 12.34375 24.5625 12.539063 24.375 C 12.734375 24.1875 12.84375 23.925781 12.84375 23.65625 C 13.578125 22.871094 14.332031 21.925781 15.03125 20.75 C 15.117188 20.648438 15.179688 20.53125 15.21875 20.40625 C 15.785156 19.40625 16.285156 18.261719 16.6875 16.96875 C 17.566406 16.75 18.390625 16.632813 19.1875 16.5625 Z M 25.4375 17.34375 C 26.03125 17.558594 26.488281 17.769531 26.8125 17.9375 C 26.269531 20.960938 24.507813 23.554688 22.03125 25.1875 C 23.160156 23.816406 23.945313 22.355469 24.46875 21.03125 C 24.957031 19.800781 25.21875 18.679688 25.375 17.8125 C 25.410156 17.621094 25.414063 17.503906 25.4375 17.34375 Z"},child:[]}]})(t)}function f4(t){return os({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"16 16 12 12 8 16"},child:[]},{tag:"line",attr:{x1:"12",y1:"12",x2:"12",y2:"21"},child:[]},{tag:"path",attr:{d:"M20.39 18.39A5 5 0 0 0 18 9h-1.26A8 8 0 1 0 3 16.3"},child:[]},{tag:"polyline",attr:{points:"16 16 12 12 8 16"},child:[]}]})(t)}function p4(){const{projectId:t}=Ya(),e=to(),{currentProject:n,setCurrentProject:r,projects:s}=Ft();return M.useEffect(()=>{t&&(s.find(o=>o.id===t)?r(t):e("/404"))},[t,r,s,e]),n?h.jsxs("div",{className:"min-h-screen bg-background-primary safe-top safe-bottom",children:[h.jsx("div",{className:"bg-background-secondary border-b border-border",children:h.jsx("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-3 sm:py-4",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-3 sm:gap-4",children:[h.jsx(It,{to:"/",className:"text-text-secondary hover:text-text-primary transition-colors text-sm sm:text-base",children:"← 返回"}),h.jsx("h1",{className:"text-lg sm:text-xl font-semibold text-text-primary truncate",children:n.name})]}),h.jsx(ho,{})]})})}),h.jsxs("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-4 sm:py-6 space-y-4 sm:space-y-6",children:[h.jsxs("div",{className:"card",children:[h.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-4",children:"專案資訊"}),h.jsxs("div",{className:"space-y-4",children:[n.source&&h.jsxs("div",{children:[h.jsx("div",{className:"text-sm text-text-secondary mb-1",children:"來源"}),h.jsx("a",{href:n.source,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline break-all text-sm",children:n.source})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("div",{className:"text-sm text-text-secondary mb-1",children:"建立日期"}),h.jsx("div",{className:"text-text-primary text-sm",children:Jh(n.createdDate)})]}),h.jsxs("div",{children:[h.jsx("div",{className:"text-sm text-text-secondary mb-1",children:"最後修改"}),h.jsx("div",{className:"text-text-primary text-sm",children:Jh(n.lastModified)})]})]}),h.jsxs("div",{className:"grid grid-cols-3 gap-4 pt-2 border-t border-border",children:[h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-sm text-text-secondary",children:"使用毛線"}),h.jsx("div",{className:"text-lg font-semibold text-text-primary",children:n.yarns.length})]}),h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-sm text-text-secondary",children:"織圖圈數"}),h.jsx("div",{className:"text-lg font-semibold text-text-primary",children:n.pattern.length})]}),h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-sm text-text-secondary",children:"總針數"}),h.jsx("div",{className:"text-lg font-semibold text-text-primary",children:Da(n)})]})]})]})]}),h.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:[h.jsx(It,{to:`/project/${n.id}/progress`,className:"card hover:shadow-md transition-shadow cursor-pointer",children:h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"w-12 h-12 flex items-center justify-center",children:h.jsx(h4,{className:"w-8 h-8 text-text-secondary"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"font-semibold text-text-primary",children:"開始編織"}),h.jsx("p",{className:"text-sm text-text-secondary",children:"追蹤編織進度"})]})]})}),h.jsx(It,{to:`/project/${n.id}/pattern`,className:"card hover:shadow-md transition-shadow cursor-pointer",children:h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"w-12 h-12 flex items-center justify-center",children:h.jsx(Pf,{className:"w-8 h-8 text-text-secondary"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"font-semibold text-text-primary",children:"編輯織圖"}),h.jsx("p",{className:"text-sm text-text-secondary",children:"管理圈數和針法"})]})]})}),h.jsx(It,{to:`/project/${n.id}/yarns`,className:"card hover:shadow-md transition-shadow cursor-pointer",children:h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"w-12 h-12 flex items-center justify-center",children:h.jsx(h_,{className:"w-8 h-8 text-text-secondary"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"font-semibold text-text-primary",children:"毛線管理"}),h.jsx("p",{className:"text-sm text-text-secondary",children:"管理專案毛線"})]})]})}),h.jsx(It,{to:`/project/${n.id}/import-export`,className:"card hover:shadow-md transition-shadow cursor-pointer",children:h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"w-12 h-12 flex items-center justify-center",children:h.jsx(f4,{className:"w-8 h-8 text-text-secondary"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"font-semibold text-text-primary",children:"匯入匯出"}),h.jsx("p",{className:"text-sm text-text-secondary",children:"備份和分享"})]})]})})]}),h.jsxs("div",{className:"card",children:[h.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-4",children:"使用的毛線"}),n.yarns.length===0?h.jsxs("div",{className:"text-center py-8",children:[h.jsx("div",{className:"mb-3 flex justify-center",children:h.jsx(h_,{className:"w-8 h-8 text-text-tertiary"})}),h.jsx("p",{className:"text-text-tertiary mb-3",children:"尚未添加毛線"}),h.jsx(It,{to:`/project/${n.id}/yarns`,className:"text-primary hover:underline text-sm",children:"點擊這裡管理毛線"})]}):h.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:n.yarns.map(i=>h.jsxs("div",{className:"flex items-center gap-3 p-3 bg-background-secondary rounded-lg",children:[h.jsx("div",{className:"w-8 h-8 rounded-full border-2 border-white shadow-sm flex-shrink-0",style:{backgroundColor:i.color.hex}}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("h3",{className:"font-medium text-text-primary truncate",children:i.name}),i.brand&&h.jsx("p",{className:"text-sm text-text-secondary truncate",children:i.brand}),h.jsx("p",{className:"text-xs text-text-tertiary",children:i.color.name})]})]},i.id))})]}),h.jsxs("div",{className:"card",children:[h.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-4",children:"織圖"}),n.pattern.length===0?h.jsxs("div",{className:"text-center py-8",children:[h.jsx("div",{className:"mb-3 flex justify-center",children:h.jsx(Pf,{className:"w-8 h-8 text-text-tertiary"})}),h.jsx("p",{className:"text-text-tertiary mb-3",children:"尚未建立織圖"}),h.jsx(It,{to:`/project/${n.id}/pattern`,className:"text-primary hover:underline text-sm",children:"點擊這裡開始編輯織圖"})]}):h.jsxs("div",{className:"space-y-4",children:[h.jsx("div",{className:"space-y-3",children:n.pattern.slice(0,5).map(i=>{const o=Bt(i),l=BR(i,n.yarns);return h.jsxs("div",{className:"flex gap-3 p-3 bg-background-secondary rounded-lg",children:[h.jsxs("div",{className:"text-sm font-semibold flex-shrink-0 leading-relaxed",style:{color:"#d96699"},children:["R",i.roundNumber]}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("p",{className:"text-text-primary font-medium text-sm leading-relaxed m-0",children:l}),i.notes&&h.jsx("p",{className:"text-xs text-text-tertiary mt-1",children:i.notes})]}),h.jsx("div",{className:"text-right flex-shrink-0",children:h.jsxs("p",{className:"text-sm font-semibold text-text-primary leading-relaxed m-0",children:[o," 針"]})})]},i.id)})}),h.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-border",children:[h.jsxs("div",{className:"text-sm font-medium text-text-secondary",children:["總圈數: ",Kc(n)]}),h.jsxs("div",{className:"text-sm font-medium text-text-secondary",children:["總針數: ",Da(n)]})]}),n.pattern.length>5&&h.jsx("div",{className:"text-center pt-2",children:h.jsxs(It,{to:`/project/${n.id}/pattern`,className:"text-primary hover:underline text-sm",children:["查看全部 ",n.pattern.length," 圈織圖"]})})]})]})]})]}):h.jsx("div",{className:"min-h-screen bg-background-primary flex items-center justify-center",children:h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),h.jsx("p",{className:"text-text-secondary",children:"載入中..."})]})})}function ii(t){return os({tag:"svg",attr:{viewBox:"0 0 16 16",fill:"currentColor"},child:[{tag:"path",attr:{d:"M13.23 1h-1.46L3.52 9.25l-.16.22L1 13.59 2.41 15l4.12-2.36.22-.16L15 4.23V2.77L13.23 1zM2.41 13.59l1.51-3 1.45 1.45-2.96 1.55zm3.83-2.06L4.47 9.76l8-8 1.77 1.77-8 8z"},child:[]}]})(t)}function gr(t){return os({tag:"svg",attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z"},child:[]},{tag:"path",attr:{d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z"},child:[]}]})(t)}function oi(t){return os({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"g",attr:{id:"Circle_Check"},child:[{tag:"g",attr:{},child:[{tag:"path",attr:{d:"M15.81,10.4a.5.5,0,0,0-.71-.71l-3.56,3.56L9.81,11.52a.5.5,0,0,0-.71.71l2.08,2.08a.513.513,0,0,0,.71,0Z"},child:[]},{tag:"path",attr:{d:"M12,21.934A9.934,9.934,0,1,1,21.933,12,9.945,9.945,0,0,1,12,21.934ZM12,3.067A8.934,8.934,0,1,0,20.933,12,8.944,8.944,0,0,0,12,3.067Z"},child:[]}]}]}]})(t)}function ai(t){return os({tag:"svg",attr:{viewBox:"0 0 15 15",fill:"none"},child:[{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M0.877075 7.49988C0.877075 3.84219 3.84222 0.877045 7.49991 0.877045C11.1576 0.877045 14.1227 3.84219 14.1227 7.49988C14.1227 11.1575 11.1576 14.1227 7.49991 14.1227C3.84222 14.1227 0.877075 11.1575 0.877075 7.49988ZM7.49991 1.82704C4.36689 1.82704 1.82708 4.36686 1.82708 7.49988C1.82708 10.6329 4.36689 13.1727 7.49991 13.1727C10.6329 13.1727 13.1727 10.6329 13.1727 7.49988C13.1727 4.36686 10.6329 1.82704 7.49991 1.82704ZM9.85358 5.14644C10.0488 5.3417 10.0488 5.65829 9.85358 5.85355L8.20713 7.49999L9.85358 9.14644C10.0488 9.3417 10.0488 9.65829 9.85358 9.85355C9.65832 10.0488 9.34173 10.0488 9.14647 9.85355L7.50002 8.2071L5.85358 9.85355C5.65832 10.0488 5.34173 10.0488 5.14647 9.85355C4.95121 9.65829 4.95121 9.3417 5.14647 9.14644L6.79292 7.49999L5.14647 5.85355C4.95121 5.65829 4.95121 5.3417 5.14647 5.14644C5.34173 4.95118 5.65832 4.95118 5.85358 5.14644L7.50002 6.79289L9.14647 5.14644C9.34173 4.95118 9.65832 4.95118 9.85358 5.14644Z",fill:"currentColor"},child:[]}]})(t)}function m4(){const{projectId:t}=Ya(),e=to(),{currentProject:n,setCurrentProject:r,projects:s,addRound:i,updateRound:o,deleteRound:l,addStitchToRound:c,addStitchGroupToRound:u,updateStitchInRound:f,deleteStitchFromRound:p,updateStitchGroupInRound:g,updateStitchInGroup:w,deleteStitchGroupFromRound:R,reorderPatternItemsInRound:N}=Ft(),[P,x]=M.useState(!1),[v,T]=M.useState(null),[D,F]=M.useState(null),[z,S]=M.useState(null),[_,I]=M.useState(null),[E,A]=M.useState(null),[k,C]=M.useState(null),[we,Pt]=M.useState(!1),[rn,Tt]=M.useState(""),[H,G]=M.useState(Cr.SINGLE),[q,se]=M.useState(1),[ie,ue]=M.useState(""),[Be,ze]=M.useState(1),[Ie,Qe]=M.useState([]),[On,fo]=M.useState(Cr.SINGLE),[ir,or]=M.useState(1),[as,ls]=M.useState(""),[cs,us]=M.useState(1),[Ws,qs]=M.useState(Cr.SINGLE),[po,Ks]=M.useState(1),[ar,Qs]=M.useState(null);M.useEffect(()=>{t&&(s.find(O=>O.id===t)?r(t):e("/404"))},[t,s,e]);const Kt=(L,O=1)=>({onChange:Y=>{const re=Y.target.value;if(re==="")L("");else{const Ee=parseInt(re);L(isNaN(Ee)?O:Math.max(O,Ee))}},onBlur:Y=>{Y.target.value===""&&L(O)}}),lr=(L,O=1)=>{if(typeof L=="number")return L;const Y=parseInt(L);return isNaN(Y)?O:Math.max(O,Y)};if(!n)return h.jsx("div",{className:"min-h-screen bg-background-primary flex items-center justify-center",children:h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),h.jsx("p",{className:"text-text-secondary",children:"載入中..."})]})});const mo=async()=>{var L;if(console.log("[UI-ADD-ROUND] Button clicked:",{isLoading:we,timestamp:new Date().toISOString()}),we){console.log("[UI-ADD-ROUND] Already loading, returning");return}Pt(!0),console.log("[UI-ADD-ROUND] Set loading to true");try{if(!n){console.error("[UI-ADD-ROUND] No current project");return}const O=((L=n.pattern)==null?void 0:L.map(Ee=>Ee.roundNumber))||[],Y=Math.max(0,...O)+1,re={id:Oe(),roundNumber:Y,stitches:[],stitchGroups:[],notes:rn.trim()||void 0};console.log("[UI-ADD-ROUND] About to call addRound with:",{newRound:re,currentProjectId:n.id,currentPatternLength:n.pattern.length}),await i(re),console.log("[UI-ADD-ROUND] Successfully added round, cleaning up UI state"),Tt(""),x(!1)}catch(O){console.error("[UI-ADD-ROUND] Error adding round:",O),alert("新增圈數時發生錯誤，請查看控制台了解詳情")}finally{console.log("[UI-ADD-ROUND] Setting loading to false"),Pt(!1)}},go=async L=>{confirm(`確定要刪除第 ${L} 圈嗎？`)&&await l(L)},yo=async L=>{var O;if(console.log("[UI-ADD-STITCH] Button clicked:",{roundNumber:L,isLoading:we,timestamp:new Date().toISOString()}),we){console.log("[UI-ADD-STITCH] Already loading, returning");return}Pt(!0),console.log("[UI-ADD-STITCH] Set loading to true");try{if(!n){console.error("[UI-ADD-STITCH] No current project");return}const Y={id:Oe(),type:H,yarnId:((O=n.yarns[0])==null?void 0:O.id)||"",count:lr(q)};console.log("[UI-ADD-STITCH] About to call addStitchToRound with:",{roundNumber:L,newStitch:Y,currentProjectId:n.id}),await c(L,Y),console.log("[UI-ADD-STITCH] Successfully added stitch, cleaning up UI state"),se(1),T(null)}catch(Y){console.error("[UI-ADD-STITCH] Error adding stitch:",Y),alert("新增針法時發生錯誤，請查看控制台了解詳情")}finally{console.log("[UI-ADD-STITCH] Setting loading to false"),Pt(!1)}},Ze=async L=>{if(Ie.length===0){alert("請先新增群組中的針法");return}const O={id:Oe(),name:ie.trim()||"針目群組",stitches:[...Ie],repeatCount:lr(Be)};await u(L,O),ue(""),ze(1),Qe([]),F(null)},st=()=>{var O;const L={id:Oe(),type:H,yarnId:((O=n.yarns[0])==null?void 0:O.id)||"",count:lr(q)};Qe([...Ie,L]),se(1)},Ys=L=>{Qe(Ie.filter(O=>O.id!==L))},vo=async(L,O)=>{const Y={...L,notes:O.trim()||void 0};await o(Y),S(null)},_o=(L,O)=>{I({roundNumber:L,stitchId:O.id}),fo(O.type),or(O.count)},ll=async(L,O)=>{var re;const Y={id:O,type:On,yarnId:((re=n.yarns[0])==null?void 0:re.id)||"",count:lr(ir)};await f(L,O,Y),I(null)},cr=async(L,O)=>{confirm("確定要刪除這個針法嗎？")&&await p(L,O)},wo=(L,O)=>{A({roundNumber:L,groupId:O.id}),ls(O.name),us(O.repeatCount)},Eo=async(L,O,Y)=>{const re={...Y,name:as.trim()||"針目群組",repeatCount:lr(cs)};await g(L,O,re),A(null)},Js=async(L,O)=>{confirm("確定要刪除這個針目群組嗎？")&&await R(L,O)},cl=(L,O,Y)=>{C({roundNumber:L,groupId:O,stitchId:Y.id}),qs(Y.type),Ks(Y.count)},ul=async(L,O,Y)=>{var Ee;const re={id:Y,type:Ws,yarnId:((Ee=n.yarns[0])==null?void 0:Ee.id)||"",count:lr(po)};await w(L,O,Y,re),C(null)},Xs=async(L,O,Y)=>{if(confirm("確定要刪除這個針法嗎？")){const re=n==null?void 0:n.pattern.find(te=>te.roundNumber===L),Ee=re==null?void 0:re.stitchGroups.find(te=>te.id===O);if(Ee){const te={...Ee,stitches:Ee.stitches.filter(Le=>Le.id!==Y)};await g(L,O,te)}}},ds=(L,O,Y)=>{console.log("[DRAG] Starting drag for PatternItem:",{index:O,roundNumber:Y}),Qs({index:O,roundNumber:Y})},hs=L=>{L.preventDefault()},_n=async(L,O,Y)=>{L.preventDefault(),ar&&ar.roundNumber===Y?(console.log("[DRAG] Dropping PatternItem:",{fromIndex:ar.index,toIndex:O,roundNumber:Y}),ar.index!==O&&await N(Y,ar.index,O),Qs(null)):console.log("[DRAG] Invalid drop - different rounds or no dragged item")};return h.jsxs("div",{className:"min-h-screen bg-background-primary safe-top safe-bottom",children:[h.jsx("div",{className:"bg-background-secondary border-b border-border sticky top-0 z-10",children:h.jsx("div",{className:"w-full px-3 sm:px-4 lg:px-6 py-3 sm:py-4",children:h.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[h.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[h.jsx(It,{to:`/project/${t}`,className:"text-text-secondary hover:text-text-primary transition-colors text-sm sm:text-base",children:"← 返回"}),h.jsx("h1",{className:"text-base sm:text-xl font-semibold text-text-primary",children:"織圖編輯"})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("button",{onClick:()=>x(!0),className:"btn btn-primary w-full sm:w-auto",disabled:we,children:we?"處理中...":"新增圈數"}),h.jsx(ho,{})]})]})})}),h.jsxs("div",{className:"w-full px-3 sm:px-4 lg:px-6 py-4 sm:py-6 space-y-4 sm:space-y-6",children:[h.jsxs("div",{className:"card",children:[h.jsx("h2",{className:"text-lg font-semibold text-text-primary mb-4",children:"織圖總覽"}),h.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-4 gap-4 text-sm",children:[h.jsxs("div",{children:[h.jsx("span",{className:"text-text-secondary",children:"總圈數："}),h.jsx("span",{className:"font-medium text-text-primary",children:n.pattern.length})]}),h.jsxs("div",{children:[h.jsx("span",{className:"text-text-secondary",children:"總針數："}),h.jsx("span",{className:"font-medium text-text-primary",children:n.pattern.reduce((L,O)=>L+Bt(O),0)})]}),h.jsxs("div",{children:[h.jsx("span",{className:"text-text-secondary",children:"使用毛線："}),h.jsxs("span",{className:"font-medium text-text-primary",children:[n.yarns.length," 種"]})]}),h.jsxs("div",{children:[h.jsx("span",{className:"text-text-secondary",children:"當前圈數："}),h.jsxs("span",{className:"font-medium text-text-primary",children:["R",n.currentRound]})]})]})]}),n.pattern.length===0?h.jsxs("div",{className:"card text-center py-12",children:[h.jsx("div",{className:"mb-4 flex justify-center",children:h.jsx(Pf,{className:"w-8 h-8 text-text-tertiary"})}),h.jsx("h3",{className:"text-xl font-semibold text-text-primary mb-2",children:"還沒有織圖圈數"}),h.jsx("p",{className:"text-text-secondary mb-6",children:"開始建立你的第一個圈數"}),h.jsx("button",{onClick:()=>x(!0),className:"btn btn-primary",children:"新增第一圈"})]}):h.jsx("div",{className:"space-y-4",children:n.pattern.sort((L,O)=>L.roundNumber-O.roundNumber).map(L=>h.jsxs("div",{className:"card",children:[h.jsxs("div",{className:"flex items-center justify-between mb-4",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsxs("h3",{className:"text-lg font-semibold text-text-primary",children:["第 ",L.roundNumber," 圈"]}),h.jsxs("div",{className:"text-sm text-text-secondary",children:[Bt(L)," 針"]}),L.roundNumber===n.currentRound&&h.jsx("div",{className:"px-2 py-1 bg-primary text-white text-xs rounded-full",children:"目前"})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("button",{onClick:()=>T(L.roundNumber),className:"btn btn-ghost text-sm",children:"新增針法"}),h.jsx("button",{onClick:()=>F(L.roundNumber),className:"btn btn-ghost text-sm",children:"新增群組"}),h.jsx("button",{onClick:()=>go(L.roundNumber),className:"text-text-tertiary hover:text-red-500 transition-colors p-2",children:h.jsx(gr,{className:"w-5 h-5"})})]})]}),(z==null?void 0:z.id)===L.id?h.jsx("div",{className:"mb-4",children:h.jsx("input",{type:"text",defaultValue:L.notes||"",className:"input text-sm",placeholder:"輸入備註...",onBlur:O=>vo(L,O.target.value),onKeyDown:O=>{O.key==="Enter"&&vo(L,O.currentTarget.value),O.key==="Escape"&&S(null)},autoFocus:!0})}):h.jsx("div",{className:"mb-4",children:L.notes?h.jsxs("div",{className:"text-sm text-text-secondary cursor-pointer hover:text-text-primary",onClick:()=>S(L),children:["備註: ",L.notes]}):h.jsx("div",{className:"text-sm text-text-tertiary cursor-pointer hover:text-text-secondary",onClick:()=>S(L),children:"點擊新增備註..."})}),zl(L).length>0&&h.jsx("div",{className:"mb-4",children:h.jsx("div",{className:"space-y-2",children:zl(L).map((O,Y)=>{var re,Ee;return O.type===nn.STITCH?h.jsxs("div",{className:"flex items-center gap-3 p-2 bg-background-tertiary rounded cursor-move",draggable:!0,onDragStart:te=>ds(te,Y,L.roundNumber),onDragOver:hs,onDrop:te=>_n(te,Y,L.roundNumber),children:[h.jsx("div",{className:"text-lg",children:((re=He[O.data.type])==null?void 0:re.symbol)||"○"}),h.jsx("div",{className:"flex-1",children:(_==null?void 0:_.stitchId)===O.data.id?h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("select",{value:On,onChange:te=>fo(te.target.value),className:"input text-sm",children:Object.entries(He).map(([te,Le])=>h.jsxs("option",{value:te,children:[Le.symbol," ",Le.rawValue]},te))}),h.jsx("input",{type:"number",min:"1",value:ir,...Kt(or),className:"input text-sm w-16"}),h.jsx("button",{onClick:()=>ll(L.roundNumber,O.data.id),className:"text-green-500 hover:text-green-600 p-2",children:h.jsx(oi,{className:"w-5 h-5"})}),h.jsx("button",{onClick:()=>I(null),className:"text-text-tertiary hover:text-text-secondary p-2",children:h.jsx(ai,{className:"w-5 h-5"})})]}):h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"font-medium text-text-primary",children:((Ee=He[O.data.type])==null?void 0:Ee.rawValue)||O.data.type}),h.jsxs("span",{className:"text-sm text-text-secondary",children:["×",O.data.count]}),h.jsxs("div",{className:"flex items-center gap-1 ml-auto",children:[h.jsx("button",{onClick:()=>_o(L.roundNumber,O.data),className:"text-text-tertiary hover:text-primary p-2",children:h.jsx(ii,{className:"w-5 h-5"})}),h.jsx("button",{onClick:()=>cr(L.roundNumber,O.data.id),className:"text-text-tertiary hover:text-red-500 p-2",children:h.jsx(gr,{className:"w-5 h-5"})})]})]})})]},O.id):h.jsxs("div",{className:"border border-border rounded-lg p-3 cursor-move",draggable:!0,onDragStart:te=>ds(te,Y,L.roundNumber),onDragOver:hs,onDrop:te=>_n(te,Y,L.roundNumber),children:[h.jsx("div",{className:"flex items-center justify-between mb-2",children:(E==null?void 0:E.groupId)===O.data.id?h.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[h.jsx("input",{type:"text",value:as,onChange:te=>ls(te.target.value),className:"input text-sm flex-1",placeholder:"群組名稱"}),h.jsx("input",{type:"number",min:"1",value:cs,...Kt(us),className:"input text-sm w-20"}),h.jsx("span",{className:"text-sm text-text-secondary",children:"次"}),h.jsx("button",{onClick:()=>Eo(L.roundNumber,O.data.id,O.data),className:"text-green-500 hover:text-green-600 p-2",children:h.jsx(oi,{className:"w-5 h-5"})}),h.jsx("button",{onClick:()=>A(null),className:"text-text-tertiary hover:text-text-secondary p-2",children:h.jsx(ai,{className:"w-5 h-5"})})]}):h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"font-medium text-text-primary",children:O.data.name}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs("div",{className:"text-sm text-text-secondary",children:["重複 ",O.data.repeatCount," 次 (共 ",Xh(O.data)," 針)"]}),h.jsx("button",{onClick:()=>wo(L.roundNumber,O.data),className:"text-text-tertiary hover:text-primary p-2",children:h.jsx(ii,{className:"w-5 h-5"})}),h.jsx("button",{onClick:()=>Js(L.roundNumber,O.data.id),className:"text-text-tertiary hover:text-red-500 p-2",children:h.jsx(gr,{className:"w-5 h-5"})})]})]})}),h.jsx("div",{className:"space-y-2",children:O.data.stitches.map(te=>{var Le,ur;return h.jsxs("div",{className:"flex items-center gap-3 p-2 bg-background-tertiary rounded ml-4",children:[h.jsx("div",{className:"text-lg",children:((Le=He[te.type])==null?void 0:Le.symbol)||"○"}),h.jsx("div",{className:"flex-1",children:(k==null?void 0:k.stitchId)===te.id&&(k==null?void 0:k.groupId)===O.data.id?h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("select",{value:Ws,onChange:$e=>qs($e.target.value),className:"input text-sm",children:Object.entries(He).map(([$e,xo])=>h.jsxs("option",{value:$e,children:[xo.symbol," ",xo.rawValue]},$e))}),h.jsx("input",{type:"number",min:"1",value:po,...Kt(Ks),className:"input text-sm w-16"}),h.jsx("button",{onClick:()=>ul(L.roundNumber,O.data.id,te.id),className:"text-green-500 hover:text-green-600 p-2",children:h.jsx(oi,{className:"w-5 h-5"})}),h.jsx("button",{onClick:()=>C(null),className:"text-text-tertiary hover:text-text-secondary p-2",children:h.jsx(ai,{className:"w-5 h-5"})})]}):h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"font-medium text-text-primary",children:((ur=He[te.type])==null?void 0:ur.rawValue)||te.type}),h.jsxs("span",{className:"text-sm text-text-secondary",children:["×",te.count]}),h.jsxs("div",{className:"flex items-center gap-1 ml-auto",children:[h.jsx("button",{onClick:()=>cl(L.roundNumber,O.data.id,te),className:"text-text-tertiary hover:text-primary p-2",children:h.jsx(ii,{className:"w-5 h-5"})}),h.jsx("button",{onClick:()=>Xs(L.roundNumber,O.data.id,te.id),className:"text-text-tertiary hover:text-red-500 p-2",children:h.jsx(gr,{className:"w-5 h-5"})})]})]})})]},te.id)})})]},O.id)})})}),zl(L).length===0&&L.stitches.length>0&&h.jsx("div",{className:"mb-4",children:h.jsx("div",{className:"space-y-2",children:L.stitches.map((O,Y)=>{var re,Ee;return h.jsxs("div",{className:"flex items-center gap-3 p-2 bg-background-tertiary rounded cursor-move",draggable:!0,onDragStart:te=>ds(te,Y,L.roundNumber),onDragOver:hs,onDrop:te=>_n(te,Y,L.roundNumber),children:[h.jsx("div",{className:"text-lg",children:((re=He[O.type])==null?void 0:re.symbol)||"○"}),h.jsx("div",{className:"flex-1",children:(_==null?void 0:_.stitchId)===O.id?h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("select",{value:On,onChange:te=>fo(te.target.value),className:"input text-sm",children:Object.entries(He).map(([te,Le])=>h.jsxs("option",{value:te,children:[Le.symbol," ",Le.rawValue]},te))}),h.jsx("input",{type:"number",min:"1",value:ir,...Kt(or),className:"input text-sm w-16"}),h.jsx("button",{onClick:()=>ll(L.roundNumber,O.id),className:"text-green-500 hover:text-green-600 p-2",children:h.jsx(oi,{className:"w-5 h-5"})}),h.jsx("button",{onClick:()=>I(null),className:"text-text-tertiary hover:text-text-secondary p-2",children:h.jsx(ai,{className:"w-5 h-5"})})]}):h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"font-medium text-text-primary",children:((Ee=He[O.type])==null?void 0:Ee.rawValue)||O.type}),h.jsxs("span",{className:"text-sm text-text-secondary",children:["×",O.count]}),h.jsxs("div",{className:"flex items-center gap-1 ml-auto",children:[h.jsx("button",{onClick:()=>_o(L.roundNumber,O),className:"text-text-tertiary hover:text-primary p-2",children:h.jsx(ii,{className:"w-5 h-5"})}),h.jsx("button",{onClick:()=>cr(L.roundNumber,O.id),className:"text-text-tertiary hover:text-red-500 p-2",children:h.jsx(gr,{className:"w-5 h-5"})})]})]})})]},O.id)})})}),zl(L).length===0&&L.stitchGroups.length>0&&h.jsx("div",{className:"mb-4",children:h.jsx("div",{className:"space-y-3",children:L.stitchGroups.map((O,Y)=>h.jsxs("div",{className:"border border-border rounded-lg p-3 cursor-move",draggable:!0,onDragStart:re=>ds(re,Y,L.roundNumber),onDragOver:hs,onDrop:re=>_n(re,Y,L.roundNumber),children:[h.jsx("div",{className:"flex items-center justify-between mb-2",children:(E==null?void 0:E.groupId)===O.id?h.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[h.jsx("input",{type:"text",value:as,onChange:re=>ls(re.target.value),className:"input text-sm flex-1",placeholder:"群組名稱"}),h.jsx("input",{type:"number",min:"1",value:cs,...Kt(us),className:"input text-sm w-20"}),h.jsx("span",{className:"text-sm text-text-secondary",children:"次"}),h.jsx("button",{onClick:()=>Eo(L.roundNumber,O.id,O),className:"text-green-500 hover:text-green-600 p-2",children:h.jsx(oi,{className:"w-5 h-5"})}),h.jsx("button",{onClick:()=>A(null),className:"text-text-tertiary hover:text-text-secondary p-2",children:h.jsx(ai,{className:"w-5 h-5"})})]}):h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"font-medium text-text-primary",children:O.name}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs("div",{className:"text-sm text-text-secondary",children:["重複 ",O.repeatCount," 次 (共 ",Xh(O)," 針)"]}),h.jsx("button",{onClick:()=>wo(L.roundNumber,O),className:"text-text-tertiary hover:text-primary p-2",children:h.jsx(ii,{className:"w-5 h-5"})}),h.jsx("button",{onClick:()=>Js(L.roundNumber,O.id),className:"text-text-tertiary hover:text-red-500 p-2",children:h.jsx(gr,{className:"w-5 h-5"})})]})]})}),h.jsx("div",{className:"space-y-2",children:O.stitches.map(re=>{var Ee,te;return h.jsxs("div",{className:"flex items-center gap-3 p-2 bg-background-tertiary rounded ml-4",children:[h.jsx("div",{className:"text-lg",children:((Ee=He[re.type])==null?void 0:Ee.symbol)||"○"}),h.jsx("div",{className:"flex-1",children:(k==null?void 0:k.stitchId)===re.id&&(k==null?void 0:k.groupId)===O.id?h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("select",{value:Ws,onChange:Le=>qs(Le.target.value),className:"input text-sm",children:Object.entries(He).map(([Le,ur])=>h.jsxs("option",{value:Le,children:[ur.symbol," ",ur.rawValue]},Le))}),h.jsx("input",{type:"number",min:"1",value:po,...Kt(Ks),className:"input text-sm w-16"}),h.jsx("button",{onClick:()=>ul(L.roundNumber,O.id,re.id),className:"text-green-500 hover:text-green-600 p-2",children:h.jsx(oi,{className:"w-5 h-5"})}),h.jsx("button",{onClick:()=>C(null),className:"text-text-tertiary hover:text-text-secondary p-2",children:h.jsx(ai,{className:"w-5 h-5"})})]}):h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"font-medium text-text-primary",children:((te=He[re.type])==null?void 0:te.rawValue)||re.type}),h.jsxs("span",{className:"text-sm text-text-secondary",children:["×",re.count]}),h.jsxs("div",{className:"flex items-center gap-1 ml-auto",children:[h.jsx("button",{onClick:()=>cl(L.roundNumber,O.id,re),className:"text-text-tertiary hover:text-primary p-2",children:h.jsx(ii,{className:"w-5 h-5"})}),h.jsx("button",{onClick:()=>Xs(L.roundNumber,O.id,re.id),className:"text-text-tertiary hover:text-red-500 p-2",children:h.jsx(gr,{className:"w-5 h-5"})})]})]})})]},re.id)})})]},O.id))})}),v===L.roundNumber&&h.jsxs("div",{className:"bg-background-tertiary rounded-lg p-4 mb-4",children:[h.jsx("h4",{className:"font-medium text-text-primary mb-3",children:"新增針法"}),h.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"針法類型"}),h.jsx("select",{value:H,onChange:O=>G(O.target.value),className:"input",children:Object.entries(He).map(([O,Y])=>h.jsxs("option",{value:O,children:[Y.symbol," ",Y.rawValue]},O))})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"數量"}),h.jsx("input",{type:"number",min:"1",value:q,...Kt(se),className:"input"})]})]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{onClick:()=>yo(L.roundNumber),className:"btn btn-primary",disabled:we,children:we?"新增中...":"新增"}),h.jsx("button",{onClick:()=>T(null),className:"btn btn-secondary",children:"取消"})]})]}),D===L.roundNumber&&h.jsxs("div",{className:"bg-background-tertiary rounded-lg p-4 mb-4",children:[h.jsx("h4",{className:"font-medium text-text-primary mb-3",children:"新增針目群組"}),h.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"群組名稱"}),h.jsx("input",{type:"text",value:ie,onChange:O=>ue(O.target.value),className:"input",placeholder:"針目群組"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"重複次數"}),h.jsx("input",{type:"number",min:"1",value:Be,...Kt(ze),className:"input"})]})]}),h.jsxs("div",{className:"mb-4",children:[h.jsxs("div",{className:"flex items-center justify-between mb-2",children:[h.jsx("label",{className:"block text-sm font-medium text-text-secondary",children:"群組針法"}),h.jsx("button",{onClick:st,className:"btn btn-ghost text-sm",children:"新增針法"})]}),h.jsx("div",{className:"space-y-2 mb-4",children:Ie.map(O=>{var Y,re;return h.jsxs("div",{className:"flex items-center gap-3 p-2 bg-background-secondary rounded",children:[h.jsx("div",{className:"text-lg",children:((Y=He[O.type])==null?void 0:Y.symbol)||"○"}),h.jsxs("div",{className:"flex-1",children:[h.jsx("span",{className:"font-medium text-text-primary",children:((re=He[O.type])==null?void 0:re.rawValue)||O.type}),h.jsxs("span",{className:"text-sm text-text-secondary ml-2",children:["×",O.count]})]}),h.jsx("button",{onClick:()=>Ys(O.id),className:"text-text-tertiary hover:text-red-500 transition-colors p-2",children:h.jsx(gr,{className:"w-5 h-5"})})]},O.id)})}),h.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4",children:[h.jsx("select",{value:H,onChange:O=>G(O.target.value),className:"input",children:Object.entries(He).map(([O,Y])=>h.jsxs("option",{value:O,children:[Y.symbol," ",Y.rawValue]},O))}),h.jsx("input",{type:"number",min:"1",value:q,...Kt(se),className:"input",placeholder:"數量"})]})]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{onClick:()=>Ze(L.roundNumber),className:"btn btn-primary",disabled:Ie.length===0,children:"新增群組"}),h.jsx("button",{onClick:()=>{F(null),Qe([]),ue(""),ze(1)},className:"btn btn-secondary",children:"取消"})]})]})]},L.id))})]}),P&&h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:h.jsxs("div",{className:"bg-background-secondary rounded-xl p-6 w-full max-w-md",children:[h.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-4",children:"新增圈數"}),h.jsxs("div",{className:"mb-4",children:[h.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"備註（選填）"}),h.jsx("input",{type:"text",value:rn,onChange:L=>Tt(L.target.value),className:"input",placeholder:"輸入備註..."})]}),h.jsxs("div",{className:"flex gap-3",children:[h.jsx("button",{onClick:()=>x(!1),className:"btn btn-secondary flex-1",children:"取消"}),h.jsx("button",{onClick:mo,className:"btn btn-primary flex-1",disabled:we,children:we?"新增中...":"新增"})]})]})})]})}function g4(){const{projectId:t}=Ya(),e=to(),{currentProject:n,setCurrentProject:r,projects:s,nextStitch:i,previousStitch:o,setCurrentRound:l,startSession:c,endSession:u,updateProject:f}=Ft(),[p,g]=M.useState(!1),[w,R]=M.useState(null),[N,P]=M.useState(0),[x,v]=M.useState(null);if(M.useEffect(()=>{t&&(s.find(q=>q.id===t)?r(t):e("/404"))},[t,r,s,e]),M.useEffect(()=>{let G;return p&&w&&(G=setInterval(()=>{P(Math.floor((Date.now()-w.getTime())/1e3))},1e3)),()=>clearInterval(G)},[p,w]),!n)return h.jsx("div",{className:"min-h-screen bg-background-primary flex items-center justify-center",children:h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),h.jsx("p",{className:"text-text-secondary",children:"載入中..."})]})});const T=x!==null&&x!==n.currentRound,D=x??n.currentRound,F=n.pattern.find(G=>G.roundNumber===D),z=Zh(n),S=T?0:n.currentStitch,_=F?Bt(F):0,I=()=>{c(),g(!0),R(new Date),P(0)},E=()=>{u(),g(!1),R(null),P(0)},A=()=>{i()},k=()=>{o()},C=G=>{G===n.currentRound?v(null):v(G)},we=async()=>{if(!F)return;console.log("[DEBUG] handleCompleteRound: Completing round",D);const G=Math.max(...n.pattern.map(q=>q.roundNumber));if(D>=G){const q={...n,isCompleted:!0,currentStitch:Bt(F),lastModified:new Date};console.log("[DEBUG] handleCompleteRound: Marking project as completed"),await f(q)}else{const q=D+1;console.log("[DEBUG] handleCompleteRound: Moving to next round",q),await l(q)}v(null)},Pt=()=>{v(null)},rn=G=>{const q=n.yarns.find(se=>se.id===G);return(q==null?void 0:q.color.hex)||"#000000"},Tt=G=>{const q=G.replace("#",""),se=parseInt(q.substring(0,2),16),ie=parseInt(q.substring(2,4),16),ue=parseInt(q.substring(4,6),16);return(se*299+ie*587+ue*114)/1e3>200},H=()=>{if(!F||_===0)return h.jsx("div",{className:"text-center py-8",children:h.jsx("p",{className:"text-text-tertiary",children:"當前圈數沒有針法資料"})});const G=[];let q=0;return F.stitches.forEach(se=>{var ue;const ie=rn(se.yarnId);for(let Be=0;Be<se.count;Be++){const ze=q<S,Ie=q===S;G.push(h.jsxs("div",{className:"flex flex-col items-center justify-center w-16 h-16 transition-all duration-300",children:[h.jsx("div",{className:`text-2xl font-bold transition-colors duration-300 ${ze?"text-text-primary":Ie?"text-primary":"text-text-tertiary/50"}`,children:((ue=He[se.type])==null?void 0:ue.symbol)||"○"}),h.jsx("div",{className:`w-2.5 h-2.5 rounded-full transition-all duration-300 ${(ze||Ie)&&Tt(ie)?"border border-gray-400":""}`,style:{backgroundColor:ze||Ie?ie:"#f3f4f6"}})]},`${se.id}-${Be}`)),q++}}),F.stitchGroups.forEach(se=>{for(let ie=0;ie<se.repeatCount;ie++)se.stitches.forEach(ue=>{var ze;const Be=rn(ue.yarnId);for(let Ie=0;Ie<ue.count;Ie++){const Qe=q<S,On=q===S;G.push(h.jsxs("div",{className:"flex flex-col items-center justify-center w-16 h-16 transition-all duration-300",children:[h.jsx("div",{className:`text-2xl font-bold transition-colors duration-300 ${Qe?"text-text-primary":On?"text-primary":"text-text-tertiary/50"}`,children:((ze=He[ue.type])==null?void 0:ze.symbol)||"○"}),h.jsx("div",{className:`w-2.5 h-2.5 rounded-full transition-all duration-300 ${(Qe||On)&&Tt(Be)?"border border-gray-400":""}`,style:{backgroundColor:Qe||On?Be:"#f3f4f6"}})]},`${se.id}-${ie}-${ue.id}-${Ie}`)),q++}})}),h.jsx("div",{className:"grid grid-cols-6 sm:grid-cols-8 md:grid-cols-10 lg:grid-cols-12 gap-2",children:G})};return h.jsxs("div",{className:"min-h-screen bg-background-primary safe-top safe-bottom",children:[h.jsx("div",{className:"bg-background-secondary border-b border-border sticky top-0 z-10",children:h.jsx("div",{className:"w-full px-3 sm:px-4 lg:px-6 py-3 sm:py-4",children:h.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[h.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[h.jsx(It,{to:`/project/${t}`,className:"text-text-secondary hover:text-text-primary transition-colors text-sm sm:text-base",children:"← 返回"}),h.jsx("h1",{className:"text-base sm:text-xl font-semibold text-text-primary truncate",children:n.name})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[p?h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"text-sm text-text-secondary hidden sm:block",children:UR(N)}),h.jsx("button",{onClick:E,className:"btn btn-secondary text-sm",children:"結束"})]}):h.jsxs("button",{onClick:I,className:"btn btn-primary text-sm",children:[h.jsx("span",{className:"hidden sm:inline",children:"開始計時"}),h.jsx("span",{className:"sm:hidden",children:"計時"})]}),h.jsx(ho,{})]})]})})}),h.jsxs("div",{className:"w-full px-3 sm:px-4 lg:px-6 py-4 sm:py-6 space-y-4 sm:space-y-6",children:[h.jsxs("div",{className:"card",children:[h.jsxs("div",{className:"flex items-center justify-between mb-3",children:[h.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:"總體進度"}),h.jsxs("span",{className:"text-sm text-text-secondary font-medium",children:[Math.round(z*100),"%"]})]}),h.jsx("div",{className:"w-full bg-background-tertiary rounded-full h-3 mb-4",children:h.jsx("div",{className:"bg-primary h-3 rounded-full transition-all duration-500",style:{width:`${z*100}%`}})}),h.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[h.jsxs("div",{children:[h.jsx("div",{className:"text-text-secondary",children:"圈數進度"}),h.jsxs("div",{className:"font-semibold text-text-primary",children:[Math.max(0,n.currentRound-1)," / ",Kc(n)," 圈"]})]}),h.jsxs("div",{children:[h.jsx("div",{className:"text-text-secondary",children:"針數進度"}),h.jsxs("div",{className:"font-semibold text-text-primary",children:[Ap(n)," / ",Da(n)," 針"]})]})]})]}),h.jsxs("div",{className:"card",children:[h.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-3",children:"快速跳轉"}),h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("label",{className:"text-sm text-text-secondary",children:"跳轉到第"}),h.jsx("select",{value:D,onChange:G=>C(parseInt(G.target.value)),className:"input w-auto min-w-0 flex-shrink-0",children:Array.from({length:Kc(n)},(G,q)=>q+1).map(G=>h.jsx("option",{value:G,children:G},G))}),h.jsx("label",{className:"text-sm text-text-secondary",children:"圈"}),T&&h.jsx("span",{className:"text-sm",style:{color:"rgb(217, 115, 152)"},children:"查看模式"})]})]}),h.jsxs("div",{className:"card",children:[h.jsxs("div",{className:"mb-6",children:[h.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-3",children:"本圈織圖"}),h.jsx("div",{className:"mb-3",children:h.jsxs("span",{className:"text-base text-text-primary",children:["第 ",D," 圈",T&&h.jsx("span",{className:"text-sm ml-2",style:{color:"rgb(217, 115, 152)"},children:"（查看中）"})]})}),(F==null?void 0:F.notes)&&h.jsxs("div",{className:"text-text-primary mb-4",children:[h.jsx("span",{className:"text-text-secondary",children:"備註："}),F.notes]})]}),h.jsx("div",{className:"mb-6",children:H()}),T?h.jsxs("div",{className:"text-center py-4",children:[h.jsx("p",{className:"mb-4",style:{color:"rgb(217, 115, 152)"},children:"此為查看模式，無法編輯進度"}),h.jsx("button",{onClick:Pt,className:"btn btn-primary",children:"返回編織進度"})]}):n.isCompleted?h.jsxs("div",{className:"text-center py-8",children:[h.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:"編織完成！"}),h.jsxs("p",{className:"text-text-secondary mb-6",children:["恭喜您完成了「",n.name,"」的編織！"]}),h.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[h.jsx("button",{onClick:()=>{const G={...n,isCompleted:!1,currentRound:1,currentStitch:0,lastModified:new Date};f(G)},className:"btn btn-secondary",children:"重新編織"}),h.jsx("button",{onClick:()=>{var G;(G=navigator.share)==null||G.call(navigator,{title:`我完成了編織作品：${n.name}`,text:`使用編織計數器完成了「${n.name}」的編織！`}).catch(()=>{alert("編織完成！")})},className:"btn btn-primary",children:"分享成果"})]})]}):h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"flex items-center justify-between gap-4",children:[h.jsxs("button",{onClick:k,disabled:n.currentRound===1&&n.currentStitch===0,className:"btn btn-secondary disabled:opacity-50 disabled:cursor-not-allowed text-lg py-4 flex items-center justify-center gap-2 flex-1",children:[h.jsx("span",{children:"←"}),"上一針"]}),h.jsxs("div",{className:"flex items-baseline px-6",children:[h.jsx("span",{className:"text-4xl font-bold text-primary",children:S}),h.jsxs("span",{className:"text-xl text-text-secondary",children:["/",_]})]}),h.jsxs("button",{onClick:A,className:"btn btn-primary text-lg py-4 flex items-center justify-center gap-2 flex-1",children:["下一針",h.jsx("span",{children:"→"})]})]}),D===n.currentRound&&h.jsxs("button",{onClick:we,className:"w-full bg-gray-500 hover:bg-gray-600 text-white font-medium py-3 px-4 rounded-lg transition-colors",children:["完成第 ",D," 圈"]})]})]})]})]})}const zo=[{name:"白色",hex:"#FFFFFF"},{name:"黑色",hex:"#000000"},{name:"紅色",hex:"#FF0000"},{name:"藍色",hex:"#0066CC"},{name:"綠色",hex:"#00AA00"},{name:"黃色",hex:"#FFD700"},{name:"紫色",hex:"#8A2BE2"},{name:"橙色",hex:"#FF8C00"},{name:"粉紅色",hex:"#FF69B4"},{name:"棕色",hex:"#A0522D"},{name:"灰色",hex:"#808080"},{name:"米色",hex:"#F5F5DC"}];function y4(){const{projectId:t}=Ya(),e=to(),{currentProject:n,setCurrentProject:r,projects:s,addYarn:i,updateYarn:o,deleteYarn:l}=Ft(),[c,u]=M.useState(!1),[f,p]=M.useState(null),[g,w]=M.useState(""),[R,N]=M.useState(""),[P,x]=M.useState(zo[0]),[v,T]=M.useState("");if(M.useEffect(()=>{t&&(s.find(A=>A.id===t)?r(t):e("/404"))},[t,r,s,e]),!n)return h.jsx("div",{className:"min-h-screen bg-background-primary flex items-center justify-center",children:h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),h.jsx("p",{className:"text-text-secondary",children:"載入中..."})]})});const D=()=>{p(null),w(zo[0].name+"毛線"),N(""),x(zo[0]),T(""),u(!0)},F=E=>{p(E),w(E.name),N(E.brand||""),x(E.color),T(E.color.hex),u(!0)},z=()=>{if(!g.trim())return;const E=v?{name:"自定義",hex:v}:P,A={id:(f==null?void 0:f.id)||Oe(),name:g.trim(),brand:R.trim()||void 0,color:E};f?o(A):i(A),u(!1),_()},S=E=>{confirm("確定要刪除這個毛線嗎？")&&l(E)},_=()=>{w(""),N(""),x(zo[0]),T(""),p(null)},I=()=>{u(!1),_()};return h.jsxs("div",{className:"min-h-screen bg-background-primary safe-top safe-bottom",children:[h.jsx("div",{className:"bg-background-secondary border-b border-border",children:h.jsx("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-3 sm:py-4",children:h.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[h.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[h.jsx(It,{to:`/project/${t}`,className:"text-text-secondary hover:text-text-primary transition-colors text-sm sm:text-base",children:"← 返回"}),h.jsx("h1",{className:"text-base sm:text-xl font-semibold text-text-primary",children:"毛線管理"})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("button",{onClick:D,className:"btn btn-primary w-full sm:w-auto",children:"+ 新增毛線"}),h.jsx(ho,{})]})]})})}),h.jsxs("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-4 sm:py-6 space-y-4 sm:space-y-6",children:[n.yarns.length===0?h.jsxs("div",{className:"text-center py-12",children:[h.jsx("div",{className:"text-6xl mb-4",children:"🧶"}),h.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-2",children:"還沒有毛線"}),h.jsx("p",{className:"text-text-secondary mb-4",children:"點擊上方「新增毛線」按鈕來添加第一個毛線"}),h.jsx("button",{onClick:D,className:"btn btn-primary",children:"新增毛線"})]}):h.jsx("div",{className:"grid gap-4",children:n.yarns.map(E=>h.jsx("div",{className:"card",children:h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"w-12 h-12 rounded-full border-2 border-border flex-shrink-0",style:{backgroundColor:E.color.hex}}),h.jsxs("div",{className:"flex-1",children:[h.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:E.name}),E.brand&&h.jsx("p",{className:"text-text-secondary",children:E.brand}),h.jsxs("p",{className:"text-sm text-text-tertiary",children:[E.color.name," (",E.color.hex,")"]})]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{onClick:()=>F(E),className:"btn btn-secondary text-sm",children:"編輯"}),h.jsx("button",{onClick:()=>S(E.id),className:"btn bg-red-500 hover:bg-red-600 text-white text-sm",children:"刪除"})]})]})},E.id))}),c&&h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:h.jsx("div",{className:"bg-background-primary rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:h.jsxs("div",{className:"p-6",children:[h.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-4",children:f?"編輯毛線":"新增毛線"}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"毛線名稱 *"}),h.jsx("input",{type:"text",value:g,onChange:E=>w(E.target.value),className:"w-full p-3 border border-border rounded-lg bg-background-secondary text-text-primary",placeholder:"例如：4號線"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"品牌（選填）"}),h.jsx("input",{type:"text",value:R,onChange:E=>N(E.target.value),className:"w-full p-3 border border-border rounded-lg bg-background-secondary text-text-primary",placeholder:"例如：台灣製"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"顏色"}),h.jsx("div",{className:"grid grid-cols-6 gap-2 mb-3",children:zo.map(E=>h.jsx("button",{onClick:()=>{x(E),T(""),!f&&(g===""||g.endsWith("毛線"))&&w(E.name+"毛線")},className:`w-10 h-10 rounded-full border-2 ${P.hex===E.hex&&!v?"border-primary ring-2 ring-primary/20":"border-border"}`,style:{backgroundColor:E.hex},title:E.name},E.hex))}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs text-text-secondary mb-1",children:"或輸入自定義顏色"}),h.jsx("input",{type:"color",value:v||P.hex,onChange:E=>{T(E.target.value),!f&&(g===""||g.endsWith("毛線"))&&w("自定義毛線")},className:"w-full h-10 border border-border rounded cursor-pointer"})]})]}),h.jsxs("div",{className:"border border-border rounded-lg p-3",children:[h.jsx("p",{className:"text-sm text-text-secondary mb-2",children:"預覽"}),h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"w-8 h-8 rounded-full border border-border",style:{backgroundColor:v||P.hex}}),h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-text-primary",children:g||"毛線名稱"}),R&&h.jsx("p",{className:"text-sm text-text-secondary",children:R})]})]})]})]}),h.jsxs("div",{className:"flex gap-3 mt-6",children:[h.jsx("button",{onClick:I,className:"flex-1 btn btn-secondary",children:"取消"}),h.jsx("button",{onClick:z,disabled:!g.trim(),className:"flex-1 btn btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:f?"更新":"新增"})]})]})})})]})]})}function v4(){const{projectId:t}=Ya();return h.jsxs("div",{className:"min-h-screen bg-background-primary safe-top safe-bottom",children:[h.jsx("div",{className:"bg-background-secondary border-b border-border",children:h.jsx("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-3 sm:py-4",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-3 sm:gap-4",children:[h.jsx(It,{to:`/project/${t}`,className:"text-text-secondary hover:text-text-primary transition-colors text-sm sm:text-base",children:"← 返回"}),h.jsx("h1",{className:"text-lg sm:text-xl font-semibold text-text-primary",children:"匯入匯出"})]}),h.jsx(ho,{})]})})}),h.jsx("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-4 sm:py-6",children:h.jsxs("div",{className:"text-center py-12",children:[h.jsx("div",{className:"text-6xl mb-4",children:"🚧"}),h.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-2",children:"匯入匯出"}),h.jsx("p",{className:"text-text-secondary",children:"此功能正在開發中..."})]})})]})}function _4(){return h.jsx("div",{className:"min-h-screen bg-background-primary flex items-center justify-center px-4",children:h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-6xl mb-6",children:"🧶"}),h.jsx("h1",{className:"text-4xl font-bold text-text-primary mb-4",children:"404"}),h.jsx("h2",{className:"text-xl font-semibold text-text-secondary mb-6",children:"找不到頁面"}),h.jsx("p",{className:"text-text-tertiary mb-8",children:"您要查找的頁面不存在或已被移動"}),h.jsx(It,{to:"/",className:"btn btn-primary",children:"回到首頁"})]})})}function w4(){const{signInWithGoogle:t,isLoading:e,error:n}=at();return h.jsx("div",{className:"min-h-screen bg-background-primary flex items-center justify-center px-4",children:h.jsxs("div",{className:"card max-w-sm sm:max-w-md w-full",children:[h.jsxs("div",{className:"text-center mb-6",children:[h.jsx("div",{className:"text-3xl sm:text-4xl mb-3",children:"🧶"}),h.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-text-primary mb-2",children:"編織計數器"}),h.jsx("p",{className:"text-sm sm:text-base text-text-secondary",children:"使用 Google 帳戶登入以同步您的編織專案"})]}),n&&h.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:n}),h.jsx("button",{onClick:t,disabled:e,className:"w-full flex items-center justify-center gap-3 px-4 py-3 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:e?h.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-gray-600"}):h.jsxs(h.Fragment,{children:[h.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[h.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),h.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),h.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),h.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"使用 Google 登入"]})}),h.jsx("div",{className:"mt-4 text-center",children:h.jsx("p",{className:"text-xs text-text-tertiary",children:"登入即表示您同意我們的服務條款和隱私政策"})})]})})}function E4(){const{setError:t,error:e,isSyncing:n,isLoading:r}=Ft(),{user:s,isLoading:i,initialize:o}=at();return M.useEffect(()=>{const l=o(),c=Ec.setupAuthStateListener();return console.log("[NETWORK] Initializing network status monitoring"),s&&(t4(),n4()),()=>{l(),c&&c()}},[o]),M.useEffect(()=>{s?(console.log(`使用者已登入 (${s.uid})，開始同步...`),Ec.handleUserLogin(s).catch(l=>{console.error("處理用戶登入錯誤:",l),t("登入處理失敗")})):(console.log("使用者已登出，清空數據..."),Ec.handleUserLogout())},[s,t]),i||r?h.jsx("div",{className:"min-h-screen bg-background-primary flex items-center justify-center",children:h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),h.jsx("p",{className:"text-text-secondary",children:i?"驗證中...":"載入數據中..."}),n&&h.jsx("p",{className:"text-text-secondary text-sm mt-2",children:"正在同步跨裝置數據..."})]})}):s?h.jsxs("div",{className:"min-h-screen bg-background-primary",children:[e&&h.jsx("div",{className:"fixed top-4 left-4 right-4 z-50 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("span",{children:e}),h.jsx("button",{onClick:()=>t(null),className:"text-red-500 hover:text-red-700 ml-4",children:"✕"})]})}),h.jsxs(ZI,{children:[h.jsx(Mn,{path:"/",element:h.jsx(s4,{})}),h.jsx(Mn,{path:"/project/:projectId",element:h.jsx(p4,{})}),h.jsx(Mn,{path:"/project/:projectId/pattern",element:h.jsx(m4,{})}),h.jsx(Mn,{path:"/project/:projectId/progress",element:h.jsx(g4,{})}),h.jsx(Mn,{path:"/project/:projectId/yarns",element:h.jsx(y4,{})}),h.jsx(Mn,{path:"/project/:projectId/import-export",element:h.jsx(v4,{})}),h.jsx(Mn,{path:"/404",element:h.jsx(_4,{})}),h.jsx(Mn,{path:"*",element:h.jsx(JI,{to:"/404",replace:!0})})]})]}):h.jsx(w4,{})}th.createRoot(document.getElementById("root")).render(h.jsx(Sn.StrictMode,{children:h.jsx(oR,{children:h.jsx(E4,{})})}));
