var Cx=Object.defineProperty;var Rx=(t,e,n)=>e in t?Cx(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var og=(t,e,n)=>(Rx(t,typeof e!="symbol"?e+"":e,n),n);function Nx(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function s_(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var i_={exports:{}},nu={},o_={exports:{}},ie={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ra=Symbol.for("react.element"),Ax=Symbol.for("react.portal"),Px=Symbol.for("react.fragment"),kx=Symbol.for("react.strict_mode"),bx=Symbol.for("react.profiler"),Dx=Symbol.for("react.provider"),jx=Symbol.for("react.context"),Vx=Symbol.for("react.forward_ref"),Ox=Symbol.for("react.suspense"),Lx=Symbol.for("react.memo"),Mx=Symbol.for("react.lazy"),ag=Symbol.iterator;function Fx(t){return t===null||typeof t!="object"?null:(t=ag&&t[ag]||t["@@iterator"],typeof t=="function"?t:null)}var a_={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},l_=Object.assign,c_={};function bi(t,e,n){this.props=t,this.context=e,this.refs=c_,this.updater=n||a_}bi.prototype.isReactComponent={};bi.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};bi.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function u_(){}u_.prototype=bi.prototype;function wf(t,e,n){this.props=t,this.context=e,this.refs=c_,this.updater=n||a_}var Ef=wf.prototype=new u_;Ef.constructor=wf;l_(Ef,bi.prototype);Ef.isPureReactComponent=!0;var lg=Array.isArray,h_=Object.prototype.hasOwnProperty,xf={current:null},d_={key:!0,ref:!0,__self:!0,__source:!0};function f_(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)h_.call(e,r)&&!d_.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:Ra,type:t,key:i,ref:o,props:s,_owner:xf.current}}function Ux(t,e){return{$$typeof:Ra,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Tf(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ra}function Bx(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var cg=/\/+/g;function th(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Bx(""+t.key):e.toString(36)}function Ll(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Ra:case Ax:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+th(o,0):r,lg(s)?(n="",t!=null&&(n=t.replace(cg,"$&/")+"/"),Ll(s,e,n,"",function(u){return u})):s!=null&&(Tf(s)&&(s=Ux(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(cg,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",lg(t))for(var l=0;l<t.length;l++){i=t[l];var c=r+th(i,l);o+=Ll(i,e,n,c,s)}else if(c=Fx(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=r+th(i,l++),o+=Ll(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function dl(t,e,n){if(t==null)return t;var r=[],s=0;return Ll(t,r,"","",function(i){return e.call(n,i,s++)}),r}function zx(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Rt={current:null},Ml={transition:null},$x={ReactCurrentDispatcher:Rt,ReactCurrentBatchConfig:Ml,ReactCurrentOwner:xf};function p_(){throw Error("act(...) is not supported in production builds of React.")}ie.Children={map:dl,forEach:function(t,e,n){dl(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return dl(t,function(){e++}),e},toArray:function(t){return dl(t,function(e){return e})||[]},only:function(t){if(!Tf(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ie.Component=bi;ie.Fragment=Px;ie.Profiler=bx;ie.PureComponent=wf;ie.StrictMode=kx;ie.Suspense=Ox;ie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$x;ie.act=p_;ie.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=l_({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=xf.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)h_.call(e,c)&&!d_.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:Ra,type:t.type,key:s,ref:i,props:r,_owner:o}};ie.createContext=function(t){return t={$$typeof:jx,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Dx,_context:t},t.Consumer=t};ie.createElement=f_;ie.createFactory=function(t){var e=f_.bind(null,t);return e.type=t,e};ie.createRef=function(){return{current:null}};ie.forwardRef=function(t){return{$$typeof:Vx,render:t}};ie.isValidElement=Tf;ie.lazy=function(t){return{$$typeof:Mx,_payload:{_status:-1,_result:t},_init:zx}};ie.memo=function(t,e){return{$$typeof:Lx,type:t,compare:e===void 0?null:e}};ie.startTransition=function(t){var e=Ml.transition;Ml.transition={};try{t()}finally{Ml.transition=e}};ie.unstable_act=p_;ie.useCallback=function(t,e){return Rt.current.useCallback(t,e)};ie.useContext=function(t){return Rt.current.useContext(t)};ie.useDebugValue=function(){};ie.useDeferredValue=function(t){return Rt.current.useDeferredValue(t)};ie.useEffect=function(t,e){return Rt.current.useEffect(t,e)};ie.useId=function(){return Rt.current.useId()};ie.useImperativeHandle=function(t,e,n){return Rt.current.useImperativeHandle(t,e,n)};ie.useInsertionEffect=function(t,e){return Rt.current.useInsertionEffect(t,e)};ie.useLayoutEffect=function(t,e){return Rt.current.useLayoutEffect(t,e)};ie.useMemo=function(t,e){return Rt.current.useMemo(t,e)};ie.useReducer=function(t,e,n){return Rt.current.useReducer(t,e,n)};ie.useRef=function(t){return Rt.current.useRef(t)};ie.useState=function(t){return Rt.current.useState(t)};ie.useSyncExternalStore=function(t,e,n){return Rt.current.useSyncExternalStore(t,e,n)};ie.useTransition=function(){return Rt.current.useTransition()};ie.version="18.3.1";o_.exports=ie;var L=o_.exports;const xn=s_(L),Gx=Nx({__proto__:null,default:xn},[L]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hx=L,Wx=Symbol.for("react.element"),qx=Symbol.for("react.fragment"),Kx=Object.prototype.hasOwnProperty,Qx=Hx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Yx={key:!0,ref:!0,__self:!0,__source:!0};function m_(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)Kx.call(e,r)&&!Yx.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:Wx,type:t,key:i,ref:o,props:s,_owner:Qx.current}}nu.Fragment=qx;nu.jsx=m_;nu.jsxs=m_;i_.exports=nu;var d=i_.exports,qh={},g_={exports:{}},qt={},y_={exports:{}},v_={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(W,$){var q=W.length;W.push($);e:for(;0<q;){var re=q-1>>>1,se=W[re];if(0<s(se,$))W[re]=$,W[q]=se,q=re;else break e}}function n(W){return W.length===0?null:W[0]}function r(W){if(W.length===0)return null;var $=W[0],q=W.pop();if(q!==$){W[0]=q;e:for(var re=0,se=W.length,ce=se>>>1;re<ce;){var ke=2*(re+1)-1,$e=W[ke],be=ke+1,De=W[be];if(0>s($e,q))be<se&&0>s(De,$e)?(W[re]=De,W[be]=q,re=be):(W[re]=$e,W[ke]=q,re=ke);else if(be<se&&0>s(De,q))W[re]=De,W[be]=q,re=be;else break e}}return $}function s(W,$){var q=W.sortIndex-$.sortIndex;return q!==0?q:W.id-$.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],f=1,m=null,g=3,w=!1,R=!1,N=!1,P=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function I(W){for(var $=n(u);$!==null;){if($.callback===null)r(u);else if($.startTime<=W)r(u),$.sortIndex=$.expirationTime,e(c,$);else break;$=n(u)}}function D(W){if(N=!1,I(W),!R)if(n(c)!==null)R=!0,Mt(F);else{var $=n(u);$!==null&&xt(D,$.startTime-W)}}function F(W,$){R=!1,N&&(N=!1,x(_),_=-1),w=!0;var q=g;try{for(I($),m=n(c);m!==null&&(!(m.expirationTime>$)||W&&!A());){var re=m.callback;if(typeof re=="function"){m.callback=null,g=m.priorityLevel;var se=re(m.expirationTime<=$);$=t.unstable_now(),typeof se=="function"?m.callback=se:m===n(c)&&r(c),I($)}else r(c);m=n(c)}if(m!==null)var ce=!0;else{var ke=n(u);ke!==null&&xt(D,ke.startTime-$),ce=!1}return ce}finally{m=null,g=q,w=!1}}var z=!1,T=null,_=-1,S=5,E=-1;function A(){return!(t.unstable_now()-E<S)}function b(){if(T!==null){var W=t.unstable_now();E=W;var $=!0;try{$=T(!0,W)}finally{$?C():(z=!1,T=null)}}else z=!1}var C;if(typeof v=="function")C=function(){v(b)};else if(typeof MessageChannel<"u"){var qe=new MessageChannel,Ke=qe.port2;qe.port1.onmessage=b,C=function(){Ke.postMessage(null)}}else C=function(){P(b,0)};function Mt(W){T=W,z||(z=!0,C())}function xt(W,$){_=P(function(){W(t.unstable_now())},$)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(W){W.callback=null},t.unstable_continueExecution=function(){R||w||(R=!0,Mt(F))},t.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<W?Math.floor(1e3/W):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(W){switch(g){case 1:case 2:case 3:var $=3;break;default:$=g}var q=g;g=$;try{return W()}finally{g=q}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(W,$){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var q=g;g=W;try{return $()}finally{g=q}},t.unstable_scheduleCallback=function(W,$,q){var re=t.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?re+q:re):q=re,W){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=q+se,W={id:f++,callback:$,priorityLevel:W,startTime:q,expirationTime:se,sortIndex:-1},q>re?(W.sortIndex=q,e(u,W),n(c)===null&&W===n(u)&&(N?(x(_),_=-1):N=!0,xt(D,q-re))):(W.sortIndex=se,e(c,W),R||w||(R=!0,Mt(F))),W},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(W){var $=g;return function(){var q=g;g=$;try{return W.apply(this,arguments)}finally{g=q}}}})(v_);y_.exports=v_;var Jx=y_.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xx=L,Wt=Jx;function U(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var __=new Set,Yo={};function Ss(t,e){gi(t,e),gi(t+"Capture",e)}function gi(t,e){for(Yo[t]=e,t=0;t<e.length;t++)__.add(e[t])}var Hn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Kh=Object.prototype.hasOwnProperty,Zx=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,ug={},hg={};function eT(t){return Kh.call(hg,t)?!0:Kh.call(ug,t)?!1:Zx.test(t)?hg[t]=!0:(ug[t]=!0,!1)}function tT(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function nT(t,e,n,r){if(e===null||typeof e>"u"||tT(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Nt(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var ut={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ut[t]=new Nt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ut[e]=new Nt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ut[t]=new Nt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ut[t]=new Nt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ut[t]=new Nt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ut[t]=new Nt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ut[t]=new Nt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ut[t]=new Nt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ut[t]=new Nt(t,5,!1,t.toLowerCase(),null,!1,!1)});var If=/[\-:]([a-z])/g;function Sf(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(If,Sf);ut[e]=new Nt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(If,Sf);ut[e]=new Nt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(If,Sf);ut[e]=new Nt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ut[t]=new Nt(t,1,!1,t.toLowerCase(),null,!1,!1)});ut.xlinkHref=new Nt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ut[t]=new Nt(t,1,!1,t.toLowerCase(),null,!0,!0)});function Cf(t,e,n,r){var s=ut.hasOwnProperty(e)?ut[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(nT(e,n,s,r)&&(n=null),r||s===null?eT(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Zn=Xx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,fl=Symbol.for("react.element"),Ks=Symbol.for("react.portal"),Qs=Symbol.for("react.fragment"),Rf=Symbol.for("react.strict_mode"),Qh=Symbol.for("react.profiler"),w_=Symbol.for("react.provider"),E_=Symbol.for("react.context"),Nf=Symbol.for("react.forward_ref"),Yh=Symbol.for("react.suspense"),Jh=Symbol.for("react.suspense_list"),Af=Symbol.for("react.memo"),lr=Symbol.for("react.lazy"),x_=Symbol.for("react.offscreen"),dg=Symbol.iterator;function go(t){return t===null||typeof t!="object"?null:(t=dg&&t[dg]||t["@@iterator"],typeof t=="function"?t:null)}var Ce=Object.assign,nh;function Ro(t){if(nh===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);nh=e&&e[1]||""}return`
`+nh+t}var rh=!1;function sh(t,e){if(!t||rh)return"";rh=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{rh=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Ro(t):""}function rT(t){switch(t.tag){case 5:return Ro(t.type);case 16:return Ro("Lazy");case 13:return Ro("Suspense");case 19:return Ro("SuspenseList");case 0:case 2:case 15:return t=sh(t.type,!1),t;case 11:return t=sh(t.type.render,!1),t;case 1:return t=sh(t.type,!0),t;default:return""}}function Xh(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Qs:return"Fragment";case Ks:return"Portal";case Qh:return"Profiler";case Rf:return"StrictMode";case Yh:return"Suspense";case Jh:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case E_:return(t.displayName||"Context")+".Consumer";case w_:return(t._context.displayName||"Context")+".Provider";case Nf:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Af:return e=t.displayName||null,e!==null?e:Xh(t.type)||"Memo";case lr:e=t._payload,t=t._init;try{return Xh(t(e))}catch{}}return null}function sT(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Xh(e);case 8:return e===Rf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function jr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function T_(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function iT(t){var e=T_(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function pl(t){t._valueTracker||(t._valueTracker=iT(t))}function I_(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=T_(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function lc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Zh(t,e){var n=e.checked;return Ce({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function fg(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=jr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function S_(t,e){e=e.checked,e!=null&&Cf(t,"checked",e,!1)}function ed(t,e){S_(t,e);var n=jr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?td(t,e.type,n):e.hasOwnProperty("defaultValue")&&td(t,e.type,jr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function pg(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function td(t,e,n){(e!=="number"||lc(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var No=Array.isArray;function oi(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+jr(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function nd(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(U(91));return Ce({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function mg(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(U(92));if(No(n)){if(1<n.length)throw Error(U(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:jr(n)}}function C_(t,e){var n=jr(e.value),r=jr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function gg(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function R_(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function rd(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?R_(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var ml,N_=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(ml=ml||document.createElement("div"),ml.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ml.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Jo(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Vo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},oT=["Webkit","ms","Moz","O"];Object.keys(Vo).forEach(function(t){oT.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Vo[e]=Vo[t]})});function A_(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Vo.hasOwnProperty(t)&&Vo[t]?(""+e).trim():e+"px"}function P_(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=A_(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var aT=Ce({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function sd(t,e){if(e){if(aT[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(U(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(U(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(U(61))}if(e.style!=null&&typeof e.style!="object")throw Error(U(62))}}function id(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var od=null;function Pf(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var ad=null,ai=null,li=null;function yg(t){if(t=Pa(t)){if(typeof ad!="function")throw Error(U(280));var e=t.stateNode;e&&(e=au(e),ad(t.stateNode,t.type,e))}}function k_(t){ai?li?li.push(t):li=[t]:ai=t}function b_(){if(ai){var t=ai,e=li;if(li=ai=null,yg(t),e)for(t=0;t<e.length;t++)yg(e[t])}}function D_(t,e){return t(e)}function j_(){}var ih=!1;function V_(t,e,n){if(ih)return t(e,n);ih=!0;try{return D_(t,e,n)}finally{ih=!1,(ai!==null||li!==null)&&(j_(),b_())}}function Xo(t,e){var n=t.stateNode;if(n===null)return null;var r=au(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(U(231,e,typeof n));return n}var ld=!1;if(Hn)try{var yo={};Object.defineProperty(yo,"passive",{get:function(){ld=!0}}),window.addEventListener("test",yo,yo),window.removeEventListener("test",yo,yo)}catch{ld=!1}function lT(t,e,n,r,s,i,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(f){this.onError(f)}}var Oo=!1,cc=null,uc=!1,cd=null,cT={onError:function(t){Oo=!0,cc=t}};function uT(t,e,n,r,s,i,o,l,c){Oo=!1,cc=null,lT.apply(cT,arguments)}function hT(t,e,n,r,s,i,o,l,c){if(uT.apply(this,arguments),Oo){if(Oo){var u=cc;Oo=!1,cc=null}else throw Error(U(198));uc||(uc=!0,cd=u)}}function Cs(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function O_(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function vg(t){if(Cs(t)!==t)throw Error(U(188))}function dT(t){var e=t.alternate;if(!e){if(e=Cs(t),e===null)throw Error(U(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return vg(s),t;if(i===r)return vg(s),e;i=i.sibling}throw Error(U(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(U(189))}}if(n.alternate!==r)throw Error(U(190))}if(n.tag!==3)throw Error(U(188));return n.stateNode.current===n?t:e}function L_(t){return t=dT(t),t!==null?M_(t):null}function M_(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=M_(t);if(e!==null)return e;t=t.sibling}return null}var F_=Wt.unstable_scheduleCallback,_g=Wt.unstable_cancelCallback,fT=Wt.unstable_shouldYield,pT=Wt.unstable_requestPaint,Oe=Wt.unstable_now,mT=Wt.unstable_getCurrentPriorityLevel,kf=Wt.unstable_ImmediatePriority,U_=Wt.unstable_UserBlockingPriority,hc=Wt.unstable_NormalPriority,gT=Wt.unstable_LowPriority,B_=Wt.unstable_IdlePriority,ru=null,Tn=null;function yT(t){if(Tn&&typeof Tn.onCommitFiberRoot=="function")try{Tn.onCommitFiberRoot(ru,t,void 0,(t.current.flags&128)===128)}catch{}}var un=Math.clz32?Math.clz32:wT,vT=Math.log,_T=Math.LN2;function wT(t){return t>>>=0,t===0?32:31-(vT(t)/_T|0)|0}var gl=64,yl=4194304;function Ao(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function dc(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=Ao(l):(i&=o,i!==0&&(r=Ao(i)))}else o=n&~s,o!==0?r=Ao(o):i!==0&&(r=Ao(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-un(e),s=1<<n,r|=t[n],e&=~s;return r}function ET(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function xT(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-un(i),l=1<<o,c=s[o];c===-1?(!(l&n)||l&r)&&(s[o]=ET(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function ud(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function z_(){var t=gl;return gl<<=1,!(gl&4194240)&&(gl=64),t}function oh(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Na(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-un(e),t[e]=n}function TT(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-un(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function bf(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-un(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var me=0;function $_(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var G_,Df,H_,W_,q_,hd=!1,vl=[],wr=null,Er=null,xr=null,Zo=new Map,ea=new Map,ur=[],IT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function wg(t,e){switch(t){case"focusin":case"focusout":wr=null;break;case"dragenter":case"dragleave":Er=null;break;case"mouseover":case"mouseout":xr=null;break;case"pointerover":case"pointerout":Zo.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ea.delete(e.pointerId)}}function vo(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Pa(e),e!==null&&Df(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function ST(t,e,n,r,s){switch(e){case"focusin":return wr=vo(wr,t,e,n,r,s),!0;case"dragenter":return Er=vo(Er,t,e,n,r,s),!0;case"mouseover":return xr=vo(xr,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Zo.set(i,vo(Zo.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,ea.set(i,vo(ea.get(i)||null,t,e,n,r,s)),!0}return!1}function K_(t){var e=os(t.target);if(e!==null){var n=Cs(e);if(n!==null){if(e=n.tag,e===13){if(e=O_(n),e!==null){t.blockedOn=e,q_(t.priority,function(){H_(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Fl(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=dd(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);od=r,n.target.dispatchEvent(r),od=null}else return e=Pa(n),e!==null&&Df(e),t.blockedOn=n,!1;e.shift()}return!0}function Eg(t,e,n){Fl(t)&&n.delete(e)}function CT(){hd=!1,wr!==null&&Fl(wr)&&(wr=null),Er!==null&&Fl(Er)&&(Er=null),xr!==null&&Fl(xr)&&(xr=null),Zo.forEach(Eg),ea.forEach(Eg)}function _o(t,e){t.blockedOn===e&&(t.blockedOn=null,hd||(hd=!0,Wt.unstable_scheduleCallback(Wt.unstable_NormalPriority,CT)))}function ta(t){function e(s){return _o(s,t)}if(0<vl.length){_o(vl[0],t);for(var n=1;n<vl.length;n++){var r=vl[n];r.blockedOn===t&&(r.blockedOn=null)}}for(wr!==null&&_o(wr,t),Er!==null&&_o(Er,t),xr!==null&&_o(xr,t),Zo.forEach(e),ea.forEach(e),n=0;n<ur.length;n++)r=ur[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<ur.length&&(n=ur[0],n.blockedOn===null);)K_(n),n.blockedOn===null&&ur.shift()}var ci=Zn.ReactCurrentBatchConfig,fc=!0;function RT(t,e,n,r){var s=me,i=ci.transition;ci.transition=null;try{me=1,jf(t,e,n,r)}finally{me=s,ci.transition=i}}function NT(t,e,n,r){var s=me,i=ci.transition;ci.transition=null;try{me=4,jf(t,e,n,r)}finally{me=s,ci.transition=i}}function jf(t,e,n,r){if(fc){var s=dd(t,e,n,r);if(s===null)gh(t,e,r,pc,n),wg(t,r);else if(ST(s,t,e,n,r))r.stopPropagation();else if(wg(t,r),e&4&&-1<IT.indexOf(t)){for(;s!==null;){var i=Pa(s);if(i!==null&&G_(i),i=dd(t,e,n,r),i===null&&gh(t,e,r,pc,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else gh(t,e,r,null,n)}}var pc=null;function dd(t,e,n,r){if(pc=null,t=Pf(r),t=os(t),t!==null)if(e=Cs(t),e===null)t=null;else if(n=e.tag,n===13){if(t=O_(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return pc=t,null}function Q_(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(mT()){case kf:return 1;case U_:return 4;case hc:case gT:return 16;case B_:return 536870912;default:return 16}default:return 16}}var mr=null,Vf=null,Ul=null;function Y_(){if(Ul)return Ul;var t,e=Vf,n=e.length,r,s="value"in mr?mr.value:mr.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Ul=s.slice(t,1<r?1-r:void 0)}function Bl(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function _l(){return!0}function xg(){return!1}function Kt(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?_l:xg,this.isPropagationStopped=xg,this}return Ce(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=_l)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=_l)},persist:function(){},isPersistent:_l}),e}var Di={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Of=Kt(Di),Aa=Ce({},Di,{view:0,detail:0}),AT=Kt(Aa),ah,lh,wo,su=Ce({},Aa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Lf,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==wo&&(wo&&t.type==="mousemove"?(ah=t.screenX-wo.screenX,lh=t.screenY-wo.screenY):lh=ah=0,wo=t),ah)},movementY:function(t){return"movementY"in t?t.movementY:lh}}),Tg=Kt(su),PT=Ce({},su,{dataTransfer:0}),kT=Kt(PT),bT=Ce({},Aa,{relatedTarget:0}),ch=Kt(bT),DT=Ce({},Di,{animationName:0,elapsedTime:0,pseudoElement:0}),jT=Kt(DT),VT=Ce({},Di,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),OT=Kt(VT),LT=Ce({},Di,{data:0}),Ig=Kt(LT),MT={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},FT={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},UT={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function BT(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=UT[t])?!!e[t]:!1}function Lf(){return BT}var zT=Ce({},Aa,{key:function(t){if(t.key){var e=MT[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Bl(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?FT[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Lf,charCode:function(t){return t.type==="keypress"?Bl(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Bl(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),$T=Kt(zT),GT=Ce({},su,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Sg=Kt(GT),HT=Ce({},Aa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Lf}),WT=Kt(HT),qT=Ce({},Di,{propertyName:0,elapsedTime:0,pseudoElement:0}),KT=Kt(qT),QT=Ce({},su,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),YT=Kt(QT),JT=[9,13,27,32],Mf=Hn&&"CompositionEvent"in window,Lo=null;Hn&&"documentMode"in document&&(Lo=document.documentMode);var XT=Hn&&"TextEvent"in window&&!Lo,J_=Hn&&(!Mf||Lo&&8<Lo&&11>=Lo),Cg=String.fromCharCode(32),Rg=!1;function X_(t,e){switch(t){case"keyup":return JT.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Z_(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ys=!1;function ZT(t,e){switch(t){case"compositionend":return Z_(e);case"keypress":return e.which!==32?null:(Rg=!0,Cg);case"textInput":return t=e.data,t===Cg&&Rg?null:t;default:return null}}function eI(t,e){if(Ys)return t==="compositionend"||!Mf&&X_(t,e)?(t=Y_(),Ul=Vf=mr=null,Ys=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return J_&&e.locale!=="ko"?null:e.data;default:return null}}var tI={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ng(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!tI[t.type]:e==="textarea"}function e1(t,e,n,r){k_(r),e=mc(e,"onChange"),0<e.length&&(n=new Of("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Mo=null,na=null;function nI(t){h1(t,0)}function iu(t){var e=Zs(t);if(I_(e))return t}function rI(t,e){if(t==="change")return e}var t1=!1;if(Hn){var uh;if(Hn){var hh="oninput"in document;if(!hh){var Ag=document.createElement("div");Ag.setAttribute("oninput","return;"),hh=typeof Ag.oninput=="function"}uh=hh}else uh=!1;t1=uh&&(!document.documentMode||9<document.documentMode)}function Pg(){Mo&&(Mo.detachEvent("onpropertychange",n1),na=Mo=null)}function n1(t){if(t.propertyName==="value"&&iu(na)){var e=[];e1(e,na,t,Pf(t)),V_(nI,e)}}function sI(t,e,n){t==="focusin"?(Pg(),Mo=e,na=n,Mo.attachEvent("onpropertychange",n1)):t==="focusout"&&Pg()}function iI(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return iu(na)}function oI(t,e){if(t==="click")return iu(e)}function aI(t,e){if(t==="input"||t==="change")return iu(e)}function lI(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var pn=typeof Object.is=="function"?Object.is:lI;function ra(t,e){if(pn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Kh.call(e,s)||!pn(t[s],e[s]))return!1}return!0}function kg(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function bg(t,e){var n=kg(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=kg(n)}}function r1(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?r1(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function s1(){for(var t=window,e=lc();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=lc(t.document)}return e}function Ff(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function cI(t){var e=s1(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&r1(n.ownerDocument.documentElement,n)){if(r!==null&&Ff(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=bg(n,i);var o=bg(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var uI=Hn&&"documentMode"in document&&11>=document.documentMode,Js=null,fd=null,Fo=null,pd=!1;function Dg(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;pd||Js==null||Js!==lc(r)||(r=Js,"selectionStart"in r&&Ff(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Fo&&ra(Fo,r)||(Fo=r,r=mc(fd,"onSelect"),0<r.length&&(e=new Of("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Js)))}function wl(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Xs={animationend:wl("Animation","AnimationEnd"),animationiteration:wl("Animation","AnimationIteration"),animationstart:wl("Animation","AnimationStart"),transitionend:wl("Transition","TransitionEnd")},dh={},i1={};Hn&&(i1=document.createElement("div").style,"AnimationEvent"in window||(delete Xs.animationend.animation,delete Xs.animationiteration.animation,delete Xs.animationstart.animation),"TransitionEvent"in window||delete Xs.transitionend.transition);function ou(t){if(dh[t])return dh[t];if(!Xs[t])return t;var e=Xs[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in i1)return dh[t]=e[n];return t}var o1=ou("animationend"),a1=ou("animationiteration"),l1=ou("animationstart"),c1=ou("transitionend"),u1=new Map,jg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function $r(t,e){u1.set(t,e),Ss(e,[t])}for(var fh=0;fh<jg.length;fh++){var ph=jg[fh],hI=ph.toLowerCase(),dI=ph[0].toUpperCase()+ph.slice(1);$r(hI,"on"+dI)}$r(o1,"onAnimationEnd");$r(a1,"onAnimationIteration");$r(l1,"onAnimationStart");$r("dblclick","onDoubleClick");$r("focusin","onFocus");$r("focusout","onBlur");$r(c1,"onTransitionEnd");gi("onMouseEnter",["mouseout","mouseover"]);gi("onMouseLeave",["mouseout","mouseover"]);gi("onPointerEnter",["pointerout","pointerover"]);gi("onPointerLeave",["pointerout","pointerover"]);Ss("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ss("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ss("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ss("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ss("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ss("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Po="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),fI=new Set("cancel close invalid load scroll toggle".split(" ").concat(Po));function Vg(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,hT(r,e,void 0,t),t.currentTarget=null}function h1(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;Vg(s,l,u),i=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;Vg(s,l,u),i=c}}}if(uc)throw t=cd,uc=!1,cd=null,t}function Ee(t,e){var n=e[_d];n===void 0&&(n=e[_d]=new Set);var r=t+"__bubble";n.has(r)||(d1(e,t,2,!1),n.add(r))}function mh(t,e,n){var r=0;e&&(r|=4),d1(n,t,r,e)}var El="_reactListening"+Math.random().toString(36).slice(2);function sa(t){if(!t[El]){t[El]=!0,__.forEach(function(n){n!=="selectionchange"&&(fI.has(n)||mh(n,!1,t),mh(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[El]||(e[El]=!0,mh("selectionchange",!1,e))}}function d1(t,e,n,r){switch(Q_(e)){case 1:var s=RT;break;case 4:s=NT;break;default:s=jf}n=s.bind(null,e,n,t),s=void 0,!ld||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function gh(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=os(l),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}l=l.parentNode}}r=r.return}V_(function(){var u=i,f=Pf(n),m=[];e:{var g=u1.get(t);if(g!==void 0){var w=Of,R=t;switch(t){case"keypress":if(Bl(n)===0)break e;case"keydown":case"keyup":w=$T;break;case"focusin":R="focus",w=ch;break;case"focusout":R="blur",w=ch;break;case"beforeblur":case"afterblur":w=ch;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":w=Tg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":w=kT;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":w=WT;break;case o1:case a1:case l1:w=jT;break;case c1:w=KT;break;case"scroll":w=AT;break;case"wheel":w=YT;break;case"copy":case"cut":case"paste":w=OT;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":w=Sg}var N=(e&4)!==0,P=!N&&t==="scroll",x=N?g!==null?g+"Capture":null:g;N=[];for(var v=u,I;v!==null;){I=v;var D=I.stateNode;if(I.tag===5&&D!==null&&(I=D,x!==null&&(D=Xo(v,x),D!=null&&N.push(ia(v,D,I)))),P)break;v=v.return}0<N.length&&(g=new w(g,R,null,n,f),m.push({event:g,listeners:N}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",w=t==="mouseout"||t==="pointerout",g&&n!==od&&(R=n.relatedTarget||n.fromElement)&&(os(R)||R[Wn]))break e;if((w||g)&&(g=f.window===f?f:(g=f.ownerDocument)?g.defaultView||g.parentWindow:window,w?(R=n.relatedTarget||n.toElement,w=u,R=R?os(R):null,R!==null&&(P=Cs(R),R!==P||R.tag!==5&&R.tag!==6)&&(R=null)):(w=null,R=u),w!==R)){if(N=Tg,D="onMouseLeave",x="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(N=Sg,D="onPointerLeave",x="onPointerEnter",v="pointer"),P=w==null?g:Zs(w),I=R==null?g:Zs(R),g=new N(D,v+"leave",w,n,f),g.target=P,g.relatedTarget=I,D=null,os(f)===u&&(N=new N(x,v+"enter",R,n,f),N.target=I,N.relatedTarget=P,D=N),P=D,w&&R)t:{for(N=w,x=R,v=0,I=N;I;I=zs(I))v++;for(I=0,D=x;D;D=zs(D))I++;for(;0<v-I;)N=zs(N),v--;for(;0<I-v;)x=zs(x),I--;for(;v--;){if(N===x||x!==null&&N===x.alternate)break t;N=zs(N),x=zs(x)}N=null}else N=null;w!==null&&Og(m,g,w,N,!1),R!==null&&P!==null&&Og(m,P,R,N,!0)}}e:{if(g=u?Zs(u):window,w=g.nodeName&&g.nodeName.toLowerCase(),w==="select"||w==="input"&&g.type==="file")var F=rI;else if(Ng(g))if(t1)F=aI;else{F=iI;var z=sI}else(w=g.nodeName)&&w.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(F=oI);if(F&&(F=F(t,u))){e1(m,F,n,f);break e}z&&z(t,g,u),t==="focusout"&&(z=g._wrapperState)&&z.controlled&&g.type==="number"&&td(g,"number",g.value)}switch(z=u?Zs(u):window,t){case"focusin":(Ng(z)||z.contentEditable==="true")&&(Js=z,fd=u,Fo=null);break;case"focusout":Fo=fd=Js=null;break;case"mousedown":pd=!0;break;case"contextmenu":case"mouseup":case"dragend":pd=!1,Dg(m,n,f);break;case"selectionchange":if(uI)break;case"keydown":case"keyup":Dg(m,n,f)}var T;if(Mf)e:{switch(t){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else Ys?X_(t,n)&&(_="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(_="onCompositionStart");_&&(J_&&n.locale!=="ko"&&(Ys||_!=="onCompositionStart"?_==="onCompositionEnd"&&Ys&&(T=Y_()):(mr=f,Vf="value"in mr?mr.value:mr.textContent,Ys=!0)),z=mc(u,_),0<z.length&&(_=new Ig(_,t,null,n,f),m.push({event:_,listeners:z}),T?_.data=T:(T=Z_(n),T!==null&&(_.data=T)))),(T=XT?ZT(t,n):eI(t,n))&&(u=mc(u,"onBeforeInput"),0<u.length&&(f=new Ig("onBeforeInput","beforeinput",null,n,f),m.push({event:f,listeners:u}),f.data=T))}h1(m,e)})}function ia(t,e,n){return{instance:t,listener:e,currentTarget:n}}function mc(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Xo(t,n),i!=null&&r.unshift(ia(t,i,s)),i=Xo(t,e),i!=null&&r.push(ia(t,i,s))),t=t.return}return r}function zs(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Og(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,s?(c=Xo(n,i),c!=null&&o.unshift(ia(n,c,l))):s||(c=Xo(n,i),c!=null&&o.push(ia(n,c,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var pI=/\r\n?/g,mI=/\u0000|\uFFFD/g;function Lg(t){return(typeof t=="string"?t:""+t).replace(pI,`
`).replace(mI,"")}function xl(t,e,n){if(e=Lg(e),Lg(t)!==e&&n)throw Error(U(425))}function gc(){}var md=null,gd=null;function yd(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var vd=typeof setTimeout=="function"?setTimeout:void 0,gI=typeof clearTimeout=="function"?clearTimeout:void 0,Mg=typeof Promise=="function"?Promise:void 0,yI=typeof queueMicrotask=="function"?queueMicrotask:typeof Mg<"u"?function(t){return Mg.resolve(null).then(t).catch(vI)}:vd;function vI(t){setTimeout(function(){throw t})}function yh(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),ta(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);ta(e)}function Tr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Fg(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ji=Math.random().toString(36).slice(2),En="__reactFiber$"+ji,oa="__reactProps$"+ji,Wn="__reactContainer$"+ji,_d="__reactEvents$"+ji,_I="__reactListeners$"+ji,wI="__reactHandles$"+ji;function os(t){var e=t[En];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Wn]||n[En]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Fg(t);t!==null;){if(n=t[En])return n;t=Fg(t)}return e}t=n,n=t.parentNode}return null}function Pa(t){return t=t[En]||t[Wn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Zs(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(U(33))}function au(t){return t[oa]||null}var wd=[],ei=-1;function Gr(t){return{current:t}}function xe(t){0>ei||(t.current=wd[ei],wd[ei]=null,ei--)}function ve(t,e){ei++,wd[ei]=t.current,t.current=e}var Vr={},wt=Gr(Vr),Vt=Gr(!1),gs=Vr;function yi(t,e){var n=t.type.contextTypes;if(!n)return Vr;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Ot(t){return t=t.childContextTypes,t!=null}function yc(){xe(Vt),xe(wt)}function Ug(t,e,n){if(wt.current!==Vr)throw Error(U(168));ve(wt,e),ve(Vt,n)}function f1(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(U(108,sT(t)||"Unknown",s));return Ce({},n,r)}function vc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Vr,gs=wt.current,ve(wt,t),ve(Vt,Vt.current),!0}function Bg(t,e,n){var r=t.stateNode;if(!r)throw Error(U(169));n?(t=f1(t,e,gs),r.__reactInternalMemoizedMergedChildContext=t,xe(Vt),xe(wt),ve(wt,t)):xe(Vt),ve(Vt,n)}var Ln=null,lu=!1,vh=!1;function p1(t){Ln===null?Ln=[t]:Ln.push(t)}function EI(t){lu=!0,p1(t)}function Hr(){if(!vh&&Ln!==null){vh=!0;var t=0,e=me;try{var n=Ln;for(me=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Ln=null,lu=!1}catch(s){throw Ln!==null&&(Ln=Ln.slice(t+1)),F_(kf,Hr),s}finally{me=e,vh=!1}}return null}var ti=[],ni=0,_c=null,wc=0,Qt=[],Yt=0,ys=null,Fn=1,Un="";function rs(t,e){ti[ni++]=wc,ti[ni++]=_c,_c=t,wc=e}function m1(t,e,n){Qt[Yt++]=Fn,Qt[Yt++]=Un,Qt[Yt++]=ys,ys=t;var r=Fn;t=Un;var s=32-un(r)-1;r&=~(1<<s),n+=1;var i=32-un(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Fn=1<<32-un(e)+s|n<<s|r,Un=i+t}else Fn=1<<i|n<<s|r,Un=t}function Uf(t){t.return!==null&&(rs(t,1),m1(t,1,0))}function Bf(t){for(;t===_c;)_c=ti[--ni],ti[ni]=null,wc=ti[--ni],ti[ni]=null;for(;t===ys;)ys=Qt[--Yt],Qt[Yt]=null,Un=Qt[--Yt],Qt[Yt]=null,Fn=Qt[--Yt],Qt[Yt]=null}var Ht=null,$t=null,Te=!1,an=null;function g1(t,e){var n=Xt(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function zg(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Ht=t,$t=Tr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Ht=t,$t=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=ys!==null?{id:Fn,overflow:Un}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Xt(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Ht=t,$t=null,!0):!1;default:return!1}}function Ed(t){return(t.mode&1)!==0&&(t.flags&128)===0}function xd(t){if(Te){var e=$t;if(e){var n=e;if(!zg(t,e)){if(Ed(t))throw Error(U(418));e=Tr(n.nextSibling);var r=Ht;e&&zg(t,e)?g1(r,n):(t.flags=t.flags&-4097|2,Te=!1,Ht=t)}}else{if(Ed(t))throw Error(U(418));t.flags=t.flags&-4097|2,Te=!1,Ht=t}}}function $g(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Ht=t}function Tl(t){if(t!==Ht)return!1;if(!Te)return $g(t),Te=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!yd(t.type,t.memoizedProps)),e&&(e=$t)){if(Ed(t))throw y1(),Error(U(418));for(;e;)g1(t,e),e=Tr(e.nextSibling)}if($g(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(U(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){$t=Tr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}$t=null}}else $t=Ht?Tr(t.stateNode.nextSibling):null;return!0}function y1(){for(var t=$t;t;)t=Tr(t.nextSibling)}function vi(){$t=Ht=null,Te=!1}function zf(t){an===null?an=[t]:an.push(t)}var xI=Zn.ReactCurrentBatchConfig;function Eo(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(U(309));var r=n.stateNode}if(!r)throw Error(U(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(U(284));if(!n._owner)throw Error(U(290,t))}return t}function Il(t,e){throw t=Object.prototype.toString.call(e),Error(U(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Gg(t){var e=t._init;return e(t._payload)}function v1(t){function e(x,v){if(t){var I=x.deletions;I===null?(x.deletions=[v],x.flags|=16):I.push(v)}}function n(x,v){if(!t)return null;for(;v!==null;)e(x,v),v=v.sibling;return null}function r(x,v){for(x=new Map;v!==null;)v.key!==null?x.set(v.key,v):x.set(v.index,v),v=v.sibling;return x}function s(x,v){return x=Rr(x,v),x.index=0,x.sibling=null,x}function i(x,v,I){return x.index=I,t?(I=x.alternate,I!==null?(I=I.index,I<v?(x.flags|=2,v):I):(x.flags|=2,v)):(x.flags|=1048576,v)}function o(x){return t&&x.alternate===null&&(x.flags|=2),x}function l(x,v,I,D){return v===null||v.tag!==6?(v=Sh(I,x.mode,D),v.return=x,v):(v=s(v,I),v.return=x,v)}function c(x,v,I,D){var F=I.type;return F===Qs?f(x,v,I.props.children,D,I.key):v!==null&&(v.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===lr&&Gg(F)===v.type)?(D=s(v,I.props),D.ref=Eo(x,v,I),D.return=x,D):(D=Kl(I.type,I.key,I.props,null,x.mode,D),D.ref=Eo(x,v,I),D.return=x,D)}function u(x,v,I,D){return v===null||v.tag!==4||v.stateNode.containerInfo!==I.containerInfo||v.stateNode.implementation!==I.implementation?(v=Ch(I,x.mode,D),v.return=x,v):(v=s(v,I.children||[]),v.return=x,v)}function f(x,v,I,D,F){return v===null||v.tag!==7?(v=ds(I,x.mode,D,F),v.return=x,v):(v=s(v,I),v.return=x,v)}function m(x,v,I){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Sh(""+v,x.mode,I),v.return=x,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case fl:return I=Kl(v.type,v.key,v.props,null,x.mode,I),I.ref=Eo(x,null,v),I.return=x,I;case Ks:return v=Ch(v,x.mode,I),v.return=x,v;case lr:var D=v._init;return m(x,D(v._payload),I)}if(No(v)||go(v))return v=ds(v,x.mode,I,null),v.return=x,v;Il(x,v)}return null}function g(x,v,I,D){var F=v!==null?v.key:null;if(typeof I=="string"&&I!==""||typeof I=="number")return F!==null?null:l(x,v,""+I,D);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case fl:return I.key===F?c(x,v,I,D):null;case Ks:return I.key===F?u(x,v,I,D):null;case lr:return F=I._init,g(x,v,F(I._payload),D)}if(No(I)||go(I))return F!==null?null:f(x,v,I,D,null);Il(x,I)}return null}function w(x,v,I,D,F){if(typeof D=="string"&&D!==""||typeof D=="number")return x=x.get(I)||null,l(v,x,""+D,F);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case fl:return x=x.get(D.key===null?I:D.key)||null,c(v,x,D,F);case Ks:return x=x.get(D.key===null?I:D.key)||null,u(v,x,D,F);case lr:var z=D._init;return w(x,v,I,z(D._payload),F)}if(No(D)||go(D))return x=x.get(I)||null,f(v,x,D,F,null);Il(v,D)}return null}function R(x,v,I,D){for(var F=null,z=null,T=v,_=v=0,S=null;T!==null&&_<I.length;_++){T.index>_?(S=T,T=null):S=T.sibling;var E=g(x,T,I[_],D);if(E===null){T===null&&(T=S);break}t&&T&&E.alternate===null&&e(x,T),v=i(E,v,_),z===null?F=E:z.sibling=E,z=E,T=S}if(_===I.length)return n(x,T),Te&&rs(x,_),F;if(T===null){for(;_<I.length;_++)T=m(x,I[_],D),T!==null&&(v=i(T,v,_),z===null?F=T:z.sibling=T,z=T);return Te&&rs(x,_),F}for(T=r(x,T);_<I.length;_++)S=w(T,x,_,I[_],D),S!==null&&(t&&S.alternate!==null&&T.delete(S.key===null?_:S.key),v=i(S,v,_),z===null?F=S:z.sibling=S,z=S);return t&&T.forEach(function(A){return e(x,A)}),Te&&rs(x,_),F}function N(x,v,I,D){var F=go(I);if(typeof F!="function")throw Error(U(150));if(I=F.call(I),I==null)throw Error(U(151));for(var z=F=null,T=v,_=v=0,S=null,E=I.next();T!==null&&!E.done;_++,E=I.next()){T.index>_?(S=T,T=null):S=T.sibling;var A=g(x,T,E.value,D);if(A===null){T===null&&(T=S);break}t&&T&&A.alternate===null&&e(x,T),v=i(A,v,_),z===null?F=A:z.sibling=A,z=A,T=S}if(E.done)return n(x,T),Te&&rs(x,_),F;if(T===null){for(;!E.done;_++,E=I.next())E=m(x,E.value,D),E!==null&&(v=i(E,v,_),z===null?F=E:z.sibling=E,z=E);return Te&&rs(x,_),F}for(T=r(x,T);!E.done;_++,E=I.next())E=w(T,x,_,E.value,D),E!==null&&(t&&E.alternate!==null&&T.delete(E.key===null?_:E.key),v=i(E,v,_),z===null?F=E:z.sibling=E,z=E);return t&&T.forEach(function(b){return e(x,b)}),Te&&rs(x,_),F}function P(x,v,I,D){if(typeof I=="object"&&I!==null&&I.type===Qs&&I.key===null&&(I=I.props.children),typeof I=="object"&&I!==null){switch(I.$$typeof){case fl:e:{for(var F=I.key,z=v;z!==null;){if(z.key===F){if(F=I.type,F===Qs){if(z.tag===7){n(x,z.sibling),v=s(z,I.props.children),v.return=x,x=v;break e}}else if(z.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===lr&&Gg(F)===z.type){n(x,z.sibling),v=s(z,I.props),v.ref=Eo(x,z,I),v.return=x,x=v;break e}n(x,z);break}else e(x,z);z=z.sibling}I.type===Qs?(v=ds(I.props.children,x.mode,D,I.key),v.return=x,x=v):(D=Kl(I.type,I.key,I.props,null,x.mode,D),D.ref=Eo(x,v,I),D.return=x,x=D)}return o(x);case Ks:e:{for(z=I.key;v!==null;){if(v.key===z)if(v.tag===4&&v.stateNode.containerInfo===I.containerInfo&&v.stateNode.implementation===I.implementation){n(x,v.sibling),v=s(v,I.children||[]),v.return=x,x=v;break e}else{n(x,v);break}else e(x,v);v=v.sibling}v=Ch(I,x.mode,D),v.return=x,x=v}return o(x);case lr:return z=I._init,P(x,v,z(I._payload),D)}if(No(I))return R(x,v,I,D);if(go(I))return N(x,v,I,D);Il(x,I)}return typeof I=="string"&&I!==""||typeof I=="number"?(I=""+I,v!==null&&v.tag===6?(n(x,v.sibling),v=s(v,I),v.return=x,x=v):(n(x,v),v=Sh(I,x.mode,D),v.return=x,x=v),o(x)):n(x,v)}return P}var _i=v1(!0),_1=v1(!1),Ec=Gr(null),xc=null,ri=null,$f=null;function Gf(){$f=ri=xc=null}function Hf(t){var e=Ec.current;xe(Ec),t._currentValue=e}function Td(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ui(t,e){xc=t,$f=ri=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(jt=!0),t.firstContext=null)}function en(t){var e=t._currentValue;if($f!==t)if(t={context:t,memoizedValue:e,next:null},ri===null){if(xc===null)throw Error(U(308));ri=t,xc.dependencies={lanes:0,firstContext:t}}else ri=ri.next=t;return e}var as=null;function Wf(t){as===null?as=[t]:as.push(t)}function w1(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Wf(e)):(n.next=s.next,s.next=n),e.interleaved=n,qn(t,r)}function qn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var cr=!1;function qf(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function E1(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function $n(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ir(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,de&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,qn(t,n)}return s=r.interleaved,s===null?(e.next=e,Wf(r)):(e.next=s.next,s.next=e),r.interleaved=e,qn(t,n)}function zl(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,bf(t,n)}}function Hg(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Tc(t,e,n,r){var s=t.updateQueue;cr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?i=u:o.next=u,o=c;var f=t.alternate;f!==null&&(f=f.updateQueue,l=f.lastBaseUpdate,l!==o&&(l===null?f.firstBaseUpdate=u:l.next=u,f.lastBaseUpdate=c))}if(i!==null){var m=s.baseState;o=0,f=u=c=null,l=i;do{var g=l.lane,w=l.eventTime;if((r&g)===g){f!==null&&(f=f.next={eventTime:w,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var R=t,N=l;switch(g=e,w=n,N.tag){case 1:if(R=N.payload,typeof R=="function"){m=R.call(w,m,g);break e}m=R;break e;case 3:R.flags=R.flags&-65537|128;case 0:if(R=N.payload,g=typeof R=="function"?R.call(w,m,g):R,g==null)break e;m=Ce({},m,g);break e;case 2:cr=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,g=s.effects,g===null?s.effects=[l]:g.push(l))}else w={eventTime:w,lane:g,tag:l.tag,payload:l.payload,callback:l.callback,next:null},f===null?(u=f=w,c=m):f=f.next=w,o|=g;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;g=l,l=g.next,g.next=null,s.lastBaseUpdate=g,s.shared.pending=null}}while(1);if(f===null&&(c=m),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=f,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);_s|=o,t.lanes=o,t.memoizedState=m}}function Wg(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(U(191,s));s.call(r)}}}var ka={},In=Gr(ka),aa=Gr(ka),la=Gr(ka);function ls(t){if(t===ka)throw Error(U(174));return t}function Kf(t,e){switch(ve(la,e),ve(aa,t),ve(In,ka),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:rd(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=rd(e,t)}xe(In),ve(In,e)}function wi(){xe(In),xe(aa),xe(la)}function x1(t){ls(la.current);var e=ls(In.current),n=rd(e,t.type);e!==n&&(ve(aa,t),ve(In,n))}function Qf(t){aa.current===t&&(xe(In),xe(aa))}var Ie=Gr(0);function Ic(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var _h=[];function Yf(){for(var t=0;t<_h.length;t++)_h[t]._workInProgressVersionPrimary=null;_h.length=0}var $l=Zn.ReactCurrentDispatcher,wh=Zn.ReactCurrentBatchConfig,vs=0,Se=null,Ge=null,Xe=null,Sc=!1,Uo=!1,ca=0,TI=0;function pt(){throw Error(U(321))}function Jf(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!pn(t[n],e[n]))return!1;return!0}function Xf(t,e,n,r,s,i){if(vs=i,Se=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,$l.current=t===null||t.memoizedState===null?RI:NI,t=n(r,s),Uo){i=0;do{if(Uo=!1,ca=0,25<=i)throw Error(U(301));i+=1,Xe=Ge=null,e.updateQueue=null,$l.current=AI,t=n(r,s)}while(Uo)}if($l.current=Cc,e=Ge!==null&&Ge.next!==null,vs=0,Xe=Ge=Se=null,Sc=!1,e)throw Error(U(300));return t}function Zf(){var t=ca!==0;return ca=0,t}function _n(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Xe===null?Se.memoizedState=Xe=t:Xe=Xe.next=t,Xe}function tn(){if(Ge===null){var t=Se.alternate;t=t!==null?t.memoizedState:null}else t=Ge.next;var e=Xe===null?Se.memoizedState:Xe.next;if(e!==null)Xe=e,Ge=t;else{if(t===null)throw Error(U(310));Ge=t,t={memoizedState:Ge.memoizedState,baseState:Ge.baseState,baseQueue:Ge.baseQueue,queue:Ge.queue,next:null},Xe===null?Se.memoizedState=Xe=t:Xe=Xe.next=t}return Xe}function ua(t,e){return typeof e=="function"?e(t):e}function Eh(t){var e=tn(),n=e.queue;if(n===null)throw Error(U(311));n.lastRenderedReducer=t;var r=Ge,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,c=null,u=i;do{var f=u.lane;if((vs&f)===f)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var m={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=m,o=r):c=c.next=m,Se.lanes|=f,_s|=f}u=u.next}while(u!==null&&u!==i);c===null?o=r:c.next=l,pn(r,e.memoizedState)||(jt=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,Se.lanes|=i,_s|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function xh(t){var e=tn(),n=e.queue;if(n===null)throw Error(U(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);pn(i,e.memoizedState)||(jt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function T1(){}function I1(t,e){var n=Se,r=tn(),s=e(),i=!pn(r.memoizedState,s);if(i&&(r.memoizedState=s,jt=!0),r=r.queue,ep(R1.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Xe!==null&&Xe.memoizedState.tag&1){if(n.flags|=2048,ha(9,C1.bind(null,n,r,s,e),void 0,null),et===null)throw Error(U(349));vs&30||S1(n,e,s)}return s}function S1(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Se.updateQueue,e===null?(e={lastEffect:null,stores:null},Se.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function C1(t,e,n,r){e.value=n,e.getSnapshot=r,N1(e)&&A1(t)}function R1(t,e,n){return n(function(){N1(e)&&A1(t)})}function N1(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!pn(t,n)}catch{return!0}}function A1(t){var e=qn(t,1);e!==null&&hn(e,t,1,-1)}function qg(t){var e=_n();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ua,lastRenderedState:t},e.queue=t,t=t.dispatch=CI.bind(null,Se,t),[e.memoizedState,t]}function ha(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Se.updateQueue,e===null?(e={lastEffect:null,stores:null},Se.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function P1(){return tn().memoizedState}function Gl(t,e,n,r){var s=_n();Se.flags|=t,s.memoizedState=ha(1|e,n,void 0,r===void 0?null:r)}function cu(t,e,n,r){var s=tn();r=r===void 0?null:r;var i=void 0;if(Ge!==null){var o=Ge.memoizedState;if(i=o.destroy,r!==null&&Jf(r,o.deps)){s.memoizedState=ha(e,n,i,r);return}}Se.flags|=t,s.memoizedState=ha(1|e,n,i,r)}function Kg(t,e){return Gl(8390656,8,t,e)}function ep(t,e){return cu(2048,8,t,e)}function k1(t,e){return cu(4,2,t,e)}function b1(t,e){return cu(4,4,t,e)}function D1(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function j1(t,e,n){return n=n!=null?n.concat([t]):null,cu(4,4,D1.bind(null,e,t),n)}function tp(){}function V1(t,e){var n=tn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Jf(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function O1(t,e){var n=tn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Jf(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function L1(t,e,n){return vs&21?(pn(n,e)||(n=z_(),Se.lanes|=n,_s|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,jt=!0),t.memoizedState=n)}function II(t,e){var n=me;me=n!==0&&4>n?n:4,t(!0);var r=wh.transition;wh.transition={};try{t(!1),e()}finally{me=n,wh.transition=r}}function M1(){return tn().memoizedState}function SI(t,e,n){var r=Cr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},F1(t))U1(e,n);else if(n=w1(t,e,n,r),n!==null){var s=St();hn(n,t,r,s),B1(n,e,r)}}function CI(t,e,n){var r=Cr(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(F1(t))U1(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,pn(l,o)){var c=e.interleaved;c===null?(s.next=s,Wf(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=w1(t,e,s,r),n!==null&&(s=St(),hn(n,t,r,s),B1(n,e,r))}}function F1(t){var e=t.alternate;return t===Se||e!==null&&e===Se}function U1(t,e){Uo=Sc=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function B1(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,bf(t,n)}}var Cc={readContext:en,useCallback:pt,useContext:pt,useEffect:pt,useImperativeHandle:pt,useInsertionEffect:pt,useLayoutEffect:pt,useMemo:pt,useReducer:pt,useRef:pt,useState:pt,useDebugValue:pt,useDeferredValue:pt,useTransition:pt,useMutableSource:pt,useSyncExternalStore:pt,useId:pt,unstable_isNewReconciler:!1},RI={readContext:en,useCallback:function(t,e){return _n().memoizedState=[t,e===void 0?null:e],t},useContext:en,useEffect:Kg,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Gl(4194308,4,D1.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Gl(4194308,4,t,e)},useInsertionEffect:function(t,e){return Gl(4,2,t,e)},useMemo:function(t,e){var n=_n();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=_n();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=SI.bind(null,Se,t),[r.memoizedState,t]},useRef:function(t){var e=_n();return t={current:t},e.memoizedState=t},useState:qg,useDebugValue:tp,useDeferredValue:function(t){return _n().memoizedState=t},useTransition:function(){var t=qg(!1),e=t[0];return t=II.bind(null,t[1]),_n().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Se,s=_n();if(Te){if(n===void 0)throw Error(U(407));n=n()}else{if(n=e(),et===null)throw Error(U(349));vs&30||S1(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,Kg(R1.bind(null,r,i,t),[t]),r.flags|=2048,ha(9,C1.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=_n(),e=et.identifierPrefix;if(Te){var n=Un,r=Fn;n=(r&~(1<<32-un(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=ca++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=TI++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},NI={readContext:en,useCallback:V1,useContext:en,useEffect:ep,useImperativeHandle:j1,useInsertionEffect:k1,useLayoutEffect:b1,useMemo:O1,useReducer:Eh,useRef:P1,useState:function(){return Eh(ua)},useDebugValue:tp,useDeferredValue:function(t){var e=tn();return L1(e,Ge.memoizedState,t)},useTransition:function(){var t=Eh(ua)[0],e=tn().memoizedState;return[t,e]},useMutableSource:T1,useSyncExternalStore:I1,useId:M1,unstable_isNewReconciler:!1},AI={readContext:en,useCallback:V1,useContext:en,useEffect:ep,useImperativeHandle:j1,useInsertionEffect:k1,useLayoutEffect:b1,useMemo:O1,useReducer:xh,useRef:P1,useState:function(){return xh(ua)},useDebugValue:tp,useDeferredValue:function(t){var e=tn();return Ge===null?e.memoizedState=t:L1(e,Ge.memoizedState,t)},useTransition:function(){var t=xh(ua)[0],e=tn().memoizedState;return[t,e]},useMutableSource:T1,useSyncExternalStore:I1,useId:M1,unstable_isNewReconciler:!1};function sn(t,e){if(t&&t.defaultProps){e=Ce({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Id(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Ce({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var uu={isMounted:function(t){return(t=t._reactInternals)?Cs(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=St(),s=Cr(t),i=$n(r,s);i.payload=e,n!=null&&(i.callback=n),e=Ir(t,i,s),e!==null&&(hn(e,t,s,r),zl(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=St(),s=Cr(t),i=$n(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Ir(t,i,s),e!==null&&(hn(e,t,s,r),zl(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=St(),r=Cr(t),s=$n(n,r);s.tag=2,e!=null&&(s.callback=e),e=Ir(t,s,r),e!==null&&(hn(e,t,r,n),zl(e,t,r))}};function Qg(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!ra(n,r)||!ra(s,i):!0}function z1(t,e,n){var r=!1,s=Vr,i=e.contextType;return typeof i=="object"&&i!==null?i=en(i):(s=Ot(e)?gs:wt.current,r=e.contextTypes,i=(r=r!=null)?yi(t,s):Vr),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=uu,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function Yg(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&uu.enqueueReplaceState(e,e.state,null)}function Sd(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},qf(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=en(i):(i=Ot(e)?gs:wt.current,s.context=yi(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Id(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&uu.enqueueReplaceState(s,s.state,null),Tc(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Ei(t,e){try{var n="",r=e;do n+=rT(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Th(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Cd(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var PI=typeof WeakMap=="function"?WeakMap:Map;function $1(t,e,n){n=$n(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Nc||(Nc=!0,Od=r),Cd(t,e)},n}function G1(t,e,n){n=$n(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Cd(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Cd(t,e),typeof r!="function"&&(Sr===null?Sr=new Set([this]):Sr.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function Jg(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new PI;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=GI.bind(null,t,e,n),e.then(t,t))}function Xg(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Zg(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=$n(-1,1),e.tag=2,Ir(n,e,1))),n.lanes|=1),t)}var kI=Zn.ReactCurrentOwner,jt=!1;function Tt(t,e,n,r){e.child=t===null?_1(e,null,n,r):_i(e,t.child,n,r)}function ey(t,e,n,r,s){n=n.render;var i=e.ref;return ui(e,s),r=Xf(t,e,n,r,i,s),n=Zf(),t!==null&&!jt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Kn(t,e,s)):(Te&&n&&Uf(e),e.flags|=1,Tt(t,e,r,s),e.child)}function ty(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!cp(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,H1(t,e,i,r,s)):(t=Kl(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:ra,n(o,r)&&t.ref===e.ref)return Kn(t,e,s)}return e.flags|=1,t=Rr(i,r),t.ref=e.ref,t.return=e,e.child=t}function H1(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(ra(i,r)&&t.ref===e.ref)if(jt=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(jt=!0);else return e.lanes=t.lanes,Kn(t,e,s)}return Rd(t,e,n,r,s)}function W1(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ve(ii,Ut),Ut|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ve(ii,Ut),Ut|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,ve(ii,Ut),Ut|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,ve(ii,Ut),Ut|=r;return Tt(t,e,s,n),e.child}function q1(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Rd(t,e,n,r,s){var i=Ot(n)?gs:wt.current;return i=yi(e,i),ui(e,s),n=Xf(t,e,n,r,i,s),r=Zf(),t!==null&&!jt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Kn(t,e,s)):(Te&&r&&Uf(e),e.flags|=1,Tt(t,e,n,s),e.child)}function ny(t,e,n,r,s){if(Ot(n)){var i=!0;vc(e)}else i=!1;if(ui(e,s),e.stateNode===null)Hl(t,e),z1(e,n,r),Sd(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=en(u):(u=Ot(n)?gs:wt.current,u=yi(e,u));var f=n.getDerivedStateFromProps,m=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==u)&&Yg(e,o,r,u),cr=!1;var g=e.memoizedState;o.state=g,Tc(e,r,o,s),c=e.memoizedState,l!==r||g!==c||Vt.current||cr?(typeof f=="function"&&(Id(e,n,f,r),c=e.memoizedState),(l=cr||Qg(e,n,l,r,g,c,u))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=u,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,E1(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:sn(e.type,l),o.props=u,m=e.pendingProps,g=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=en(c):(c=Ot(n)?gs:wt.current,c=yi(e,c));var w=n.getDerivedStateFromProps;(f=typeof w=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==m||g!==c)&&Yg(e,o,r,c),cr=!1,g=e.memoizedState,o.state=g,Tc(e,r,o,s);var R=e.memoizedState;l!==m||g!==R||Vt.current||cr?(typeof w=="function"&&(Id(e,n,w,r),R=e.memoizedState),(u=cr||Qg(e,n,u,r,g,R,c)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,R,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,R,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=R),o.props=r,o.state=R,o.context=c,r=u):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),r=!1)}return Nd(t,e,n,r,i,s)}function Nd(t,e,n,r,s,i){q1(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&Bg(e,n,!1),Kn(t,e,i);r=e.stateNode,kI.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=_i(e,t.child,null,i),e.child=_i(e,null,l,i)):Tt(t,e,l,i),e.memoizedState=r.state,s&&Bg(e,n,!0),e.child}function K1(t){var e=t.stateNode;e.pendingContext?Ug(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Ug(t,e.context,!1),Kf(t,e.containerInfo)}function ry(t,e,n,r,s){return vi(),zf(s),e.flags|=256,Tt(t,e,n,r),e.child}var Ad={dehydrated:null,treeContext:null,retryLane:0};function Pd(t){return{baseLanes:t,cachePool:null,transitions:null}}function Q1(t,e,n){var r=e.pendingProps,s=Ie.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),ve(Ie,s&1),t===null)return xd(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=fu(o,r,0,null),t=ds(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Pd(n),e.memoizedState=Ad,t):np(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return bI(t,e,o,r,l,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=Rr(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Rr(l,i):(i=ds(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?Pd(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=Ad,r}return i=t.child,t=i.sibling,r=Rr(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function np(t,e){return e=fu({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Sl(t,e,n,r){return r!==null&&zf(r),_i(e,t.child,null,n),t=np(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function bI(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=Th(Error(U(422))),Sl(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=fu({mode:"visible",children:r.children},s,0,null),i=ds(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&_i(e,t.child,null,o),e.child.memoizedState=Pd(o),e.memoizedState=Ad,i);if(!(e.mode&1))return Sl(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(U(419)),r=Th(i,r,void 0),Sl(t,e,o,r)}if(l=(o&t.childLanes)!==0,jt||l){if(r=et,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,qn(t,s),hn(r,t,s,-1))}return lp(),r=Th(Error(U(421))),Sl(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=HI.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,$t=Tr(s.nextSibling),Ht=e,Te=!0,an=null,t!==null&&(Qt[Yt++]=Fn,Qt[Yt++]=Un,Qt[Yt++]=ys,Fn=t.id,Un=t.overflow,ys=e),e=np(e,r.children),e.flags|=4096,e)}function sy(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Td(t.return,e,n)}function Ih(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function Y1(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Tt(t,e,r.children,n),r=Ie.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&sy(t,n,e);else if(t.tag===19)sy(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ve(Ie,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Ic(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Ih(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Ic(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Ih(e,!0,n,null,i);break;case"together":Ih(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Hl(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Kn(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),_s|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(U(153));if(e.child!==null){for(t=e.child,n=Rr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Rr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function DI(t,e,n){switch(e.tag){case 3:K1(e),vi();break;case 5:x1(e);break;case 1:Ot(e.type)&&vc(e);break;case 4:Kf(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;ve(Ec,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ve(Ie,Ie.current&1),e.flags|=128,null):n&e.child.childLanes?Q1(t,e,n):(ve(Ie,Ie.current&1),t=Kn(t,e,n),t!==null?t.sibling:null);ve(Ie,Ie.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Y1(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ve(Ie,Ie.current),r)break;return null;case 22:case 23:return e.lanes=0,W1(t,e,n)}return Kn(t,e,n)}var J1,kd,X1,Z1;J1=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};kd=function(){};X1=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,ls(In.current);var i=null;switch(n){case"input":s=Zh(t,s),r=Zh(t,r),i=[];break;case"select":s=Ce({},s,{value:void 0}),r=Ce({},r,{value:void 0}),i=[];break;case"textarea":s=nd(t,s),r=nd(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=gc)}sd(n,r);var o;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Yo.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var c=r[u];if(l=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Yo.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Ee("scroll",t),i||l===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};Z1=function(t,e,n,r){n!==r&&(e.flags|=4)};function xo(t,e){if(!Te)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function mt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function jI(t,e,n){var r=e.pendingProps;switch(Bf(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return mt(e),null;case 1:return Ot(e.type)&&yc(),mt(e),null;case 3:return r=e.stateNode,wi(),xe(Vt),xe(wt),Yf(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Tl(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,an!==null&&(Fd(an),an=null))),kd(t,e),mt(e),null;case 5:Qf(e);var s=ls(la.current);if(n=e.type,t!==null&&e.stateNode!=null)X1(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(U(166));return mt(e),null}if(t=ls(In.current),Tl(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[En]=e,r[oa]=i,t=(e.mode&1)!==0,n){case"dialog":Ee("cancel",r),Ee("close",r);break;case"iframe":case"object":case"embed":Ee("load",r);break;case"video":case"audio":for(s=0;s<Po.length;s++)Ee(Po[s],r);break;case"source":Ee("error",r);break;case"img":case"image":case"link":Ee("error",r),Ee("load",r);break;case"details":Ee("toggle",r);break;case"input":fg(r,i),Ee("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ee("invalid",r);break;case"textarea":mg(r,i),Ee("invalid",r)}sd(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&xl(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&xl(r.textContent,l,t),s=["children",""+l]):Yo.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Ee("scroll",r)}switch(n){case"input":pl(r),pg(r,i,!0);break;case"textarea":pl(r),gg(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=gc)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=R_(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[En]=e,t[oa]=r,J1(t,e,!1,!1),e.stateNode=t;e:{switch(o=id(n,r),n){case"dialog":Ee("cancel",t),Ee("close",t),s=r;break;case"iframe":case"object":case"embed":Ee("load",t),s=r;break;case"video":case"audio":for(s=0;s<Po.length;s++)Ee(Po[s],t);s=r;break;case"source":Ee("error",t),s=r;break;case"img":case"image":case"link":Ee("error",t),Ee("load",t),s=r;break;case"details":Ee("toggle",t),s=r;break;case"input":fg(t,r),s=Zh(t,r),Ee("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Ce({},r,{value:void 0}),Ee("invalid",t);break;case"textarea":mg(t,r),s=nd(t,r),Ee("invalid",t);break;default:s=r}sd(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?P_(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&N_(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Jo(t,c):typeof c=="number"&&Jo(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Yo.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Ee("scroll",t):c!=null&&Cf(t,i,c,o))}switch(n){case"input":pl(t),pg(t,r,!1);break;case"textarea":pl(t),gg(t);break;case"option":r.value!=null&&t.setAttribute("value",""+jr(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?oi(t,!!r.multiple,i,!1):r.defaultValue!=null&&oi(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=gc)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return mt(e),null;case 6:if(t&&e.stateNode!=null)Z1(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(U(166));if(n=ls(la.current),ls(In.current),Tl(e)){if(r=e.stateNode,n=e.memoizedProps,r[En]=e,(i=r.nodeValue!==n)&&(t=Ht,t!==null))switch(t.tag){case 3:xl(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&xl(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[En]=e,e.stateNode=r}return mt(e),null;case 13:if(xe(Ie),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Te&&$t!==null&&e.mode&1&&!(e.flags&128))y1(),vi(),e.flags|=98560,i=!1;else if(i=Tl(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(U(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(U(317));i[En]=e}else vi(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;mt(e),i=!1}else an!==null&&(Fd(an),an=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Ie.current&1?He===0&&(He=3):lp())),e.updateQueue!==null&&(e.flags|=4),mt(e),null);case 4:return wi(),kd(t,e),t===null&&sa(e.stateNode.containerInfo),mt(e),null;case 10:return Hf(e.type._context),mt(e),null;case 17:return Ot(e.type)&&yc(),mt(e),null;case 19:if(xe(Ie),i=e.memoizedState,i===null)return mt(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)xo(i,!1);else{if(He!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Ic(t),o!==null){for(e.flags|=128,xo(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ve(Ie,Ie.current&1|2),e.child}t=t.sibling}i.tail!==null&&Oe()>xi&&(e.flags|=128,r=!0,xo(i,!1),e.lanes=4194304)}else{if(!r)if(t=Ic(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),xo(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Te)return mt(e),null}else 2*Oe()-i.renderingStartTime>xi&&n!==1073741824&&(e.flags|=128,r=!0,xo(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Oe(),e.sibling=null,n=Ie.current,ve(Ie,r?n&1|2:n&1),e):(mt(e),null);case 22:case 23:return ap(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Ut&1073741824&&(mt(e),e.subtreeFlags&6&&(e.flags|=8192)):mt(e),null;case 24:return null;case 25:return null}throw Error(U(156,e.tag))}function VI(t,e){switch(Bf(e),e.tag){case 1:return Ot(e.type)&&yc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return wi(),xe(Vt),xe(wt),Yf(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Qf(e),null;case 13:if(xe(Ie),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(U(340));vi()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return xe(Ie),null;case 4:return wi(),null;case 10:return Hf(e.type._context),null;case 22:case 23:return ap(),null;case 24:return null;default:return null}}var Cl=!1,vt=!1,OI=typeof WeakSet=="function"?WeakSet:Set,Q=null;function si(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ae(t,e,r)}else n.current=null}function bd(t,e,n){try{n()}catch(r){Ae(t,e,r)}}var iy=!1;function LI(t,e){if(md=fc,t=s1(),Ff(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,u=0,f=0,m=t,g=null;t:for(;;){for(var w;m!==n||s!==0&&m.nodeType!==3||(l=o+s),m!==i||r!==0&&m.nodeType!==3||(c=o+r),m.nodeType===3&&(o+=m.nodeValue.length),(w=m.firstChild)!==null;)g=m,m=w;for(;;){if(m===t)break t;if(g===n&&++u===s&&(l=o),g===i&&++f===r&&(c=o),(w=m.nextSibling)!==null)break;m=g,g=m.parentNode}m=w}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(gd={focusedElem:t,selectionRange:n},fc=!1,Q=e;Q!==null;)if(e=Q,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Q=t;else for(;Q!==null;){e=Q;try{var R=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(R!==null){var N=R.memoizedProps,P=R.memoizedState,x=e.stateNode,v=x.getSnapshotBeforeUpdate(e.elementType===e.type?N:sn(e.type,N),P);x.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var I=e.stateNode.containerInfo;I.nodeType===1?I.textContent="":I.nodeType===9&&I.documentElement&&I.removeChild(I.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(U(163))}}catch(D){Ae(e,e.return,D)}if(t=e.sibling,t!==null){t.return=e.return,Q=t;break}Q=e.return}return R=iy,iy=!1,R}function Bo(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&bd(e,n,i)}s=s.next}while(s!==r)}}function hu(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Dd(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function e0(t){var e=t.alternate;e!==null&&(t.alternate=null,e0(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[En],delete e[oa],delete e[_d],delete e[_I],delete e[wI])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function t0(t){return t.tag===5||t.tag===3||t.tag===4}function oy(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||t0(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function jd(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=gc));else if(r!==4&&(t=t.child,t!==null))for(jd(t,e,n),t=t.sibling;t!==null;)jd(t,e,n),t=t.sibling}function Vd(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Vd(t,e,n),t=t.sibling;t!==null;)Vd(t,e,n),t=t.sibling}var it=null,on=!1;function or(t,e,n){for(n=n.child;n!==null;)n0(t,e,n),n=n.sibling}function n0(t,e,n){if(Tn&&typeof Tn.onCommitFiberUnmount=="function")try{Tn.onCommitFiberUnmount(ru,n)}catch{}switch(n.tag){case 5:vt||si(n,e);case 6:var r=it,s=on;it=null,or(t,e,n),it=r,on=s,it!==null&&(on?(t=it,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):it.removeChild(n.stateNode));break;case 18:it!==null&&(on?(t=it,n=n.stateNode,t.nodeType===8?yh(t.parentNode,n):t.nodeType===1&&yh(t,n),ta(t)):yh(it,n.stateNode));break;case 4:r=it,s=on,it=n.stateNode.containerInfo,on=!0,or(t,e,n),it=r,on=s;break;case 0:case 11:case 14:case 15:if(!vt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&bd(n,e,o),s=s.next}while(s!==r)}or(t,e,n);break;case 1:if(!vt&&(si(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Ae(n,e,l)}or(t,e,n);break;case 21:or(t,e,n);break;case 22:n.mode&1?(vt=(r=vt)||n.memoizedState!==null,or(t,e,n),vt=r):or(t,e,n);break;default:or(t,e,n)}}function ay(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new OI),e.forEach(function(r){var s=WI.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function rn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:it=l.stateNode,on=!1;break e;case 3:it=l.stateNode.containerInfo,on=!0;break e;case 4:it=l.stateNode.containerInfo,on=!0;break e}l=l.return}if(it===null)throw Error(U(160));n0(i,o,s),it=null,on=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){Ae(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)r0(e,t),e=e.sibling}function r0(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(rn(e,t),yn(t),r&4){try{Bo(3,t,t.return),hu(3,t)}catch(N){Ae(t,t.return,N)}try{Bo(5,t,t.return)}catch(N){Ae(t,t.return,N)}}break;case 1:rn(e,t),yn(t),r&512&&n!==null&&si(n,n.return);break;case 5:if(rn(e,t),yn(t),r&512&&n!==null&&si(n,n.return),t.flags&32){var s=t.stateNode;try{Jo(s,"")}catch(N){Ae(t,t.return,N)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&S_(s,i),id(l,o);var u=id(l,i);for(o=0;o<c.length;o+=2){var f=c[o],m=c[o+1];f==="style"?P_(s,m):f==="dangerouslySetInnerHTML"?N_(s,m):f==="children"?Jo(s,m):Cf(s,f,m,u)}switch(l){case"input":ed(s,i);break;case"textarea":C_(s,i);break;case"select":var g=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var w=i.value;w!=null?oi(s,!!i.multiple,w,!1):g!==!!i.multiple&&(i.defaultValue!=null?oi(s,!!i.multiple,i.defaultValue,!0):oi(s,!!i.multiple,i.multiple?[]:"",!1))}s[oa]=i}catch(N){Ae(t,t.return,N)}}break;case 6:if(rn(e,t),yn(t),r&4){if(t.stateNode===null)throw Error(U(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(N){Ae(t,t.return,N)}}break;case 3:if(rn(e,t),yn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{ta(e.containerInfo)}catch(N){Ae(t,t.return,N)}break;case 4:rn(e,t),yn(t);break;case 13:rn(e,t),yn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(ip=Oe())),r&4&&ay(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(vt=(u=vt)||f,rn(e,t),vt=u):rn(e,t),yn(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!f&&t.mode&1)for(Q=t,f=t.child;f!==null;){for(m=Q=f;Q!==null;){switch(g=Q,w=g.child,g.tag){case 0:case 11:case 14:case 15:Bo(4,g,g.return);break;case 1:si(g,g.return);var R=g.stateNode;if(typeof R.componentWillUnmount=="function"){r=g,n=g.return;try{e=r,R.props=e.memoizedProps,R.state=e.memoizedState,R.componentWillUnmount()}catch(N){Ae(r,n,N)}}break;case 5:si(g,g.return);break;case 22:if(g.memoizedState!==null){cy(m);continue}}w!==null?(w.return=g,Q=w):cy(m)}f=f.sibling}e:for(f=null,m=t;;){if(m.tag===5){if(f===null){f=m;try{s=m.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=m.stateNode,c=m.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=A_("display",o))}catch(N){Ae(t,t.return,N)}}}else if(m.tag===6){if(f===null)try{m.stateNode.nodeValue=u?"":m.memoizedProps}catch(N){Ae(t,t.return,N)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;f===m&&(f=null),m=m.return}f===m&&(f=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:rn(e,t),yn(t),r&4&&ay(t);break;case 21:break;default:rn(e,t),yn(t)}}function yn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(t0(n)){var r=n;break e}n=n.return}throw Error(U(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Jo(s,""),r.flags&=-33);var i=oy(t);Vd(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=oy(t);jd(t,l,o);break;default:throw Error(U(161))}}catch(c){Ae(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function MI(t,e,n){Q=t,s0(t)}function s0(t,e,n){for(var r=(t.mode&1)!==0;Q!==null;){var s=Q,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Cl;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||vt;l=Cl;var u=vt;if(Cl=o,(vt=c)&&!u)for(Q=s;Q!==null;)o=Q,c=o.child,o.tag===22&&o.memoizedState!==null?uy(s):c!==null?(c.return=o,Q=c):uy(s);for(;i!==null;)Q=i,s0(i),i=i.sibling;Q=s,Cl=l,vt=u}ly(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Q=i):ly(t)}}function ly(t){for(;Q!==null;){var e=Q;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:vt||hu(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!vt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:sn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Wg(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Wg(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var m=f.dehydrated;m!==null&&ta(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(U(163))}vt||e.flags&512&&Dd(e)}catch(g){Ae(e,e.return,g)}}if(e===t){Q=null;break}if(n=e.sibling,n!==null){n.return=e.return,Q=n;break}Q=e.return}}function cy(t){for(;Q!==null;){var e=Q;if(e===t){Q=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Q=n;break}Q=e.return}}function uy(t){for(;Q!==null;){var e=Q;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{hu(4,e)}catch(c){Ae(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){Ae(e,s,c)}}var i=e.return;try{Dd(e)}catch(c){Ae(e,i,c)}break;case 5:var o=e.return;try{Dd(e)}catch(c){Ae(e,o,c)}}}catch(c){Ae(e,e.return,c)}if(e===t){Q=null;break}var l=e.sibling;if(l!==null){l.return=e.return,Q=l;break}Q=e.return}}var FI=Math.ceil,Rc=Zn.ReactCurrentDispatcher,rp=Zn.ReactCurrentOwner,Zt=Zn.ReactCurrentBatchConfig,de=0,et=null,Ue=null,ct=0,Ut=0,ii=Gr(0),He=0,da=null,_s=0,du=0,sp=0,zo=null,bt=null,ip=0,xi=1/0,On=null,Nc=!1,Od=null,Sr=null,Rl=!1,gr=null,Ac=0,$o=0,Ld=null,Wl=-1,ql=0;function St(){return de&6?Oe():Wl!==-1?Wl:Wl=Oe()}function Cr(t){return t.mode&1?de&2&&ct!==0?ct&-ct:xI.transition!==null?(ql===0&&(ql=z_()),ql):(t=me,t!==0||(t=window.event,t=t===void 0?16:Q_(t.type)),t):1}function hn(t,e,n,r){if(50<$o)throw $o=0,Ld=null,Error(U(185));Na(t,n,r),(!(de&2)||t!==et)&&(t===et&&(!(de&2)&&(du|=n),He===4&&hr(t,ct)),Lt(t,r),n===1&&de===0&&!(e.mode&1)&&(xi=Oe()+500,lu&&Hr()))}function Lt(t,e){var n=t.callbackNode;xT(t,e);var r=dc(t,t===et?ct:0);if(r===0)n!==null&&_g(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&_g(n),e===1)t.tag===0?EI(hy.bind(null,t)):p1(hy.bind(null,t)),yI(function(){!(de&6)&&Hr()}),n=null;else{switch($_(r)){case 1:n=kf;break;case 4:n=U_;break;case 16:n=hc;break;case 536870912:n=B_;break;default:n=hc}n=d0(n,i0.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function i0(t,e){if(Wl=-1,ql=0,de&6)throw Error(U(327));var n=t.callbackNode;if(hi()&&t.callbackNode!==n)return null;var r=dc(t,t===et?ct:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Pc(t,r);else{e=r;var s=de;de|=2;var i=a0();(et!==t||ct!==e)&&(On=null,xi=Oe()+500,hs(t,e));do try{zI();break}catch(l){o0(t,l)}while(1);Gf(),Rc.current=i,de=s,Ue!==null?e=0:(et=null,ct=0,e=He)}if(e!==0){if(e===2&&(s=ud(t),s!==0&&(r=s,e=Md(t,s))),e===1)throw n=da,hs(t,0),hr(t,r),Lt(t,Oe()),n;if(e===6)hr(t,r);else{if(s=t.current.alternate,!(r&30)&&!UI(s)&&(e=Pc(t,r),e===2&&(i=ud(t),i!==0&&(r=i,e=Md(t,i))),e===1))throw n=da,hs(t,0),hr(t,r),Lt(t,Oe()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(U(345));case 2:ss(t,bt,On);break;case 3:if(hr(t,r),(r&130023424)===r&&(e=ip+500-Oe(),10<e)){if(dc(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){St(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=vd(ss.bind(null,t,bt,On),e);break}ss(t,bt,On);break;case 4:if(hr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-un(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Oe()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*FI(r/1960))-r,10<r){t.timeoutHandle=vd(ss.bind(null,t,bt,On),r);break}ss(t,bt,On);break;case 5:ss(t,bt,On);break;default:throw Error(U(329))}}}return Lt(t,Oe()),t.callbackNode===n?i0.bind(null,t):null}function Md(t,e){var n=zo;return t.current.memoizedState.isDehydrated&&(hs(t,e).flags|=256),t=Pc(t,e),t!==2&&(e=bt,bt=n,e!==null&&Fd(e)),t}function Fd(t){bt===null?bt=t:bt.push.apply(bt,t)}function UI(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!pn(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function hr(t,e){for(e&=~sp,e&=~du,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-un(e),r=1<<n;t[n]=-1,e&=~r}}function hy(t){if(de&6)throw Error(U(327));hi();var e=dc(t,0);if(!(e&1))return Lt(t,Oe()),null;var n=Pc(t,e);if(t.tag!==0&&n===2){var r=ud(t);r!==0&&(e=r,n=Md(t,r))}if(n===1)throw n=da,hs(t,0),hr(t,e),Lt(t,Oe()),n;if(n===6)throw Error(U(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ss(t,bt,On),Lt(t,Oe()),null}function op(t,e){var n=de;de|=1;try{return t(e)}finally{de=n,de===0&&(xi=Oe()+500,lu&&Hr())}}function ws(t){gr!==null&&gr.tag===0&&!(de&6)&&hi();var e=de;de|=1;var n=Zt.transition,r=me;try{if(Zt.transition=null,me=1,t)return t()}finally{me=r,Zt.transition=n,de=e,!(de&6)&&Hr()}}function ap(){Ut=ii.current,xe(ii)}function hs(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,gI(n)),Ue!==null)for(n=Ue.return;n!==null;){var r=n;switch(Bf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&yc();break;case 3:wi(),xe(Vt),xe(wt),Yf();break;case 5:Qf(r);break;case 4:wi();break;case 13:xe(Ie);break;case 19:xe(Ie);break;case 10:Hf(r.type._context);break;case 22:case 23:ap()}n=n.return}if(et=t,Ue=t=Rr(t.current,null),ct=Ut=e,He=0,da=null,sp=du=_s=0,bt=zo=null,as!==null){for(e=0;e<as.length;e++)if(n=as[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}as=null}return t}function o0(t,e){do{var n=Ue;try{if(Gf(),$l.current=Cc,Sc){for(var r=Se.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Sc=!1}if(vs=0,Xe=Ge=Se=null,Uo=!1,ca=0,rp.current=null,n===null||n.return===null){He=1,da=e,Ue=null;break}e:{var i=t,o=n.return,l=n,c=e;if(e=ct,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,f=l,m=f.tag;if(!(f.mode&1)&&(m===0||m===11||m===15)){var g=f.alternate;g?(f.updateQueue=g.updateQueue,f.memoizedState=g.memoizedState,f.lanes=g.lanes):(f.updateQueue=null,f.memoizedState=null)}var w=Xg(o);if(w!==null){w.flags&=-257,Zg(w,o,l,i,e),w.mode&1&&Jg(i,u,e),e=w,c=u;var R=e.updateQueue;if(R===null){var N=new Set;N.add(c),e.updateQueue=N}else R.add(c);break e}else{if(!(e&1)){Jg(i,u,e),lp();break e}c=Error(U(426))}}else if(Te&&l.mode&1){var P=Xg(o);if(P!==null){!(P.flags&65536)&&(P.flags|=256),Zg(P,o,l,i,e),zf(Ei(c,l));break e}}i=c=Ei(c,l),He!==4&&(He=2),zo===null?zo=[i]:zo.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var x=$1(i,c,e);Hg(i,x);break e;case 1:l=c;var v=i.type,I=i.stateNode;if(!(i.flags&128)&&(typeof v.getDerivedStateFromError=="function"||I!==null&&typeof I.componentDidCatch=="function"&&(Sr===null||!Sr.has(I)))){i.flags|=65536,e&=-e,i.lanes|=e;var D=G1(i,l,e);Hg(i,D);break e}}i=i.return}while(i!==null)}c0(n)}catch(F){e=F,Ue===n&&n!==null&&(Ue=n=n.return);continue}break}while(1)}function a0(){var t=Rc.current;return Rc.current=Cc,t===null?Cc:t}function lp(){(He===0||He===3||He===2)&&(He=4),et===null||!(_s&268435455)&&!(du&268435455)||hr(et,ct)}function Pc(t,e){var n=de;de|=2;var r=a0();(et!==t||ct!==e)&&(On=null,hs(t,e));do try{BI();break}catch(s){o0(t,s)}while(1);if(Gf(),de=n,Rc.current=r,Ue!==null)throw Error(U(261));return et=null,ct=0,He}function BI(){for(;Ue!==null;)l0(Ue)}function zI(){for(;Ue!==null&&!fT();)l0(Ue)}function l0(t){var e=h0(t.alternate,t,Ut);t.memoizedProps=t.pendingProps,e===null?c0(t):Ue=e,rp.current=null}function c0(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=VI(n,e),n!==null){n.flags&=32767,Ue=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{He=6,Ue=null;return}}else if(n=jI(n,e,Ut),n!==null){Ue=n;return}if(e=e.sibling,e!==null){Ue=e;return}Ue=e=t}while(e!==null);He===0&&(He=5)}function ss(t,e,n){var r=me,s=Zt.transition;try{Zt.transition=null,me=1,$I(t,e,n,r)}finally{Zt.transition=s,me=r}return null}function $I(t,e,n,r){do hi();while(gr!==null);if(de&6)throw Error(U(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(U(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(TT(t,i),t===et&&(Ue=et=null,ct=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Rl||(Rl=!0,d0(hc,function(){return hi(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Zt.transition,Zt.transition=null;var o=me;me=1;var l=de;de|=4,rp.current=null,LI(t,n),r0(n,t),cI(gd),fc=!!md,gd=md=null,t.current=n,MI(n),pT(),de=l,me=o,Zt.transition=i}else t.current=n;if(Rl&&(Rl=!1,gr=t,Ac=s),i=t.pendingLanes,i===0&&(Sr=null),yT(n.stateNode),Lt(t,Oe()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Nc)throw Nc=!1,t=Od,Od=null,t;return Ac&1&&t.tag!==0&&hi(),i=t.pendingLanes,i&1?t===Ld?$o++:($o=0,Ld=t):$o=0,Hr(),null}function hi(){if(gr!==null){var t=$_(Ac),e=Zt.transition,n=me;try{if(Zt.transition=null,me=16>t?16:t,gr===null)var r=!1;else{if(t=gr,gr=null,Ac=0,de&6)throw Error(U(331));var s=de;for(de|=4,Q=t.current;Q!==null;){var i=Q,o=i.child;if(Q.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(Q=u;Q!==null;){var f=Q;switch(f.tag){case 0:case 11:case 15:Bo(8,f,i)}var m=f.child;if(m!==null)m.return=f,Q=m;else for(;Q!==null;){f=Q;var g=f.sibling,w=f.return;if(e0(f),f===u){Q=null;break}if(g!==null){g.return=w,Q=g;break}Q=w}}}var R=i.alternate;if(R!==null){var N=R.child;if(N!==null){R.child=null;do{var P=N.sibling;N.sibling=null,N=P}while(N!==null)}}Q=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Q=o;else e:for(;Q!==null;){if(i=Q,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Bo(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,Q=x;break e}Q=i.return}}var v=t.current;for(Q=v;Q!==null;){o=Q;var I=o.child;if(o.subtreeFlags&2064&&I!==null)I.return=o,Q=I;else e:for(o=v;Q!==null;){if(l=Q,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:hu(9,l)}}catch(F){Ae(l,l.return,F)}if(l===o){Q=null;break e}var D=l.sibling;if(D!==null){D.return=l.return,Q=D;break e}Q=l.return}}if(de=s,Hr(),Tn&&typeof Tn.onPostCommitFiberRoot=="function")try{Tn.onPostCommitFiberRoot(ru,t)}catch{}r=!0}return r}finally{me=n,Zt.transition=e}}return!1}function dy(t,e,n){e=Ei(n,e),e=$1(t,e,1),t=Ir(t,e,1),e=St(),t!==null&&(Na(t,1,e),Lt(t,e))}function Ae(t,e,n){if(t.tag===3)dy(t,t,n);else for(;e!==null;){if(e.tag===3){dy(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Sr===null||!Sr.has(r))){t=Ei(n,t),t=G1(e,t,1),e=Ir(e,t,1),t=St(),e!==null&&(Na(e,1,t),Lt(e,t));break}}e=e.return}}function GI(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=St(),t.pingedLanes|=t.suspendedLanes&n,et===t&&(ct&n)===n&&(He===4||He===3&&(ct&130023424)===ct&&500>Oe()-ip?hs(t,0):sp|=n),Lt(t,e)}function u0(t,e){e===0&&(t.mode&1?(e=yl,yl<<=1,!(yl&130023424)&&(yl=4194304)):e=1);var n=St();t=qn(t,e),t!==null&&(Na(t,e,n),Lt(t,n))}function HI(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),u0(t,n)}function WI(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(U(314))}r!==null&&r.delete(e),u0(t,n)}var h0;h0=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Vt.current)jt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return jt=!1,DI(t,e,n);jt=!!(t.flags&131072)}else jt=!1,Te&&e.flags&1048576&&m1(e,wc,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Hl(t,e),t=e.pendingProps;var s=yi(e,wt.current);ui(e,n),s=Xf(null,e,r,t,s,n);var i=Zf();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ot(r)?(i=!0,vc(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,qf(e),s.updater=uu,e.stateNode=s,s._reactInternals=e,Sd(e,r,t,n),e=Nd(null,e,r,!0,i,n)):(e.tag=0,Te&&i&&Uf(e),Tt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Hl(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=KI(r),t=sn(r,t),s){case 0:e=Rd(null,e,r,t,n);break e;case 1:e=ny(null,e,r,t,n);break e;case 11:e=ey(null,e,r,t,n);break e;case 14:e=ty(null,e,r,sn(r.type,t),n);break e}throw Error(U(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:sn(r,s),Rd(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:sn(r,s),ny(t,e,r,s,n);case 3:e:{if(K1(e),t===null)throw Error(U(387));r=e.pendingProps,i=e.memoizedState,s=i.element,E1(t,e),Tc(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Ei(Error(U(423)),e),e=ry(t,e,r,n,s);break e}else if(r!==s){s=Ei(Error(U(424)),e),e=ry(t,e,r,n,s);break e}else for($t=Tr(e.stateNode.containerInfo.firstChild),Ht=e,Te=!0,an=null,n=_1(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(vi(),r===s){e=Kn(t,e,n);break e}Tt(t,e,r,n)}e=e.child}return e;case 5:return x1(e),t===null&&xd(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,yd(r,s)?o=null:i!==null&&yd(r,i)&&(e.flags|=32),q1(t,e),Tt(t,e,o,n),e.child;case 6:return t===null&&xd(e),null;case 13:return Q1(t,e,n);case 4:return Kf(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=_i(e,null,r,n):Tt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:sn(r,s),ey(t,e,r,s,n);case 7:return Tt(t,e,e.pendingProps,n),e.child;case 8:return Tt(t,e,e.pendingProps.children,n),e.child;case 12:return Tt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,ve(Ec,r._currentValue),r._currentValue=o,i!==null)if(pn(i.value,o)){if(i.children===s.children&&!Vt.current){e=Kn(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=$n(-1,n&-n),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?c.next=c:(c.next=f.next,f.next=c),u.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),Td(i.return,n,e),l.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(U(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),Td(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Tt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,ui(e,n),s=en(s),r=r(s),e.flags|=1,Tt(t,e,r,n),e.child;case 14:return r=e.type,s=sn(r,e.pendingProps),s=sn(r.type,s),ty(t,e,r,s,n);case 15:return H1(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:sn(r,s),Hl(t,e),e.tag=1,Ot(r)?(t=!0,vc(e)):t=!1,ui(e,n),z1(e,r,s),Sd(e,r,s,n),Nd(null,e,r,!0,t,n);case 19:return Y1(t,e,n);case 22:return W1(t,e,n)}throw Error(U(156,e.tag))};function d0(t,e){return F_(t,e)}function qI(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Xt(t,e,n,r){return new qI(t,e,n,r)}function cp(t){return t=t.prototype,!(!t||!t.isReactComponent)}function KI(t){if(typeof t=="function")return cp(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Nf)return 11;if(t===Af)return 14}return 2}function Rr(t,e){var n=t.alternate;return n===null?(n=Xt(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Kl(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")cp(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Qs:return ds(n.children,s,i,e);case Rf:o=8,s|=8;break;case Qh:return t=Xt(12,n,e,s|2),t.elementType=Qh,t.lanes=i,t;case Yh:return t=Xt(13,n,e,s),t.elementType=Yh,t.lanes=i,t;case Jh:return t=Xt(19,n,e,s),t.elementType=Jh,t.lanes=i,t;case x_:return fu(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case w_:o=10;break e;case E_:o=9;break e;case Nf:o=11;break e;case Af:o=14;break e;case lr:o=16,r=null;break e}throw Error(U(130,t==null?t:typeof t,""))}return e=Xt(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function ds(t,e,n,r){return t=Xt(7,t,r,e),t.lanes=n,t}function fu(t,e,n,r){return t=Xt(22,t,r,e),t.elementType=x_,t.lanes=n,t.stateNode={isHidden:!1},t}function Sh(t,e,n){return t=Xt(6,t,null,e),t.lanes=n,t}function Ch(t,e,n){return e=Xt(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function QI(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=oh(0),this.expirationTimes=oh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=oh(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function up(t,e,n,r,s,i,o,l,c){return t=new QI(t,e,n,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Xt(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},qf(i),t}function YI(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ks,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function f0(t){if(!t)return Vr;t=t._reactInternals;e:{if(Cs(t)!==t||t.tag!==1)throw Error(U(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ot(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(U(171))}if(t.tag===1){var n=t.type;if(Ot(n))return f1(t,n,e)}return e}function p0(t,e,n,r,s,i,o,l,c){return t=up(n,r,!0,t,s,i,o,l,c),t.context=f0(null),n=t.current,r=St(),s=Cr(n),i=$n(r,s),i.callback=e??null,Ir(n,i,s),t.current.lanes=s,Na(t,s,r),Lt(t,r),t}function pu(t,e,n,r){var s=e.current,i=St(),o=Cr(s);return n=f0(n),e.context===null?e.context=n:e.pendingContext=n,e=$n(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Ir(s,e,o),t!==null&&(hn(t,s,o,i),zl(t,s,o)),o}function kc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function fy(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function hp(t,e){fy(t,e),(t=t.alternate)&&fy(t,e)}function JI(){return null}var m0=typeof reportError=="function"?reportError:function(t){console.error(t)};function dp(t){this._internalRoot=t}mu.prototype.render=dp.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(U(409));pu(t,e,null,null)};mu.prototype.unmount=dp.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ws(function(){pu(null,t,null,null)}),e[Wn]=null}};function mu(t){this._internalRoot=t}mu.prototype.unstable_scheduleHydration=function(t){if(t){var e=W_();t={blockedOn:null,target:t,priority:e};for(var n=0;n<ur.length&&e!==0&&e<ur[n].priority;n++);ur.splice(n,0,t),n===0&&K_(t)}};function fp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function gu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function py(){}function XI(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var u=kc(o);i.call(u)}}var o=p0(e,r,t,0,null,!1,!1,"",py);return t._reactRootContainer=o,t[Wn]=o.current,sa(t.nodeType===8?t.parentNode:t),ws(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var u=kc(c);l.call(u)}}var c=up(t,0,!1,null,null,!1,!1,"",py);return t._reactRootContainer=c,t[Wn]=c.current,sa(t.nodeType===8?t.parentNode:t),ws(function(){pu(e,c,n,r)}),c}function yu(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=kc(o);l.call(c)}}pu(e,o,t,s)}else o=XI(n,e,t,s,r);return kc(o)}G_=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ao(e.pendingLanes);n!==0&&(bf(e,n|1),Lt(e,Oe()),!(de&6)&&(xi=Oe()+500,Hr()))}break;case 13:ws(function(){var r=qn(t,1);if(r!==null){var s=St();hn(r,t,1,s)}}),hp(t,1)}};Df=function(t){if(t.tag===13){var e=qn(t,134217728);if(e!==null){var n=St();hn(e,t,134217728,n)}hp(t,134217728)}};H_=function(t){if(t.tag===13){var e=Cr(t),n=qn(t,e);if(n!==null){var r=St();hn(n,t,e,r)}hp(t,e)}};W_=function(){return me};q_=function(t,e){var n=me;try{return me=t,e()}finally{me=n}};ad=function(t,e,n){switch(e){case"input":if(ed(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=au(r);if(!s)throw Error(U(90));I_(r),ed(r,s)}}}break;case"textarea":C_(t,n);break;case"select":e=n.value,e!=null&&oi(t,!!n.multiple,e,!1)}};D_=op;j_=ws;var ZI={usingClientEntryPoint:!1,Events:[Pa,Zs,au,k_,b_,op]},To={findFiberByHostInstance:os,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},eS={bundleType:To.bundleType,version:To.version,rendererPackageName:To.rendererPackageName,rendererConfig:To.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Zn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=L_(t),t===null?null:t.stateNode},findFiberByHostInstance:To.findFiberByHostInstance||JI,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Nl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Nl.isDisabled&&Nl.supportsFiber)try{ru=Nl.inject(eS),Tn=Nl}catch{}}qt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ZI;qt.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!fp(e))throw Error(U(200));return YI(t,e,null,n)};qt.createRoot=function(t,e){if(!fp(t))throw Error(U(299));var n=!1,r="",s=m0;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=up(t,1,!1,null,null,n,!1,r,s),t[Wn]=e.current,sa(t.nodeType===8?t.parentNode:t),new dp(e)};qt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(U(188)):(t=Object.keys(t).join(","),Error(U(268,t)));return t=L_(e),t=t===null?null:t.stateNode,t};qt.flushSync=function(t){return ws(t)};qt.hydrate=function(t,e,n){if(!gu(e))throw Error(U(200));return yu(null,t,e,!0,n)};qt.hydrateRoot=function(t,e,n){if(!fp(t))throw Error(U(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=m0;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=p0(e,null,t,1,n??null,s,!1,i,o),t[Wn]=e.current,sa(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new mu(e)};qt.render=function(t,e,n){if(!gu(e))throw Error(U(200));return yu(null,t,e,!1,n)};qt.unmountComponentAtNode=function(t){if(!gu(t))throw Error(U(40));return t._reactRootContainer?(ws(function(){yu(null,null,t,!1,function(){t._reactRootContainer=null,t[Wn]=null})}),!0):!1};qt.unstable_batchedUpdates=op;qt.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!gu(n))throw Error(U(200));if(t==null||t._reactInternals===void 0)throw Error(U(38));return yu(t,e,n,!1,r)};qt.version="18.3.1-next-f1338f8080-20240426";function g0(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(g0)}catch(t){console.error(t)}}g0(),g_.exports=qt;var tS=g_.exports,my=tS;qh.createRoot=my.createRoot,qh.hydrateRoot=my.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function fa(){return fa=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},fa.apply(this,arguments)}var yr;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(yr||(yr={}));const gy="popstate";function nS(t){t===void 0&&(t={});function e(r,s){let{pathname:i,search:o,hash:l}=r.location;return Ud("",{pathname:i,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:bc(s)}return sS(e,n,null,t)}function Le(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function y0(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function rS(){return Math.random().toString(36).substr(2,8)}function yy(t,e){return{usr:t.state,key:t.key,idx:e}}function Ud(t,e,n,r){return n===void 0&&(n=null),fa({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Vi(e):e,{state:n,key:e&&e.key||r||rS()})}function bc(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Vi(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function sS(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,l=yr.Pop,c=null,u=f();u==null&&(u=0,o.replaceState(fa({},o.state,{idx:u}),""));function f(){return(o.state||{idx:null}).idx}function m(){l=yr.Pop;let P=f(),x=P==null?null:P-u;u=P,c&&c({action:l,location:N.location,delta:x})}function g(P,x){l=yr.Push;let v=Ud(N.location,P,x);n&&n(v,P),u=f()+1;let I=yy(v,u),D=N.createHref(v);try{o.pushState(I,"",D)}catch(F){if(F instanceof DOMException&&F.name==="DataCloneError")throw F;s.location.assign(D)}i&&c&&c({action:l,location:N.location,delta:1})}function w(P,x){l=yr.Replace;let v=Ud(N.location,P,x);n&&n(v,P),u=f();let I=yy(v,u),D=N.createHref(v);o.replaceState(I,"",D),i&&c&&c({action:l,location:N.location,delta:0})}function R(P){let x=s.location.origin!=="null"?s.location.origin:s.location.href,v=typeof P=="string"?P:bc(P);return v=v.replace(/ $/,"%20"),Le(x,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,x)}let N={get action(){return l},get location(){return t(s,o)},listen(P){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(gy,m),c=P,()=>{s.removeEventListener(gy,m),c=null}},createHref(P){return e(s,P)},createURL:R,encodeLocation(P){let x=R(P);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:g,replace:w,go(P){return o.go(P)}};return N}var vy;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(vy||(vy={}));function iS(t,e,n){return n===void 0&&(n="/"),oS(t,e,n,!1)}function oS(t,e,n,r){let s=typeof e=="string"?Vi(e):e,i=pp(s.pathname||"/",n);if(i==null)return null;let o=v0(t);aS(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=vS(i);l=gS(o[c],u,r)}return l}function v0(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};c.relativePath.startsWith("/")&&(Le(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let u=Nr([r,c.relativePath]),f=n.concat(c);i.children&&i.children.length>0&&(Le(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),v0(i.children,e,f,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:pS(u,i.index),routesMeta:f})};return t.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))s(i,o);else for(let c of _0(i.path))s(i,o,c)}),e}function _0(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=_0(r.join("/")),l=[];return l.push(...o.map(c=>c===""?i:[i,c].join("/"))),s&&l.push(...o),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function aS(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:mS(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const lS=/^:[\w-]+$/,cS=3,uS=2,hS=1,dS=10,fS=-2,_y=t=>t==="*";function pS(t,e){let n=t.split("/"),r=n.length;return n.some(_y)&&(r+=fS),e&&(r+=uS),n.filter(s=>!_y(s)).reduce((s,i)=>s+(lS.test(i)?cS:i===""?hS:dS),r)}function mS(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function gS(t,e,n){n===void 0&&(n=!1);let{routesMeta:r}=t,s={},i="/",o=[];for(let l=0;l<r.length;++l){let c=r[l],u=l===r.length-1,f=i==="/"?e:e.slice(i.length)||"/",m=wy({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},f),g=c.route;if(!m&&u&&n&&!r[r.length-1].route.index&&(m=wy({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},f)),!m)return null;Object.assign(s,m.params),o.push({params:s,pathname:Nr([i,m.pathname]),pathnameBase:xS(Nr([i,m.pathnameBase])),route:g}),m.pathnameBase!=="/"&&(i=Nr([i,m.pathnameBase]))}return o}function wy(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=yS(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((u,f,m)=>{let{paramName:g,isOptional:w}=f;if(g==="*"){let N=l[m]||"";o=i.slice(0,i.length-N.length).replace(/(.)\/+$/,"$1")}const R=l[m];return w&&!R?u[g]=void 0:u[g]=(R||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:o,pattern:t}}function yS(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),y0(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(r.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function vS(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return y0(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function pp(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function _S(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?Vi(t):t;return{pathname:n?n.startsWith("/")?n:wS(n,e):e,search:TS(r),hash:IS(s)}}function wS(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function Rh(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function ES(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function mp(t,e){let n=ES(t);return e?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function gp(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=Vi(t):(s=fa({},t),Le(!s.pathname||!s.pathname.includes("?"),Rh("?","pathname","search",s)),Le(!s.pathname||!s.pathname.includes("#"),Rh("#","pathname","hash",s)),Le(!s.search||!s.search.includes("#"),Rh("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,l;if(o==null)l=n;else{let m=e.length-1;if(!r&&o.startsWith("..")){let g=o.split("/");for(;g[0]==="..";)g.shift(),m-=1;s.pathname=g.join("/")}l=m>=0?e[m]:"/"}let c=_S(s,l),u=o&&o!=="/"&&o.endsWith("/"),f=(i||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||f)&&(c.pathname+="/"),c}const Nr=t=>t.join("/").replace(/\/\/+/g,"/"),xS=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),TS=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,IS=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function SS(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const w0=["post","put","patch","delete"];new Set(w0);const CS=["get",...w0];new Set(CS);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function pa(){return pa=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},pa.apply(this,arguments)}const yp=L.createContext(null),RS=L.createContext(null),Wr=L.createContext(null),vu=L.createContext(null),er=L.createContext({outlet:null,matches:[],isDataRoute:!1}),E0=L.createContext(null);function NS(t,e){let{relative:n}=e===void 0?{}:e;Oi()||Le(!1);let{basename:r,navigator:s}=L.useContext(Wr),{hash:i,pathname:o,search:l}=T0(t,{relative:n}),c=o;return r!=="/"&&(c=o==="/"?r:Nr([r,o])),s.createHref({pathname:c,search:l,hash:i})}function Oi(){return L.useContext(vu)!=null}function ba(){return Oi()||Le(!1),L.useContext(vu).location}function x0(t){L.useContext(Wr).static||L.useLayoutEffect(t)}function Li(){let{isDataRoute:t}=L.useContext(er);return t?BS():AS()}function AS(){Oi()||Le(!1);let t=L.useContext(yp),{basename:e,future:n,navigator:r}=L.useContext(Wr),{matches:s}=L.useContext(er),{pathname:i}=ba(),o=JSON.stringify(mp(s,n.v7_relativeSplatPath)),l=L.useRef(!1);return x0(()=>{l.current=!0}),L.useCallback(function(u,f){if(f===void 0&&(f={}),!l.current)return;if(typeof u=="number"){r.go(u);return}let m=gp(u,JSON.parse(o),i,f.relative==="path");t==null&&e!=="/"&&(m.pathname=m.pathname==="/"?e:Nr([e,m.pathname])),(f.replace?r.replace:r.push)(m,f.state,f)},[e,r,o,i,t])}function Da(){let{matches:t}=L.useContext(er),e=t[t.length-1];return e?e.params:{}}function T0(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=L.useContext(Wr),{matches:s}=L.useContext(er),{pathname:i}=ba(),o=JSON.stringify(mp(s,r.v7_relativeSplatPath));return L.useMemo(()=>gp(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function PS(t,e){return kS(t,e)}function kS(t,e,n,r){Oi()||Le(!1);let{navigator:s}=L.useContext(Wr),{matches:i}=L.useContext(er),o=i[i.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let u=ba(),f;if(e){var m;let P=typeof e=="string"?Vi(e):e;c==="/"||(m=P.pathname)!=null&&m.startsWith(c)||Le(!1),f=P}else f=u;let g=f.pathname||"/",w=g;if(c!=="/"){let P=c.replace(/^\//,"").split("/");w="/"+g.replace(/^\//,"").split("/").slice(P.length).join("/")}let R=iS(t,{pathname:w}),N=OS(R&&R.map(P=>Object.assign({},P,{params:Object.assign({},l,P.params),pathname:Nr([c,s.encodeLocation?s.encodeLocation(P.pathname).pathname:P.pathname]),pathnameBase:P.pathnameBase==="/"?c:Nr([c,s.encodeLocation?s.encodeLocation(P.pathnameBase).pathname:P.pathnameBase])})),i,n,r);return e&&N?L.createElement(vu.Provider,{value:{location:pa({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:yr.Pop}},N):N}function bS(){let t=US(),e=SS(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},i=null;return L.createElement(L.Fragment,null,L.createElement("h2",null,"Unexpected Application Error!"),L.createElement("h3",{style:{fontStyle:"italic"}},e),n?L.createElement("pre",{style:s},n):null,i)}const DS=L.createElement(bS,null);class jS extends L.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?L.createElement(er.Provider,{value:this.props.routeContext},L.createElement(E0.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function VS(t){let{routeContext:e,match:n,children:r}=t,s=L.useContext(yp);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),L.createElement(er.Provider,{value:e},r)}function OS(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,l=(s=n)==null?void 0:s.errors;if(l!=null){let f=o.findIndex(m=>m.route.id&&(l==null?void 0:l[m.route.id])!==void 0);f>=0||Le(!1),o=o.slice(0,Math.min(o.length,f+1))}let c=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let f=0;f<o.length;f++){let m=o[f];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(u=f),m.route.id){let{loaderData:g,errors:w}=n,R=m.route.loader&&g[m.route.id]===void 0&&(!w||w[m.route.id]===void 0);if(m.route.lazy||R){c=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((f,m,g)=>{let w,R=!1,N=null,P=null;n&&(w=l&&m.route.id?l[m.route.id]:void 0,N=m.route.errorElement||DS,c&&(u<0&&g===0?(zS("route-fallback",!1),R=!0,P=null):u===g&&(R=!0,P=m.route.hydrateFallbackElement||null)));let x=e.concat(o.slice(0,g+1)),v=()=>{let I;return w?I=N:R?I=P:m.route.Component?I=L.createElement(m.route.Component,null):m.route.element?I=m.route.element:I=f,L.createElement(VS,{match:m,routeContext:{outlet:f,matches:x,isDataRoute:n!=null},children:I})};return n&&(m.route.ErrorBoundary||m.route.errorElement||g===0)?L.createElement(jS,{location:n.location,revalidation:n.revalidation,component:N,error:w,children:v(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):v()},null)}var I0=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(I0||{}),Dc=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Dc||{});function LS(t){let e=L.useContext(yp);return e||Le(!1),e}function MS(t){let e=L.useContext(RS);return e||Le(!1),e}function FS(t){let e=L.useContext(er);return e||Le(!1),e}function S0(t){let e=FS(),n=e.matches[e.matches.length-1];return n.route.id||Le(!1),n.route.id}function US(){var t;let e=L.useContext(E0),n=MS(Dc.UseRouteError),r=S0(Dc.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function BS(){let{router:t}=LS(I0.UseNavigateStable),e=S0(Dc.UseNavigateStable),n=L.useRef(!1);return x0(()=>{n.current=!0}),L.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,pa({fromRouteId:e},i)))},[t,e])}const Ey={};function zS(t,e,n){!e&&!Ey[t]&&(Ey[t]=!0)}function $S(t,e){t==null||t.v7_startTransition,(t==null?void 0:t.v7_relativeSplatPath)===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function GS(t){let{to:e,replace:n,state:r,relative:s}=t;Oi()||Le(!1);let{future:i,static:o}=L.useContext(Wr),{matches:l}=L.useContext(er),{pathname:c}=ba(),u=Li(),f=gp(e,mp(l,i.v7_relativeSplatPath),c,s==="path"),m=JSON.stringify(f);return L.useEffect(()=>u(JSON.parse(m),{replace:n,state:r,relative:s}),[u,m,s,n,r]),null}function Vn(t){Le(!1)}function HS(t){let{basename:e="/",children:n=null,location:r,navigationType:s=yr.Pop,navigator:i,static:o=!1,future:l}=t;Oi()&&Le(!1);let c=e.replace(/^\/*/,"/"),u=L.useMemo(()=>({basename:c,navigator:i,static:o,future:pa({v7_relativeSplatPath:!1},l)}),[c,l,i,o]);typeof r=="string"&&(r=Vi(r));let{pathname:f="/",search:m="",hash:g="",state:w=null,key:R="default"}=r,N=L.useMemo(()=>{let P=pp(f,c);return P==null?null:{location:{pathname:P,search:m,hash:g,state:w,key:R},navigationType:s}},[c,f,m,g,w,R,s]);return N==null?null:L.createElement(Wr.Provider,{value:u},L.createElement(vu.Provider,{children:n,value:N}))}function WS(t){let{children:e,location:n}=t;return PS(Bd(e),n)}new Promise(()=>{});function Bd(t,e){e===void 0&&(e=[]);let n=[];return L.Children.forEach(t,(r,s)=>{if(!L.isValidElement(r))return;let i=[...e,s];if(r.type===L.Fragment){n.push.apply(n,Bd(r.props.children,i));return}r.type!==Vn&&Le(!1),!r.props.index||!r.props.children||Le(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Bd(r.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function zd(){return zd=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},zd.apply(this,arguments)}function qS(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function KS(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function QS(t,e){return t.button===0&&(!e||e==="_self")&&!KS(t)}const YS=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],JS="6";try{window.__reactRouterVersion=JS}catch{}const XS="startTransition",xy=Gx[XS];function ZS(t){let{basename:e,children:n,future:r,window:s}=t,i=L.useRef();i.current==null&&(i.current=nS({window:s,v5Compat:!0}));let o=i.current,[l,c]=L.useState({action:o.action,location:o.location}),{v7_startTransition:u}=r||{},f=L.useCallback(m=>{u&&xy?xy(()=>c(m)):c(m)},[c,u]);return L.useLayoutEffect(()=>o.listen(f),[o,f]),L.useEffect(()=>$S(r),[r]),L.createElement(HS,{basename:e,children:n,location:l.location,navigationType:l.action,navigator:o,future:r})}const e2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",t2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,It=L.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:i,replace:o,state:l,target:c,to:u,preventScrollReset:f,viewTransition:m}=e,g=qS(e,YS),{basename:w}=L.useContext(Wr),R,N=!1;if(typeof u=="string"&&t2.test(u)&&(R=u,e2))try{let I=new URL(window.location.href),D=u.startsWith("//")?new URL(I.protocol+u):new URL(u),F=pp(D.pathname,w);D.origin===I.origin&&F!=null?u=F+D.search+D.hash:N=!0}catch{}let P=NS(u,{relative:s}),x=n2(u,{replace:o,state:l,target:c,preventScrollReset:f,relative:s,viewTransition:m});function v(I){r&&r(I),I.defaultPrevented||x(I)}return L.createElement("a",zd({},g,{href:R||P,onClick:N||i?r:v,ref:n,target:c}))});var Ty;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Ty||(Ty={}));var Iy;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Iy||(Iy={}));function n2(t,e){let{target:n,replace:r,state:s,preventScrollReset:i,relative:o,viewTransition:l}=e===void 0?{}:e,c=Li(),u=ba(),f=T0(t,{relative:o});return L.useCallback(m=>{if(QS(m,n)){m.preventDefault();let g=r!==void 0?r:bc(u)===bc(f);c(t,{replace:g,state:s,preventScrollReset:i,relative:o,viewTransition:l})}},[u,c,f,r,s,n,t,i,o,l])}const Sy=t=>{let e;const n=new Set,r=(f,m)=>{const g=typeof f=="function"?f(e):f;if(!Object.is(g,e)){const w=e;e=m??(typeof g!="object"||g===null)?g:Object.assign({},e,g),n.forEach(R=>R(e,w))}},s=()=>e,c={setState:r,getState:s,getInitialState:()=>u,subscribe:f=>(n.add(f),()=>n.delete(f)),destroy:()=>{n.clear()}},u=e=t(r,s,c);return c},r2=t=>t?Sy(t):Sy;var C0={exports:{}},R0={},N0={exports:{}},A0={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ti=L;function s2(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var i2=typeof Object.is=="function"?Object.is:s2,o2=Ti.useState,a2=Ti.useEffect,l2=Ti.useLayoutEffect,c2=Ti.useDebugValue;function u2(t,e){var n=e(),r=o2({inst:{value:n,getSnapshot:e}}),s=r[0].inst,i=r[1];return l2(function(){s.value=n,s.getSnapshot=e,Nh(s)&&i({inst:s})},[t,n,e]),a2(function(){return Nh(s)&&i({inst:s}),t(function(){Nh(s)&&i({inst:s})})},[t]),c2(n),n}function Nh(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!i2(t,n)}catch{return!0}}function h2(t,e){return e()}var d2=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h2:u2;A0.useSyncExternalStore=Ti.useSyncExternalStore!==void 0?Ti.useSyncExternalStore:d2;N0.exports=A0;var f2=N0.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _u=L,p2=f2;function m2(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var g2=typeof Object.is=="function"?Object.is:m2,y2=p2.useSyncExternalStore,v2=_u.useRef,_2=_u.useEffect,w2=_u.useMemo,E2=_u.useDebugValue;R0.useSyncExternalStoreWithSelector=function(t,e,n,r,s){var i=v2(null);if(i.current===null){var o={hasValue:!1,value:null};i.current=o}else o=i.current;i=w2(function(){function c(w){if(!u){if(u=!0,f=w,w=r(w),s!==void 0&&o.hasValue){var R=o.value;if(s(R,w))return m=R}return m=w}if(R=m,g2(f,w))return R;var N=r(w);return s!==void 0&&s(R,N)?(f=w,R):(f=w,m=N)}var u=!1,f,m,g=n===void 0?null:n;return[function(){return c(e())},g===null?void 0:function(){return c(g())}]},[e,n,r,s]);var l=y2(t,i[0],i[1]);return _2(function(){o.hasValue=!0,o.value=l},[l]),E2(l),l};C0.exports=R0;var x2=C0.exports;const T2=s_(x2),{useDebugValue:I2}=xn,{useSyncExternalStoreWithSelector:S2}=T2;const C2=t=>t;function R2(t,e=C2,n){const r=S2(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,n);return I2(r),r}const Cy=t=>{const e=typeof t=="function"?r2(t):t,n=(r,s)=>R2(e,r,s);return Object.assign(n,e),n},P0=t=>t?Cy(t):Cy;function N2(t,e){let n;try{n=t()}catch{return}return{getItem:s=>{var i;const o=c=>c===null?null:JSON.parse(c,e==null?void 0:e.reviver),l=(i=n.getItem(s))!=null?i:null;return l instanceof Promise?l.then(o):o(l)},setItem:(s,i)=>n.setItem(s,JSON.stringify(i,e==null?void 0:e.replacer)),removeItem:s=>n.removeItem(s)}}const ma=t=>e=>{try{const n=t(e);return n instanceof Promise?n:{then(r){return ma(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return ma(r)(n)}}}},A2=(t,e)=>(n,r,s)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:P=>P,version:0,merge:(P,x)=>({...x,...P}),...e},o=!1;const l=new Set,c=new Set;let u;try{u=i.getStorage()}catch{}if(!u)return t((...P)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...P)},r,s);const f=ma(i.serialize),m=()=>{const P=i.partialize({...r()});let x;const v=f({state:P,version:i.version}).then(I=>u.setItem(i.name,I)).catch(I=>{x=I});if(x)throw x;return v},g=s.setState;s.setState=(P,x)=>{g(P,x),m()};const w=t((...P)=>{n(...P),m()},r,s);let R;const N=()=>{var P;if(!u)return;o=!1,l.forEach(v=>v(r()));const x=((P=i.onRehydrateStorage)==null?void 0:P.call(i,r()))||void 0;return ma(u.getItem.bind(u))(i.name).then(v=>{if(v)return i.deserialize(v)}).then(v=>{if(v)if(typeof v.version=="number"&&v.version!==i.version){if(i.migrate)return i.migrate(v.state,v.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return v.state}).then(v=>{var I;return R=i.merge(v,(I=r())!=null?I:w),n(R,!0),m()}).then(()=>{x==null||x(R,void 0),o=!0,c.forEach(v=>v(R))}).catch(v=>{x==null||x(void 0,v)})};return s.persist={setOptions:P=>{i={...i,...P},P.getStorage&&(u=P.getStorage())},clearStorage:()=>{u==null||u.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>N(),hasHydrated:()=>o,onHydrate:P=>(l.add(P),()=>{l.delete(P)}),onFinishHydration:P=>(c.add(P),()=>{c.delete(P)})},N(),R||w},P2=(t,e)=>(n,r,s)=>{let i={storage:N2(()=>localStorage),partialize:N=>N,version:0,merge:(N,P)=>({...P,...N}),...e},o=!1;const l=new Set,c=new Set;let u=i.storage;if(!u)return t((...N)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...N)},r,s);const f=()=>{const N=i.partialize({...r()});return u.setItem(i.name,{state:N,version:i.version})},m=s.setState;s.setState=(N,P)=>{m(N,P),f()};const g=t((...N)=>{n(...N),f()},r,s);s.getInitialState=()=>g;let w;const R=()=>{var N,P;if(!u)return;o=!1,l.forEach(v=>{var I;return v((I=r())!=null?I:g)});const x=((P=i.onRehydrateStorage)==null?void 0:P.call(i,(N=r())!=null?N:g))||void 0;return ma(u.getItem.bind(u))(i.name).then(v=>{if(v)if(typeof v.version=="number"&&v.version!==i.version){if(i.migrate)return[!0,i.migrate(v.state,v.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,v.state];return[!1,void 0]}).then(v=>{var I;const[D,F]=v;if(w=i.merge(F,(I=r())!=null?I:g),n(w,!0),D)return f()}).then(()=>{x==null||x(w,void 0),w=r(),o=!0,c.forEach(v=>v(w))}).catch(v=>{x==null||x(void 0,v)})};return s.persist={setOptions:N=>{i={...i,...N},N.storage&&(u=N.storage)},clearStorage:()=>{u==null||u.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>R(),hasHydrated:()=>o,onHydrate:N=>(l.add(N),()=>{l.delete(N)}),onFinishHydration:N=>(c.add(N),()=>{c.delete(N)})},i.skipHydration||R(),w||g},k2=(t,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?A2(t,e):P2(t,e),k0=k2;var vr=(t=>(t.SINGLE="single",t.DOUBLE="double",t.TRIPLE="triple",t.CHAIN="chain",t.SLIP="slip",t.INCREASE="increase",t.DECREASE="decrease",t.MAGIC_RING="magic_ring",t.FRONT_POST="front_post",t.BACK_POST="back_post",t))(vr||{});const Pt={single:{rawValue:"短針",symbol:"×",englishName:"Single Crochet"},double:{rawValue:"長針",symbol:"↑",englishName:"Double Crochet"},triple:{rawValue:"長長針",symbol:"↟",englishName:"Triple Crochet"},chain:{rawValue:"鎖針",symbol:"○",englishName:"Chain"},slip:{rawValue:"引拔針",symbol:"•",englishName:"Slip Stitch"},increase:{rawValue:"加針",symbol:"▲",englishName:"Increase"},decrease:{rawValue:"減針",symbol:"▼",englishName:"Decrease"},magic_ring:{rawValue:"魔術環",symbol:"◉",englishName:"Magic Ring"},front_post:{rawValue:"前柱針",symbol:"⟨",englishName:"Front Post"},back_post:{rawValue:"後柱針",symbol:"⟩",englishName:"Back Post"}};function Ze(){return crypto.randomUUID()}function b2(t){const e=Math.floor(t/3600),n=Math.floor(t%3600/60);return e>0?`${e}小時${n}分`:n>0?`${n}分鐘`:`${t}秒`}function $d(t){let e;return t instanceof Date?e=t:e=new Date(t),isNaN(e.getTime())?"無效日期":new Intl.DateTimeFormat("zh-TW",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(e)}function D2(){return[{id:Ze(),name:"白色棉線",brand:"樣本品牌",color:{name:"白色",hex:"#FFFFFF"}},{id:Ze(),name:"粉色棉線",brand:"樣本品牌",color:{name:"粉色",hex:"#FFB3E6"}},{id:Ze(),name:"藍色棉線",brand:"樣本品牌",color:{name:"藍色",hex:"#87CEEB"}}]}function Ah(){const t=D2(),e={id:Ze(),roundNumber:1,stitches:[{id:Ze(),type:vr.CHAIN,yarnId:t[0].id,count:4},{id:Ze(),type:vr.SLIP,yarnId:t[0].id,count:1}],stitchGroups:[],notes:"起始魔術環"},n={id:Ze(),roundNumber:2,stitches:[{id:Ze(),type:vr.SINGLE,yarnId:t[0].id,count:8}],stitchGroups:[],notes:"短針增加"},r={id:Ze(),roundNumber:3,stitches:[{id:Ze(),type:vr.SINGLE,yarnId:t[1].id,count:16}],stitchGroups:[],notes:"換色，繼續增加"};return{id:Ze(),name:"範例杯墊",source:"https://www.youtube.com/watch?v=example",pattern:[e,n,r],currentRound:1,currentStitch:0,yarns:t,sessions:[],createdDate:new Date,lastModified:new Date,isCompleted:!1}}function j2(t,e){const n=[],r=t.stitches.map(i=>{var f;const o=e.find(m=>m.id===i.yarnId),l=(o==null?void 0:o.name)||"未知毛線",c=i.count>1?` ×${i.count}`:"";return`${((f=Pt[i.type])==null?void 0:f.rawValue)||i.type}(${l})${c}`});n.push(...r);const s=t.stitchGroups.map(i=>V2(i,e));return n.push(...s),n.join(", ")||"無針法"}function V2(t,e){const n=t.stitches.map(i=>{var f;const o=e.find(m=>m.id===i.yarnId),l=(o==null?void 0:o.name)||"未知毛線",c=i.count>1?` ×${i.count}`:"";return`${((f=Pt[i.type])==null?void 0:f.rawValue)||i.type}(${l})${c}`}),r=t.name||"針目群組",s=t.repeatCount>1?` 重複${t.repeatCount}次`:"";return`[${r}: ${n.join(", ")}]${s}`}function b0(t){return t.stitches.reduce((e,n)=>e+n.count,0)*t.repeatCount}function zt(t){const e=t.stitches.reduce((r,s)=>r+s.count,0),n=t.stitchGroups.reduce((r,s)=>r+b0(s),0);return e+n}function jc(t){return t.pattern.map(e=>e.roundNumber).reduce((e,n)=>Math.max(e,n),0)}function ga(t){return t.pattern.reduce((e,n)=>e+zt(n),0)}function vp(t){if(!t.pattern||t.pattern.length===0)return 0;let e=0;for(let r=1;r<t.currentRound;r++){const s=t.pattern.find(i=>i.roundNumber===r);s&&(e+=zt(s))}const n=t.pattern.find(r=>r.roundNumber===t.currentRound);if(n){const r=zt(n),s=Math.min(Math.max(0,t.currentStitch),r);e+=s}return e}function Gd(t){if(!t.pattern||t.pattern.length===0)return 0;const e=ga(t);if(e===0)return 0;const r=vp(t)/e;return Math.min(Math.max(0,r),1)}const O2=()=>{};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D0=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},L2=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},j0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,c=s+2<t.length,u=c?t[s+2]:0,f=i>>2,m=(i&3)<<4|l>>4;let g=(l&15)<<2|u>>6,w=u&63;c||(w=64,o||(g=64)),r.push(n[f],n[m],n[g],n[w])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(D0(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):L2(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const u=s<t.length?n[t.charAt(s)]:64;++s;const m=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||u==null||m==null)throw new M2;const g=i<<2|l>>4;if(r.push(g),u!==64){const w=l<<4&240|u>>2;if(r.push(w),m!==64){const R=u<<6&192|m;r.push(R)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class M2 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const F2=function(t){const e=D0(t);return j0.encodeByteArray(e,!0)},Vc=function(t){return F2(t).replace(/\./g,"")},V0=function(t){try{return j0.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U2(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B2=()=>U2().__FIREBASE_DEFAULTS__,z2=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},$2=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&V0(t[1]);return e&&JSON.parse(e)},wu=()=>{try{return O2()||B2()||z2()||$2()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},O0=t=>{var e,n;return(n=(e=wu())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},G2=t=>{const e=O0(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},L0=()=>{var t;return(t=wu())==null?void 0:t.config},M0=t=>{var e;return(e=wu())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H2{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rs(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function _p(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W2(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t},l="";return[Vc(JSON.stringify(n)),Vc(JSON.stringify(o)),l].join(".")}const Go={};function q2(){const t={prod:[],emulator:[]};for(const e of Object.keys(Go))Go[e]?t.emulator.push(e):t.prod.push(e);return t}function K2(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let Ry=!1;function F0(t,e){if(typeof window>"u"||typeof document>"u"||!Rs(window.location.host)||Go[t]===e||Go[t]||Ry)return;Go[t]=e;function n(g){return`__firebase__banner__${g}`}const r="__firebase__banner",i=q2().prod.length>0;function o(){const g=document.getElementById(r);g&&g.remove()}function l(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function c(g,w){g.setAttribute("width","24"),g.setAttribute("id",w),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function u(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{Ry=!0,o()},g}function f(g,w){g.setAttribute("id",w),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function m(){const g=K2(r),w=n("text"),R=document.getElementById(w)||document.createElement("span"),N=n("learnmore"),P=document.getElementById(N)||document.createElement("a"),x=n("preprendIcon"),v=document.getElementById(x)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const I=g.element;l(I),f(P,N);const D=u();c(v,x),I.append(v,R,P,D),document.body.appendChild(I)}i?(R.innerText="Preview backend disconnected.",v.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(v.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,R.innerText="Preview backend running in this workspace."),R.setAttribute("id",w)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Et(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Q2(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Et())}function Y2(){var e;const t=(e=wu())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function J2(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function X2(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Z2(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function eC(){const t=Et();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function tC(){return!Y2()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function nC(){try{return typeof indexedDB=="object"}catch{return!1}}function rC(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sC="FirebaseError";class tr extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=sC,Object.setPrototypeOf(this,tr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ja.prototype.create)}}class ja{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?iC(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new tr(s,l,r)}}function iC(t,e){return t.replace(oC,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const oC=/\{\$([^}]+)}/g;function aC(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Or(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(Ny(i)&&Ny(o)){if(!Or(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Ny(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Va(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function lC(t,e){const n=new cC(t,e);return n.subscribe.bind(n)}class cC{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");uC(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=Ph),s.error===void 0&&(s.error=Ph),s.complete===void 0&&(s.complete=Ph);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function uC(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Ph(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tt(t){return t&&t._delegate?t._delegate:t}class Es{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const is="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hC{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new H2;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(fC(e))try{this.getOrInitializeService({instanceIdentifier:is})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=is){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=is){return this.instances.has(e)}getOptions(e=is){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&o.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:dC(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=is){return this.component?this.component.multipleInstances?e:is:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function dC(t){return t===is?void 0:t}function fC(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pC{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new hC(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var oe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(oe||(oe={}));const mC={debug:oe.DEBUG,verbose:oe.VERBOSE,info:oe.INFO,warn:oe.WARN,error:oe.ERROR,silent:oe.SILENT},gC=oe.INFO,yC={[oe.DEBUG]:"log",[oe.VERBOSE]:"log",[oe.INFO]:"info",[oe.WARN]:"warn",[oe.ERROR]:"error"},vC=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=yC[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class wp{constructor(e){this.name=e,this._logLevel=gC,this._logHandler=vC,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in oe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?mC[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,oe.DEBUG,...e),this._logHandler(this,oe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,oe.VERBOSE,...e),this._logHandler(this,oe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,oe.INFO,...e),this._logHandler(this,oe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,oe.WARN,...e),this._logHandler(this,oe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,oe.ERROR,...e),this._logHandler(this,oe.ERROR,...e)}}const _C=(t,e)=>e.some(n=>t instanceof n);let Ay,Py;function wC(){return Ay||(Ay=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function EC(){return Py||(Py=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const U0=new WeakMap,Hd=new WeakMap,B0=new WeakMap,kh=new WeakMap,Ep=new WeakMap;function xC(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Ar(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&U0.set(n,t)}).catch(()=>{}),Ep.set(e,t),e}function TC(t){if(Hd.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Hd.set(t,e)}let Wd={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Hd.get(t);if(e==="objectStoreNames")return t.objectStoreNames||B0.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ar(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function IC(t){Wd=t(Wd)}function SC(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(bh(this),e,...n);return B0.set(r,e.sort?e.sort():[e]),Ar(r)}:EC().includes(t)?function(...e){return t.apply(bh(this),e),Ar(U0.get(this))}:function(...e){return Ar(t.apply(bh(this),e))}}function CC(t){return typeof t=="function"?SC(t):(t instanceof IDBTransaction&&TC(t),_C(t,wC())?new Proxy(t,Wd):t)}function Ar(t){if(t instanceof IDBRequest)return xC(t);if(kh.has(t))return kh.get(t);const e=CC(t);return e!==t&&(kh.set(t,e),Ep.set(e,t)),e}const bh=t=>Ep.get(t);function RC(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),l=Ar(o);return r&&o.addEventListener("upgradeneeded",c=>{r(Ar(o.result),c.oldVersion,c.newVersion,Ar(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const NC=["get","getKey","getAll","getAllKeys","count"],AC=["put","add","delete","clear"],Dh=new Map;function ky(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Dh.get(e))return Dh.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=AC.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||NC.includes(n)))return;const i=async function(o,...l){const c=this.transaction(o,s?"readwrite":"readonly");let u=c.store;return r&&(u=u.index(l.shift())),(await Promise.all([u[n](...l),s&&c.done]))[0]};return Dh.set(e,i),i}IC(t=>({...t,get:(e,n,r)=>ky(e,n)||t.get(e,n,r),has:(e,n)=>!!ky(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PC{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(kC(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function kC(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const qd="@firebase/app",by="0.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qn=new wp("@firebase/app"),bC="@firebase/app-compat",DC="@firebase/analytics-compat",jC="@firebase/analytics",VC="@firebase/app-check-compat",OC="@firebase/app-check",LC="@firebase/auth",MC="@firebase/auth-compat",FC="@firebase/database",UC="@firebase/data-connect",BC="@firebase/database-compat",zC="@firebase/functions",$C="@firebase/functions-compat",GC="@firebase/installations",HC="@firebase/installations-compat",WC="@firebase/messaging",qC="@firebase/messaging-compat",KC="@firebase/performance",QC="@firebase/performance-compat",YC="@firebase/remote-config",JC="@firebase/remote-config-compat",XC="@firebase/storage",ZC="@firebase/storage-compat",eR="@firebase/firestore",tR="@firebase/ai",nR="@firebase/firestore-compat",rR="firebase",sR="12.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kd="[DEFAULT]",iR={[qd]:"fire-core",[bC]:"fire-core-compat",[jC]:"fire-analytics",[DC]:"fire-analytics-compat",[OC]:"fire-app-check",[VC]:"fire-app-check-compat",[LC]:"fire-auth",[MC]:"fire-auth-compat",[FC]:"fire-rtdb",[UC]:"fire-data-connect",[BC]:"fire-rtdb-compat",[zC]:"fire-fn",[$C]:"fire-fn-compat",[GC]:"fire-iid",[HC]:"fire-iid-compat",[WC]:"fire-fcm",[qC]:"fire-fcm-compat",[KC]:"fire-perf",[QC]:"fire-perf-compat",[YC]:"fire-rc",[JC]:"fire-rc-compat",[XC]:"fire-gcs",[ZC]:"fire-gcs-compat",[eR]:"fire-fst",[nR]:"fire-fst-compat",[tR]:"fire-vertex","fire-js":"fire-js",[rR]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oc=new Map,oR=new Map,Qd=new Map;function Dy(t,e){try{t.container.addComponent(e)}catch(n){Qn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Ii(t){const e=t.name;if(Qd.has(e))return Qn.debug(`There were multiple attempts to register component ${e}.`),!1;Qd.set(e,t);for(const n of Oc.values())Dy(n,t);for(const n of oR.values())Dy(n,t);return!0}function Eu(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function ln(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aR={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Pr=new ja("app","Firebase",aR);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lR{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Es("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Pr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mi=sR;function z0(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Kd,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw Pr.create("bad-app-name",{appName:String(s)});if(n||(n=L0()),!n)throw Pr.create("no-options");const i=Oc.get(s);if(i){if(Or(n,i.options)&&Or(r,i.config))return i;throw Pr.create("duplicate-app",{appName:s})}const o=new pC(s);for(const c of Qd.values())o.addComponent(c);const l=new lR(n,r,o);return Oc.set(s,l),l}function $0(t=Kd){const e=Oc.get(t);if(!e&&t===Kd&&L0())return z0();if(!e)throw Pr.create("no-app",{appName:t});return e}function kr(t,e,n){let r=iR[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${r}" with version "${e}":`];s&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Qn.warn(o.join(" "));return}Ii(new Es(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cR="firebase-heartbeat-database",uR=1,ya="firebase-heartbeat-store";let jh=null;function G0(){return jh||(jh=RC(cR,uR,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(ya)}catch(n){console.warn(n)}}}}).catch(t=>{throw Pr.create("idb-open",{originalErrorMessage:t.message})})),jh}async function hR(t){try{const n=(await G0()).transaction(ya),r=await n.objectStore(ya).get(H0(t));return await n.done,r}catch(e){if(e instanceof tr)Qn.warn(e.message);else{const n=Pr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Qn.warn(n.message)}}}async function jy(t,e){try{const r=(await G0()).transaction(ya,"readwrite");await r.objectStore(ya).put(e,H0(t)),await r.done}catch(n){if(n instanceof tr)Qn.warn(n.message);else{const r=Pr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Qn.warn(r.message)}}}function H0(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dR=1024,fR=30;class pR{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new gR(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Vy();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>fR){const o=yR(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Qn.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Vy(),{heartbeatsToSend:r,unsentEntries:s}=mR(this._heartbeatsCache.heartbeats),i=Vc(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Qn.warn(n),""}}}function Vy(){return new Date().toISOString().substring(0,10)}function mR(t,e=dR){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Oy(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Oy(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class gR{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return nC()?rC().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await hR(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return jy(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return jy(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Oy(t){return Vc(JSON.stringify({version:2,heartbeats:t})).length}function yR(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vR(t){Ii(new Es("platform-logger",e=>new PC(e),"PRIVATE")),Ii(new Es("heartbeat",e=>new pR(e),"PRIVATE")),kr(qd,by,t),kr(qd,by,"esm2020"),kr("fire-js","")}vR("");function W0(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const _R=W0,q0=new ja("auth","Firebase",W0());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lc=new wp("@firebase/auth");function wR(t,...e){Lc.logLevel<=oe.WARN&&Lc.warn(`Auth (${Mi}): ${t}`,...e)}function Ql(t,...e){Lc.logLevel<=oe.ERROR&&Lc.error(`Auth (${Mi}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pn(t,...e){throw Tp(t,...e)}function dn(t,...e){return Tp(t,...e)}function xp(t,e,n){const r={..._R(),[e]:n};return new ja("auth","Firebase",r).create(e,{appName:t.name})}function fs(t){return xp(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function ER(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Pn(t,"argument-error"),xp(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Tp(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return q0.create(t,...e)}function X(t,e,...n){if(!t)throw Tp(e,...n)}function Bn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Ql(e),new Error(e)}function Yn(t,e){t||Bn(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yd(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function xR(){return Ly()==="http:"||Ly()==="https:"}function Ly(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TR(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(xR()||X2()||"connection"in navigator)?navigator.onLine:!0}function IR(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oa{constructor(e,n){this.shortDelay=e,this.longDelay=n,Yn(n>e,"Short delay should be less than long delay!"),this.isMobile=Q2()||Z2()}get(){return TR()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ip(t,e){Yn(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K0{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Bn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Bn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Bn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SR={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CR=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],RR=new Oa(3e4,6e4);function Sp(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Fi(t,e,n,r,s={}){return Q0(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const l=Va({key:t.config.apiKey,...o}).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u={method:e,headers:c,...i};return J2()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&Rs(t.emulatorConfig.host)&&(u.credentials="include"),K0.fetch()(await Y0(t,t.config.apiHost,n,l),u)})}async function Q0(t,e,n){t._canInitEmulator=!1;const r={...SR,...e};try{const s=new AR(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Al(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Al(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Al(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw Al(t,"user-disabled",o);const f=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw xp(t,f,u);Pn(t,f)}}catch(s){if(s instanceof tr)throw s;Pn(t,"network-request-failed",{message:String(s)})}}async function NR(t,e,n,r,s={}){const i=await Fi(t,e,n,r,s);return"mfaPendingCredential"in i&&Pn(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function Y0(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?Ip(t.config,s):`${t.config.apiScheme}://${s}`;return CR.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}class AR{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(dn(this.auth,"network-request-failed")),RR.get())})}}function Al(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=dn(t,e,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PR(t,e){return Fi(t,"POST","/v1/accounts:delete",e)}async function Mc(t,e){return Fi(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ho(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function kR(t,e=!1){const n=tt(t),r=await n.getIdToken(e),s=Cp(r);X(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Ho(Vh(s.auth_time)),issuedAtTime:Ho(Vh(s.iat)),expirationTime:Ho(Vh(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Vh(t){return Number(t)*1e3}function Cp(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Ql("JWT malformed, contained fewer than 3 sections"),null;try{const s=V0(n);return s?JSON.parse(s):(Ql("Failed to decode base64 JWT payload"),null)}catch(s){return Ql("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function My(t){const e=Cp(t);return X(e,"internal-error"),X(typeof e.exp<"u","internal-error"),X(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function va(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof tr&&bR(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function bR({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DR{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jd{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ho(this.lastLoginAt),this.creationTime=Ho(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fc(t){var m;const e=t.auth,n=await t.getIdToken(),r=await va(t,Mc(e,{idToken:n}));X(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const i=(m=s.providerUserInfo)!=null&&m.length?J0(s.providerUserInfo):[],o=VR(t.providerData,i),l=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),u=l?c:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Jd(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(t,f)}async function jR(t){const e=tt(t);await Fc(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function VR(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function J0(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OR(t,e){const n=await Q0(t,{},async()=>{const r=Va({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await Y0(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:l,body:r};return t.emulatorConfig&&Rs(t.emulatorConfig.host)&&(c.credentials="include"),K0.fetch()(o,c)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function LR(t,e){return Fi(t,"POST","/v2/accounts:revokeToken",Sp(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class di{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){X(e.idToken,"internal-error"),X(typeof e.idToken<"u","internal-error"),X(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):My(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){X(e.length!==0,"internal-error");const n=My(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(X(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await OR(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new di;return r&&(X(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(X(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(X(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new di,this.toJSON())}_performRefresh(){return Bn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ar(t,e){X(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class cn{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new DR(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Jd(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await va(this,this.stsTokenManager.getToken(this.auth,e));return X(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return kR(this,e)}reload(){return jR(this)}_assign(e){this!==e&&(X(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new cn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){X(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Fc(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ln(this.auth.app))return Promise.reject(fs(this.auth));const e=await this.getIdToken();return await va(this,PR(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,i=n.phoneNumber??void 0,o=n.photoURL??void 0,l=n.tenantId??void 0,c=n._redirectEventId??void 0,u=n.createdAt??void 0,f=n.lastLoginAt??void 0,{uid:m,emailVerified:g,isAnonymous:w,providerData:R,stsTokenManager:N}=n;X(m&&N,e,"internal-error");const P=di.fromJSON(this.name,N);X(typeof m=="string",e,"internal-error"),ar(r,e.name),ar(s,e.name),X(typeof g=="boolean",e,"internal-error"),X(typeof w=="boolean",e,"internal-error"),ar(i,e.name),ar(o,e.name),ar(l,e.name),ar(c,e.name),ar(u,e.name),ar(f,e.name);const x=new cn({uid:m,auth:e,email:s,emailVerified:g,displayName:r,isAnonymous:w,photoURL:o,phoneNumber:i,tenantId:l,stsTokenManager:P,createdAt:u,lastLoginAt:f});return R&&Array.isArray(R)&&(x.providerData=R.map(v=>({...v}))),c&&(x._redirectEventId=c),x}static async _fromIdTokenResponse(e,n,r=!1){const s=new di;s.updateFromServerResponse(n);const i=new cn({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Fc(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];X(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?J0(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),l=new di;l.updateFromIdToken(r);const c=new cn({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:o}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Jd(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fy=new Map;function zn(t){Yn(t instanceof Function,"Expected a class definition");let e=Fy.get(t);return e?(Yn(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Fy.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X0{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}X0.type="NONE";const Uy=X0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yl(t,e,n){return`firebase:${t}:${e}:${n}`}class fi{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Yl(this.userKey,s.apiKey,i),this.fullPersistenceKey=Yl("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Mc(this.auth,{idToken:e}).catch(()=>{});return n?cn._fromGetAccountInfoResponse(this.auth,n,e):null}return cn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new fi(zn(Uy),e,r);const s=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=s[0]||zn(Uy);const o=Yl(r,e.config.apiKey,e.name);let l=null;for(const u of n)try{const f=await u._get(o);if(f){let m;if(typeof f=="string"){const g=await Mc(e,{idToken:f}).catch(()=>{});if(!g)break;m=await cn._fromGetAccountInfoResponse(e,g,f)}else m=cn._fromJSON(e,f);u!==i&&(l=m),i=u;break}}catch{}const c=s.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new fi(i,e,r):(i=c[0],l&&await i._set(o,l.toJSON()),await Promise.all(n.map(async u=>{if(u!==i)try{await u._remove(o)}catch{}})),new fi(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function By(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(nw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Z0(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(sw(e))return"Blackberry";if(iw(e))return"Webos";if(ew(e))return"Safari";if((e.includes("chrome/")||tw(e))&&!e.includes("edge/"))return"Chrome";if(rw(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function Z0(t=Et()){return/firefox\//i.test(t)}function ew(t=Et()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function tw(t=Et()){return/crios\//i.test(t)}function nw(t=Et()){return/iemobile/i.test(t)}function rw(t=Et()){return/android/i.test(t)}function sw(t=Et()){return/blackberry/i.test(t)}function iw(t=Et()){return/webos/i.test(t)}function Rp(t=Et()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function MR(t=Et()){var e;return Rp(t)&&!!((e=window.navigator)!=null&&e.standalone)}function FR(){return eC()&&document.documentMode===10}function ow(t=Et()){return Rp(t)||rw(t)||iw(t)||sw(t)||/windows phone/i.test(t)||nw(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aw(t,e=[]){let n;switch(t){case"Browser":n=By(Et());break;case"Worker":n=`${By(Et())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Mi}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UR{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,l)=>{try{const c=e(i);o(c)}catch(c){l(c)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BR(t,e={}){return Fi(t,"GET","/v2/passwordPolicy",Sp(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zR=6;class $R{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??zR,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GR{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new zy(this),this.idTokenSubscription=new zy(this),this.beforeStateQueue=new UR(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=q0,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=zn(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await fi.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Mc(this,{idToken:e}),r=await cn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(ln(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,l=r==null?void 0:r._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(r=c.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return X(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Fc(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=IR()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ln(this.app))return Promise.reject(fs(this));const n=e?tt(e):null;return n&&X(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&X(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ln(this.app)?Promise.reject(fs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ln(this.app)?Promise.reject(fs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(zn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await BR(this),n=new $R(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ja("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await LR(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&zn(e)||this._popupRedirectResolver;X(n,this,"argument-error"),this.redirectPersistenceManager=await fi.create(this,[zn(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(X(l,this,"internal-error"),l.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,s);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return X(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=aw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(ln(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&wR(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function xu(t){return tt(t)}class zy{constructor(e){this.auth=e,this.observer=null,this.addObserver=lC(n=>this.observer=n)}get next(){return X(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Np={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function HR(t){Np=t}function WR(t){return Np.loadJS(t)}function qR(){return Np.gapiScript}function KR(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QR(t,e){const n=Eu(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(Or(i,e??{}))return s;Pn(s,"already-initialized")}return n.initialize({options:e})}function YR(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(zn);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function JR(t,e,n){const r=xu(t);X(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!(n!=null&&n.disableWarnings),i=lw(e),{host:o,port:l}=XR(e),c=l===null?"":`:${l}`,u={url:`${i}//${o}${c}/`},f=Object.freeze({host:o,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){X(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),X(Or(u,r.config.emulator)&&Or(f,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=u,r.emulatorConfig=f,r.settings.appVerificationDisabledForTesting=!0,Rs(o)?(_p(`${i}//${o}${c}`),F0("Auth",!0)):s||ZR()}function lw(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function XR(t){const e=lw(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:$y(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:$y(o)}}}function $y(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function ZR(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cw{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Bn("not implemented")}_getIdTokenResponse(e){return Bn("not implemented")}_linkToIdToken(e,n){return Bn("not implemented")}_getReauthenticationResolver(e){return Bn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pi(t,e){return NR(t,"POST","/v1/accounts:signInWithIdp",Sp(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eN="http://localhost";class xs extends cw{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new xs(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Pn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=n;if(!r||!s)return null;const o=new xs(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return pi(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,pi(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,pi(e,n)}buildRequest(){const e={requestUri:eN,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Va(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ap{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class La extends Ap{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dr extends La{constructor(){super("facebook.com")}static credential(e){return xs._fromParams({providerId:dr.PROVIDER_ID,signInMethod:dr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return dr.credentialFromTaggedObject(e)}static credentialFromError(e){return dr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return dr.credential(e.oauthAccessToken)}catch{return null}}}dr.FACEBOOK_SIGN_IN_METHOD="facebook.com";dr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mn extends La{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return xs._fromParams({providerId:Mn.PROVIDER_ID,signInMethod:Mn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Mn.credentialFromTaggedObject(e)}static credentialFromError(e){return Mn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Mn.credential(n,r)}catch{return null}}}Mn.GOOGLE_SIGN_IN_METHOD="google.com";Mn.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fr extends La{constructor(){super("github.com")}static credential(e){return xs._fromParams({providerId:fr.PROVIDER_ID,signInMethod:fr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return fr.credentialFromTaggedObject(e)}static credentialFromError(e){return fr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return fr.credential(e.oauthAccessToken)}catch{return null}}}fr.GITHUB_SIGN_IN_METHOD="github.com";fr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pr extends La{constructor(){super("twitter.com")}static credential(e,n){return xs._fromParams({providerId:pr.PROVIDER_ID,signInMethod:pr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return pr.credentialFromTaggedObject(e)}static credentialFromError(e){return pr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return pr.credential(n,r)}catch{return null}}}pr.TWITTER_SIGN_IN_METHOD="twitter.com";pr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Si{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await cn._fromIdTokenResponse(e,r,s),o=Gy(r);return new Si({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=Gy(r);return new Si({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function Gy(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uc extends tr{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Uc.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Uc(e,n,r,s)}}function uw(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Uc._fromErrorAndOperation(t,i,e,r):i})}async function tN(t,e,n=!1){const r=await va(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Si._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nN(t,e,n=!1){const{auth:r}=t;if(ln(r.app))return Promise.reject(fs(r));const s="reauthenticate";try{const i=await va(t,uw(r,s,e,t),n);X(i.idToken,r,"internal-error");const o=Cp(i.idToken);X(o,r,"internal-error");const{sub:l}=o;return X(t.uid===l,r,"user-mismatch"),Si._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Pn(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rN(t,e,n=!1){if(ln(t.app))return Promise.reject(fs(t));const r="signIn",s=await uw(t,r,e),i=await Si._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}function sN(t,e,n,r){return tt(t).onIdTokenChanged(e,n,r)}function iN(t,e,n){return tt(t).beforeAuthStateChanged(e,n)}function oN(t,e,n,r){return tt(t).onAuthStateChanged(e,n,r)}function aN(t){return tt(t).signOut()}const Bc="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hw{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Bc,"1"),this.storage.removeItem(Bc),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lN=1e3,cN=10;class dw extends hw{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=ow(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);FR()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,cN):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},lN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}dw.type="LOCAL";const uN=dw;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fw extends hw{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}fw.type="SESSION";const pw=fw;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hN(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tu{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Tu(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(o).map(async u=>u(n.origin,i)),c=await hN(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Tu.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pp(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dN{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((l,c)=>{const u=Pp("",20);s.port1.start();const f=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(m){const g=m;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(f),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(g.data.response);break;default:clearTimeout(f),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sn(){return window}function fN(t){Sn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mw(){return typeof Sn().WorkerGlobalScope<"u"&&typeof Sn().importScripts=="function"}async function pN(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function mN(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function gN(){return mw()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gw="firebaseLocalStorageDb",yN=1,zc="firebaseLocalStorage",yw="fbase_key";class Ma{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Iu(t,e){return t.transaction([zc],e?"readwrite":"readonly").objectStore(zc)}function vN(){const t=indexedDB.deleteDatabase(gw);return new Ma(t).toPromise()}function Xd(){const t=indexedDB.open(gw,yN);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(zc,{keyPath:yw})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(zc)?e(r):(r.close(),await vN(),e(await Xd()))})})}async function Hy(t,e,n){const r=Iu(t,!0).put({[yw]:e,value:n});return new Ma(r).toPromise()}async function _N(t,e){const n=Iu(t,!1).get(e),r=await new Ma(n).toPromise();return r===void 0?null:r.value}function Wy(t,e){const n=Iu(t,!0).delete(e);return new Ma(n).toPromise()}const wN=800,EN=3;class vw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Xd(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>EN)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return mw()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Tu._getInstance(gN()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await pN(),!this.activeServiceWorker)return;this.sender=new dN(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||mN()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Xd();return await Hy(e,Bc,"1"),await Wy(e,Bc),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>Hy(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>_N(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Wy(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Iu(s,!1).getAll();return new Ma(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),wN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}vw.type="LOCAL";const xN=vw;new Oa(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _w(t,e){return e?zn(e):(X(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kp extends cw{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return pi(e,this._buildIdpRequest())}_linkToIdToken(e,n){return pi(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return pi(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function TN(t){return rN(t.auth,new kp(t),t.bypassAuthState)}function IN(t){const{auth:e,user:n}=t;return X(n,e,"internal-error"),nN(n,new kp(t),t.bypassAuthState)}async function SN(t){const{auth:e,user:n}=t;return X(n,e,"internal-error"),tN(n,new kp(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ww{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return TN;case"linkViaPopup":case"linkViaRedirect":return SN;case"reauthViaPopup":case"reauthViaRedirect":return IN;default:Pn(this.auth,"internal-error")}}resolve(e){Yn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Yn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CN=new Oa(2e3,1e4);async function RN(t,e,n){if(ln(t.app))return Promise.reject(dn(t,"operation-not-supported-in-this-environment"));const r=xu(t);ER(t,e,Ap);const s=_w(r,n);return new cs(r,"signInViaPopup",e,s).executeNotNull()}class cs extends ww{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,cs.currentPopupAction&&cs.currentPopupAction.cancel(),cs.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return X(e,this.auth,"internal-error"),e}async onExecution(){Yn(this.filter.length===1,"Popup operations only handle one event");const e=Pp();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(dn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(dn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,cs.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(dn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,CN.get())};e()}}cs.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NN="pendingRedirect",Jl=new Map;class AN extends ww{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Jl.get(this.auth._key());if(!e){try{const r=await PN(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Jl.set(this.auth._key(),e)}return this.bypassAuthState||Jl.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function PN(t,e){const n=DN(e),r=bN(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function kN(t,e){Jl.set(t._key(),e)}function bN(t){return zn(t._redirectPersistence)}function DN(t){return Yl(NN,t.config.apiKey,t.name)}async function jN(t,e,n=!1){if(ln(t.app))return Promise.reject(fs(t));const r=xu(t),s=_w(r,e),o=await new AN(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VN=10*60*1e3;class ON{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!LN(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!Ew(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(dn(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=VN&&this.cachedEventUids.clear(),this.cachedEventUids.has(qy(e))}saveEventToCache(e){this.cachedEventUids.add(qy(e)),this.lastProcessedEventTime=Date.now()}}function qy(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Ew({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function LN(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Ew(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MN(t,e={}){return Fi(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FN=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,UN=/^https?/;async function BN(t){if(t.config.emulator)return;const{authorizedDomains:e}=await MN(t);for(const n of e)try{if(zN(n))return}catch{}Pn(t,"unauthorized-domain")}function zN(t){const e=Yd(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!UN.test(n))return!1;if(FN.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $N=new Oa(3e4,6e4);function Ky(){const t=Sn().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function GN(t){return new Promise((e,n)=>{var s,i,o;function r(){Ky(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Ky(),n(dn(t,"network-request-failed"))},timeout:$N.get()})}if((i=(s=Sn().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=Sn().gapi)!=null&&o.load)r();else{const l=KR("iframefcb");return Sn()[l]=()=>{gapi.load?r():n(dn(t,"network-request-failed"))},WR(`${qR()}?onload=${l}`).catch(c=>n(c))}}).catch(e=>{throw Xl=null,e})}let Xl=null;function HN(t){return Xl=Xl||GN(t),Xl}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WN=new Oa(5e3,15e3),qN="__/auth/iframe",KN="emulator/auth/iframe",QN={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},YN=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function JN(t){const e=t.config;X(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Ip(e,KN):`https://${t.config.authDomain}/${qN}`,r={apiKey:e.apiKey,appName:t.name,v:Mi},s=YN.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Va(r).slice(1)}`}async function XN(t){const e=await HN(t),n=Sn().gapi;return X(n,t,"internal-error"),e.open({where:document.body,url:JN(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:QN,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=dn(t,"network-request-failed"),l=Sn().setTimeout(()=>{i(o)},WN.get());function c(){Sn().clearTimeout(l),s(r)}r.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZN={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},eA=500,tA=600,nA="_blank",rA="http://localhost";class Qy{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function sA(t,e,n,r=eA,s=tA){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const c={...ZN,width:r.toString(),height:s.toString(),top:i,left:o},u=Et().toLowerCase();n&&(l=tw(u)?nA:n),Z0(u)&&(e=e||rA,c.scrollbars="yes");const f=Object.entries(c).reduce((g,[w,R])=>`${g}${w}=${R},`,"");if(MR(u)&&l!=="_self")return iA(e||"",l),new Qy(null);const m=window.open(e||"",l,f);X(m,t,"popup-blocked");try{m.focus()}catch{}return new Qy(m)}function iA(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oA="__/auth/handler",aA="emulator/auth/handler",lA=encodeURIComponent("fac");async function Yy(t,e,n,r,s,i){X(t.config.authDomain,t,"auth-domain-config-required"),X(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Mi,eventId:s};if(e instanceof Ap){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",aC(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,m]of Object.entries(i||{}))o[f]=m}if(e instanceof La){const f=e.getScopes().filter(m=>m!=="");f.length>0&&(o.scopes=f.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const f of Object.keys(l))l[f]===void 0&&delete l[f];const c=await t._getAppCheckToken(),u=c?`#${lA}=${encodeURIComponent(c)}`:"";return`${cA(t)}?${Va(l).slice(1)}${u}`}function cA({config:t}){return t.emulator?Ip(t,aA):`https://${t.authDomain}/${oA}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oh="webStorageSupport";class uA{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=pw,this._completeRedirectFn=jN,this._overrideRedirectResult=kN}async _openPopup(e,n,r,s){var o;Yn((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await Yy(e,n,r,Yd(),s);return sA(e,i,Pp())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await Yy(e,n,r,Yd(),s);return fN(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Yn(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await XN(e),r=new ON(e);return n.register("authEvent",s=>(X(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Oh,{type:Oh},s=>{var o;const i=(o=s==null?void 0:s[0])==null?void 0:o[Oh];i!==void 0&&n(!!i),Pn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=BN(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return ow()||ew()||Rp()}}const hA=uA;var Jy="@firebase/auth",Xy="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dA{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){X(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fA(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function pA(t){Ii(new Es("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;X(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:aw(t)},u=new GR(r,s,i,c);return YR(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Ii(new Es("auth-internal",e=>{const n=xu(e.getProvider("auth").getImmediate());return(r=>new dA(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),kr(Jy,Xy,fA(t)),kr(Jy,Xy,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mA=5*60,gA=M0("authIdTokenMaxAge")||mA;let Zy=null;const yA=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>gA)return;const s=n==null?void 0:n.token;Zy!==s&&(Zy=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function vA(t=$0()){const e=Eu(t,"auth");if(e.isInitialized())return e.getImmediate();const n=QR(t,{popupRedirectResolver:hA,persistence:[xN,uN,pw]}),r=M0("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=yA(i.toString());iN(n,o,()=>o(n.currentUser)),sN(n,l=>o(l))}}const s=O0("auth");return s&&JR(n,`http://${s}`),n}function _A(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}HR({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=dn("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",_A().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});pA("Browser");var wA="firebase",EA="12.1.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */kr(wA,EA,"app");var ev=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var br,xw;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(T,_){function S(){}S.prototype=_.prototype,T.D=_.prototype,T.prototype=new S,T.prototype.constructor=T,T.C=function(E,A,b){for(var C=Array(arguments.length-2),qe=2;qe<arguments.length;qe++)C[qe-2]=arguments[qe];return _.prototype[A].apply(E,C)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(T,_,S){S||(S=0);var E=Array(16);if(typeof _=="string")for(var A=0;16>A;++A)E[A]=_.charCodeAt(S++)|_.charCodeAt(S++)<<8|_.charCodeAt(S++)<<16|_.charCodeAt(S++)<<24;else for(A=0;16>A;++A)E[A]=_[S++]|_[S++]<<8|_[S++]<<16|_[S++]<<24;_=T.g[0],S=T.g[1],A=T.g[2];var b=T.g[3],C=_+(b^S&(A^b))+E[0]+3614090360&4294967295;_=S+(C<<7&4294967295|C>>>25),C=b+(A^_&(S^A))+E[1]+3905402710&4294967295,b=_+(C<<12&4294967295|C>>>20),C=A+(S^b&(_^S))+E[2]+606105819&4294967295,A=b+(C<<17&4294967295|C>>>15),C=S+(_^A&(b^_))+E[3]+3250441966&4294967295,S=A+(C<<22&4294967295|C>>>10),C=_+(b^S&(A^b))+E[4]+4118548399&4294967295,_=S+(C<<7&4294967295|C>>>25),C=b+(A^_&(S^A))+E[5]+1200080426&4294967295,b=_+(C<<12&4294967295|C>>>20),C=A+(S^b&(_^S))+E[6]+2821735955&4294967295,A=b+(C<<17&4294967295|C>>>15),C=S+(_^A&(b^_))+E[7]+4249261313&4294967295,S=A+(C<<22&4294967295|C>>>10),C=_+(b^S&(A^b))+E[8]+1770035416&4294967295,_=S+(C<<7&4294967295|C>>>25),C=b+(A^_&(S^A))+E[9]+2336552879&4294967295,b=_+(C<<12&4294967295|C>>>20),C=A+(S^b&(_^S))+E[10]+4294925233&4294967295,A=b+(C<<17&4294967295|C>>>15),C=S+(_^A&(b^_))+E[11]+2304563134&4294967295,S=A+(C<<22&4294967295|C>>>10),C=_+(b^S&(A^b))+E[12]+1804603682&4294967295,_=S+(C<<7&4294967295|C>>>25),C=b+(A^_&(S^A))+E[13]+4254626195&4294967295,b=_+(C<<12&4294967295|C>>>20),C=A+(S^b&(_^S))+E[14]+2792965006&4294967295,A=b+(C<<17&4294967295|C>>>15),C=S+(_^A&(b^_))+E[15]+1236535329&4294967295,S=A+(C<<22&4294967295|C>>>10),C=_+(A^b&(S^A))+E[1]+4129170786&4294967295,_=S+(C<<5&4294967295|C>>>27),C=b+(S^A&(_^S))+E[6]+3225465664&4294967295,b=_+(C<<9&4294967295|C>>>23),C=A+(_^S&(b^_))+E[11]+643717713&4294967295,A=b+(C<<14&4294967295|C>>>18),C=S+(b^_&(A^b))+E[0]+3921069994&4294967295,S=A+(C<<20&4294967295|C>>>12),C=_+(A^b&(S^A))+E[5]+3593408605&4294967295,_=S+(C<<5&4294967295|C>>>27),C=b+(S^A&(_^S))+E[10]+38016083&4294967295,b=_+(C<<9&4294967295|C>>>23),C=A+(_^S&(b^_))+E[15]+3634488961&4294967295,A=b+(C<<14&4294967295|C>>>18),C=S+(b^_&(A^b))+E[4]+3889429448&4294967295,S=A+(C<<20&4294967295|C>>>12),C=_+(A^b&(S^A))+E[9]+568446438&4294967295,_=S+(C<<5&4294967295|C>>>27),C=b+(S^A&(_^S))+E[14]+3275163606&4294967295,b=_+(C<<9&4294967295|C>>>23),C=A+(_^S&(b^_))+E[3]+4107603335&4294967295,A=b+(C<<14&4294967295|C>>>18),C=S+(b^_&(A^b))+E[8]+1163531501&4294967295,S=A+(C<<20&4294967295|C>>>12),C=_+(A^b&(S^A))+E[13]+2850285829&4294967295,_=S+(C<<5&4294967295|C>>>27),C=b+(S^A&(_^S))+E[2]+4243563512&4294967295,b=_+(C<<9&4294967295|C>>>23),C=A+(_^S&(b^_))+E[7]+1735328473&4294967295,A=b+(C<<14&4294967295|C>>>18),C=S+(b^_&(A^b))+E[12]+2368359562&4294967295,S=A+(C<<20&4294967295|C>>>12),C=_+(S^A^b)+E[5]+4294588738&4294967295,_=S+(C<<4&4294967295|C>>>28),C=b+(_^S^A)+E[8]+2272392833&4294967295,b=_+(C<<11&4294967295|C>>>21),C=A+(b^_^S)+E[11]+1839030562&4294967295,A=b+(C<<16&4294967295|C>>>16),C=S+(A^b^_)+E[14]+4259657740&4294967295,S=A+(C<<23&4294967295|C>>>9),C=_+(S^A^b)+E[1]+2763975236&4294967295,_=S+(C<<4&4294967295|C>>>28),C=b+(_^S^A)+E[4]+1272893353&4294967295,b=_+(C<<11&4294967295|C>>>21),C=A+(b^_^S)+E[7]+4139469664&4294967295,A=b+(C<<16&4294967295|C>>>16),C=S+(A^b^_)+E[10]+3200236656&4294967295,S=A+(C<<23&4294967295|C>>>9),C=_+(S^A^b)+E[13]+681279174&4294967295,_=S+(C<<4&4294967295|C>>>28),C=b+(_^S^A)+E[0]+3936430074&4294967295,b=_+(C<<11&4294967295|C>>>21),C=A+(b^_^S)+E[3]+3572445317&4294967295,A=b+(C<<16&4294967295|C>>>16),C=S+(A^b^_)+E[6]+76029189&4294967295,S=A+(C<<23&4294967295|C>>>9),C=_+(S^A^b)+E[9]+3654602809&4294967295,_=S+(C<<4&4294967295|C>>>28),C=b+(_^S^A)+E[12]+3873151461&4294967295,b=_+(C<<11&4294967295|C>>>21),C=A+(b^_^S)+E[15]+530742520&4294967295,A=b+(C<<16&4294967295|C>>>16),C=S+(A^b^_)+E[2]+3299628645&4294967295,S=A+(C<<23&4294967295|C>>>9),C=_+(A^(S|~b))+E[0]+4096336452&4294967295,_=S+(C<<6&4294967295|C>>>26),C=b+(S^(_|~A))+E[7]+1126891415&4294967295,b=_+(C<<10&4294967295|C>>>22),C=A+(_^(b|~S))+E[14]+2878612391&4294967295,A=b+(C<<15&4294967295|C>>>17),C=S+(b^(A|~_))+E[5]+4237533241&4294967295,S=A+(C<<21&4294967295|C>>>11),C=_+(A^(S|~b))+E[12]+1700485571&4294967295,_=S+(C<<6&4294967295|C>>>26),C=b+(S^(_|~A))+E[3]+2399980690&4294967295,b=_+(C<<10&4294967295|C>>>22),C=A+(_^(b|~S))+E[10]+4293915773&4294967295,A=b+(C<<15&4294967295|C>>>17),C=S+(b^(A|~_))+E[1]+2240044497&4294967295,S=A+(C<<21&4294967295|C>>>11),C=_+(A^(S|~b))+E[8]+1873313359&4294967295,_=S+(C<<6&4294967295|C>>>26),C=b+(S^(_|~A))+E[15]+4264355552&4294967295,b=_+(C<<10&4294967295|C>>>22),C=A+(_^(b|~S))+E[6]+2734768916&4294967295,A=b+(C<<15&4294967295|C>>>17),C=S+(b^(A|~_))+E[13]+1309151649&4294967295,S=A+(C<<21&4294967295|C>>>11),C=_+(A^(S|~b))+E[4]+4149444226&4294967295,_=S+(C<<6&4294967295|C>>>26),C=b+(S^(_|~A))+E[11]+3174756917&4294967295,b=_+(C<<10&4294967295|C>>>22),C=A+(_^(b|~S))+E[2]+718787259&4294967295,A=b+(C<<15&4294967295|C>>>17),C=S+(b^(A|~_))+E[9]+3951481745&4294967295,T.g[0]=T.g[0]+_&4294967295,T.g[1]=T.g[1]+(A+(C<<21&4294967295|C>>>11))&4294967295,T.g[2]=T.g[2]+A&4294967295,T.g[3]=T.g[3]+b&4294967295}r.prototype.u=function(T,_){_===void 0&&(_=T.length);for(var S=_-this.blockSize,E=this.B,A=this.h,b=0;b<_;){if(A==0)for(;b<=S;)s(this,T,b),b+=this.blockSize;if(typeof T=="string"){for(;b<_;)if(E[A++]=T.charCodeAt(b++),A==this.blockSize){s(this,E),A=0;break}}else for(;b<_;)if(E[A++]=T[b++],A==this.blockSize){s(this,E),A=0;break}}this.h=A,this.o+=_},r.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var _=1;_<T.length-8;++_)T[_]=0;var S=8*this.o;for(_=T.length-8;_<T.length;++_)T[_]=S&255,S/=256;for(this.u(T),T=Array(16),_=S=0;4>_;++_)for(var E=0;32>E;E+=8)T[S++]=this.g[_]>>>E&255;return T};function i(T,_){var S=l;return Object.prototype.hasOwnProperty.call(S,T)?S[T]:S[T]=_(T)}function o(T,_){this.h=_;for(var S=[],E=!0,A=T.length-1;0<=A;A--){var b=T[A]|0;E&&b==_||(S[A]=b,E=!1)}this.g=S}var l={};function c(T){return-128<=T&&128>T?i(T,function(_){return new o([_|0],0>_?-1:0)}):new o([T|0],0>T?-1:0)}function u(T){if(isNaN(T)||!isFinite(T))return m;if(0>T)return P(u(-T));for(var _=[],S=1,E=0;T>=S;E++)_[E]=T/S|0,S*=4294967296;return new o(_,0)}function f(T,_){if(T.length==0)throw Error("number format error: empty string");if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(T.charAt(0)=="-")return P(f(T.substring(1),_));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var S=u(Math.pow(_,8)),E=m,A=0;A<T.length;A+=8){var b=Math.min(8,T.length-A),C=parseInt(T.substring(A,A+b),_);8>b?(b=u(Math.pow(_,b)),E=E.j(b).add(u(C))):(E=E.j(S),E=E.add(u(C)))}return E}var m=c(0),g=c(1),w=c(16777216);t=o.prototype,t.m=function(){if(N(this))return-P(this).m();for(var T=0,_=1,S=0;S<this.g.length;S++){var E=this.i(S);T+=(0<=E?E:4294967296+E)*_,_*=4294967296}return T},t.toString=function(T){if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(R(this))return"0";if(N(this))return"-"+P(this).toString(T);for(var _=u(Math.pow(T,6)),S=this,E="";;){var A=D(S,_).g;S=x(S,A.j(_));var b=((0<S.g.length?S.g[0]:S.h)>>>0).toString(T);if(S=A,R(S))return b+E;for(;6>b.length;)b="0"+b;E=b+E}},t.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h};function R(T){if(T.h!=0)return!1;for(var _=0;_<T.g.length;_++)if(T.g[_]!=0)return!1;return!0}function N(T){return T.h==-1}t.l=function(T){return T=x(this,T),N(T)?-1:R(T)?0:1};function P(T){for(var _=T.g.length,S=[],E=0;E<_;E++)S[E]=~T.g[E];return new o(S,~T.h).add(g)}t.abs=function(){return N(this)?P(this):this},t.add=function(T){for(var _=Math.max(this.g.length,T.g.length),S=[],E=0,A=0;A<=_;A++){var b=E+(this.i(A)&65535)+(T.i(A)&65535),C=(b>>>16)+(this.i(A)>>>16)+(T.i(A)>>>16);E=C>>>16,b&=65535,C&=65535,S[A]=C<<16|b}return new o(S,S[S.length-1]&-2147483648?-1:0)};function x(T,_){return T.add(P(_))}t.j=function(T){if(R(this)||R(T))return m;if(N(this))return N(T)?P(this).j(P(T)):P(P(this).j(T));if(N(T))return P(this.j(P(T)));if(0>this.l(w)&&0>T.l(w))return u(this.m()*T.m());for(var _=this.g.length+T.g.length,S=[],E=0;E<2*_;E++)S[E]=0;for(E=0;E<this.g.length;E++)for(var A=0;A<T.g.length;A++){var b=this.i(E)>>>16,C=this.i(E)&65535,qe=T.i(A)>>>16,Ke=T.i(A)&65535;S[2*E+2*A]+=C*Ke,v(S,2*E+2*A),S[2*E+2*A+1]+=b*Ke,v(S,2*E+2*A+1),S[2*E+2*A+1]+=C*qe,v(S,2*E+2*A+1),S[2*E+2*A+2]+=b*qe,v(S,2*E+2*A+2)}for(E=0;E<_;E++)S[E]=S[2*E+1]<<16|S[2*E];for(E=_;E<2*_;E++)S[E]=0;return new o(S,0)};function v(T,_){for(;(T[_]&65535)!=T[_];)T[_+1]+=T[_]>>>16,T[_]&=65535,_++}function I(T,_){this.g=T,this.h=_}function D(T,_){if(R(_))throw Error("division by zero");if(R(T))return new I(m,m);if(N(T))return _=D(P(T),_),new I(P(_.g),P(_.h));if(N(_))return _=D(T,P(_)),new I(P(_.g),_.h);if(30<T.g.length){if(N(T)||N(_))throw Error("slowDivide_ only works with positive integers.");for(var S=g,E=_;0>=E.l(T);)S=F(S),E=F(E);var A=z(S,1),b=z(E,1);for(E=z(E,2),S=z(S,2);!R(E);){var C=b.add(E);0>=C.l(T)&&(A=A.add(S),b=C),E=z(E,1),S=z(S,1)}return _=x(T,A.j(_)),new I(A,_)}for(A=m;0<=T.l(_);){for(S=Math.max(1,Math.floor(T.m()/_.m())),E=Math.ceil(Math.log(S)/Math.LN2),E=48>=E?1:Math.pow(2,E-48),b=u(S),C=b.j(_);N(C)||0<C.l(T);)S-=E,b=u(S),C=b.j(_);R(b)&&(b=g),A=A.add(b),T=x(T,C)}return new I(A,T)}t.A=function(T){return D(this,T).h},t.and=function(T){for(var _=Math.max(this.g.length,T.g.length),S=[],E=0;E<_;E++)S[E]=this.i(E)&T.i(E);return new o(S,this.h&T.h)},t.or=function(T){for(var _=Math.max(this.g.length,T.g.length),S=[],E=0;E<_;E++)S[E]=this.i(E)|T.i(E);return new o(S,this.h|T.h)},t.xor=function(T){for(var _=Math.max(this.g.length,T.g.length),S=[],E=0;E<_;E++)S[E]=this.i(E)^T.i(E);return new o(S,this.h^T.h)};function F(T){for(var _=T.g.length+1,S=[],E=0;E<_;E++)S[E]=T.i(E)<<1|T.i(E-1)>>>31;return new o(S,T.h)}function z(T,_){var S=_>>5;_%=32;for(var E=T.g.length-S,A=[],b=0;b<E;b++)A[b]=0<_?T.i(b+S)>>>_|T.i(b+S+1)<<32-_:T.i(b+S);return new o(A,T.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,xw=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=f,br=o}).apply(typeof ev<"u"?ev:typeof self<"u"?self:typeof window<"u"?window:{});var Pl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Tw,ko,Iw,Zl,Zd,Sw,Cw,Rw;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,h,p){return a==Array.prototype||a==Object.prototype||(a[h]=p.value),a};function n(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof Pl=="object"&&Pl];for(var h=0;h<a.length;++h){var p=a[h];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var r=n(this);function s(a,h){if(h)e:{var p=r;a=a.split(".");for(var y=0;y<a.length-1;y++){var k=a[y];if(!(k in p))break e;p=p[k]}a=a[a.length-1],y=p[a],h=h(y),h!=y&&h!=null&&e(p,a,{configurable:!0,writable:!0,value:h})}}function i(a,h){a instanceof String&&(a+="");var p=0,y=!1,k={next:function(){if(!y&&p<a.length){var j=p++;return{value:h(j,a[j]),done:!1}}return y=!0,{done:!0,value:void 0}}};return k[Symbol.iterator]=function(){return k},k}s("Array.prototype.values",function(a){return a||function(){return i(this,function(h,p){return p})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(a){var h=typeof a;return h=h!="object"?h:a?Array.isArray(a)?"array":h:"null",h=="array"||h=="object"&&typeof a.length=="number"}function u(a){var h=typeof a;return h=="object"&&a!=null||h=="function"}function f(a,h,p){return a.call.apply(a.bind,arguments)}function m(a,h,p){if(!a)throw Error();if(2<arguments.length){var y=Array.prototype.slice.call(arguments,2);return function(){var k=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(k,y),a.apply(h,k)}}return function(){return a.apply(h,arguments)}}function g(a,h,p){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:m,g.apply(null,arguments)}function w(a,h){var p=Array.prototype.slice.call(arguments,1);return function(){var y=p.slice();return y.push.apply(y,arguments),a.apply(this,y)}}function R(a,h){function p(){}p.prototype=h.prototype,a.aa=h.prototype,a.prototype=new p,a.prototype.constructor=a,a.Qb=function(y,k,j){for(var G=Array(arguments.length-2),ge=2;ge<arguments.length;ge++)G[ge-2]=arguments[ge];return h.prototype[k].apply(y,G)}}function N(a){const h=a.length;if(0<h){const p=Array(h);for(let y=0;y<h;y++)p[y]=a[y];return p}return[]}function P(a,h){for(let p=1;p<arguments.length;p++){const y=arguments[p];if(c(y)){const k=a.length||0,j=y.length||0;a.length=k+j;for(let G=0;G<j;G++)a[k+G]=y[G]}else a.push(y)}}class x{constructor(h,p){this.i=h,this.j=p,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function v(a){return/^[\s\xa0]*$/.test(a)}function I(){var a=l.navigator;return a&&(a=a.userAgent)?a:""}function D(a){return D[" "](a),a}D[" "]=function(){};var F=I().indexOf("Gecko")!=-1&&!(I().toLowerCase().indexOf("webkit")!=-1&&I().indexOf("Edge")==-1)&&!(I().indexOf("Trident")!=-1||I().indexOf("MSIE")!=-1)&&I().indexOf("Edge")==-1;function z(a,h,p){for(const y in a)h.call(p,a[y],y,a)}function T(a,h){for(const p in a)h.call(void 0,a[p],p,a)}function _(a){const h={};for(const p in a)h[p]=a[p];return h}const S="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function E(a,h){let p,y;for(let k=1;k<arguments.length;k++){y=arguments[k];for(p in y)a[p]=y[p];for(let j=0;j<S.length;j++)p=S[j],Object.prototype.hasOwnProperty.call(y,p)&&(a[p]=y[p])}}function A(a){var h=1;a=a.split(":");const p=[];for(;0<h&&a.length;)p.push(a.shift()),h--;return a.length&&p.push(a.join(":")),p}function b(a){l.setTimeout(()=>{throw a},0)}function C(){var a=$;let h=null;return a.g&&(h=a.g,a.g=a.g.next,a.g||(a.h=null),h.next=null),h}class qe{constructor(){this.h=this.g=null}add(h,p){const y=Ke.get();y.set(h,p),this.h?this.h.next=y:this.g=y,this.h=y}}var Ke=new x(()=>new Mt,a=>a.reset());class Mt{constructor(){this.next=this.g=this.h=null}set(h,p){this.h=h,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let xt,W=!1,$=new qe,q=()=>{const a=l.Promise.resolve(void 0);xt=()=>{a.then(re)}};var re=()=>{for(var a;a=C();){try{a.h.call(a.g)}catch(p){b(p)}var h=Ke;h.j(a),100>h.h&&(h.h++,a.next=h.g,h.g=a)}W=!1};function se(){this.s=this.s,this.C=this.C}se.prototype.s=!1,se.prototype.ma=function(){this.s||(this.s=!0,this.N())},se.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ce(a,h){this.type=a,this.g=this.target=h,this.defaultPrevented=!1}ce.prototype.h=function(){this.defaultPrevented=!0};var ke=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var a=!1,h=Object.defineProperty({},"passive",{get:function(){a=!0}});try{const p=()=>{};l.addEventListener("test",p,h),l.removeEventListener("test",p,h)}catch{}return a}();function $e(a,h){if(ce.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var p=this.type=a.type,y=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=h,h=a.relatedTarget){if(F){e:{try{D(h.nodeName);var k=!0;break e}catch{}k=!1}k||(h=null)}}else p=="mouseover"?h=a.fromElement:p=="mouseout"&&(h=a.toElement);this.relatedTarget=h,y?(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:be[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&$e.aa.h.call(this)}}R($e,ce);var be={2:"touch",3:"pen",4:"mouse"};$e.prototype.h=function(){$e.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var De="closure_listenable_"+(1e6*Math.random()|0),gn=0;function Ha(a,h,p,y,k){this.listener=a,this.proxy=null,this.src=h,this.type=p,this.capture=!!y,this.ha=k,this.key=++gn,this.da=this.fa=!1}function Jr(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function Xr(a){this.src=a,this.g={},this.h=0}Xr.prototype.add=function(a,h,p,y,k){var j=a.toString();a=this.g[j],a||(a=this.g[j]=[],this.h++);var G=ks(a,h,y,k);return-1<G?(h=a[G],p||(h.fa=!1)):(h=new Ha(h,this.src,j,!!y,k),h.fa=p,a.push(h)),h};function Ps(a,h){var p=h.type;if(p in a.g){var y=a.g[p],k=Array.prototype.indexOf.call(y,h,void 0),j;(j=0<=k)&&Array.prototype.splice.call(y,k,1),j&&(Jr(h),a.g[p].length==0&&(delete a.g[p],a.h--))}}function ks(a,h,p,y){for(var k=0;k<a.length;++k){var j=a[k];if(!j.da&&j.listener==h&&j.capture==!!p&&j.ha==y)return k}return-1}var bs="closure_lm_"+(1e6*Math.random()|0),Ds={};function Ki(a,h,p,y,k){if(y&&y.once)return Yi(a,h,p,y,k);if(Array.isArray(h)){for(var j=0;j<h.length;j++)Ki(a,h[j],p,y,k);return null}return p=eo(p),a&&a[De]?a.K(h,p,u(y)?!!y.capture:!!y,k):Qi(a,h,p,!1,y,k)}function Qi(a,h,p,y,k,j){if(!h)throw Error("Invalid event type");var G=u(k)?!!k.capture:!!k,ge=Vs(a);if(ge||(a[bs]=ge=new Xr(a)),p=ge.add(h,p,y,G,j),p.proxy)return p;if(y=Wa(),p.proxy=y,y.src=a,y.listener=p,a.addEventListener)ke||(k=G),k===void 0&&(k=!1),a.addEventListener(h.toString(),y,k);else if(a.attachEvent)a.attachEvent(Xi(h.toString()),y);else if(a.addListener&&a.removeListener)a.addListener(y);else throw Error("addEventListener and attachEvent are unavailable.");return p}function Wa(){function a(p){return h.call(a.src,a.listener,p)}const h=qa;return a}function Yi(a,h,p,y,k){if(Array.isArray(h)){for(var j=0;j<h.length;j++)Yi(a,h[j],p,y,k);return null}return p=eo(p),a&&a[De]?a.L(h,p,u(y)?!!y.capture:!!y,k):Qi(a,h,p,!0,y,k)}function Ji(a,h,p,y,k){if(Array.isArray(h))for(var j=0;j<h.length;j++)Ji(a,h[j],p,y,k);else y=u(y)?!!y.capture:!!y,p=eo(p),a&&a[De]?(a=a.i,h=String(h).toString(),h in a.g&&(j=a.g[h],p=ks(j,p,y,k),-1<p&&(Jr(j[p]),Array.prototype.splice.call(j,p,1),j.length==0&&(delete a.g[h],a.h--)))):a&&(a=Vs(a))&&(h=a.g[h.toString()],a=-1,h&&(a=ks(h,p,y,k)),(p=-1<a?h[a]:null)&&js(p))}function js(a){if(typeof a!="number"&&a&&!a.da){var h=a.src;if(h&&h[De])Ps(h.i,a);else{var p=a.type,y=a.proxy;h.removeEventListener?h.removeEventListener(p,y,a.capture):h.detachEvent?h.detachEvent(Xi(p),y):h.addListener&&h.removeListener&&h.removeListener(y),(p=Vs(h))?(Ps(p,a),p.h==0&&(p.src=null,h[bs]=null)):Jr(a)}}}function Xi(a){return a in Ds?Ds[a]:Ds[a]="on"+a}function qa(a,h){if(a.da)a=!0;else{h=new $e(h,this);var p=a.listener,y=a.ha||a.src;a.fa&&js(a),a=p.call(y,h)}return a}function Vs(a){return a=a[bs],a instanceof Xr?a:null}var Zi="__closure_events_fn_"+(1e9*Math.random()>>>0);function eo(a){return typeof a=="function"?a:(a[Zi]||(a[Zi]=function(h){return a.handleEvent(h)}),a[Zi])}function Qe(){se.call(this),this.i=new Xr(this),this.M=this,this.F=null}R(Qe,se),Qe.prototype[De]=!0,Qe.prototype.removeEventListener=function(a,h,p,y){Ji(this,a,h,p,y)};function nt(a,h){var p,y=a.F;if(y)for(p=[];y;y=y.F)p.push(y);if(a=a.M,y=h.type||h,typeof h=="string")h=new ce(h,a);else if(h instanceof ce)h.target=h.target||a;else{var k=h;h=new ce(y,a),E(h,k)}if(k=!0,p)for(var j=p.length-1;0<=j;j--){var G=h.g=p[j];k=Os(G,y,!0,h)&&k}if(G=h.g=a,k=Os(G,y,!0,h)&&k,k=Os(G,y,!1,h)&&k,p)for(j=0;j<p.length;j++)G=h.g=p[j],k=Os(G,y,!1,h)&&k}Qe.prototype.N=function(){if(Qe.aa.N.call(this),this.i){var a=this.i,h;for(h in a.g){for(var p=a.g[h],y=0;y<p.length;y++)Jr(p[y]);delete a.g[h],a.h--}}this.F=null},Qe.prototype.K=function(a,h,p,y){return this.i.add(String(a),h,!1,p,y)},Qe.prototype.L=function(a,h,p,y){return this.i.add(String(a),h,!0,p,y)};function Os(a,h,p,y){if(h=a.i.g[String(h)],!h)return!0;h=h.concat();for(var k=!0,j=0;j<h.length;++j){var G=h[j];if(G&&!G.da&&G.capture==p){var ge=G.listener,st=G.ha||G.src;G.fa&&Ps(a.i,G),k=ge.call(st,y)!==!1&&k}}return k&&!y.defaultPrevented}function Ka(a,h,p){if(typeof a=="function")p&&(a=g(a,p));else if(a&&typeof a.handleEvent=="function")a=g(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:l.setTimeout(a,h||0)}function to(a){a.g=Ka(()=>{a.g=null,a.i&&(a.i=!1,to(a))},a.l);const h=a.h;a.h=null,a.m.apply(null,h)}class Uu extends se{constructor(h,p){super(),this.m=h,this.l=p,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:to(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Zr(a){se.call(this),this.h=a,this.g={}}R(Zr,se);var Qa=[];function Ya(a){z(a.g,function(h,p){this.g.hasOwnProperty(p)&&js(h)},a),a.g={}}Zr.prototype.N=function(){Zr.aa.N.call(this),Ya(this)},Zr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var no=l.JSON.stringify,Bu=l.JSON.parse,zu=class{stringify(a){return l.JSON.stringify(a,void 0)}parse(a){return l.JSON.parse(a,void 0)}};function ro(){}ro.prototype.h=null;function Ja(a){return a.h||(a.h=a.i())}function so(){}var nr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ls(){ce.call(this,"d")}R(Ls,ce);function B(){ce.call(this,"c")}R(B,ce);var O={},ne=null;function Z(){return ne=ne||new Qe}O.La="serverreachability";function rt(a){ce.call(this,O.La,a)}R(rt,ce);function _e(a){const h=Z();nt(h,new rt(h))}O.STAT_EVENT="statevent";function At(a,h){ce.call(this,O.STAT_EVENT,a),this.stat=h}R(At,ce);function Ye(a){const h=Z();nt(h,new At(h,a))}O.Ma="timingevent";function wm(a,h){ce.call(this,O.Ma,a),this.size=h}R(wm,ce);function io(a,h){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){a()},h)}function oo(){this.g=!0}oo.prototype.xa=function(){this.g=!1};function rx(a,h,p,y,k,j){a.info(function(){if(a.g)if(j)for(var G="",ge=j.split("&"),st=0;st<ge.length;st++){var fe=ge[st].split("=");if(1<fe.length){var dt=fe[0];fe=fe[1];var ft=dt.split("_");G=2<=ft.length&&ft[1]=="type"?G+(dt+"="+fe+"&"):G+(dt+"=redacted&")}}else G=null;else G=j;return"XMLHTTP REQ ("+y+") [attempt "+k+"]: "+h+`
`+p+`
`+G})}function sx(a,h,p,y,k,j,G){a.info(function(){return"XMLHTTP RESP ("+y+") [ attempt "+k+"]: "+h+`
`+p+`
`+j+" "+G})}function Ms(a,h,p,y){a.info(function(){return"XMLHTTP TEXT ("+h+"): "+ox(a,p)+(y?" "+y:"")})}function ix(a,h){a.info(function(){return"TIMEOUT: "+h})}oo.prototype.info=function(){};function ox(a,h){if(!a.g)return h;if(!h)return null;try{var p=JSON.parse(h);if(p){for(a=0;a<p.length;a++)if(Array.isArray(p[a])){var y=p[a];if(!(2>y.length)){var k=y[1];if(Array.isArray(k)&&!(1>k.length)){var j=k[0];if(j!="noop"&&j!="stop"&&j!="close")for(var G=1;G<k.length;G++)k[G]=""}}}}return no(p)}catch{return h}}var Xa={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Em={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},$u;function Za(){}R(Za,ro),Za.prototype.g=function(){return new XMLHttpRequest},Za.prototype.i=function(){return{}},$u=new Za;function rr(a,h,p,y){this.j=a,this.i=h,this.l=p,this.R=y||1,this.U=new Zr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new xm}function xm(){this.i=null,this.g="",this.h=!1}var Tm={},Gu={};function Hu(a,h,p){a.L=1,a.v=rl(Dn(h)),a.m=p,a.P=!0,Im(a,null)}function Im(a,h){a.F=Date.now(),el(a),a.A=Dn(a.v);var p=a.A,y=a.R;Array.isArray(y)||(y=[String(y)]),Mm(p.i,"t",y),a.C=0,p=a.j.J,a.h=new xm,a.g=ng(a.j,p?h:null,!a.m),0<a.O&&(a.M=new Uu(g(a.Y,a,a.g),a.O)),h=a.U,p=a.g,y=a.ca;var k="readystatechange";Array.isArray(k)||(k&&(Qa[0]=k.toString()),k=Qa);for(var j=0;j<k.length;j++){var G=Ki(p,k[j],y||h.handleEvent,!1,h.h||h);if(!G)break;h.g[G.key]=G}h=a.H?_(a.H):{},a.m?(a.u||(a.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,h)):(a.u="GET",a.g.ea(a.A,a.u,null,h)),_e(),rx(a.i,a.u,a.A,a.l,a.R,a.m)}rr.prototype.ca=function(a){a=a.target;const h=this.M;h&&jn(a)==3?h.j():this.Y(a)},rr.prototype.Y=function(a){try{if(a==this.g)e:{const ft=jn(this.g);var h=this.g.Ba();const Bs=this.g.Z();if(!(3>ft)&&(ft!=3||this.g&&(this.h.h||this.g.oa()||Hm(this.g)))){this.J||ft!=4||h==7||(h==8||0>=Bs?_e(3):_e(2)),Wu(this);var p=this.g.Z();this.X=p;t:if(Sm(this)){var y=Hm(this.g);a="";var k=y.length,j=jn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){es(this),ao(this);var G="";break t}this.h.i=new l.TextDecoder}for(h=0;h<k;h++)this.h.h=!0,a+=this.h.i.decode(y[h],{stream:!(j&&h==k-1)});y.length=0,this.h.g+=a,this.C=0,G=this.h.g}else G=this.g.oa();if(this.o=p==200,sx(this.i,this.u,this.A,this.l,this.R,ft,p),this.o){if(this.T&&!this.K){t:{if(this.g){var ge,st=this.g;if((ge=st.g?st.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!v(ge)){var fe=ge;break t}}fe=null}if(p=fe)Ms(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,qu(this,p);else{this.o=!1,this.s=3,Ye(12),es(this),ao(this);break e}}if(this.P){p=!0;let nn;for(;!this.J&&this.C<G.length;)if(nn=ax(this,G),nn==Gu){ft==4&&(this.s=4,Ye(14),p=!1),Ms(this.i,this.l,null,"[Incomplete Response]");break}else if(nn==Tm){this.s=4,Ye(15),Ms(this.i,this.l,G,"[Invalid Chunk]"),p=!1;break}else Ms(this.i,this.l,nn,null),qu(this,nn);if(Sm(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ft!=4||G.length!=0||this.h.h||(this.s=1,Ye(16),p=!1),this.o=this.o&&p,!p)Ms(this.i,this.l,G,"[Invalid Chunked Response]"),es(this),ao(this);else if(0<G.length&&!this.W){this.W=!0;var dt=this.j;dt.g==this&&dt.ba&&!dt.M&&(dt.j.info("Great, no buffering proxy detected. Bytes received: "+G.length),Zu(dt),dt.M=!0,Ye(11))}}else Ms(this.i,this.l,G,null),qu(this,G);ft==4&&es(this),this.o&&!this.J&&(ft==4?Xm(this.j,this):(this.o=!1,el(this)))}else Ix(this.g),p==400&&0<G.indexOf("Unknown SID")?(this.s=3,Ye(12)):(this.s=0,Ye(13)),es(this),ao(this)}}}catch{}finally{}};function Sm(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function ax(a,h){var p=a.C,y=h.indexOf(`
`,p);return y==-1?Gu:(p=Number(h.substring(p,y)),isNaN(p)?Tm:(y+=1,y+p>h.length?Gu:(h=h.slice(y,y+p),a.C=y+p,h)))}rr.prototype.cancel=function(){this.J=!0,es(this)};function el(a){a.S=Date.now()+a.I,Cm(a,a.I)}function Cm(a,h){if(a.B!=null)throw Error("WatchDog timer not null");a.B=io(g(a.ba,a),h)}function Wu(a){a.B&&(l.clearTimeout(a.B),a.B=null)}rr.prototype.ba=function(){this.B=null;const a=Date.now();0<=a-this.S?(ix(this.i,this.A),this.L!=2&&(_e(),Ye(17)),es(this),this.s=2,ao(this)):Cm(this,this.S-a)};function ao(a){a.j.G==0||a.J||Xm(a.j,a)}function es(a){Wu(a);var h=a.M;h&&typeof h.ma=="function"&&h.ma(),a.M=null,Ya(a.U),a.g&&(h=a.g,a.g=null,h.abort(),h.ma())}function qu(a,h){try{var p=a.j;if(p.G!=0&&(p.g==a||Ku(p.h,a))){if(!a.K&&Ku(p.h,a)&&p.G==3){try{var y=p.Da.g.parse(h)}catch{y=null}if(Array.isArray(y)&&y.length==3){var k=y;if(k[0]==0){e:if(!p.u){if(p.g)if(p.g.F+3e3<a.F)cl(p),al(p);else break e;Xu(p),Ye(18)}}else p.za=k[1],0<p.za-p.T&&37500>k[2]&&p.F&&p.v==0&&!p.C&&(p.C=io(g(p.Za,p),6e3));if(1>=Am(p.h)&&p.ca){try{p.ca()}catch{}p.ca=void 0}}else ns(p,11)}else if((a.K||p.g==a)&&cl(p),!v(h))for(k=p.Da.g.parse(h),h=0;h<k.length;h++){let fe=k[h];if(p.T=fe[0],fe=fe[1],p.G==2)if(fe[0]=="c"){p.K=fe[1],p.ia=fe[2];const dt=fe[3];dt!=null&&(p.la=dt,p.j.info("VER="+p.la));const ft=fe[4];ft!=null&&(p.Aa=ft,p.j.info("SVER="+p.Aa));const Bs=fe[5];Bs!=null&&typeof Bs=="number"&&0<Bs&&(y=1.5*Bs,p.L=y,p.j.info("backChannelRequestTimeoutMs_="+y)),y=p;const nn=a.g;if(nn){const hl=nn.g?nn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(hl){var j=y.h;j.g||hl.indexOf("spdy")==-1&&hl.indexOf("quic")==-1&&hl.indexOf("h2")==-1||(j.j=j.l,j.g=new Set,j.h&&(Qu(j,j.h),j.h=null))}if(y.D){const eh=nn.g?nn.g.getResponseHeader("X-HTTP-Session-Id"):null;eh&&(y.ya=eh,we(y.I,y.D,eh))}}p.G=3,p.l&&p.l.ua(),p.ba&&(p.R=Date.now()-a.F,p.j.info("Handshake RTT: "+p.R+"ms")),y=p;var G=a;if(y.qa=tg(y,y.J?y.ia:null,y.W),G.K){Pm(y.h,G);var ge=G,st=y.L;st&&(ge.I=st),ge.B&&(Wu(ge),el(ge)),y.g=G}else Ym(y);0<p.i.length&&ll(p)}else fe[0]!="stop"&&fe[0]!="close"||ns(p,7);else p.G==3&&(fe[0]=="stop"||fe[0]=="close"?fe[0]=="stop"?ns(p,7):Ju(p):fe[0]!="noop"&&p.l&&p.l.ta(fe),p.v=0)}}_e(4)}catch{}}var lx=class{constructor(a,h){this.g=a,this.map=h}};function Rm(a){this.l=a||10,l.PerformanceNavigationTiming?(a=l.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Nm(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function Am(a){return a.h?1:a.g?a.g.size:0}function Ku(a,h){return a.h?a.h==h:a.g?a.g.has(h):!1}function Qu(a,h){a.g?a.g.add(h):a.h=h}function Pm(a,h){a.h&&a.h==h?a.h=null:a.g&&a.g.has(h)&&a.g.delete(h)}Rm.prototype.cancel=function(){if(this.i=km(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const a of this.g.values())a.cancel();this.g.clear()}};function km(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let h=a.i;for(const p of a.g.values())h=h.concat(p.D);return h}return N(a.i)}function cx(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(c(a)){for(var h=[],p=a.length,y=0;y<p;y++)h.push(a[y]);return h}h=[],p=0;for(y in a)h[p++]=a[y];return h}function ux(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(c(a)||typeof a=="string"){var h=[];a=a.length;for(var p=0;p<a;p++)h.push(p);return h}h=[],p=0;for(const y in a)h[p++]=y;return h}}}function bm(a,h){if(a.forEach&&typeof a.forEach=="function")a.forEach(h,void 0);else if(c(a)||typeof a=="string")Array.prototype.forEach.call(a,h,void 0);else for(var p=ux(a),y=cx(a),k=y.length,j=0;j<k;j++)h.call(void 0,y[j],p&&p[j],a)}var Dm=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function hx(a,h){if(a){a=a.split("&");for(var p=0;p<a.length;p++){var y=a[p].indexOf("="),k=null;if(0<=y){var j=a[p].substring(0,y);k=a[p].substring(y+1)}else j=a[p];h(j,k?decodeURIComponent(k.replace(/\+/g," ")):"")}}}function ts(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof ts){this.h=a.h,tl(this,a.j),this.o=a.o,this.g=a.g,nl(this,a.s),this.l=a.l;var h=a.i,p=new uo;p.i=h.i,h.g&&(p.g=new Map(h.g),p.h=h.h),jm(this,p),this.m=a.m}else a&&(h=String(a).match(Dm))?(this.h=!1,tl(this,h[1]||"",!0),this.o=lo(h[2]||""),this.g=lo(h[3]||"",!0),nl(this,h[4]),this.l=lo(h[5]||"",!0),jm(this,h[6]||"",!0),this.m=lo(h[7]||"")):(this.h=!1,this.i=new uo(null,this.h))}ts.prototype.toString=function(){var a=[],h=this.j;h&&a.push(co(h,Vm,!0),":");var p=this.g;return(p||h=="file")&&(a.push("//"),(h=this.o)&&a.push(co(h,Vm,!0),"@"),a.push(encodeURIComponent(String(p)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.s,p!=null&&a.push(":",String(p))),(p=this.l)&&(this.g&&p.charAt(0)!="/"&&a.push("/"),a.push(co(p,p.charAt(0)=="/"?px:fx,!0))),(p=this.i.toString())&&a.push("?",p),(p=this.m)&&a.push("#",co(p,gx)),a.join("")};function Dn(a){return new ts(a)}function tl(a,h,p){a.j=p?lo(h,!0):h,a.j&&(a.j=a.j.replace(/:$/,""))}function nl(a,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);a.s=h}else a.s=null}function jm(a,h,p){h instanceof uo?(a.i=h,yx(a.i,a.h)):(p||(h=co(h,mx)),a.i=new uo(h,a.h))}function we(a,h,p){a.i.set(h,p)}function rl(a){return we(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function lo(a,h){return a?h?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function co(a,h,p){return typeof a=="string"?(a=encodeURI(a).replace(h,dx),p&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function dx(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Vm=/[#\/\?@]/g,fx=/[#\?:]/g,px=/[#\?]/g,mx=/[#\?@]/g,gx=/#/g;function uo(a,h){this.h=this.g=null,this.i=a||null,this.j=!!h}function sr(a){a.g||(a.g=new Map,a.h=0,a.i&&hx(a.i,function(h,p){a.add(decodeURIComponent(h.replace(/\+/g," ")),p)}))}t=uo.prototype,t.add=function(a,h){sr(this),this.i=null,a=Fs(this,a);var p=this.g.get(a);return p||this.g.set(a,p=[]),p.push(h),this.h+=1,this};function Om(a,h){sr(a),h=Fs(a,h),a.g.has(h)&&(a.i=null,a.h-=a.g.get(h).length,a.g.delete(h))}function Lm(a,h){return sr(a),h=Fs(a,h),a.g.has(h)}t.forEach=function(a,h){sr(this),this.g.forEach(function(p,y){p.forEach(function(k){a.call(h,k,y,this)},this)},this)},t.na=function(){sr(this);const a=Array.from(this.g.values()),h=Array.from(this.g.keys()),p=[];for(let y=0;y<h.length;y++){const k=a[y];for(let j=0;j<k.length;j++)p.push(h[y])}return p},t.V=function(a){sr(this);let h=[];if(typeof a=="string")Lm(this,a)&&(h=h.concat(this.g.get(Fs(this,a))));else{a=Array.from(this.g.values());for(let p=0;p<a.length;p++)h=h.concat(a[p])}return h},t.set=function(a,h){return sr(this),this.i=null,a=Fs(this,a),Lm(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[h]),this.h+=1,this},t.get=function(a,h){return a?(a=this.V(a),0<a.length?String(a[0]):h):h};function Mm(a,h,p){Om(a,h),0<p.length&&(a.i=null,a.g.set(Fs(a,h),N(p)),a.h+=p.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const a=[],h=Array.from(this.g.keys());for(var p=0;p<h.length;p++){var y=h[p];const j=encodeURIComponent(String(y)),G=this.V(y);for(y=0;y<G.length;y++){var k=j;G[y]!==""&&(k+="="+encodeURIComponent(String(G[y]))),a.push(k)}}return this.i=a.join("&")};function Fs(a,h){return h=String(h),a.j&&(h=h.toLowerCase()),h}function yx(a,h){h&&!a.j&&(sr(a),a.i=null,a.g.forEach(function(p,y){var k=y.toLowerCase();y!=k&&(Om(this,y),Mm(this,k,p))},a)),a.j=h}function vx(a,h){const p=new oo;if(l.Image){const y=new Image;y.onload=w(ir,p,"TestLoadImage: loaded",!0,h,y),y.onerror=w(ir,p,"TestLoadImage: error",!1,h,y),y.onabort=w(ir,p,"TestLoadImage: abort",!1,h,y),y.ontimeout=w(ir,p,"TestLoadImage: timeout",!1,h,y),l.setTimeout(function(){y.ontimeout&&y.ontimeout()},1e4),y.src=a}else h(!1)}function _x(a,h){const p=new oo,y=new AbortController,k=setTimeout(()=>{y.abort(),ir(p,"TestPingServer: timeout",!1,h)},1e4);fetch(a,{signal:y.signal}).then(j=>{clearTimeout(k),j.ok?ir(p,"TestPingServer: ok",!0,h):ir(p,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(k),ir(p,"TestPingServer: error",!1,h)})}function ir(a,h,p,y,k){try{k&&(k.onload=null,k.onerror=null,k.onabort=null,k.ontimeout=null),y(p)}catch{}}function wx(){this.g=new zu}function Ex(a,h,p){const y=p||"";try{bm(a,function(k,j){let G=k;u(k)&&(G=no(k)),h.push(y+j+"="+encodeURIComponent(G))})}catch(k){throw h.push(y+"type="+encodeURIComponent("_badmap")),k}}function sl(a){this.l=a.Ub||null,this.j=a.eb||!1}R(sl,ro),sl.prototype.g=function(){return new il(this.l,this.j)},sl.prototype.i=function(a){return function(){return a}}({});function il(a,h){Qe.call(this),this.D=a,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}R(il,Qe),t=il.prototype,t.open=function(a,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=h,this.readyState=1,fo(this)},t.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(h.body=a),(this.D||l).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ho(this)),this.readyState=0},t.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,fo(this)),this.g&&(this.readyState=3,fo(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Fm(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function Fm(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}t.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var h=a.value?a.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!a.done}))&&(this.response=this.responseText+=h)}a.done?ho(this):fo(this),this.readyState==3&&Fm(this)}},t.Ra=function(a){this.g&&(this.response=this.responseText=a,ho(this))},t.Qa=function(a){this.g&&(this.response=a,ho(this))},t.ga=function(){this.g&&ho(this)};function ho(a){a.readyState=4,a.l=null,a.j=null,a.v=null,fo(a)}t.setRequestHeader=function(a,h){this.u.append(a,h)},t.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const a=[],h=this.h.entries();for(var p=h.next();!p.done;)p=p.value,a.push(p[0]+": "+p[1]),p=h.next();return a.join(`\r
`)};function fo(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(il.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function Um(a){let h="";return z(a,function(p,y){h+=y,h+=":",h+=p,h+=`\r
`}),h}function Yu(a,h,p){e:{for(y in p){var y=!1;break e}y=!0}y||(p=Um(p),typeof a=="string"?p!=null&&encodeURIComponent(String(p)):we(a,h,p))}function Ne(a){Qe.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}R(Ne,Qe);var xx=/^https?$/i,Tx=["POST","PUT"];t=Ne.prototype,t.Ha=function(a){this.J=a},t.ea=function(a,h,p,y){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);h=h?h.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():$u.g(),this.v=this.o?Ja(this.o):Ja($u),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(h,String(a),!0),this.B=!1}catch(j){Bm(this,j);return}if(a=p||"",p=new Map(this.headers),y)if(Object.getPrototypeOf(y)===Object.prototype)for(var k in y)p.set(k,y[k]);else if(typeof y.keys=="function"&&typeof y.get=="function")for(const j of y.keys())p.set(j,y.get(j));else throw Error("Unknown input type for opt_headers: "+String(y));y=Array.from(p.keys()).find(j=>j.toLowerCase()=="content-type"),k=l.FormData&&a instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Tx,h,void 0))||y||k||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[j,G]of p)this.g.setRequestHeader(j,G);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Gm(this),this.u=!0,this.g.send(a),this.u=!1}catch(j){Bm(this,j)}};function Bm(a,h){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=h,a.m=5,zm(a),ol(a)}function zm(a){a.A||(a.A=!0,nt(a,"complete"),nt(a,"error"))}t.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,nt(this,"complete"),nt(this,"abort"),ol(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ol(this,!0)),Ne.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?$m(this):this.bb())},t.bb=function(){$m(this)};function $m(a){if(a.h&&typeof o<"u"&&(!a.v[1]||jn(a)!=4||a.Z()!=2)){if(a.u&&jn(a)==4)Ka(a.Ea,0,a);else if(nt(a,"readystatechange"),jn(a)==4){a.h=!1;try{const G=a.Z();e:switch(G){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var p;if(!(p=h)){var y;if(y=G===0){var k=String(a.D).match(Dm)[1]||null;!k&&l.self&&l.self.location&&(k=l.self.location.protocol.slice(0,-1)),y=!xx.test(k?k.toLowerCase():"")}p=y}if(p)nt(a,"complete"),nt(a,"success");else{a.m=6;try{var j=2<jn(a)?a.g.statusText:""}catch{j=""}a.l=j+" ["+a.Z()+"]",zm(a)}}finally{ol(a)}}}}function ol(a,h){if(a.g){Gm(a);const p=a.g,y=a.v[0]?()=>{}:null;a.g=null,a.v=null,h||nt(a,"ready");try{p.onreadystatechange=y}catch{}}}function Gm(a){a.I&&(l.clearTimeout(a.I),a.I=null)}t.isActive=function(){return!!this.g};function jn(a){return a.g?a.g.readyState:0}t.Z=function(){try{return 2<jn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(a){if(this.g){var h=this.g.responseText;return a&&h.indexOf(a)==0&&(h=h.substring(a.length)),Bu(h)}};function Hm(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function Ix(a){const h={};a=(a.g&&2<=jn(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let y=0;y<a.length;y++){if(v(a[y]))continue;var p=A(a[y]);const k=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();const j=h[k]||[];h[k]=j,j.push(p)}T(h,function(y){return y.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function po(a,h,p){return p&&p.internalChannelParams&&p.internalChannelParams[a]||h}function Wm(a){this.Aa=0,this.i=[],this.j=new oo,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=po("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=po("baseRetryDelayMs",5e3,a),this.cb=po("retryDelaySeedMs",1e4,a),this.Wa=po("forwardChannelMaxRetries",2,a),this.wa=po("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new Rm(a&&a.concurrentRequestLimit),this.Da=new wx,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Wm.prototype,t.la=8,t.G=1,t.connect=function(a,h,p,y){Ye(0),this.W=a,this.H=h||{},p&&y!==void 0&&(this.H.OSID=p,this.H.OAID=y),this.F=this.X,this.I=tg(this,null,this.W),ll(this)};function Ju(a){if(qm(a),a.G==3){var h=a.U++,p=Dn(a.I);if(we(p,"SID",a.K),we(p,"RID",h),we(p,"TYPE","terminate"),mo(a,p),h=new rr(a,a.j,h),h.L=2,h.v=rl(Dn(p)),p=!1,l.navigator&&l.navigator.sendBeacon)try{p=l.navigator.sendBeacon(h.v.toString(),"")}catch{}!p&&l.Image&&(new Image().src=h.v,p=!0),p||(h.g=ng(h.j,null),h.g.ea(h.v)),h.F=Date.now(),el(h)}eg(a)}function al(a){a.g&&(Zu(a),a.g.cancel(),a.g=null)}function qm(a){al(a),a.u&&(l.clearTimeout(a.u),a.u=null),cl(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&l.clearTimeout(a.s),a.s=null)}function ll(a){if(!Nm(a.h)&&!a.s){a.s=!0;var h=a.Ga;xt||q(),W||(xt(),W=!0),$.add(h,a),a.B=0}}function Sx(a,h){return Am(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=h.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=io(g(a.Ga,a,h),Zm(a,a.B)),a.B++,!0)}t.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;const k=new rr(this,this.j,a);let j=this.o;if(this.S&&(j?(j=_(j),E(j,this.S)):j=this.S),this.m!==null||this.O||(k.H=j,j=null),this.P)e:{for(var h=0,p=0;p<this.i.length;p++){t:{var y=this.i[p];if("__data__"in y.map&&(y=y.map.__data__,typeof y=="string")){y=y.length;break t}y=void 0}if(y===void 0)break;if(h+=y,4096<h){h=p;break e}if(h===4096||p===this.i.length-1){h=p+1;break e}}h=1e3}else h=1e3;h=Qm(this,k,h),p=Dn(this.I),we(p,"RID",a),we(p,"CVER",22),this.D&&we(p,"X-HTTP-Session-Id",this.D),mo(this,p),j&&(this.O?h="headers="+encodeURIComponent(String(Um(j)))+"&"+h:this.m&&Yu(p,this.m,j)),Qu(this.h,k),this.Ua&&we(p,"TYPE","init"),this.P?(we(p,"$req",h),we(p,"SID","null"),k.T=!0,Hu(k,p,null)):Hu(k,p,h),this.G=2}}else this.G==3&&(a?Km(this,a):this.i.length==0||Nm(this.h)||Km(this))};function Km(a,h){var p;h?p=h.l:p=a.U++;const y=Dn(a.I);we(y,"SID",a.K),we(y,"RID",p),we(y,"AID",a.T),mo(a,y),a.m&&a.o&&Yu(y,a.m,a.o),p=new rr(a,a.j,p,a.B+1),a.m===null&&(p.H=a.o),h&&(a.i=h.D.concat(a.i)),h=Qm(a,p,1e3),p.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),Qu(a.h,p),Hu(p,y,h)}function mo(a,h){a.H&&z(a.H,function(p,y){we(h,y,p)}),a.l&&bm({},function(p,y){we(h,y,p)})}function Qm(a,h,p){p=Math.min(a.i.length,p);var y=a.l?g(a.l.Na,a.l,a):null;e:{var k=a.i;let j=-1;for(;;){const G=["count="+p];j==-1?0<p?(j=k[0].g,G.push("ofs="+j)):j=0:G.push("ofs="+j);let ge=!0;for(let st=0;st<p;st++){let fe=k[st].g;const dt=k[st].map;if(fe-=j,0>fe)j=Math.max(0,k[st].g-100),ge=!1;else try{Ex(dt,G,"req"+fe+"_")}catch{y&&y(dt)}}if(ge){y=G.join("&");break e}}}return a=a.i.splice(0,p),h.D=a,y}function Ym(a){if(!a.g&&!a.u){a.Y=1;var h=a.Fa;xt||q(),W||(xt(),W=!0),$.add(h,a),a.v=0}}function Xu(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=io(g(a.Fa,a),Zm(a,a.v)),a.v++,!0)}t.Fa=function(){if(this.u=null,Jm(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=io(g(this.ab,this),a)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ye(10),al(this),Jm(this))};function Zu(a){a.A!=null&&(l.clearTimeout(a.A),a.A=null)}function Jm(a){a.g=new rr(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var h=Dn(a.qa);we(h,"RID","rpc"),we(h,"SID",a.K),we(h,"AID",a.T),we(h,"CI",a.F?"0":"1"),!a.F&&a.ja&&we(h,"TO",a.ja),we(h,"TYPE","xmlhttp"),mo(a,h),a.m&&a.o&&Yu(h,a.m,a.o),a.L&&(a.g.I=a.L);var p=a.g;a=a.ia,p.L=1,p.v=rl(Dn(h)),p.m=null,p.P=!0,Im(p,a)}t.Za=function(){this.C!=null&&(this.C=null,al(this),Xu(this),Ye(19))};function cl(a){a.C!=null&&(l.clearTimeout(a.C),a.C=null)}function Xm(a,h){var p=null;if(a.g==h){cl(a),Zu(a),a.g=null;var y=2}else if(Ku(a.h,h))p=h.D,Pm(a.h,h),y=1;else return;if(a.G!=0){if(h.o)if(y==1){p=h.m?h.m.length:0,h=Date.now()-h.F;var k=a.B;y=Z(),nt(y,new wm(y,p)),ll(a)}else Ym(a);else if(k=h.s,k==3||k==0&&0<h.X||!(y==1&&Sx(a,h)||y==2&&Xu(a)))switch(p&&0<p.length&&(h=a.h,h.i=h.i.concat(p)),k){case 1:ns(a,5);break;case 4:ns(a,10);break;case 3:ns(a,6);break;default:ns(a,2)}}}function Zm(a,h){let p=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(p*=2),p*h}function ns(a,h){if(a.j.info("Error code "+h),h==2){var p=g(a.fb,a),y=a.Xa;const k=!y;y=new ts(y||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||tl(y,"https"),rl(y),k?vx(y.toString(),p):_x(y.toString(),p)}else Ye(2);a.G=0,a.l&&a.l.sa(h),eg(a),qm(a)}t.fb=function(a){a?(this.j.info("Successfully pinged google.com"),Ye(2)):(this.j.info("Failed to ping google.com"),Ye(1))};function eg(a){if(a.G=0,a.ka=[],a.l){const h=km(a.h);(h.length!=0||a.i.length!=0)&&(P(a.ka,h),P(a.ka,a.i),a.h.i.length=0,N(a.i),a.i.length=0),a.l.ra()}}function tg(a,h,p){var y=p instanceof ts?Dn(p):new ts(p);if(y.g!="")h&&(y.g=h+"."+y.g),nl(y,y.s);else{var k=l.location;y=k.protocol,h=h?h+"."+k.hostname:k.hostname,k=+k.port;var j=new ts(null);y&&tl(j,y),h&&(j.g=h),k&&nl(j,k),p&&(j.l=p),y=j}return p=a.D,h=a.ya,p&&h&&we(y,p,h),we(y,"VER",a.la),mo(a,y),y}function ng(a,h,p){if(h&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=a.Ca&&!a.pa?new Ne(new sl({eb:p})):new Ne(a.pa),h.Ha(a.J),h}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function rg(){}t=rg.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function ul(){}ul.prototype.g=function(a,h){return new Ft(a,h)};function Ft(a,h){Qe.call(this),this.g=new Wm(h),this.l=a,this.h=h&&h.messageUrlParams||null,a=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(a?a["X-WebChannel-Content-Type"]=h.messageContentType:a={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(a?a["X-WebChannel-Client-Profile"]=h.va:a={"X-WebChannel-Client-Profile":h.va}),this.g.S=a,(a=h&&h.Sb)&&!v(a)&&(this.g.m=a),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!v(h)&&(this.g.D=h,a=this.h,a!==null&&h in a&&(a=this.h,h in a&&delete a[h])),this.j=new Us(this)}R(Ft,Qe),Ft.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ft.prototype.close=function(){Ju(this.g)},Ft.prototype.o=function(a){var h=this.g;if(typeof a=="string"){var p={};p.__data__=a,a=p}else this.u&&(p={},p.__data__=no(a),a=p);h.i.push(new lx(h.Ya++,a)),h.G==3&&ll(h)},Ft.prototype.N=function(){this.g.l=null,delete this.j,Ju(this.g),delete this.g,Ft.aa.N.call(this)};function sg(a){Ls.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var h=a.__sm__;if(h){e:{for(const p in h){a=p;break e}a=void 0}(this.i=a)&&(a=this.i,h=h!==null&&a in h?h[a]:void 0),this.data=h}else this.data=a}R(sg,Ls);function ig(){B.call(this),this.status=1}R(ig,B);function Us(a){this.g=a}R(Us,rg),Us.prototype.ua=function(){nt(this.g,"a")},Us.prototype.ta=function(a){nt(this.g,new sg(a))},Us.prototype.sa=function(a){nt(this.g,new ig)},Us.prototype.ra=function(){nt(this.g,"b")},ul.prototype.createWebChannel=ul.prototype.g,Ft.prototype.send=Ft.prototype.o,Ft.prototype.open=Ft.prototype.m,Ft.prototype.close=Ft.prototype.close,Rw=function(){return new ul},Cw=function(){return Z()},Sw=O,Zd={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Xa.NO_ERROR=0,Xa.TIMEOUT=8,Xa.HTTP_ERROR=6,Zl=Xa,Em.COMPLETE="complete",Iw=Em,so.EventType=nr,nr.OPEN="a",nr.CLOSE="b",nr.ERROR="c",nr.MESSAGE="d",Qe.prototype.listen=Qe.prototype.K,ko=so,Ne.prototype.listenOnce=Ne.prototype.L,Ne.prototype.getLastError=Ne.prototype.Ka,Ne.prototype.getLastErrorCode=Ne.prototype.Ba,Ne.prototype.getStatus=Ne.prototype.Z,Ne.prototype.getResponseJson=Ne.prototype.Oa,Ne.prototype.getResponseText=Ne.prototype.oa,Ne.prototype.send=Ne.prototype.ea,Ne.prototype.setWithCredentials=Ne.prototype.Ha,Tw=Ne}).apply(typeof Pl<"u"?Pl:typeof self<"u"?self:typeof window<"u"?window:{});const tv="@firebase/firestore",nv="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}yt.UNAUTHENTICATED=new yt(null),yt.GOOGLE_CREDENTIALS=new yt("google-credentials-uid"),yt.FIRST_PARTY=new yt("first-party-uid"),yt.MOCK_USER=new yt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ui="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ts=new wp("@firebase/firestore");function Gs(){return Ts.logLevel}function K(t,...e){if(Ts.logLevel<=oe.DEBUG){const n=e.map(bp);Ts.debug(`Firestore (${Ui}): ${t}`,...n)}}function Jn(t,...e){if(Ts.logLevel<=oe.ERROR){const n=e.map(bp);Ts.error(`Firestore (${Ui}): ${t}`,...n)}}function Ci(t,...e){if(Ts.logLevel<=oe.WARN){const n=e.map(bp);Ts.warn(`Firestore (${Ui}): ${t}`,...n)}}function bp(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,Nw(t,r,n)}function Nw(t,e,n){let r=`FIRESTORE (${Ui}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Jn(r),new Error(r)}function pe(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||Nw(e,s,r)}function ee(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class H extends tr{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aw{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class xA{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(yt.UNAUTHENTICATED))}shutdown(){}}class TA{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class IA{constructor(e){this.t=e,this.currentUser=yt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){pe(this.o===void 0,42304);let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new Gn;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Gn,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},l=c=>{K("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(K("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Gn)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(K("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(pe(typeof r.accessToken=="string",31837,{l:r}),new Aw(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return pe(e===null||typeof e=="string",2055,{h:e}),new yt(e)}}class SA{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=yt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class CA{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new SA(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(yt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class rv{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class RA{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ln(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){pe(this.o===void 0,3512);const r=i=>{i.error!=null&&K("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,K("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{K("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):K("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new rv(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(pe(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new rv(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NA(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dp{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=NA(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function ae(t,e){return t<e?-1:t>e?1:0}function ef(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const s=t.charAt(r),i=e.charAt(r);if(s!==i)return Lh(s)===Lh(i)?ae(s,i):Lh(s)?1:-1}return ae(t.length,e.length)}const AA=55296,PA=57343;function Lh(t){const e=t.charCodeAt(0);return e>=AA&&e<=PA}function Ri(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sv="__name__";class wn{constructor(e,n,r){n===void 0?n=0:n>e.length&&J(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&J(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return wn.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof wn?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=wn.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return ae(e.length,n.length)}static compareSegments(e,n){const r=wn.isNumericId(e),s=wn.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?wn.extractNumericId(e).compare(wn.extractNumericId(n)):ef(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return br.fromString(e.substring(4,e.length-2))}}class ye extends wn{construct(e,n,r){return new ye(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new H(V.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new ye(n)}static emptyPath(){return new ye([])}}const kA=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class lt extends wn{construct(e,n,r){return new lt(e,n,r)}static isValidIdentifier(e){return kA.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),lt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===sv}static keyField(){return new lt([sv])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new H(V.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new H(V.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new H(V.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(r+=l,s++):(i(),s++)}if(i(),o)throw new H(V.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new lt(n)}static emptyPath(){return new lt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y{constructor(e){this.path=e}static fromPath(e){return new Y(ye.fromString(e))}static fromName(e){return new Y(ye.fromString(e).popFirst(5))}static empty(){return new Y(ye.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ye.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ye.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Y(new ye(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pw(t,e,n){if(!n)throw new H(V.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function bA(t,e,n,r){if(e===!0&&r===!0)throw new H(V.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function iv(t){if(!Y.isDocumentKey(t))throw new H(V.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function ov(t){if(Y.isDocumentKey(t))throw new H(V.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function kw(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Su(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":J(12329,{type:typeof t})}function Ct(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new H(V.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Su(t);throw new H(V.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ze(t,e){const n={typeString:t};return e&&(n.value=e),n}function Fa(t,e){if(!kw(t))throw new H(V.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(s&&typeof o!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new H(V.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const av=-62135596800,lv=1e6;class he{static now(){return he.fromMillis(Date.now())}static fromDate(e){return he.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*lv);return new he(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new H(V.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new H(V.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<av)throw new H(V.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new H(V.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/lv}_compareTo(e){return this.seconds===e.seconds?ae(this.nanoseconds,e.nanoseconds):ae(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:he._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Fa(e,he._jsonSchema))return new he(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-av;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}he._jsonSchemaVersion="firestore/timestamp/1.0",he._jsonSchema={type:ze("string",he._jsonSchemaVersion),seconds:ze("number"),nanoseconds:ze("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class te{static fromTimestamp(e){return new te(e)}static min(){return new te(new he(0,0))}static max(){return new te(new he(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _a=-1;function DA(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=te.fromTimestamp(r===1e9?new he(n+1,0):new he(n,r));return new Lr(s,Y.empty(),e)}function jA(t){return new Lr(t.readTime,t.key,_a)}class Lr{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Lr(te.min(),Y.empty(),_a)}static max(){return new Lr(te.max(),Y.empty(),_a)}}function VA(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Y.comparator(t.documentKey,e.documentKey),n!==0?n:ae(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OA="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class LA{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bi(t){if(t.code!==V.FAILED_PRECONDITION||t.message!==OA)throw t;K("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&J(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new M((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof M?n:M.resolve(n)}catch(n){return M.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):M.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):M.reject(n)}static resolve(e){return new M((n,r)=>{n(e)})}static reject(e){return new M((n,r)=>{r(e)})}static waitFor(e){return new M((n,r)=>{let s=0,i=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++i,o&&i===s&&n()},c=>r(c))}),o=!0,i===s&&n()})}static or(e){let n=M.resolve(!1);for(const r of e)n=n.next(s=>s?M.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new M((r,s)=>{const i=e.length,o=new Array(i);let l=0;for(let c=0;c<i;c++){const u=c;n(e[u]).next(f=>{o[u]=f,++l,l===i&&r(o)},f=>s(f))}})}static doWhile(e,n){return new M((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function MA(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function zi(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cu{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Cu.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jp=-1;function Ru(t){return t==null}function $c(t){return t===0&&1/t==-1/0}function FA(t){return typeof t=="number"&&Number.isInteger(t)&&!$c(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bw="";function UA(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=cv(e)),e=BA(t.get(n),e);return cv(e)}function BA(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case bw:n+="";break;default:n+=i}}return n}function cv(t){return t+bw+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uv(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function qr(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Dw(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Re{constructor(e,n){this.comparator=e,this.root=n||at.EMPTY}insert(e,n){return new Re(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,at.BLACK,null,null))}remove(e){return new Re(this.comparator,this.root.remove(e,this.comparator).copy(null,null,at.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new kl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new kl(this.root,e,this.comparator,!1)}getReverseIterator(){return new kl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new kl(this.root,e,this.comparator,!0)}}class kl{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class at{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??at.RED,this.left=s??at.EMPTY,this.right=i??at.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new at(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return at.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return at.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,at.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,at.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw J(43730,{key:this.key,value:this.value});if(this.right.isRed())throw J(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw J(27949);return e+(this.isRed()?0:1)}}at.EMPTY=null,at.RED=!0,at.BLACK=!1;at.EMPTY=new class{constructor(){this.size=0}get key(){throw J(57766)}get value(){throw J(16141)}get color(){throw J(16727)}get left(){throw J(29726)}get right(){throw J(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new at(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class We{constructor(e){this.comparator=e,this.data=new Re(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new hv(this.data.getIterator())}getIteratorFrom(e){return new hv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof We)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new We(this.comparator);return n.data=e,n}}class hv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(e){this.fields=e,e.sort(lt.comparator)}static empty(){return new Gt([])}unionWith(e){let n=new We(lt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Gt(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Ri(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jw extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new jw("Invalid base64 string: "+i):i}}(e);return new ht(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new ht(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ae(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ht.EMPTY_BYTE_STRING=new ht("");const zA=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Mr(t){if(pe(!!t,39018),typeof t=="string"){let e=0;const n=zA.exec(t);if(pe(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ve(t.seconds),nanos:Ve(t.nanos)}}function Ve(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Fr(t){return typeof t=="string"?ht.fromBase64String(t):ht.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vw="server_timestamp",Ow="__type__",Lw="__previous_value__",Mw="__local_write_time__";function Vp(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[Ow])==null?void 0:r.stringValue)===Vw}function Nu(t){const e=t.mapValue.fields[Lw];return Vp(e)?Nu(e):e}function wa(t){const e=Mr(t.mapValue.fields[Mw].timestampValue);return new he(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $A{constructor(e,n,r,s,i,o,l,c,u,f){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u,this.isUsingEmulator=f}}const Ea="(default)";class xa{constructor(e,n){this.projectId=e,this.database=n||Ea}static empty(){return new xa("","")}get isDefaultDatabase(){return this.database===Ea}isEqual(e){return e instanceof xa&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fw="__type__",Uw="__max__",bl={mapValue:{fields:{__type__:{stringValue:Uw}}}},Bw="__vector__",Gc="value";function Ur(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Vp(t)?4:HA(t)?9007199254740991:GA(t)?10:11:J(28295,{value:t})}function kn(t,e){if(t===e)return!0;const n=Ur(t);if(n!==Ur(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return wa(t).isEqual(wa(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Mr(s.timestampValue),l=Mr(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Fr(s.bytesValue).isEqual(Fr(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Ve(s.geoPointValue.latitude)===Ve(i.geoPointValue.latitude)&&Ve(s.geoPointValue.longitude)===Ve(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Ve(s.integerValue)===Ve(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Ve(s.doubleValue),l=Ve(i.doubleValue);return o===l?$c(o)===$c(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return Ri(t.arrayValue.values||[],e.arrayValue.values||[],kn);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},l=i.mapValue.fields||{};if(uv(o)!==uv(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!kn(o[c],l[c])))return!1;return!0}(t,e);default:return J(52216,{left:t})}}function Ta(t,e){return(t.values||[]).find(n=>kn(n,e))!==void 0}function Ni(t,e){if(t===e)return 0;const n=Ur(t),r=Ur(e);if(n!==r)return ae(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ae(t.booleanValue,e.booleanValue);case 2:return function(i,o){const l=Ve(i.integerValue||i.doubleValue),c=Ve(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return dv(t.timestampValue,e.timestampValue);case 4:return dv(wa(t),wa(e));case 5:return ef(t.stringValue,e.stringValue);case 6:return function(i,o){const l=Fr(i),c=Fr(o);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),c=o.split("/");for(let u=0;u<l.length&&u<c.length;u++){const f=ae(l[u],c[u]);if(f!==0)return f}return ae(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const l=ae(Ve(i.latitude),Ve(o.latitude));return l!==0?l:ae(Ve(i.longitude),Ve(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return fv(t.arrayValue,e.arrayValue);case 10:return function(i,o){var g,w,R,N;const l=i.fields||{},c=o.fields||{},u=(g=l[Gc])==null?void 0:g.arrayValue,f=(w=c[Gc])==null?void 0:w.arrayValue,m=ae(((R=u==null?void 0:u.values)==null?void 0:R.length)||0,((N=f==null?void 0:f.values)==null?void 0:N.length)||0);return m!==0?m:fv(u,f)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===bl.mapValue&&o===bl.mapValue)return 0;if(i===bl.mapValue)return 1;if(o===bl.mapValue)return-1;const l=i.fields||{},c=Object.keys(l),u=o.fields||{},f=Object.keys(u);c.sort(),f.sort();for(let m=0;m<c.length&&m<f.length;++m){const g=ef(c[m],f[m]);if(g!==0)return g;const w=Ni(l[c[m]],u[f[m]]);if(w!==0)return w}return ae(c.length,f.length)}(t.mapValue,e.mapValue);default:throw J(23264,{he:n})}}function dv(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ae(t,e);const n=Mr(t),r=Mr(e),s=ae(n.seconds,r.seconds);return s!==0?s:ae(n.nanos,r.nanos)}function fv(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Ni(n[s],r[s]);if(i)return i}return ae(n.length,r.length)}function Ai(t){return tf(t)}function tf(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Mr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Fr(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return Y.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=tf(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${tf(n.fields[o])}`;return s+"}"}(t.mapValue):J(61005,{value:t})}function ec(t){switch(Ur(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Nu(t);return e?16+ec(e):16;case 5:return 2*t.stringValue.length;case 6:return Fr(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+ec(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return qr(r.fields,(i,o)=>{s+=i.length+ec(o)}),s}(t.mapValue);default:throw J(13486,{value:t})}}function pv(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function nf(t){return!!t&&"integerValue"in t}function Op(t){return!!t&&"arrayValue"in t}function mv(t){return!!t&&"nullValue"in t}function gv(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function tc(t){return!!t&&"mapValue"in t}function GA(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[Fw])==null?void 0:r.stringValue)===Bw}function Wo(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return qr(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Wo(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Wo(t.arrayValue.values[n]);return e}return{...t}}function HA(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===Uw}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dt{constructor(e){this.value=e}static empty(){return new Dt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!tc(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Wo(n)}setAll(e){let n=lt.emptyPath(),r={},s=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=l.popLast()}o?r[l.lastSegment()]=Wo(o):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());tc(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return kn(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];tc(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){qr(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Dt(Wo(this.value))}}function zw(t){const e=[];return qr(t.fields,(n,r)=>{const s=new lt([n]);if(tc(r)){const i=zw(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Gt(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _t{constructor(e,n,r,s,i,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new _t(e,0,te.min(),te.min(),te.min(),Dt.empty(),0)}static newFoundDocument(e,n,r,s){return new _t(e,1,n,te.min(),r,s,0)}static newNoDocument(e,n){return new _t(e,2,n,te.min(),te.min(),Dt.empty(),0)}static newUnknownDocument(e,n){return new _t(e,3,n,te.min(),te.min(),Dt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(te.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Dt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Dt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=te.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof _t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new _t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hc{constructor(e,n){this.position=e,this.inclusive=n}}function yv(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=Y.comparator(Y.fromName(o.referenceValue),n.key):r=Ni(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function vv(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!kn(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ia{constructor(e,n="asc"){this.field=e,this.dir=n}}function WA(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $w{}class Be extends $w{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new KA(e,n,r):n==="array-contains"?new JA(e,r):n==="in"?new XA(e,r):n==="not-in"?new ZA(e,r):n==="array-contains-any"?new eP(e,r):new Be(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new QA(e,r):new YA(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Ni(n,this.value)):n!==null&&Ur(this.value)===Ur(n)&&this.matchesComparison(Ni(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return J(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class mn extends $w{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new mn(e,n)}matches(e){return Gw(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Gw(t){return t.op==="and"}function Hw(t){return qA(t)&&Gw(t)}function qA(t){for(const e of t.filters)if(e instanceof mn)return!1;return!0}function rf(t){if(t instanceof Be)return t.field.canonicalString()+t.op.toString()+Ai(t.value);if(Hw(t))return t.filters.map(e=>rf(e)).join(",");{const e=t.filters.map(n=>rf(n)).join(",");return`${t.op}(${e})`}}function Ww(t,e){return t instanceof Be?function(r,s){return s instanceof Be&&r.op===s.op&&r.field.isEqual(s.field)&&kn(r.value,s.value)}(t,e):t instanceof mn?function(r,s){return s instanceof mn&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,l)=>i&&Ww(o,s.filters[l]),!0):!1}(t,e):void J(19439)}function qw(t){return t instanceof Be?function(n){return`${n.field.canonicalString()} ${n.op} ${Ai(n.value)}`}(t):t instanceof mn?function(n){return n.op.toString()+" {"+n.getFilters().map(qw).join(" ,")+"}"}(t):"Filter"}class KA extends Be{constructor(e,n,r){super(e,n,r),this.key=Y.fromName(r.referenceValue)}matches(e){const n=Y.comparator(e.key,this.key);return this.matchesComparison(n)}}class QA extends Be{constructor(e,n){super(e,"in",n),this.keys=Kw("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class YA extends Be{constructor(e,n){super(e,"not-in",n),this.keys=Kw("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function Kw(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>Y.fromName(r.referenceValue))}class JA extends Be{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Op(n)&&Ta(n.arrayValue,this.value)}}class XA extends Be{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Ta(this.value.arrayValue,n)}}class ZA extends Be{constructor(e,n){super(e,"not-in",n)}matches(e){if(Ta(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Ta(this.value.arrayValue,n)}}class eP extends Be{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Op(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Ta(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tP{constructor(e,n=null,r=[],s=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=l,this.Te=null}}function _v(t,e=null,n=[],r=[],s=null,i=null,o=null){return new tP(t,e,n,r,s,i,o)}function Lp(t){const e=ee(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>rf(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Ru(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Ai(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Ai(r)).join(",")),e.Te=n}return e.Te}function Mp(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!WA(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Ww(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!vv(t.startAt,e.startAt)&&vv(t.endAt,e.endAt)}function sf(t){return Y.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $i{constructor(e,n=null,r=[],s=[],i=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=c,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function nP(t,e,n,r,s,i,o,l){return new $i(t,e,n,r,s,i,o,l)}function Au(t){return new $i(t)}function wv(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Qw(t){return t.collectionGroup!==null}function qo(t){const e=ee(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new We(lt.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(l=l.add(u.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Ia(i,r))}),n.has(lt.keyField().canonicalString())||e.Ie.push(new Ia(lt.keyField(),r))}return e.Ie}function Cn(t){const e=ee(t);return e.Ee||(e.Ee=rP(e,qo(t))),e.Ee}function rP(t,e){if(t.limitType==="F")return _v(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Ia(s.field,i)});const n=t.endAt?new Hc(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Hc(t.startAt.position,t.startAt.inclusive):null;return _v(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function of(t,e){const n=t.filters.concat([e]);return new $i(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function af(t,e,n){return new $i(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Pu(t,e){return Mp(Cn(t),Cn(e))&&t.limitType===e.limitType}function Yw(t){return`${Lp(Cn(t))}|lt:${t.limitType}`}function Hs(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>qw(s)).join(", ")}]`),Ru(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>Ai(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>Ai(s)).join(",")),`Target(${r})`}(Cn(t))}; limitType=${t.limitType})`}function ku(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):Y.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of qo(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,l,c){const u=yv(o,l,c);return o.inclusive?u<=0:u<0}(r.startAt,qo(r),s)||r.endAt&&!function(o,l,c){const u=yv(o,l,c);return o.inclusive?u>=0:u>0}(r.endAt,qo(r),s))}(t,e)}function sP(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Jw(t){return(e,n)=>{let r=!1;for(const s of qo(t)){const i=iP(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function iP(t,e,n){const r=t.field.isKeyField()?Y.comparator(e.key,n.key):function(i,o,l){const c=o.data.field(i),u=l.data.field(i);return c!==null&&u!==null?Ni(c,u):J(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return J(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ns{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){qr(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return Dw(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oP=new Re(Y.comparator);function Xn(){return oP}const Xw=new Re(Y.comparator);function bo(...t){let e=Xw;for(const n of t)e=e.insert(n.key,n);return e}function Zw(t){let e=Xw;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function us(){return Ko()}function eE(){return Ko()}function Ko(){return new Ns(t=>t.toString(),(t,e)=>t.isEqual(e))}const aP=new Re(Y.comparator),lP=new We(Y.comparator);function le(...t){let e=lP;for(const n of t)e=e.add(n);return e}const cP=new We(ae);function uP(){return cP}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fp(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:$c(e)?"-0":e}}function tE(t){return{integerValue:""+t}}function hP(t,e){return FA(e)?tE(e):Fp(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu{constructor(){this._=void 0}}function dP(t,e,n){return t instanceof Wc?function(s,i){const o={fields:{[Ow]:{stringValue:Vw},[Mw]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Vp(i)&&(i=Nu(i)),i&&(o.fields[Lw]=i),{mapValue:o}}(n,e):t instanceof Sa?rE(t,e):t instanceof Ca?sE(t,e):function(s,i){const o=nE(s,i),l=Ev(o)+Ev(s.Ae);return nf(o)&&nf(s.Ae)?tE(l):Fp(s.serializer,l)}(t,e)}function fP(t,e,n){return t instanceof Sa?rE(t,e):t instanceof Ca?sE(t,e):n}function nE(t,e){return t instanceof qc?function(r){return nf(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Wc extends bu{}class Sa extends bu{constructor(e){super(),this.elements=e}}function rE(t,e){const n=iE(e);for(const r of t.elements)n.some(s=>kn(s,r))||n.push(r);return{arrayValue:{values:n}}}class Ca extends bu{constructor(e){super(),this.elements=e}}function sE(t,e){let n=iE(e);for(const r of t.elements)n=n.filter(s=>!kn(s,r));return{arrayValue:{values:n}}}class qc extends bu{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function Ev(t){return Ve(t.integerValue||t.doubleValue)}function iE(t){return Op(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function pP(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof Sa&&s instanceof Sa||r instanceof Ca&&s instanceof Ca?Ri(r.elements,s.elements,kn):r instanceof qc&&s instanceof qc?kn(r.Ae,s.Ae):r instanceof Wc&&s instanceof Wc}(t.transform,e.transform)}class mP{constructor(e,n){this.version=e,this.transformResults=n}}class fn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new fn}static exists(e){return new fn(void 0,e)}static updateTime(e){return new fn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function nc(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Du{}function oE(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Up(t.key,fn.none()):new Ua(t.key,t.data,fn.none());{const n=t.data,r=Dt.empty();let s=new We(lt.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Kr(t.key,r,new Gt(s.toArray()),fn.none())}}function gP(t,e,n){t instanceof Ua?function(s,i,o){const l=s.value.clone(),c=Tv(s.fieldTransforms,i,o.transformResults);l.setAll(c),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof Kr?function(s,i,o){if(!nc(s.precondition,i))return void i.convertToUnknownDocument(o.version);const l=Tv(s.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(aE(s)),c.setAll(l),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Qo(t,e,n,r){return t instanceof Ua?function(i,o,l,c){if(!nc(i.precondition,o))return l;const u=i.value.clone(),f=Iv(i.fieldTransforms,c,o);return u.setAll(f),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof Kr?function(i,o,l,c){if(!nc(i.precondition,o))return l;const u=Iv(i.fieldTransforms,c,o),f=o.data;return f.setAll(aE(i)),f.setAll(u),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(m=>m.field))}(t,e,n,r):function(i,o,l){return nc(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function yP(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=nE(r.transform,s||null);i!=null&&(n===null&&(n=Dt.empty()),n.set(r.field,i))}return n||null}function xv(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Ri(r,s,(i,o)=>pP(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Ua extends Du{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Kr extends Du{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function aE(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Tv(t,e,n){const r=new Map;pe(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,l=e.data.field(i.field);r.set(i.field,fP(o,l,n[s]))}return r}function Iv(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,dP(i,o,e))}return r}class Up extends Du{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class vP extends Du{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _P{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&gP(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Qo(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Qo(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=eE();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=n.has(s.key)?null:l;const c=oE(o,l);c!==null&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(te.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),le())}isEqual(e){return this.batchId===e.batchId&&Ri(this.mutations,e.mutations,(n,r)=>xv(n,r))&&Ri(this.baseMutations,e.baseMutations,(n,r)=>xv(n,r))}}class Bp{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){pe(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=function(){return aP}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Bp(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wP{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EP{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Me,ue;function xP(t){switch(t){case V.OK:return J(64938);case V.CANCELLED:case V.UNKNOWN:case V.DEADLINE_EXCEEDED:case V.RESOURCE_EXHAUSTED:case V.INTERNAL:case V.UNAVAILABLE:case V.UNAUTHENTICATED:return!1;case V.INVALID_ARGUMENT:case V.NOT_FOUND:case V.ALREADY_EXISTS:case V.PERMISSION_DENIED:case V.FAILED_PRECONDITION:case V.ABORTED:case V.OUT_OF_RANGE:case V.UNIMPLEMENTED:case V.DATA_LOSS:return!0;default:return J(15467,{code:t})}}function lE(t){if(t===void 0)return Jn("GRPC error has no .code"),V.UNKNOWN;switch(t){case Me.OK:return V.OK;case Me.CANCELLED:return V.CANCELLED;case Me.UNKNOWN:return V.UNKNOWN;case Me.DEADLINE_EXCEEDED:return V.DEADLINE_EXCEEDED;case Me.RESOURCE_EXHAUSTED:return V.RESOURCE_EXHAUSTED;case Me.INTERNAL:return V.INTERNAL;case Me.UNAVAILABLE:return V.UNAVAILABLE;case Me.UNAUTHENTICATED:return V.UNAUTHENTICATED;case Me.INVALID_ARGUMENT:return V.INVALID_ARGUMENT;case Me.NOT_FOUND:return V.NOT_FOUND;case Me.ALREADY_EXISTS:return V.ALREADY_EXISTS;case Me.PERMISSION_DENIED:return V.PERMISSION_DENIED;case Me.FAILED_PRECONDITION:return V.FAILED_PRECONDITION;case Me.ABORTED:return V.ABORTED;case Me.OUT_OF_RANGE:return V.OUT_OF_RANGE;case Me.UNIMPLEMENTED:return V.UNIMPLEMENTED;case Me.DATA_LOSS:return V.DATA_LOSS;default:return J(39323,{code:t})}}(ue=Me||(Me={}))[ue.OK=0]="OK",ue[ue.CANCELLED=1]="CANCELLED",ue[ue.UNKNOWN=2]="UNKNOWN",ue[ue.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ue[ue.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ue[ue.NOT_FOUND=5]="NOT_FOUND",ue[ue.ALREADY_EXISTS=6]="ALREADY_EXISTS",ue[ue.PERMISSION_DENIED=7]="PERMISSION_DENIED",ue[ue.UNAUTHENTICATED=16]="UNAUTHENTICATED",ue[ue.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ue[ue.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ue[ue.ABORTED=10]="ABORTED",ue[ue.OUT_OF_RANGE=11]="OUT_OF_RANGE",ue[ue.UNIMPLEMENTED=12]="UNIMPLEMENTED",ue[ue.INTERNAL=13]="INTERNAL",ue[ue.UNAVAILABLE=14]="UNAVAILABLE",ue[ue.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TP(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IP=new br([4294967295,4294967295],0);function Sv(t){const e=TP().encode(t),n=new xw;return n.update(e),new Uint8Array(n.digest())}function Cv(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new br([n,r],0),new br([s,i],0)]}class zp{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Do(`Invalid padding: ${n}`);if(r<0)throw new Do(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Do(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Do(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=br.fromNumber(this.ge)}ye(e,n,r){let s=e.add(n.multiply(br.fromNumber(r)));return s.compare(IP)===1&&(s=new br([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=Sv(e),[r,s]=Cv(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);if(!this.we(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new zp(i,s,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.ge===0)return;const n=Sv(e),[r,s]=Cv(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Do extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ju{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Ba.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new ju(te.min(),s,new Re(ae),Xn(),le())}}class Ba{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Ba(r,n,le(),le(),le())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rc{constructor(e,n,r,s){this.be=e,this.removedTargetIds=n,this.key=r,this.De=s}}class cE{constructor(e,n){this.targetId=e,this.Ce=n}}class uE{constructor(e,n,r=ht.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class Rv{constructor(){this.ve=0,this.Fe=Nv(),this.Me=ht.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=le(),n=le(),r=le();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:J(38017,{changeType:i})}}),new Ba(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=Nv()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,pe(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class SP{constructor(e){this.Ge=e,this.ze=new Map,this.je=Xn(),this.Je=Dl(),this.He=Dl(),this.Ye=new Re(ae)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:J(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,s)=>{this.rt(s)&&n(s)})}st(e){const n=e.targetId,r=e.Ce.count,s=this.ot(n);if(s){const i=s.target;if(sf(i))if(r===0){const o=new Y(i.path);this.et(n,o,_t.newNoDocument(o,te.min()))}else pe(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const l=this.ut(e),c=l?this.ct(l,e,o):1;if(c!==0){this.it(n);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,u)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,l;try{o=Fr(r).toUint8Array()}catch(c){if(c instanceof jw)return Ci("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new zp(o,s,i)}catch(c){return Ci(c instanceof Do?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.ge===0?null:l}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Ge.ht(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.et(n,i,null),s++)}),s}Tt(e){const n=new Map;this.ze.forEach((i,o)=>{const l=this.ot(o);if(l){if(i.current&&sf(l.target)){const c=new Y(l.target.path);this.It(c).has(o)||this.Et(o,c)||this.et(o,c,_t.newNoDocument(c,e))}i.Be&&(n.set(o,i.ke()),i.qe())}});let r=le();this.He.forEach((i,o)=>{let l=!0;o.forEachWhile(c=>{const u=this.ot(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const s=new ju(e,n,this.Ye,this.je,r);return this.je=Xn(),this.Je=Dl(),this.He=Dl(),this.Ye=new Re(ae),s}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,n)?s.Qe(n,1):s.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new Rv,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new We(ae),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new We(ae),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||K("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Rv),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Dl(){return new Re(Y.comparator)}function Nv(){return new Re(Y.comparator)}const CP=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),RP=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),NP=(()=>({and:"AND",or:"OR"}))();class AP{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function lf(t,e){return t.useProto3Json||Ru(e)?e:{value:e}}function Kc(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function hE(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function PP(t,e){return Kc(t,e.toTimestamp())}function Rn(t){return pe(!!t,49232),te.fromTimestamp(function(n){const r=Mr(n);return new he(r.seconds,r.nanos)}(t))}function $p(t,e){return cf(t,e).canonicalString()}function cf(t,e){const n=function(s){return new ye(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function dE(t){const e=ye.fromString(t);return pe(yE(e),10190,{key:e.toString()}),e}function uf(t,e){return $p(t.databaseId,e.path)}function Mh(t,e){const n=dE(e);if(n.get(1)!==t.databaseId.projectId)throw new H(V.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new H(V.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Y(pE(n))}function fE(t,e){return $p(t.databaseId,e)}function kP(t){const e=dE(t);return e.length===4?ye.emptyPath():pE(e)}function hf(t){return new ye(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function pE(t){return pe(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Av(t,e,n){return{name:uf(t,e),fields:n.value.mapValue.fields}}function bP(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:J(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(u,f){return u.useProto3Json?(pe(f===void 0||typeof f=="string",58123),ht.fromBase64String(f||"")):(pe(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),ht.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(u){const f=u.code===void 0?V.UNKNOWN:lE(u.code);return new H(f,u.message||"")}(o);n=new uE(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Mh(t,r.document.name),i=Rn(r.document.updateTime),o=r.document.createTime?Rn(r.document.createTime):te.min(),l=new Dt({mapValue:{fields:r.document.fields}}),c=_t.newFoundDocument(s,i,o,l),u=r.targetIds||[],f=r.removedTargetIds||[];n=new rc(u,f,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Mh(t,r.document),i=r.readTime?Rn(r.readTime):te.min(),o=_t.newNoDocument(s,i),l=r.removedTargetIds||[];n=new rc([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Mh(t,r.document),i=r.removedTargetIds||[];n=new rc([],i,s,null)}else{if(!("filter"in e))return J(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new EP(s,i),l=r.targetId;n=new cE(l,o)}}return n}function DP(t,e){let n;if(e instanceof Ua)n={update:Av(t,e.key,e.value)};else if(e instanceof Up)n={delete:uf(t,e.key)};else if(e instanceof Kr)n={update:Av(t,e.key,e.data),updateMask:zP(e.fieldMask)};else{if(!(e instanceof vP))return J(16599,{Vt:e.type});n={verify:uf(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const l=o.transform;if(l instanceof Wc)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Sa)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Ca)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof qc)return{fieldPath:o.field.canonicalString(),increment:l.Ae};throw J(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:PP(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:J(27497)}(t,e.precondition)),n}function jP(t,e){return t&&t.length>0?(pe(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?Rn(s.updateTime):Rn(i);return o.isEqual(te.min())&&(o=Rn(i)),new mP(o,s.transformResults||[])}(n,e))):[]}function VP(t,e){return{documents:[fE(t,e.path)]}}function OP(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=fE(t,s);const i=function(u){if(u.length!==0)return gE(mn.create(u,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(u){if(u.length!==0)return u.map(f=>function(g){return{field:Ws(g.field),direction:FP(g.dir)}}(f))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=lf(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ft:n,parent:s}}function LP(t){let e=kP(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){pe(r===1,65062);const f=n.from[0];f.allDescendants?s=f.collectionId:e=e.child(f.collectionId)}let i=[];n.where&&(i=function(m){const g=mE(m);return g instanceof mn&&Hw(g)?g.getFilters():[g]}(n.where));let o=[];n.orderBy&&(o=function(m){return m.map(g=>function(R){return new Ia(qs(R.field),function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(R.direction))}(g))}(n.orderBy));let l=null;n.limit&&(l=function(m){let g;return g=typeof m=="object"?m.value:m,Ru(g)?null:g}(n.limit));let c=null;n.startAt&&(c=function(m){const g=!!m.before,w=m.values||[];return new Hc(w,g)}(n.startAt));let u=null;return n.endAt&&(u=function(m){const g=!m.before,w=m.values||[];return new Hc(w,g)}(n.endAt)),nP(e,s,o,i,l,"F",c,u)}function MP(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return J(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function mE(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=qs(n.unaryFilter.field);return Be.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=qs(n.unaryFilter.field);return Be.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=qs(n.unaryFilter.field);return Be.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=qs(n.unaryFilter.field);return Be.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return J(61313);default:return J(60726)}}(t):t.fieldFilter!==void 0?function(n){return Be.create(qs(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return J(58110);default:return J(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return mn.create(n.compositeFilter.filters.map(r=>mE(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return J(1026)}}(n.compositeFilter.op))}(t):J(30097,{filter:t})}function FP(t){return CP[t]}function UP(t){return RP[t]}function BP(t){return NP[t]}function Ws(t){return{fieldPath:t.canonicalString()}}function qs(t){return lt.fromServerFormat(t.fieldPath)}function gE(t){return t instanceof Be?function(n){if(n.op==="=="){if(gv(n.value))return{unaryFilter:{field:Ws(n.field),op:"IS_NAN"}};if(mv(n.value))return{unaryFilter:{field:Ws(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(gv(n.value))return{unaryFilter:{field:Ws(n.field),op:"IS_NOT_NAN"}};if(mv(n.value))return{unaryFilter:{field:Ws(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ws(n.field),op:UP(n.op),value:n.value}}}(t):t instanceof mn?function(n){const r=n.getFilters().map(s=>gE(s));return r.length===1?r[0]:{compositeFilter:{op:BP(n.op),filters:r}}}(t):J(54877,{filter:t})}function zP(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function yE(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _r{constructor(e,n,r,s,i=te.min(),o=te.min(),l=ht.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new _r(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new _r(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new _r(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new _r(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $P{constructor(e){this.yt=e}}function GP(t){const e=LP({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?af(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HP{constructor(){this.Cn=new WP}addToCollectionParentIndex(e,n){return this.Cn.add(n),M.resolve()}getCollectionParents(e,n){return M.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return M.resolve()}deleteFieldIndex(e,n){return M.resolve()}deleteAllFieldIndexes(e){return M.resolve()}createTargetIndexes(e,n){return M.resolve()}getDocumentsMatchingTarget(e,n){return M.resolve(null)}getIndexType(e,n){return M.resolve(0)}getFieldIndexes(e,n){return M.resolve([])}getNextCollectionGroupToUpdate(e){return M.resolve(null)}getMinOffset(e,n){return M.resolve(Lr.min())}getMinOffsetFromCollectionGroup(e,n){return M.resolve(Lr.min())}updateCollectionGroup(e,n,r){return M.resolve()}updateIndexEntries(e,n){return M.resolve()}}class WP{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new We(ye.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new We(ye.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pv={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},vE=41943040;class kt{static withCacheSize(e){return new kt(e,kt.DEFAULT_COLLECTION_PERCENTILE,kt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */kt.DEFAULT_COLLECTION_PERCENTILE=10,kt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,kt.DEFAULT=new kt(vE,kt.DEFAULT_COLLECTION_PERCENTILE,kt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),kt.DISABLED=new kt(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pi{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Pi(0)}static cr(){return new Pi(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kv="LruGarbageCollector",_E=1048576;function bv([t,e],[n,r]){const s=ae(t,n);return s===0?ae(e,r):s}class qP{constructor(e){this.Ir=e,this.buffer=new We(bv),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();bv(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class KP{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){K(kv,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){zi(n)?K(kv,"Ignoring IndexedDB error during garbage collection: ",n):await Bi(n)}await this.Vr(3e5)})}}class QP{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return M.resolve(Cu.ce);const r=new qP(n);return this.mr.forEachTarget(e,s=>r.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>r.Ar(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(K("LruGarbageCollector","Garbage collection skipped; disabled"),M.resolve(Pv)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(K("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Pv):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,s,i,o,l,c,u;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(K("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),s=this.params.maximumSequenceNumbersToCollect):s=m,o=Date.now(),this.nthSequenceNumber(e,s))).next(m=>(r=m,l=Date.now(),this.removeTargets(e,r,n))).next(m=>(i=m,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(m=>(u=Date.now(),Gs()<=oe.DEBUG&&K("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${s} in `+(l-o)+`ms
	Removed ${i} targets in `+(c-l)+`ms
	Removed ${m} documents in `+(u-c)+`ms
Total Duration: ${u-f}ms`),M.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:m})))}}function YP(t,e){return new QP(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JP{constructor(){this.changes=new Ns(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,_t.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?M.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XP{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZP{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Qo(r.mutation,s,Gt.empty(),he.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,le()).next(()=>r))}getLocalViewOfDocuments(e,n,r=le()){const s=us();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=bo();return i.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=us();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,le()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,s){let i=Xn();const o=Ko(),l=function(){return Ko()}();return n.forEach((c,u)=>{const f=r.get(u.key);s.has(u.key)&&(f===void 0||f.mutation instanceof Kr)?i=i.insert(u.key,u):f!==void 0?(o.set(u.key,f.mutation.getFieldMask()),Qo(f.mutation,u,f.mutation.getFieldMask(),he.now())):o.set(u.key,Gt.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((u,f)=>o.set(u,f)),n.forEach((u,f)=>l.set(u,new XP(f,o.get(u)??null))),l))}recalculateAndSaveOverlays(e,n){const r=Ko();let s=new Re((o,l)=>o-l),i=le();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(c=>{const u=n.get(c);if(u===null)return;let f=r.get(c)||Gt.empty();f=l.applyToLocalView(u,f),r.set(c,f);const m=(s.get(l.batchId)||le()).add(c);s=s.insert(l.batchId,m)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,f=c.value,m=eE();f.forEach(g=>{if(!i.has(g)){const w=oE(n.get(g),r.get(g));w!==null&&m.set(g,w),i=i.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,m))}return M.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return Y.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Qw(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):M.resolve(us());let l=_a,c=i;return o.next(u=>M.forEach(u,(f,m)=>(l<m.largestBatchId&&(l=m.largestBatchId),i.get(f)?M.resolve():this.remoteDocumentCache.getEntry(e,f).next(g=>{c=c.insert(f,g)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,c,u,le())).next(f=>({batchId:l,changes:Zw(f)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Y(n)).next(r=>{let s=bo();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=bo();return this.indexManager.getCollectionParents(e,i).next(l=>M.forEach(l,c=>{const u=function(m,g){return new $i(g,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(n,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,u,r,s).next(f=>{f.forEach((m,g)=>{o=o.insert(m,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((c,u)=>{const f=u.getKey();o.get(f)===null&&(o=o.insert(f,_t.newInvalidDocument(f)))});let l=bo();return o.forEach((c,u)=>{const f=i.get(c);f!==void 0&&Qo(f.mutation,u,Gt.empty(),he.now()),ku(n,u)&&(l=l.insert(c,u))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ek{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return M.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Rn(s.createTime)}}(n)),M.resolve()}getNamedQuery(e,n){return M.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(s){return{name:s.name,query:GP(s.bundledQuery),readTime:Rn(s.readTime)}}(n)),M.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tk{constructor(){this.overlays=new Re(Y.comparator),this.qr=new Map}getOverlay(e,n){return M.resolve(this.overlays.get(n))}getOverlays(e,n){const r=us();return M.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.St(e,n,i)}),M.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(r)),M.resolve()}getOverlaysForCollection(e,n,r){const s=us(),i=n.length+1,o=new Y(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return M.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Re((u,f)=>u-f);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let f=i.get(u.largestBatchId);f===null&&(f=us(),i=i.insert(u.largestBatchId,f)),f.set(u.getKey(),u)}}const l=us(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,f)=>l.set(u,f)),!(l.size()>=s)););return M.resolve(l)}St(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new wP(n,r));let i=this.qr.get(n);i===void 0&&(i=le(),this.qr.set(n,i)),this.qr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nk{constructor(){this.sessionToken=ht.EMPTY_BYTE_STRING}getSessionToken(e){return M.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,M.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gp{constructor(){this.Qr=new We(Je.$r),this.Ur=new We(Je.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new Je(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new Je(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new Y(new ye([])),r=new Je(n,e),s=new Je(n,e+1),i=[];return this.Ur.forEachInRange([r,s],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new Y(new ye([])),r=new Je(n,e),s=new Je(n,e+1);let i=le();return this.Ur.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new Je(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Je{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return Y.comparator(e.key,n.key)||ae(e.Yr,n.Yr)}static Kr(e,n){return ae(e.Yr,n.Yr)||Y.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rk{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new We(Je.$r)}checkEmpty(e){return M.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new _P(i,n,r,s);this.mutationQueue.push(o);for(const l of s)this.Zr=this.Zr.add(new Je(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return M.resolve(o)}lookupMutationBatch(e,n){return M.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ei(r),i=s<0?0:s;return M.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return M.resolve(this.mutationQueue.length===0?jp:this.tr-1)}getAllMutationBatches(e){return M.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Je(n,0),s=new Je(n,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],o=>{const l=this.Xr(o.Yr);i.push(l)}),M.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new We(ae);return n.forEach(s=>{const i=new Je(s,0),o=new Je(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],l=>{r=r.add(l.Yr)})}),M.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;Y.isDocumentKey(i)||(i=i.child(""));const o=new Je(new Y(i),0);let l=new We(ae);return this.Zr.forEachWhile(c=>{const u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===s&&(l=l.add(c.Yr)),!0)},o),M.resolve(this.ti(l))}ti(e){const n=[];return e.forEach(r=>{const s=this.Xr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){pe(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return M.forEach(n.mutations,s=>{const i=new Je(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new Je(n,0),s=this.Zr.firstAfterOrEqual(r);return M.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,M.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sk{constructor(e){this.ri=e,this.docs=function(){return new Re(Y.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return M.resolve(r?r.document.mutableCopy():_t.newInvalidDocument(n))}getEntries(e,n){let r=Xn();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():_t.newInvalidDocument(s))}),M.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=Xn();const o=n.path,l=new Y(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:f}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||VA(jA(f),r)<=0||(s.has(f.key)||ku(n,f))&&(i=i.insert(f.key,f.mutableCopy()))}return M.resolve(i)}getAllFromCollectionGroup(e,n,r,s){J(9500)}ii(e,n){return M.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new ik(this)}getSize(e){return M.resolve(this.size)}}class ik extends JP{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)}),M.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ok{constructor(e){this.persistence=e,this.si=new Ns(n=>Lp(n),Mp),this.lastRemoteSnapshotVersion=te.min(),this.highestTargetId=0,this.oi=0,this._i=new Gp,this.targetCount=0,this.ai=Pi.ur()}forEachTarget(e,n){return this.si.forEach((r,s)=>n(s)),M.resolve()}getLastRemoteSnapshotVersion(e){return M.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return M.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),M.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),M.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new Pi(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,M.resolve()}updateTargetData(e,n){return this.Pr(n),M.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,M.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.si.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),M.waitFor(i).next(()=>s)}getTargetCount(e){return M.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return M.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),M.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),M.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),M.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return M.resolve(r)}containsKey(e,n){return M.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wE{constructor(e,n){this.ui={},this.overlays={},this.ci=new Cu(0),this.li=!1,this.li=!0,this.hi=new nk,this.referenceDelegate=e(this),this.Pi=new ok(this),this.indexManager=new HP,this.remoteDocumentCache=function(s){return new sk(s)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new $P(n),this.Ii=new ek(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new tk,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new rk(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){K("MemoryPersistence","Starting transaction:",e);const s=new ak(this.ci.next());return this.referenceDelegate.Ei(),r(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ai(e,n){return M.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class ak extends LA{constructor(e){super(),this.currentSequenceNumber=e}}class Hp{constructor(e){this.persistence=e,this.Ri=new Gp,this.Vi=null}static mi(e){return new Hp(e)}get fi(){if(this.Vi)return this.Vi;throw J(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),M.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),M.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),M.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(s=>this.fi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.fi.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return M.forEach(this.fi,r=>{const s=Y.fromPath(r);return this.gi(e,s).next(i=>{i||n.removeEntry(s,te.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return M.or([()=>M.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class Qc{constructor(e,n){this.persistence=e,this.pi=new Ns(r=>UA(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=YP(this,n)}static mi(e,n){return new Qc(e,n)}Ei(){}di(e){return M.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return M.forEach(this.pi,(r,s)=>this.br(e,r,s).next(i=>i?M.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,o=>this.br(e,o,n).next(l=>{l||(r++,i.removeEntry(o,te.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),M.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),M.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),M.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),M.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=ec(e.data.value)),n}br(e,n,r){return M.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.pi.get(n);return M.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wp{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=s}static As(e,n){let r=le(),s=le();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Wp(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lk{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ck{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return tC()?8:MA(Et())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.ys(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new lk;return this.Ss(e,n,o).next(l=>{if(i.result=l,this.Vs)return this.bs(e,n,o,l.size)})}).next(()=>i.result)}bs(e,n,r,s){return r.documentReadCount<this.fs?(Gs()<=oe.DEBUG&&K("QueryEngine","SDK will not create cache indexes for query:",Hs(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),M.resolve()):(Gs()<=oe.DEBUG&&K("QueryEngine","Query:",Hs(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(Gs()<=oe.DEBUG&&K("QueryEngine","The SDK decides to create cache indexes for query:",Hs(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Cn(n))):M.resolve())}ys(e,n){if(wv(n))return M.resolve(null);let r=Cn(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=af(n,null,"F"),r=Cn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=le(...i);return this.ps.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(c=>{const u=this.Ds(n,l);return this.Cs(n,u,o,c.readTime)?this.ys(e,af(n,null,"F")):this.vs(e,u,n,c)}))})))}ws(e,n,r,s){return wv(n)||s.isEqual(te.min())?M.resolve(null):this.ps.getDocuments(e,r).next(i=>{const o=this.Ds(n,i);return this.Cs(n,o,r,s)?M.resolve(null):(Gs()<=oe.DEBUG&&K("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Hs(n)),this.vs(e,o,n,DA(s,_a)).next(l=>l))})}Ds(e,n){let r=new We(Jw(e));return n.forEach((s,i)=>{ku(e,i)&&(r=r.add(i))}),r}Cs(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,n,r){return Gs()<=oe.DEBUG&&K("QueryEngine","Using full collection scan to execute query:",Hs(n)),this.ps.getDocumentsMatchingQuery(e,n,Lr.min(),r)}vs(e,n,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qp="LocalStore",uk=3e8;class hk{constructor(e,n,r,s){this.persistence=e,this.Fs=n,this.serializer=s,this.Ms=new Re(ae),this.xs=new Ns(i=>Lp(i),Mp),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ZP(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function dk(t,e,n,r){return new hk(t,e,n,r)}async function EE(t,e){const n=ee(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],l=[];let c=le();for(const u of s){o.push(u.batchId);for(const f of u.mutations)c=c.add(f.key)}for(const u of i){l.push(u.batchId);for(const f of u.mutations)c=c.add(f.key)}return n.localDocuments.getDocuments(r,c).next(u=>({Ls:u,removedBatchIds:o,addedBatchIds:l}))})})}function fk(t,e){const n=ee(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(l,c,u,f){const m=u.batch,g=m.keys();let w=M.resolve();return g.forEach(R=>{w=w.next(()=>f.getEntry(c,R)).next(N=>{const P=u.docVersions.get(R);pe(P!==null,48541),N.version.compareTo(P)<0&&(m.applyToRemoteDocument(N,u),N.isValidDocument()&&(N.setReadTime(u.commitVersion),f.addEntry(N)))})}),w.next(()=>l.mutationQueue.removeMutationBatch(c,m))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let c=le();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function xE(t){const e=ee(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function pk(t,e){const n=ee(t),r=e.snapshotVersion;let s=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});s=n.Ms;const l=[];e.targetChanges.forEach((f,m)=>{const g=s.get(m);if(!g)return;l.push(n.Pi.removeMatchingKeys(i,f.removedDocuments,m).next(()=>n.Pi.addMatchingKeys(i,f.addedDocuments,m)));let w=g.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(m)!==null?w=w.withResumeToken(ht.EMPTY_BYTE_STRING,te.min()).withLastLimboFreeSnapshotVersion(te.min()):f.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(f.resumeToken,r)),s=s.insert(m,w),function(N,P,x){return N.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-N.snapshotVersion.toMicroseconds()>=uk?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0}(g,w,f)&&l.push(n.Pi.updateTargetData(i,w))});let c=Xn(),u=le();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,f))}),l.push(mk(i,o,e.documentUpdates).next(f=>{c=f.ks,u=f.qs})),!r.isEqual(te.min())){const f=n.Pi.getLastRemoteSnapshotVersion(i).next(m=>n.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(f)}return M.waitFor(l).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,u)).next(()=>c)}).then(i=>(n.Ms=s,i))}function mk(t,e,n){let r=le(),s=le();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=Xn();return n.forEach((l,c)=>{const u=i.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(l)),c.isNoDocument()&&c.version.isEqual(te.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):K(qp,"Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)}),{ks:o,qs:s}})}function gk(t,e){const n=ee(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=jp),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function yk(t,e){const n=ee(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Pi.getTargetData(r,e).next(i=>i?(s=i,M.resolve(s)):n.Pi.allocateTargetId(r).next(o=>(s=new _r(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function df(t,e,n){const r=ee(t),s=r.Ms.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!zi(o))throw o;K(qp,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function Dv(t,e,n){const r=ee(t);let s=te.min(),i=le();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,f){const m=ee(c),g=m.xs.get(f);return g!==void 0?M.resolve(m.Ms.get(g)):m.Pi.getTargetData(u,f)}(r,o,Cn(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,l.targetId).next(c=>{i=c})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?s:te.min(),n?i:le())).next(l=>(vk(r,sP(e),l),{documents:l,Qs:i})))}function vk(t,e,n){let r=t.Os.get(e)||te.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Os.set(e,r)}class jv{constructor(){this.activeTargetIds=uP()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class _k{constructor(){this.Mo=new jv,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new jv,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wk{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vv="ConnectivityMonitor";class Ov{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){K(Vv,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){K(Vv,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jl=null;function ff(){return jl===null?jl=function(){return 268435456+Math.round(2147483648*Math.random())}():jl++,"0x"+jl.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fh="RestConnection",Ek={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class xk{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===Ea?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,n,r,s,i){const o=ff(),l=this.zo(e,n.toUriEncodedString());K(Fh,`Sending RPC '${e}' ${o}:`,l,r);const c={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(c,s,i);const{host:u}=new URL(l),f=Rs(u);return this.Jo(e,l,c,r,f).then(m=>(K(Fh,`Received RPC '${e}' ${o}: `,m),m),m=>{throw Ci(Fh,`RPC '${e}' ${o} failed with error: `,m,"url: ",l,"request:",r),m})}Ho(e,n,r,s,i,o){return this.Go(e,n,r,s,i)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ui}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}zo(e,n){const r=Ek[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tk{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gt="WebChannelConnection";class Ik extends xk{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,s,i){const o=ff();return new Promise((l,c)=>{const u=new Tw;u.setWithCredentials(!0),u.listenOnce(Iw.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Zl.NO_ERROR:const m=u.getResponseJson();K(gt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(m)),l(m);break;case Zl.TIMEOUT:K(gt,`RPC '${e}' ${o} timed out`),c(new H(V.DEADLINE_EXCEEDED,"Request time out"));break;case Zl.HTTP_ERROR:const g=u.getStatus();if(K(gt,`RPC '${e}' ${o} failed with status:`,g,"response text:",u.getResponseText()),g>0){let w=u.getResponseJson();Array.isArray(w)&&(w=w[0]);const R=w==null?void 0:w.error;if(R&&R.status&&R.message){const N=function(x){const v=x.toLowerCase().replace(/_/g,"-");return Object.values(V).indexOf(v)>=0?v:V.UNKNOWN}(R.status);c(new H(N,R.message))}else c(new H(V.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new H(V.UNAVAILABLE,"Connection failed."));break;default:J(9055,{l_:e,streamId:o,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{K(gt,`RPC '${e}' ${o} completed.`)}});const f=JSON.stringify(s);K(gt,`RPC '${e}' ${o} sending request:`,s),u.send(n,"POST",f,r,15)})}T_(e,n,r){const s=ff(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Rw(),l=Cw(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.jo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const f=i.join("");K(gt,`Creating RPC '${e}' stream ${s}: ${f}`,c);const m=o.createWebChannel(f,c);this.I_(m);let g=!1,w=!1;const R=new Tk({Yo:P=>{w?K(gt,`Not sending because RPC '${e}' stream ${s} is closed:`,P):(g||(K(gt,`Opening RPC '${e}' stream ${s} transport.`),m.open(),g=!0),K(gt,`RPC '${e}' stream ${s} sending:`,P),m.send(P))},Zo:()=>m.close()}),N=(P,x,v)=>{P.listen(x,I=>{try{v(I)}catch(D){setTimeout(()=>{throw D},0)}})};return N(m,ko.EventType.OPEN,()=>{w||(K(gt,`RPC '${e}' stream ${s} transport opened.`),R.o_())}),N(m,ko.EventType.CLOSE,()=>{w||(w=!0,K(gt,`RPC '${e}' stream ${s} transport closed`),R.a_(),this.E_(m))}),N(m,ko.EventType.ERROR,P=>{w||(w=!0,Ci(gt,`RPC '${e}' stream ${s} transport errored. Name:`,P.name,"Message:",P.message),R.a_(new H(V.UNAVAILABLE,"The operation could not be completed")))}),N(m,ko.EventType.MESSAGE,P=>{var x;if(!w){const v=P.data[0];pe(!!v,16349);const I=v,D=(I==null?void 0:I.error)||((x=I[0])==null?void 0:x.error);if(D){K(gt,`RPC '${e}' stream ${s} received error:`,D);const F=D.status;let z=function(S){const E=Me[S];if(E!==void 0)return lE(E)}(F),T=D.message;z===void 0&&(z=V.INTERNAL,T="Unknown error status: "+F+" with message "+D.message),w=!0,R.a_(new H(z,T)),m.close()}else K(gt,`RPC '${e}' stream ${s} received:`,v),R.u_(v)}}),N(l,Sw.STAT_EVENT,P=>{P.stat===Zd.PROXY?K(gt,`RPC '${e}' stream ${s} detected buffering proxy`):P.stat===Zd.NOPROXY&&K(gt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{R.__()},0),R}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}function Uh(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vu(t){return new AP(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TE{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,n-r);s>0&&K("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lv="PersistentStream";class IE{constructor(e,n,r,s,i,o,l,c){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new TE(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===V.RESOURCE_EXHAUSTED?(Jn(n.toString()),Jn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===V.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.D_===n&&this.G_(r,s)},r=>{e(()=>{const s=new H(V.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{r(()=>this.z_(s))}),this.stream.onMessage(s=>{r(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return K(Lv,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(K(Lv,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Sk extends IE{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=bP(this.serializer,e),r=function(i){if(!("targetChange"in i))return te.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?te.min():o.readTime?Rn(o.readTime):te.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=hf(this.serializer),n.addTarget=function(i,o){let l;const c=o.target;if(l=sf(c)?{documents:VP(i,c)}:{query:OP(i,c).ft},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=hE(i,o.resumeToken);const u=lf(i,o.expectedCount);u!==null&&(l.expectedCount=u)}else if(o.snapshotVersion.compareTo(te.min())>0){l.readTime=Kc(i,o.snapshotVersion.toTimestamp());const u=lf(i,o.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const r=MP(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=hf(this.serializer),n.removeTarget=e,this.q_(n)}}class Ck extends IE{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return pe(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,pe(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){pe(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=jP(e.writeResults,e.commitTime),r=Rn(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=hf(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>DP(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rk{}class Nk extends Rk{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new H(V.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,cf(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===V.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new H(V.UNKNOWN,i.toString())})}Ho(e,n,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Ho(e,cf(n,r),s,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===V.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new H(V.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class Ak{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Jn(n),this.aa=!1):K("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Is="RemoteStore";class Pk{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{As(this)&&(K(Is,"Restarting streams for network reachability change."),await async function(c){const u=ee(c);u.Ea.add(4),await Gi(u),u.Ra.set("Unknown"),u.Ea.delete(4),await za(u)}(this))})}),this.Ra=new Ak(r,s)}}async function za(t){if(As(t))for(const e of t.da)await e(!0)}async function Gi(t){for(const e of t.da)await e(!1)}function SE(t,e){const n=ee(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),Jp(n)?Yp(n):Hi(n).O_()&&Qp(n,e))}function Kp(t,e){const n=ee(t),r=Hi(n);n.Ia.delete(e),r.O_()&&CE(n,e),n.Ia.size===0&&(r.O_()?r.L_():As(n)&&n.Ra.set("Unknown"))}function Qp(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(te.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Hi(t).Y_(e)}function CE(t,e){t.Va.Ue(e),Hi(t).Z_(e)}function Yp(t){t.Va=new SP({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Hi(t).start(),t.Ra.ua()}function Jp(t){return As(t)&&!Hi(t).x_()&&t.Ia.size>0}function As(t){return ee(t).Ea.size===0}function RE(t){t.Va=void 0}async function kk(t){t.Ra.set("Online")}async function bk(t){t.Ia.forEach((e,n)=>{Qp(t,e)})}async function Dk(t,e){RE(t),Jp(t)?(t.Ra.ha(e),Yp(t)):t.Ra.set("Unknown")}async function jk(t,e,n){if(t.Ra.set("Online"),e instanceof uE&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const l of i.targetIds)s.Ia.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.Ia.delete(l),s.Va.removeTarget(l))}(t,e)}catch(r){K(Is,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Yc(t,r)}else if(e instanceof rc?t.Va.Ze(e):e instanceof cE?t.Va.st(e):t.Va.tt(e),!n.isEqual(te.min()))try{const r=await xE(t.localStore);n.compareTo(r)>=0&&await function(i,o){const l=i.Va.Tt(o);return l.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const f=i.Ia.get(u);f&&i.Ia.set(u,f.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,u)=>{const f=i.Ia.get(c);if(!f)return;i.Ia.set(c,f.withResumeToken(ht.EMPTY_BYTE_STRING,f.snapshotVersion)),CE(i,c);const m=new _r(f.target,c,u,f.sequenceNumber);Qp(i,m)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){K(Is,"Failed to raise snapshot:",r),await Yc(t,r)}}async function Yc(t,e,n){if(!zi(e))throw e;t.Ea.add(1),await Gi(t),t.Ra.set("Offline"),n||(n=()=>xE(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{K(Is,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await za(t)})}function NE(t,e){return e().catch(n=>Yc(t,n,e))}async function Ou(t){const e=ee(t),n=Br(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:jp;for(;Vk(e);)try{const s=await gk(e.localStore,r);if(s===null){e.Ta.length===0&&n.L_();break}r=s.batchId,Ok(e,s)}catch(s){await Yc(e,s)}AE(e)&&PE(e)}function Vk(t){return As(t)&&t.Ta.length<10}function Ok(t,e){t.Ta.push(e);const n=Br(t);n.O_()&&n.X_&&n.ea(e.mutations)}function AE(t){return As(t)&&!Br(t).x_()&&t.Ta.length>0}function PE(t){Br(t).start()}async function Lk(t){Br(t).ra()}async function Mk(t){const e=Br(t);for(const n of t.Ta)e.ea(n.mutations)}async function Fk(t,e,n){const r=t.Ta.shift(),s=Bp.from(r,e,n);await NE(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Ou(t)}async function Uk(t,e){e&&Br(t).X_&&await async function(r,s){if(function(o){return xP(o)&&o!==V.ABORTED}(s.code)){const i=r.Ta.shift();Br(r).B_(),await NE(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Ou(r)}}(t,e),AE(t)&&PE(t)}async function Mv(t,e){const n=ee(t);n.asyncQueue.verifyOperationInProgress(),K(Is,"RemoteStore received new credentials");const r=As(n);n.Ea.add(3),await Gi(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await za(n)}async function Bk(t,e){const n=ee(t);e?(n.Ea.delete(2),await za(n)):e||(n.Ea.add(2),await Gi(n),n.Ra.set("Unknown"))}function Hi(t){return t.ma||(t.ma=function(n,r,s){const i=ee(n);return i.sa(),new Sk(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:kk.bind(null,t),t_:bk.bind(null,t),r_:Dk.bind(null,t),H_:jk.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Jp(t)?Yp(t):t.Ra.set("Unknown")):(await t.ma.stop(),RE(t))})),t.ma}function Br(t){return t.fa||(t.fa=function(n,r,s){const i=ee(n);return i.sa(),new Ck(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:Lk.bind(null,t),r_:Uk.bind(null,t),ta:Mk.bind(null,t),na:Fk.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Ou(t)):(await t.fa.stop(),t.Ta.length>0&&(K(Is,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xp{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Gn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,l=new Xp(e,n,o,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new H(V.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Zp(t,e){if(Jn("AsyncQueue",`${e}: ${t}`),zi(t))return new H(V.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi{static emptySet(e){return new mi(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||Y.comparator(n.key,r.key):(n,r)=>Y.comparator(n.key,r.key),this.keyedMap=bo(),this.sortedSet=new Re(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof mi)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new mi;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fv{constructor(){this.ga=new Re(Y.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):J(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class ki{constructor(e,n,r,s,i,o,l,c,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new ki(e,n,mi.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Pu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zk{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class $k{constructor(){this.queries=Uv(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const s=ee(n),i=s.queries;s.queries=Uv(),i.forEach((o,l)=>{for(const c of l.Sa)c.onError(r)})})(this,new H(V.ABORTED,"Firestore shutting down"))}}function Uv(){return new Ns(t=>Yw(t),Pu)}async function em(t,e){const n=ee(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new zk,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await n.onListen(s,!0);break;case 1:i.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const l=Zp(o,`Initialization of query '${Hs(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.Sa.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&nm(n)}async function tm(t,e){const n=ee(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Gk(t,e){const n=ee(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const l of o.Sa)l.Fa(s)&&(r=!0);o.wa=s}}r&&nm(n)}function Hk(t,e,n){const r=ee(t),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(n);r.queries.delete(e)}function nm(t){t.Ca.forEach(e=>{e.next()})}var pf,Bv;(Bv=pf||(pf={})).Ma="default",Bv.Cache="cache";class rm{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new ki(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=ki.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==pf.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kE{constructor(e){this.key=e}}class bE{constructor(e){this.key=e}}class Wk{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=le(),this.mutatedKeys=le(),this.eu=Jw(e),this.tu=new mi(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new Fv,s=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,l=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((f,m)=>{const g=s.get(f),w=ku(this.query,m)?m:null,R=!!g&&this.mutatedKeys.has(g.key),N=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations);let P=!1;g&&w?g.data.isEqual(w.data)?R!==N&&(r.track({type:3,doc:w}),P=!0):this.su(g,w)||(r.track({type:2,doc:w}),P=!0,(c&&this.eu(w,c)>0||u&&this.eu(w,u)<0)&&(l=!0)):!g&&w?(r.track({type:0,doc:w}),P=!0):g&&!w&&(r.track({type:1,doc:g}),P=!0,(c||u)&&(l=!0)),P&&(w?(o=o.add(w),i=N?i.add(f):i.delete(f)):(o=o.delete(f),i=i.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),i=i.delete(f.key),r.track({type:1,doc:f})}return{tu:o,iu:r,Cs:l,mutatedKeys:i}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((f,m)=>function(w,R){const N=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return J(20277,{Rt:P})}};return N(w)-N(R)}(f.type,m.type)||this.eu(f.doc,m.doc)),this.ou(r),s=s??!1;const l=n&&!s?this._u():[],c=this.Xa.size===0&&this.current&&!s?1:0,u=c!==this.Za;return this.Za=c,o.length!==0||u?{snapshot:new ki(this.query,e.tu,i,o,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:l}:{au:l}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Fv,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=le(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new bE(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new kE(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=le();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return ki.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const sm="SyncEngine";class qk{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class Kk{constructor(e){this.key=e,this.hu=!1}}class Qk{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Ns(l=>Yw(l),Pu),this.Iu=new Map,this.Eu=new Set,this.du=new Re(Y.comparator),this.Au=new Map,this.Ru=new Gp,this.Vu={},this.mu=new Map,this.fu=Pi.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Yk(t,e,n=!0){const r=ME(t);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await DE(r,e,n,!0),s}async function Jk(t,e){const n=ME(t);await DE(n,e,!0,!1)}async function DE(t,e,n,r){const s=await yk(t.localStore,Cn(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await Xk(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&SE(t.remoteStore,s),l}async function Xk(t,e,n,r,s){t.pu=(m,g,w)=>async function(N,P,x,v){let I=P.view.ru(x);I.Cs&&(I=await Dv(N.localStore,P.query,!1).then(({documents:T})=>P.view.ru(T,I)));const D=v&&v.targetChanges.get(P.targetId),F=v&&v.targetMismatches.get(P.targetId)!=null,z=P.view.applyChanges(I,N.isPrimaryClient,D,F);return $v(N,P.targetId,z.au),z.snapshot}(t,m,g,w);const i=await Dv(t.localStore,e,!0),o=new Wk(e,i.Qs),l=o.ru(i.documents),c=Ba.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),u=o.applyChanges(l,t.isPrimaryClient,c);$v(t,n,u.au);const f=new qk(e,n,o);return t.Tu.set(e,f),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),u.snapshot}async function Zk(t,e,n){const r=ee(t),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter(o=>!Pu(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await df(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Kp(r.remoteStore,s.targetId),mf(r,s.targetId)}).catch(Bi)):(mf(r,s.targetId),await df(r.localStore,s.targetId,!0))}async function e4(t,e){const n=ee(t),r=n.Tu.get(e),s=n.Iu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Kp(n.remoteStore,r.targetId))}async function t4(t,e,n){const r=l4(t);try{const s=await function(o,l){const c=ee(o),u=he.now(),f=l.reduce((w,R)=>w.add(R.key),le());let m,g;return c.persistence.runTransaction("Locally write mutations","readwrite",w=>{let R=Xn(),N=le();return c.Ns.getEntries(w,f).next(P=>{R=P,R.forEach((x,v)=>{v.isValidDocument()||(N=N.add(x))})}).next(()=>c.localDocuments.getOverlayedDocuments(w,R)).next(P=>{m=P;const x=[];for(const v of l){const I=yP(v,m.get(v.key).overlayedDocument);I!=null&&x.push(new Kr(v.key,I,zw(I.value.mapValue),fn.exists(!0)))}return c.mutationQueue.addMutationBatch(w,u,x,l)}).next(P=>{g=P;const x=P.applyToLocalDocumentSet(m,N);return c.documentOverlayCache.saveOverlays(w,P.batchId,x)})}).then(()=>({batchId:g.batchId,changes:Zw(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,l,c){let u=o.Vu[o.currentUser.toKey()];u||(u=new Re(ae)),u=u.insert(l,c),o.Vu[o.currentUser.toKey()]=u}(r,s.batchId,n),await $a(r,s.changes),await Ou(r.remoteStore)}catch(s){const i=Zp(s,"Failed to persist write");n.reject(i)}}async function jE(t,e){const n=ee(t);try{const r=await pk(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Au.get(i);o&&(pe(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?pe(o.hu,14607):s.removedDocuments.size>0&&(pe(o.hu,42227),o.hu=!1))}),await $a(n,r,e)}catch(r){await Bi(r)}}function zv(t,e,n){const r=ee(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Tu.forEach((i,o)=>{const l=o.view.va(e);l.snapshot&&s.push(l.snapshot)}),function(o,l){const c=ee(o);c.onlineState=l;let u=!1;c.queries.forEach((f,m)=>{for(const g of m.Sa)g.va(l)&&(u=!0)}),u&&nm(c)}(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function n4(t,e,n){const r=ee(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Au.get(e),i=s&&s.key;if(i){let o=new Re(Y.comparator);o=o.insert(i,_t.newNoDocument(i,te.min()));const l=le().add(i),c=new ju(te.min(),new Map,new Re(ae),o,l);await jE(r,c),r.du=r.du.remove(i),r.Au.delete(e),im(r)}else await df(r.localStore,e,!1).then(()=>mf(r,e,n)).catch(Bi)}async function r4(t,e){const n=ee(t),r=e.batch.batchId;try{const s=await fk(n.localStore,e);OE(n,r,null),VE(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await $a(n,s)}catch(s){await Bi(s)}}async function s4(t,e,n){const r=ee(t);try{const s=await function(o,l){const c=ee(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let f;return c.mutationQueue.lookupMutationBatch(u,l).next(m=>(pe(m!==null,37113),f=m.keys(),c.mutationQueue.removeMutationBatch(u,m))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,f,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,f)).next(()=>c.localDocuments.getDocuments(u,f))})}(r.localStore,e);OE(r,e,n),VE(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await $a(r,s)}catch(s){await Bi(s)}}function VE(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function OE(t,e,n){const r=ee(t);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function mf(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||LE(t,r)})}function LE(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Kp(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),im(t))}function $v(t,e,n){for(const r of n)r instanceof kE?(t.Ru.addReference(r.key,e),i4(t,r)):r instanceof bE?(K(sm,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||LE(t,r.key)):J(19791,{wu:r})}function i4(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(K(sm,"New document in limbo: "+n),t.Eu.add(r),im(t))}function im(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new Y(ye.fromString(e)),r=t.fu.next();t.Au.set(r,new Kk(n)),t.du=t.du.insert(n,r),SE(t.remoteStore,new _r(Cn(Au(n.path)),r,"TargetPurposeLimboResolution",Cu.ce))}}async function $a(t,e,n){const r=ee(t),s=[],i=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((l,c)=>{o.push(r.pu(c,e,n).then(u=>{var f;if((u||n)&&r.isPrimaryClient){const m=u?!u.fromCache:(f=n==null?void 0:n.targetChanges.get(c.targetId))==null?void 0:f.current;r.sharedClientState.updateQueryState(c.targetId,m?"current":"not-current")}if(u){s.push(u);const m=Wp.As(c.targetId,u);i.push(m)}}))}),await Promise.all(o),r.Pu.H_(s),await async function(c,u){const f=ee(c);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>M.forEach(u,g=>M.forEach(g.Es,w=>f.persistence.referenceDelegate.addReference(m,g.targetId,w)).next(()=>M.forEach(g.ds,w=>f.persistence.referenceDelegate.removeReference(m,g.targetId,w)))))}catch(m){if(!zi(m))throw m;K(qp,"Failed to update sequence numbers: "+m)}for(const m of u){const g=m.targetId;if(!m.fromCache){const w=f.Ms.get(g),R=w.snapshotVersion,N=w.withLastLimboFreeSnapshotVersion(R);f.Ms=f.Ms.insert(g,N)}}}(r.localStore,i))}async function o4(t,e){const n=ee(t);if(!n.currentUser.isEqual(e)){K(sm,"User change. New user:",e.toKey());const r=await EE(n.localStore,e);n.currentUser=e,function(i,o){i.mu.forEach(l=>{l.forEach(c=>{c.reject(new H(V.CANCELLED,o))})}),i.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await $a(n,r.Ls)}}function a4(t,e){const n=ee(t),r=n.Au.get(e);if(r&&r.hu)return le().add(r.key);{let s=le();const i=n.Iu.get(e);if(!i)return s;for(const o of i){const l=n.Tu.get(o);s=s.unionWith(l.view.nu)}return s}}function ME(t){const e=ee(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=jE.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=a4.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=n4.bind(null,e),e.Pu.H_=Gk.bind(null,e.eventManager),e.Pu.yu=Hk.bind(null,e.eventManager),e}function l4(t){const e=ee(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=r4.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=s4.bind(null,e),e}class Jc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Vu(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return dk(this.persistence,new ck,e.initialUser,this.serializer)}Cu(e){return new wE(Hp.mi,this.serializer)}Du(e){return new _k}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Jc.provider={build:()=>new Jc};class c4 extends Jc{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){pe(this.persistence.referenceDelegate instanceof Qc,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new KP(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?kt.withCacheSize(this.cacheSizeBytes):kt.DEFAULT;return new wE(r=>Qc.mi(r,n),this.serializer)}}class gf{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>zv(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=o4.bind(null,this.syncEngine),await Bk(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new $k}()}createDatastore(e){const n=Vu(e.databaseInfo.databaseId),r=function(i){return new Ik(i)}(e.databaseInfo);return function(i,o,l,c){return new Nk(i,o,l,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,l){return new Pk(r,s,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>zv(this.syncEngine,n,0),function(){return Ov.v()?new Ov:new wk}())}createSyncEngine(e,n){return function(s,i,o,l,c,u,f){const m=new Qk(s,i,o,l,c,u);return f&&(m.gu=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=ee(s);K(Is,"RemoteStore shutting down."),i.Ea.add(5),await Gi(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}gf.provider={build:()=>new gf};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class om{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Jn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zr="FirestoreClient";class u4{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=yt.UNAUTHENTICATED,this.clientId=Dp.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{K(zr,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(K(zr,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Gn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Zp(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Bh(t,e){t.asyncQueue.verifyOperationInProgress(),K(zr,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await EE(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Gv(t,e){t.asyncQueue.verifyOperationInProgress();const n=await FE(t);K(zr,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Mv(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>Mv(e.remoteStore,s)),t._onlineComponents=e}async function FE(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){K(zr,"Using user provided OfflineComponentProvider");try{await Bh(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===V.FAILED_PRECONDITION||s.code===V.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Ci("Error using user provided cache. Falling back to memory cache: "+n),await Bh(t,new Jc)}}else K(zr,"Using default OfflineComponentProvider"),await Bh(t,new c4(void 0));return t._offlineComponents}async function am(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(K(zr,"Using user provided OnlineComponentProvider"),await Gv(t,t._uninitializedComponentsProvider._online)):(K(zr,"Using default OnlineComponentProvider"),await Gv(t,new gf))),t._onlineComponents}function UE(t){return FE(t).then(e=>e.persistence)}function BE(t){return am(t).then(e=>e.remoteStore)}function h4(t){return am(t).then(e=>e.syncEngine)}async function Xc(t){const e=await am(t),n=e.eventManager;return n.onListen=Yk.bind(null,e.syncEngine),n.onUnlisten=Zk.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=Jk.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=e4.bind(null,e.syncEngine),n}function d4(t){return t.asyncQueue.enqueue(async()=>{const e=await UE(t),n=await BE(t);return e.setNetworkEnabled(!0),function(s){const i=ee(s);return i.Ea.delete(0),za(i)}(n)})}function f4(t){return t.asyncQueue.enqueue(async()=>{const e=await UE(t),n=await BE(t);return e.setNetworkEnabled(!1),async function(s){const i=ee(s);i.Ea.add(0),await Gi(i),i.Ra.set("Offline")}(n)})}function p4(t,e,n={}){const r=new Gn;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,u){const f=new om({next:g=>{f.Nu(),o.enqueueAndForget(()=>tm(i,m));const w=g.docs.has(l);!w&&g.fromCache?u.reject(new H(V.UNAVAILABLE,"Failed to get document because the client is offline.")):w&&g.fromCache&&c&&c.source==="server"?u.reject(new H(V.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(g)},error:g=>u.reject(g)}),m=new rm(Au(l.path),f,{includeMetadataChanges:!0,qa:!0});return em(i,m)}(await Xc(t),t.asyncQueue,e,n,r)),r.promise}function m4(t,e,n={}){const r=new Gn;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,u){const f=new om({next:g=>{f.Nu(),o.enqueueAndForget(()=>tm(i,m)),g.fromCache&&c.source==="server"?u.reject(new H(V.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(g)},error:g=>u.reject(g)}),m=new rm(l,f,{includeMetadataChanges:!0,qa:!0});return em(i,m)}(await Xc(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zE(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hv=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $E="firestore.googleapis.com",Wv=!0;class qv{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new H(V.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=$E,this.ssl=Wv}else this.host=e.host,this.ssl=e.ssl??Wv;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=vE;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<_E)throw new H(V.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}bA("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=zE(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new H(V.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new H(V.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new H(V.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Lu{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new qv({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new H(V.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new H(V.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new qv(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new xA;switch(r.type){case"firstParty":return new CA(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new H(V.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Hv.get(n);r&&(K("ComponentProvider","Removing Datastore"),Hv.delete(n),r.terminate())}(this),Promise.resolve()}}function g4(t,e,n,r={}){var u;t=Ct(t,Lu);const s=Rs(e),i=t._getSettings(),o={...i,emulatorOptions:t._getEmulatorOptions()},l=`${e}:${n}`;s&&(_p(`https://${l}`),F0("Firestore",!0)),i.host!==$E&&i.host!==l&&Ci("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...i,host:l,ssl:s,emulatorOptions:r};if(!Or(c,o)&&(t._setSettings(c),r.mockUserToken)){let f,m;if(typeof r.mockUserToken=="string")f=r.mockUserToken,m=yt.MOCK_USER;else{f=W2(r.mockUserToken,(u=t._app)==null?void 0:u.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new H(V.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new yt(g)}t._authCredentials=new TA(new Aw(f,m))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Qr(this.firestore,e,this._query)}}class Pe{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Dr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Pe(this.firestore,e,this._key)}toJSON(){return{type:Pe._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(Fa(n,Pe._jsonSchema))return new Pe(e,r||null,new Y(ye.fromString(n.referencePath)))}}Pe._jsonSchemaVersion="firestore/documentReference/1.0",Pe._jsonSchema={type:ze("string",Pe._jsonSchemaVersion),referencePath:ze("string")};class Dr extends Qr{constructor(e,n,r){super(e,n,Au(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Pe(this.firestore,null,new Y(e))}withConverter(e){return new Dr(this.firestore,e,this._path)}}function $s(t,e,...n){if(t=tt(t),Pw("collection","path",e),t instanceof Lu){const r=ye.fromString(e,...n);return ov(r),new Dr(t,null,r)}{if(!(t instanceof Pe||t instanceof Dr))throw new H(V.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ye.fromString(e,...n));return ov(r),new Dr(t.firestore,null,r)}}function vn(t,e,...n){if(t=tt(t),arguments.length===1&&(e=Dp.newId()),Pw("doc","path",e),t instanceof Lu){const r=ye.fromString(e,...n);return iv(r),new Pe(t,null,new Y(r))}{if(!(t instanceof Pe||t instanceof Dr))throw new H(V.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ye.fromString(e,...n));return iv(r),new Pe(t.firestore,t instanceof Dr?t.converter:null,new Y(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kv="AsyncQueue";class Qv{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new TE(this,"async_queue_retry"),this._c=()=>{const r=Uh();r&&K(Kv,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=Uh();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Uh();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new Gn;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!zi(e))throw e;K(Kv,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,Jn("INTERNAL UNHANDLED ERROR: ",Yv(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const s=Xp.createAndSchedule(this,e,n,r,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&J(47125,{Pc:Yv(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function Yv(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jv(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class bn extends Lu{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new Qv,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Qv(e),this._firestoreClient=void 0,await e}}}function y4(t,e,n){n||(n=Ea);const r=Eu(t,"firestore");if(r.isInitialized(n)){const s=r.getImmediate({identifier:n}),i=r.getOptions(n);if(Or(i,e))return s;throw new H(V.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new H(V.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<_E)throw new H(V.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&Rs(e.host)&&_p(e.host),r.initialize({options:e,instanceIdentifier:n})}function v4(t,e){const n=typeof t=="object"?t:$0(),r=typeof t=="string"?t:e||Ea,s=Eu(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=G2("firestore");i&&g4(s,...i)}return s}function Wi(t){if(t._terminated)throw new H(V.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||_4(t),t._firestoreClient}function _4(t){var r,s,i;const e=t._freezeSettings(),n=function(l,c,u,f){return new $A(l,c,u,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,zE(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new u4(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}function w4(t){return d4(Wi(t=Ct(t,bn)))}function E4(t){return f4(Wi(t=Ct(t,bn)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jt{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Jt(ht.fromBase64String(e))}catch(n){throw new H(V.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Jt(ht.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Jt._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Fa(e,Jt._jsonSchema))return Jt.fromBase64String(e.bytes)}}Jt._jsonSchemaVersion="firestore/bytes/1.0",Jt._jsonSchema={type:ze("string",Jt._jsonSchemaVersion),bytes:ze("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mu{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new H(V.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new lt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lm{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nn{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new H(V.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new H(V.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ae(this._lat,e._lat)||ae(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Nn._jsonSchemaVersion}}static fromJSON(e){if(Fa(e,Nn._jsonSchema))return new Nn(e.latitude,e.longitude)}}Nn._jsonSchemaVersion="firestore/geoPoint/1.0",Nn._jsonSchema={type:ze("string",Nn._jsonSchemaVersion),latitude:ze("number"),longitude:ze("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class An{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:An._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Fa(e,An._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new An(e.vectorValues);throw new H(V.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}An._jsonSchemaVersion="firestore/vectorValue/1.0",An._jsonSchema={type:ze("string",An._jsonSchemaVersion),vectorValues:ze("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x4=/^__.*__$/;class T4{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Kr(e,this.data,this.fieldMask,n,this.fieldTransforms):new Ua(e,this.data,n,this.fieldTransforms)}}class GE{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Kr(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function HE(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw J(40011,{Ac:t})}}class cm{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new cm({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Zc(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(HE(this.Ac)&&x4.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class I4{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Vu(e)}Cc(e,n,r,s=!1){return new cm({Ac:e,methodName:n,Dc:r,path:lt.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function um(t){const e=t._freezeSettings(),n=Vu(t._databaseId);return new I4(t._databaseId,!!e.ignoreUndefinedProperties,n)}function S4(t,e,n,r,s,i={}){const o=t.Cc(i.merge||i.mergeFields?2:0,e,n,s);hm("Data must be an object, but it was:",o,r);const l=WE(r,o);let c,u;if(i.merge)c=new Gt(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){const f=[];for(const m of i.mergeFields){const g=yf(e,m,n);if(!o.contains(g))throw new H(V.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);KE(f,g)||f.push(g)}c=new Gt(f),u=o.fieldTransforms.filter(m=>c.covers(m.field))}else c=null,u=o.fieldTransforms;return new T4(new Dt(l),c,u)}class Fu extends lm{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Fu}}function C4(t,e,n,r){const s=t.Cc(1,e,n);hm("Data must be an object, but it was:",s,r);const i=[],o=Dt.empty();qr(r,(c,u)=>{const f=dm(e,c,n);u=tt(u);const m=s.yc(f);if(u instanceof Fu)i.push(f);else{const g=Ga(u,m);g!=null&&(i.push(f),o.set(f,g))}});const l=new Gt(i);return new GE(o,l,s.fieldTransforms)}function R4(t,e,n,r,s,i){const o=t.Cc(1,e,n),l=[yf(e,r,n)],c=[s];if(i.length%2!=0)throw new H(V.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<i.length;g+=2)l.push(yf(e,i[g])),c.push(i[g+1]);const u=[],f=Dt.empty();for(let g=l.length-1;g>=0;--g)if(!KE(u,l[g])){const w=l[g];let R=c[g];R=tt(R);const N=o.yc(w);if(R instanceof Fu)u.push(w);else{const P=Ga(R,N);P!=null&&(u.push(w),f.set(w,P))}}const m=new Gt(u);return new GE(f,m,o.fieldTransforms)}function N4(t,e,n,r=!1){return Ga(n,t.Cc(r?4:3,e))}function Ga(t,e){if(qE(t=tt(t)))return hm("Unsupported field value:",e,t),WE(t,e);if(t instanceof lm)return function(r,s){if(!HE(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const l of r){let c=Ga(l,s.wc(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=tt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return hP(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=he.fromDate(r);return{timestampValue:Kc(s.serializer,i)}}if(r instanceof he){const i=new he(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Kc(s.serializer,i)}}if(r instanceof Nn)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Jt)return{bytesValue:hE(s.serializer,r._byteString)};if(r instanceof Pe){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:$p(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof An)return function(o,l){return{mapValue:{fields:{[Fw]:{stringValue:Bw},[Gc]:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw l.Sc("VectorValues must only contain numeric values.");return Fp(l.serializer,u)})}}}}}}(r,s);throw s.Sc(`Unsupported field value: ${Su(r)}`)}(t,e)}function WE(t,e){const n={};return Dw(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):qr(t,(r,s)=>{const i=Ga(s,e.mc(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function qE(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof he||t instanceof Nn||t instanceof Jt||t instanceof Pe||t instanceof lm||t instanceof An)}function hm(t,e,n){if(!qE(n)||!kw(n)){const r=Su(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function yf(t,e,n){if((e=tt(e))instanceof Mu)return e._internalPath;if(typeof e=="string")return dm(t,e);throw Zc("Field path arguments must be of type string or ",t,!1,void 0,n)}const A4=new RegExp("[~\\*/\\[\\]]");function dm(t,e,n){if(e.search(A4)>=0)throw Zc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Mu(...e.split("."))._internalPath}catch{throw Zc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Zc(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new H(V.INVALID_ARGUMENT,l+t+c)}function KE(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QE{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Pe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new P4(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(fm("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class P4 extends QE{data(){return super.data()}}function fm(t,e){return typeof e=="string"?dm(t,e):e instanceof Mu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YE(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new H(V.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class pm{}class JE extends pm{}function Vl(t,e,...n){let r=[];e instanceof pm&&r.push(e),r=r.concat(n),function(i){const o=i.filter(c=>c instanceof gm).length,l=i.filter(c=>c instanceof mm).length;if(o>1||o>0&&l>0)throw new H(V.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class mm extends JE{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new mm(e,n,r)}_apply(e){const n=this._parse(e);return XE(e._query,n),new Qr(e.firestore,e.converter,of(e._query,n))}_parse(e){const n=um(e.firestore);return function(i,o,l,c,u,f,m){let g;if(u.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new H(V.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){Zv(m,f);const R=[];for(const N of m)R.push(Xv(c,i,N));g={arrayValue:{values:R}}}else g=Xv(c,i,m)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||Zv(m,f),g=N4(l,o,m,f==="in"||f==="not-in");return Be.create(u,f,g)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}class gm extends pm{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new gm(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:mn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const l=i.getFlattenedFilters();for(const c of l)XE(o,c),o=of(o,c)}(e._query,n),new Qr(e.firestore,e.converter,of(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class ym extends JE{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new ym(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new H(V.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new H(V.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ia(i,o)}(e._query,this._field,this._direction);return new Qr(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new $i(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function Ol(t,e="asc"){const n=e,r=fm("orderBy",t);return ym._create(r,n)}function Xv(t,e,n){if(typeof(n=tt(n))=="string"){if(n==="")throw new H(V.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Qw(e)&&n.indexOf("/")!==-1)throw new H(V.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(ye.fromString(n));if(!Y.isDocumentKey(r))throw new H(V.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return pv(t,new Y(r))}if(n instanceof Pe)return pv(t,n._key);throw new H(V.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Su(n)}.`)}function Zv(t,e){if(!Array.isArray(t)||t.length===0)throw new H(V.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function XE(t,e){const n=function(s,i){for(const o of s)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new H(V.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new H(V.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class k4{convertValue(e,n="none"){switch(Ur(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ve(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Fr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw J(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return qr(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var r,s,i;const n=(i=(s=(r=e.fields)==null?void 0:r[Gc].arrayValue)==null?void 0:s.values)==null?void 0:i.map(o=>Ve(o.doubleValue));return new An(n)}convertGeoPoint(e){return new Nn(Ve(e.latitude),Ve(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Nu(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(wa(e));default:return null}}convertTimestamp(e){const n=Mr(e);return new he(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=ye.fromString(e);pe(yE(r),9688,{name:e});const s=new xa(r.get(1),r.get(3)),i=new Y(r.popFirst(5));return s.isEqual(n)||Jn(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b4(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class jo{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ps extends QE{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new sc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(fm("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new H(V.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=ps._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}ps._jsonSchemaVersion="firestore/documentSnapshot/1.0",ps._jsonSchema={type:ze("string",ps._jsonSchemaVersion),bundleSource:ze("string","DocumentSnapshot"),bundleName:ze("string"),bundle:ze("string")};class sc extends ps{data(e={}){return super.data(e)}}class ms{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new jo(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new sc(this._firestore,this._userDataWriter,r.key,r,new jo(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new H(V.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(l=>{const c=new sc(s._firestore,s._userDataWriter,l.doc.key,l.doc,new jo(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const c=new sc(s._firestore,s._userDataWriter,l.doc.key,l.doc,new jo(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,f=-1;return l.type!==0&&(u=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),f=o.indexOf(l.doc.key)),{type:D4(l.type),doc:c,oldIndex:u,newIndex:f}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new H(V.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ms._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Dp.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function D4(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return J(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZE(t){t=Ct(t,Pe);const e=Ct(t.firestore,bn);return p4(Wi(e),t._key).then(n=>ex(e,t,n))}ms._jsonSchemaVersion="firestore/querySnapshot/1.0",ms._jsonSchema={type:ze("string",ms._jsonSchemaVersion),bundleSource:ze("string","QuerySnapshot"),bundleName:ze("string"),bundle:ze("string")};class vm extends k4{constructor(e){super(),this.firestore=e}convertBytes(e){return new Jt(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Pe(this.firestore,null,n)}}function Io(t){t=Ct(t,Qr);const e=Ct(t.firestore,bn),n=Wi(e),r=new vm(e);return YE(t._query),m4(n,t._query).then(s=>new ms(e,r,t,s))}function ic(t,e,n){t=Ct(t,Pe);const r=Ct(t.firestore,bn),s=b4(t.converter,e,n);return _m(r,[S4(um(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,fn.none())])}function zh(t,e,n,...r){t=Ct(t,Pe);const s=Ct(t.firestore,bn),i=um(s);let o;return o=typeof(e=tt(e))=="string"||e instanceof Mu?R4(i,"updateDoc",t._key,e,n,r):C4(i,"updateDoc",t._key,e),_m(s,[o.toMutation(t._key,fn.exists(!0))])}function $h(t){return _m(Ct(t.firestore,bn),[new Up(t._key,fn.none())])}function j4(t,...e){var c,u,f;t=tt(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||Jv(e[r])||(n=e[r++]);const s={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(Jv(e[r])){const m=e[r];e[r]=(c=m.next)==null?void 0:c.bind(m),e[r+1]=(u=m.error)==null?void 0:u.bind(m),e[r+2]=(f=m.complete)==null?void 0:f.bind(m)}let i,o,l;if(t instanceof Pe)o=Ct(t.firestore,bn),l=Au(t._key.path),i={next:m=>{e[r]&&e[r](ex(o,t,m))},error:e[r+1],complete:e[r+2]};else{const m=Ct(t,Qr);o=Ct(m.firestore,bn),l=m._query;const g=new vm(o);i={next:w=>{e[r]&&e[r](new ms(o,g,m,w))},error:e[r+1],complete:e[r+2]},YE(t._query)}return function(g,w,R,N){const P=new om(N),x=new rm(w,P,R);return g.asyncQueue.enqueueAndForget(async()=>em(await Xc(g),x)),()=>{P.Nu(),g.asyncQueue.enqueueAndForget(async()=>tm(await Xc(g),x))}}(Wi(o),l,s,i)}function _m(t,e){return function(r,s){const i=new Gn;return r.asyncQueue.enqueueAndForget(async()=>t4(await h4(r),s,i)),i.promise}(Wi(t),e)}function ex(t,e,n){const r=n.docs.get(e._key),s=new vm(t);return new ps(t,s,e._key,r,new jo(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(s){Ui=s})(Mi),Ii(new Es("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),l=new bn(new IA(r.getProvider("auth-internal")),new RA(o,r.getProvider("app-check-internal")),function(u,f){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new H(V.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new xa(u.options.projectId,f)}(o,s),o);return i={useFetchStreams:n,...i},l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),kr(tv,nv,e),kr(tv,nv,"esm2020")})();const V4={apiKey:"AIzaSyBBJxbUabZm4ZKhDhIgbN4L3RzSHTB9HRs",authDomain:"knitting-counter-web.firebaseapp.com",projectId:"knitting-counter-web",storageBucket:"knitting-counter-web.firebasestorage.app",messagingSenderId:"991773187813",appId:"1:991773187813:web:97c6cd3d3e0add31213e0c",measurementId:"G-4T4J8NYV3D"},vf=z0(V4),oc=vA(vf);let Fe;try{Fe=y4(vf,{experimentalForceLongPolling:!1,experimentalAutoDetectLongPolling:!0,ignoreUndefinedProperties:!0,cacheSizeBytes:40*1024*1024,localCache:{kind:"persistent"}})}catch{console.log("Firestore already initialized, using existing instance"),Fe=v4(vf)}const O4=new Mn,ot=P0()(k0((t,e)=>({user:null,isLoading:!1,error:null,setUser:n=>t({user:n}),setLoading:n=>t({isLoading:n}),setError:n=>t({error:n}),signInWithGoogle:async()=>{try{t({isLoading:!0,error:null});const n=await RN(oc,O4);t({user:n.user,isLoading:!1})}catch(n){console.error("Google 登入失敗:",n),t({error:n.message||"登入失敗",isLoading:!1})}},signOut:async()=>{try{t({isLoading:!0,error:null}),await aN(oc),t({user:null,isLoading:!1})}catch(n){console.error("登出失敗:",n),t({error:n.message||"登出失敗",isLoading:!1})}},initialize:()=>oN(oc,n=>{t({user:n,isLoading:!1})})}),{name:"auth-storage",partialize:t=>({user:t.user})}));class L4{async getUserProfile(e){try{const n=vn(Fe,"users",e,"profile","info"),r=await ZE(n);if(r.exists()){const s=r.data();return{uid:s.uid,displayName:s.displayName,email:s.email,createdAt:s.createdAt.toDate(),lastLogin:s.lastLogin.toDate()}}return null}catch(n){throw console.error("Error getting user profile:",n),n}}async createUserProfile(e){try{const n=vn(Fe,"users",e.uid,"profile","info");await ic(n,{uid:e.uid,displayName:e.displayName,email:e.email,createdAt:he.fromDate(e.createdAt),lastLogin:he.fromDate(e.lastLogin)})}catch(n){throw console.error("Error creating user profile:",n),n}}async updateUserLastLogin(e){try{const n=vn(Fe,"users",e,"profile","info");await zh(n,{lastLogin:he.fromDate(new Date)})}catch(n){throw console.error("Error updating last login:",n),n}}async getUserProjects(e){try{const n=$s(Fe,"users",e,"projects"),r=Vl(n,Ol("lastModified","desc")),s=await Io(r),i=[];for(const o of s.docs){const l=o.data(),c=$s(Fe,"users",e,"projects",o.id,"rounds"),u=Vl(c,Ol("roundNumber")),m=(await Io(u)).docs.map(g=>{const w=g.data();return{id:w.id,roundNumber:w.roundNumber,stitches:w.stitches,stitchGroups:w.stitchGroups,notes:w.notes}});i.push({id:l.id,name:l.name,source:l.source,pattern:m,currentRound:l.currentRound,currentStitch:l.currentStitch,yarns:l.yarns,sessions:l.sessions.map(g=>({...g,startTime:g.startTime instanceof Date?g.startTime:g.startTime.toDate()})),createdDate:l.createdDate instanceof Date?l.createdDate:l.createdDate.toDate(),lastModified:l.lastModified instanceof Date?l.lastModified:l.lastModified.toDate(),isCompleted:l.isCompleted})}return i}catch(n){throw console.error("Error getting user projects:",n),n}}async createProject(e,n){var r;try{const s=vn(Fe,"users",e,"projects",n.id),i={id:n.id,name:n.name,source:n.source||"",currentRound:n.currentRound,currentStitch:n.currentStitch,yarns:n.yarns||[],sessions:((r=n.sessions)==null?void 0:r.map(o=>({...o,startTime:o.startTime})))||[],createdDate:n.createdDate,lastModified:n.lastModified,isCompleted:n.isCompleted??!1};await ic(s,{...i,createdDate:he.fromDate(i.createdDate),lastModified:he.fromDate(i.lastModified),sessions:i.sessions.map(o=>({...o,startTime:he.fromDate(o.startTime)}))});for(const o of n.pattern)await this.createRound(e,n.id,o)}catch(s){throw console.error("Error creating project:",s),s}}async updateProject(e,n){var r;try{const s=vn(Fe,"users",e,"projects",n.id),i={name:n.name,source:n.source||"",currentRound:n.currentRound,currentStitch:n.currentStitch,yarns:n.yarns||[],sessions:((r=n.sessions)==null?void 0:r.map(o=>({...o,startTime:o.startTime})))||[],lastModified:n.lastModified,isCompleted:n.isCompleted??!1};await zh(s,{...i,lastModified:he.fromDate(i.lastModified),sessions:i.sessions.map(o=>({...o,startTime:he.fromDate(o.startTime)}))}),await this.syncRounds(e,n.id,n.pattern)}catch(s){throw console.error("Error updating project:",s),s}}async deleteProject(e,n){try{const r=$s(Fe,"users",e,"projects",n,"rounds"),s=await Io(r);for(const o of s.docs)await $h(o.ref);const i=vn(Fe,"users",e,"projects",n);await $h(i)}catch(r){throw console.error("Error deleting project:",r),r}}async createRound(e,n,r){try{const s=vn(Fe,"users",e,"projects",n,"rounds",r.id);await ic(s,{id:r.id,roundNumber:r.roundNumber,stitches:r.stitches,stitchGroups:r.stitchGroups,notes:r.notes})}catch(s){throw console.error("Error creating round:",s),s}}async updateRound(e,n,r){try{const s=vn(Fe,"users",e,"projects",n,"rounds",r.id);await zh(s,{roundNumber:r.roundNumber,stitches:r.stitches,stitchGroups:r.stitchGroups,notes:r.notes})}catch(s){throw console.error("Error updating round:",s),s}}async deleteRound(e,n,r){try{const s=vn(Fe,"users",e,"projects",n,"rounds",r);await $h(s)}catch(s){throw console.error("Error deleting round:",s),s}}async syncRounds(e,n,r){try{const s=$s(Fe,"users",e,"projects",n,"rounds"),i=await Io(s),o=new Set(i.docs.map(c=>c.id)),l=new Set(r.map(c=>c.id));for(const c of o)l.has(c)||await this.deleteRound(e,n,c);for(const c of r)o.has(c.id)?await this.updateRound(e,n,c):await this.createRound(e,n,c)}catch(s){throw console.error("Error syncing rounds:",s),s}}subscribeToUserProjects(e,n){const r=$s(Fe,"users",e,"projects"),s=Vl(r,Ol("lastModified","desc"));return j4(s,async i=>{try{const o=[];for(const l of i.docs){const c=l.data(),u=$s(Fe,"users",e,"projects",l.id,"rounds"),f=Vl(u,Ol("roundNumber")),g=(await Io(f)).docs.map(w=>{const R=w.data();return{id:R.id,roundNumber:R.roundNumber,stitches:R.stitches,stitchGroups:R.stitchGroups,notes:R.notes}});o.push({id:c.id,name:c.name,source:c.source,pattern:g,currentRound:c.currentRound,currentStitch:c.currentStitch,yarns:c.yarns,sessions:c.sessions.map(w=>({...w,startTime:w.startTime instanceof Date?w.startTime:w.startTime.toDate()})),createdDate:c.createdDate instanceof Date?c.createdDate:c.createdDate.toDate(),lastModified:c.lastModified instanceof Date?c.lastModified:c.lastModified.toDate(),isCompleted:c.isCompleted})}n(o)}catch(o){console.error("Error in projects subscription:",o)}})}async enableOfflineSupport(){try{await w4(Fe)}catch(e){console.error("Error enabling offline support:",e)}}async disableOfflineSupport(){try{await E4(Fe)}catch(e){console.error("Error disabling offline support:",e)}}}const je=new L4,Bt=P0()(k0((t,e)=>({projects:[],currentProject:null,isLoading:!1,error:null,isSyncing:!1,lastSyncTime:null,isLocallyUpdating:!1,setLoading:n=>t({isLoading:n}),setError:n=>t({error:n}),setSyncing:n=>t({isSyncing:n}),clearUserData:()=>{t({projects:[],currentProject:null,error:null,lastSyncTime:null})},clearUserDataSilently:()=>{const n=e();Object.assign(n,{projects:[],currentProject:null,error:null,lastSyncTime:null})},loadUserProjects:async()=>{const{user:n}=ot.getState();if(!n){e().clearUserDataSilently();return}try{t({isLoading:!0,error:null});const r=await je.getUserProjects(n.uid);if(r.length>0){console.log("Loaded projects from Firestore:",r.length),t({projects:r,currentProject:r[0]||null,lastSyncTime:new Date});return}const s=`user_${n.uid}_knitting-counter-storage`,i=localStorage.getItem(s);if(i)try{const l=JSON.parse(i),c=l.state||l;if(c.projects&&c.projects.length>0){const u=c.projects.map(f=>{var m;return{...f,createdDate:new Date(f.createdDate),lastModified:new Date(f.lastModified),sessions:((m=f.sessions)==null?void 0:m.map(g=>({...g,startTime:new Date(g.startTime)})))||[]}});console.log("Migrating local projects to Firestore:",u.length);for(const f of u)await je.createProject(n.uid,f);t({projects:u,currentProject:u[0]||null,lastSyncTime:new Date});return}}catch(l){console.error("Error parsing saved data:",l)}console.log("No data found, creating sample project");const o=Ah();await je.createProject(n.uid,o),t({projects:[o],currentProject:o,lastSyncTime:new Date})}catch(r){console.error("Error loading user projects:",r),t({error:"載入專案時發生錯誤"});const s=`user_${n.uid}_knitting-counter-storage`,i=localStorage.getItem(s);if(i)try{const o=JSON.parse(i),l=o.state||o;if(l.projects){const c=l.projects.map(u=>{var f;return{...u,createdDate:new Date(u.createdDate),lastModified:new Date(u.lastModified),sessions:((f=u.sessions)==null?void 0:f.map(m=>({...m,startTime:new Date(m.startTime)})))||[]}});t({projects:c,currentProject:c[0]||null})}}catch(o){console.error("Error loading from localStorage:",o);const l=Ah();t({projects:[l],currentProject:l})}}finally{t({isLoading:!1})}},syncWithFirestore:async()=>{const{user:n}=ot.getState();if(n)try{t({isSyncing:!0,error:null});const r=await je.getUserProjects(n.uid);t({projects:r,currentProject:r.find(s=>{var i;return s.id===((i=e().currentProject)==null?void 0:i.id)})||r[0]||null,lastSyncTime:new Date})}catch(r){console.error("Error syncing with Firestore:",r),t({error:"同步失敗"})}finally{t({isSyncing:!1})}},initializeUserProfile:async n=>{try{if(await je.getUserProfile(n.uid))await je.updateUserLastLogin(n.uid);else{const s={uid:n.uid,displayName:n.displayName,email:n.email,createdAt:new Date,lastLogin:new Date};await je.createUserProfile(s)}}catch(r){console.error("Error initializing user profile:",r)}},subscribeToFirestoreChanges:()=>{const{user:n}=ot.getState();return n?je.subscribeToUserProjects(n.uid,r=>{const s=e();!s.isSyncing&&!s.isLocallyUpdating&&t({projects:r,currentProject:r.find(i=>{var o;return i.id===((o=s.currentProject)==null?void 0:o.id)})||r[0]||null,lastSyncTime:new Date})}):null},createProject:async(n,r)=>{const{user:s}=ot.getState(),i={id:Ze(),name:n,source:r||"",pattern:[],currentRound:1,currentStitch:0,yarns:[],sessions:[],createdDate:new Date,lastModified:new Date,isCompleted:!1};if(t(o=>({projects:[...o.projects,i],currentProject:i})),s)try{await je.createProject(s.uid,i),t({lastSyncTime:new Date})}catch(o){console.error("Error syncing new project to Firestore:",o)}},updateProject:async n=>{const{user:r}=ot.getState(),s={...n,lastModified:new Date};if(t(i=>{var o;return{projects:i.projects.map(l=>l.id===n.id?s:l),currentProject:((o=i.currentProject)==null?void 0:o.id)===n.id?s:i.currentProject}}),r)try{await je.updateProject(r.uid,s),t({lastSyncTime:new Date})}catch(i){console.error("Error syncing project update to Firestore:",i)}},deleteProject:async n=>{const{user:r}=ot.getState();if(t(s=>{var i;return{projects:s.projects.filter(o=>o.id!==n),currentProject:((i=s.currentProject)==null?void 0:i.id)===n?null:s.currentProject}}),r)try{await je.deleteProject(r.uid,n),t({lastSyncTime:new Date})}catch(s){console.error("Error syncing project deletion to Firestore:",s)}},setCurrentProject:n=>{const r=e().projects.find(s=>s.id===n);r&&t({currentProject:r})},loadProjects:async()=>{const{projects:n}=e();if(n.length===0){const r=Ah();t({projects:[r],currentProject:r})}},nextStitch:async()=>{const{currentProject:n}=e();if(!n||n.isCompleted){console.log("[DEBUG] nextStitch: No current project or already completed");return}if(!n.pattern||n.pattern.length===0){console.log("[DEBUG] nextStitch: No pattern available");return}const r=n.pattern.find(u=>u.roundNumber===n.currentRound);if(!r){console.log("[DEBUG] nextStitch: Current round not found",n.currentRound);const u=Math.min(...n.pattern.map(m=>m.roundNumber)),f={...n,currentRound:u,currentStitch:0,lastModified:new Date};await e().updateProjectLocally(f);return}const s=zt(r);let i=n.currentStitch+1,o=n.currentRound,l=!1;if(i>=s){const u=Math.max(...n.pattern.map(f=>f.roundNumber));if(n.currentRound>=u)l=!0,i=s,o=n.currentRound;else{const f=n.currentRound+1;n.pattern.find(g=>g.roundNumber===f)?(i=0,o=f):(i=s,o=n.currentRound,l=!0)}}const c={...n,currentRound:o,currentStitch:i,isCompleted:l,lastModified:new Date};await e().updateProjectLocally(c)},previousStitch:async()=>{const{currentProject:n}=e();if(!n)return;if(!n.pattern||n.pattern.length===0){console.log("[DEBUG] previousStitch: No pattern available");return}let r=n.currentStitch-1,s=n.currentRound;if(r<0&&s>1){for(let l=n.currentRound-1;l>=1;l--){const c=n.pattern.find(u=>u.roundNumber===l);if(c){s=l,r=zt(c)-1;break}}r<0&&(r=0,s=n.currentRound)}else r<0&&(r=0);n.pattern.find(l=>l.roundNumber===s)||(console.log("[DEBUG] previousStitch: Target round not found",s),s=Math.min(...n.pattern.map(c=>c.roundNumber)),r=0);const o={...n,currentRound:s,currentStitch:r,isCompleted:!1,lastModified:new Date};await e().updateProjectLocally(o)},setCurrentRound:async n=>{const{currentProject:r}=e();if(!r)return;const s={...r,currentRound:n,currentStitch:0,lastModified:new Date};await e().updateProjectLocally(s)},setCurrentStitch:async n=>{const{currentProject:r}=e();if(!r)return;const s={...r,currentStitch:n,lastModified:new Date};await e().updateProjectLocally(s)},startSession:async()=>{const{currentProject:n}=e();if(!n)return;const r={id:Ze(),startTime:new Date,duration:0,roundsCompleted:0,stitchesCompleted:0},s={...n,sessions:[...n.sessions,r],lastModified:new Date};await e().updateProjectLocally(s)},endSession:async()=>{const{currentProject:n}=e();if(!n||n.sessions.length===0)return;const r=n.sessions[n.sessions.length-1];if(r.duration>0)return;const i=Math.floor((new Date().getTime()-r.startTime.getTime())/1e3),o={...r,duration:i},l={...n,sessions:[...n.sessions.slice(0,-1),o],lastModified:new Date};await e().updateProjectLocally(l)},updateProjectLocally:async n=>{t(s=>{var i;return{isLocallyUpdating:!0,projects:s.projects.map(o=>o.id===n.id?n:o),currentProject:((i=s.currentProject)==null?void 0:i.id)===n.id?n:s.currentProject}});const{user:r}=ot.getState();if(r)try{await je.updateProject(r.uid,n),t({lastSyncTime:new Date,isLocallyUpdating:!1})}catch(s){console.error("Error syncing project update to Firestore:",s),t({isLocallyUpdating:!1})}else t({isLocallyUpdating:!1})},addRound:async n=>{const{currentProject:r}=e();if(!r)return;const s={...r,pattern:[...r.pattern,n],lastModified:new Date};await e().updateProjectLocally(s)},updateRound:async n=>{const{currentProject:r}=e();if(!r)return;const s={...r,pattern:r.pattern.map(i=>i.id===n.id?n:i),lastModified:new Date};await e().updateProjectLocally(s)},deleteRound:async n=>{const{currentProject:r}=e();if(!r)return;const i=r.pattern.filter(f=>f.roundNumber!==n).map(f=>f.roundNumber>n?{...f,roundNumber:f.roundNumber-1}:f);let o=r.currentRound,l=r.currentStitch;if(r.currentRound===n)if(n>1&&i.find(f=>f.roundNumber===n-1)){const f=i.find(m=>m.roundNumber===n-1);f&&(o=n-1,l=zt(f))}else i.find(f=>f.roundNumber===n)?(o=n,l=0):(o=1,l=0);else r.currentRound>n&&(o=Math.max(1,r.currentRound-1));const c=Math.max(1,...i.map(f=>f.roundNumber));if(o>c){o=c;const f=i.find(m=>m.roundNumber===c);l=f?zt(f):0}else{const f=i.find(m=>m.roundNumber===o);if(f){const m=zt(f);l=Math.min(l,m)}}const u={...r,pattern:i,currentRound:o,currentStitch:l,lastModified:new Date};await e().updateProjectLocally(u)},addStitchToRound:async(n,r)=>{const{currentProject:s}=e();if(!s)return;const i=s.pattern.map(l=>l.roundNumber===n?{...l,stitches:[...l.stitches,r]}:l),o={...s,pattern:i,lastModified:new Date};await e().updateProjectLocally(o)},addStitchGroupToRound:async(n,r)=>{const{currentProject:s}=e();if(!s)return;const i=s.pattern.map(l=>l.roundNumber===n?{...l,stitchGroups:[...l.stitchGroups,r]}:l),o={...s,pattern:i,lastModified:new Date};await e().updateProjectLocally(o)},updateStitchInRound:async(n,r,s)=>{const{currentProject:i}=e();if(!i)return;const o=i.pattern.map(c=>c.roundNumber===n?{...c,stitches:c.stitches.map(u=>u.id===r?s:u)}:c),l={...i,pattern:o,lastModified:new Date};await e().updateProjectLocally(l)},deleteStitchFromRound:async(n,r)=>{const{currentProject:s}=e();if(!s)return;const i=s.pattern.map(l=>l.roundNumber===n?{...l,stitches:l.stitches.filter(c=>c.id!==r)}:l),o={...s,pattern:i,lastModified:new Date};await e().updateProjectLocally(o)},reorderStitchesInRound:async(n,r,s)=>{const{currentProject:i}=e();if(!i)return;const o=i.pattern.map(c=>{if(c.roundNumber===n){const u=[...c.stitches],[f]=u.splice(r,1);return u.splice(s,0,f),{...c,stitches:u}}return c}),l={...i,pattern:o,lastModified:new Date};await e().updateProjectLocally(l)},updateStitchGroupInRound:async(n,r,s)=>{const{currentProject:i}=e();if(!i)return;const o=i.pattern.map(c=>c.roundNumber===n?{...c,stitchGroups:c.stitchGroups.map(u=>u.id===r?s:u)}:c),l={...i,pattern:o,lastModified:new Date};await e().updateProjectLocally(l)},updateStitchInGroup:async(n,r,s,i)=>{const{currentProject:o}=e();if(!o)return;const l=o.pattern.map(u=>u.roundNumber===n?{...u,stitchGroups:u.stitchGroups.map(f=>f.id===r?{...f,stitches:f.stitches.map(m=>m.id===s?i:m)}:f)}:u),c={...o,pattern:l,lastModified:new Date};await e().updateProjectLocally(c)},deleteStitchGroupFromRound:async(n,r)=>{const{currentProject:s}=e();if(!s)return;const i=s.pattern.map(l=>l.roundNumber===n?{...l,stitchGroups:l.stitchGroups.filter(c=>c.id!==r)}:l),o={...s,pattern:i,lastModified:new Date};await e().updateProjectLocally(o)},reorderStitchGroupsInRound:async(n,r,s)=>{const{currentProject:i}=e();if(!i)return;const o=i.pattern.map(c=>{if(c.roundNumber===n){const u=[...c.stitchGroups],[f]=u.splice(r,1);return u.splice(s,0,f),{...c,stitchGroups:u}}return c}),l={...i,pattern:o,lastModified:new Date};await e().updateProjectLocally(l)},addYarn:async n=>{const{currentProject:r}=e();if(!r)return;const s={...r,yarns:[...r.yarns,n],lastModified:new Date};await e().updateProjectLocally(s)},updateYarn:async n=>{const{currentProject:r}=e();if(!r)return;const s={...r,yarns:r.yarns.map(i=>i.id===n.id?n:i),lastModified:new Date};await e().updateProjectLocally(s)},deleteYarn:async n=>{const{currentProject:r}=e();if(!r)return;const s={...r,yarns:r.yarns.filter(i=>i.id!==n),lastModified:new Date};await e().updateProjectLocally(s)}}),{name:"synced-knitting-counter-storage",version:1,partialize:t=>({projects:t.projects,currentProject:t.currentProject,lastSyncTime:t.lastSyncTime}),storage:{getItem:t=>{var s;const{user:e}=ot.getState();if(console.log("getItem called:",{name:t,user:e==null?void 0:e.uid}),!e)return console.log("No user - returning empty state"),JSON.stringify({state:{projects:[],currentProject:null,lastSyncTime:null},version:1});const n=`user_${e.uid}_${t}`,r=localStorage.getItem(n);if(console.log("Loading from storage:",{userStorageKey:n,hasData:!!r}),!r)return console.log("No data found - returning empty state"),JSON.stringify({state:{projects:[],currentProject:null,lastSyncTime:null},version:1});try{const i=JSON.parse(r);return i.state&&(i.state.projects&&(i.state.projects=i.state.projects.map(o=>{var l;return{...o,createdDate:new Date(o.createdDate),lastModified:new Date(o.lastModified),sessions:((l=o.sessions)==null?void 0:l.map(c=>({...c,startTime:new Date(c.startTime)})))||[]}})),i.state.currentProject&&(i.state.currentProject={...i.state.currentProject,createdDate:new Date(i.state.currentProject.createdDate),lastModified:new Date(i.state.currentProject.lastModified),sessions:((s=i.state.currentProject.sessions)==null?void 0:s.map(o=>({...o,startTime:new Date(o.startTime)})))||[]}),i.state.lastSyncTime&&(i.state.lastSyncTime=new Date(i.state.lastSyncTime))),i}catch{return null}},setItem:(t,e)=>{var s,i,o,l,c;const{user:n}=ot.getState();if(!n){console.log("No user - skipping save to localStorage");return}const r=`user_${n.uid}_${t}`;console.log(`Saving to ${r}`,{projects:((i=(s=e==null?void 0:e.state)==null?void 0:s.projects)==null?void 0:i.length)||0,currentProject:((l=(o=e==null?void 0:e.state)==null?void 0:o.currentProject)==null?void 0:l.name)||"none",lastSyncTime:(c=e==null?void 0:e.state)==null?void 0:c.lastSyncTime}),localStorage.setItem(r,JSON.stringify(e))},removeItem:t=>{const{user:e}=ot.getState();if(!e)return;const n=`user_${e.uid}_${t}`;localStorage.removeItem(n)}}}));class M4{async mergeLocalAndRemoteData(e,n,r={strategy:"newest_wins",autoResolve:!0}){try{const s=await je.getUserProjects(e);console.log("Merging data:",{localCount:n.length,remoteCount:s.length,strategy:r.strategy});const i={success:!0,merged:[],conflicts:[],errors:[]},o=new Map(n.map(u=>[u.id,u])),l=new Map(s.map(u=>[u.id,u])),c=new Set([...o.keys(),...l.keys()]);for(const u of c){const f=o.get(u),m=l.get(u);if(f&&!m){console.log(`Uploading local-only project: ${f.name}`);try{await je.createProject(e,f),i.merged.push(f)}catch(g){console.error("Error uploading local project:",g),i.errors.push(`Failed to upload project ${f.name}`),i.merged.push(f)}}else if(!f&&m)console.log(`Adding remote-only project: ${m.name}`),i.merged.push(m);else if(f&&m){const g=await this.mergeProjects(e,f,m,r);g.conflict&&!r.autoResolve&&i.conflicts.push(g.conflict),i.merged.push(g.merged)}}return i.conflicts.length>0&&!r.autoResolve&&(i.success=!1),console.log("Merge completed:",{merged:i.merged.length,conflicts:i.conflicts.length,errors:i.errors.length}),i}catch(s){return console.error("Error in merge operation:",s),{success:!1,merged:n,conflicts:[],errors:[s instanceof Error?s.message:"Unknown error during merge"]}}}async mergeProjects(e,n,r,s){const i=n.lastModified.getTime(),o=r.lastModified.getTime();console.log(`Merging project ${n.name}:`,{localTime:new Date(i).toISOString(),remoteTime:new Date(o).toISOString(),timeDiff:i-o});let l,c;switch(Math.abs(i-o)<1e3?c={projectId:n.id,projectName:n.name,localVersion:n,remoteVersion:r,conflictType:"both_modified"}:i>o?c={projectId:n.id,projectName:n.name,localVersion:n,remoteVersion:r,conflictType:"local_newer"}:c={projectId:n.id,projectName:n.name,localVersion:n,remoteVersion:r,conflictType:"remote_newer"},s.strategy){case"local_wins":l=n;break;case"remote_wins":l=r;break;case"newest_wins":default:l=i>=o?n:r;break}if(s.autoResolve)try{await je.updateProject(e,l),console.log(`Auto-resolved conflict for ${l.name}, chose ${i>=o?"local":"remote"} version`),c=void 0}catch(u){console.error("Error auto-resolving conflict:",u),l=n}return{merged:l,conflict:c}}async resolveConflict(e,n,r,s){try{let i;switch(r){case"use_local":i=n.localVersion;break;case"use_remote":i=n.remoteVersion;break;case"custom":if(!s)throw new Error("Custom project required for custom resolution");i=s;break;default:throw new Error(`Unknown resolution type: ${r}`)}return await je.updateProject(e,i),console.log(`Conflict resolved for project ${n.projectName} using ${r}`),!0}catch(i){return console.error("Error resolving conflict:",i),!1}}async syncProjectChanges(e,n){try{const s=(await je.getUserProjects(e)).find(i=>i.id===n.id);return s?s.lastModified.getTime()>n.lastModified.getTime()?(console.log(`Remote version is newer for ${n.name}, skipping sync`),!1):(await je.updateProject(e,n),console.log(`Synced project changes: ${n.name}`),!0):(await je.createProject(e,n),console.log(`Created new project in cloud: ${n.name}`),!0)}catch(r){return console.error("Error syncing project changes:",r),!1}}async performIncrementalSync(e,n,r){try{const s={updated:[],conflicts:[],errors:[]},i=await je.getUserProjects(e),o=n?i.filter(l=>l.lastModified.getTime()>n.getTime()):i;console.log(`Incremental sync: ${o.length} changed remote projects`);for(const l of o){const c=r.find(u=>u.id===l.id);if(!c)s.updated.push(l);else{const u=c.lastModified.getTime(),f=l.lastModified.getTime();if(Math.abs(u-f)>1e3)if(f>u)s.updated.push(l);else try{await je.updateProject(e,c),s.updated.push(c)}catch(m){s.errors.push(`Failed to sync ${c.name}: ${m}`)}}}return s}catch(s){return console.error("Error in incremental sync:",s),{updated:[],conflicts:[],errors:[s instanceof Error?s.message:"Unknown error"]}}}}const e_=new M4;class F4{constructor(){og(this,"unsubscribeFirestore",null)}async handleUserLogin(e){console.log("User logged in:",e.uid);try{const n=Bt.getState();await n.initializeUserProfile(e),await n.loadUserProjects(),this.unsubscribeFirestore=n.subscribeToFirestoreChanges(),console.log("User login handling completed")}catch(n){console.error("Error handling user login:",n),Bt.getState().setError("登入時載入數據失敗，請檢查網絡連接並重新整理頁面")}}async handleUserLogout(){console.log("User logged out");try{this.unsubscribeFirestore&&(this.unsubscribeFirestore(),this.unsubscribeFirestore=null),Bt.getState().clearUserData(),console.log("User logout handling completed")}catch(e){console.error("Error handling user logout:",e)}}async handleUserSwitch(e,n){console.log("User switched:",{from:(n==null?void 0:n.uid)||"none",to:e.uid});try{n&&await this.handleUserLogout(),await this.handleUserLogin(e),console.log("User switch handling completed")}catch(r){console.error("Error handling user switch:",r)}}async performCrossDeviceSync(e){console.log("Performing cross-device sync for user:",e.uid);try{const n=Bt.getState();n.setSyncing(!0);const r=n.projects,s=await e_.mergeLocalAndRemoteData(e.uid,r,{strategy:"newest_wins",autoResolve:!0});s.success?(n.projects=s.merged,n.currentProject=s.merged.find(i=>{var o;return i.id===((o=n.currentProject)==null?void 0:o.id)})||s.merged[0]||null,n.lastSyncTime=new Date,console.log("Cross-device sync completed successfully:",{merged:s.merged.length,conflicts:s.conflicts.length,errors:s.errors.length})):(console.warn("Cross-device sync completed with issues:",s.errors),n.setError("同步過程中發生問題"))}catch(n){console.error("Error in cross-device sync:",n),Bt.getState().setError("跨裝置同步失敗")}finally{Bt.getState().setSyncing(!1)}}setupAuthStateListener(){let e=null;const n=ot.getState().initialize(),r=setInterval(()=>{const s=ot.getState().user;(e==null?void 0:e.uid)!==(s==null?void 0:s.uid)&&(console.log("Auth state changed:",{previousUser:(e==null?void 0:e.uid)||"none",currentUser:(s==null?void 0:s.uid)||"none"}),!e&&s?this.handleUserLogin(s):e&&!s?this.handleUserLogout():e&&s&&e.uid!==s.uid?this.handleUserSwitch(s,e):s&&this.performCrossDeviceSync(s),e=s)},1e3);return()=>{n(),clearInterval(r)}}async forceSync(){const{user:e}=ot.getState();e&&await this.performCrossDeviceSync(e)}async resolveConflicts(e,n){const{user:r}=ot.getState();if(!r)return!1;try{for(const s of e){const i=n[s.projectId];i&&await e_.resolveConflict(r.uid,s,i==="local"?"use_local":"use_remote")}return await this.performCrossDeviceSync(r),!0}catch(s){return console.error("Error resolving conflicts:",s),!1}}}const ac=new F4;async function U4(){try{console.log("Testing Firebase connection...");const t=vn(Fe,"test","connection");await ic(t,{timestamp:new Date,test:"connection test"}),console.log("✅ Firebase write test successful");const e=await ZE(t);return e.exists()?console.log("✅ Firebase read test successful:",e.data()):console.log("❌ Firebase read test failed: document does not exist"),!0}catch(t){return console.error("❌ Firebase connection test failed:",t),!1}}async function B4(){var t;try{return console.log("Testing Auth connection..."),console.log("Current user:",((t=oc.currentUser)==null?void 0:t.uid)||"Not logged in"),!0}catch(e){return console.error("❌ Auth connection test failed:",e),!1}}function z4(){const{user:t,signOut:e,isLoading:n}=ot(),r=async()=>{try{await e()}catch(s){console.error("登出失敗:",s)}};return t?d.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[t.photoURL&&d.jsx("img",{src:t.photoURL,alt:t.displayName||"使用者",className:"w-6 h-6 sm:w-8 sm:h-8 rounded-full"}),d.jsxs("div",{className:"hidden md:block",children:[d.jsx("p",{className:"text-xs sm:text-sm font-medium text-text-primary",children:t.displayName||"使用者"}),d.jsx("p",{className:"text-xs text-text-secondary",children:t.email})]})]}),d.jsx("button",{onClick:r,disabled:n,className:"text-xs sm:text-sm text-text-secondary hover:text-text-primary transition-colors disabled:opacity-50",title:"登出並清除當前用戶數據",children:n?"登出中...":"登出"})]}):null}function qi(){const{isSyncing:t,lastSyncTime:e,error:n,setError:r}=Bt(),[s,i]=L.useState(!1),o=async()=>{try{await ac.forceSync()}catch(l){console.error("Manual sync failed:",l),r("手動同步失敗")}};return d.jsxs("div",{className:"relative",children:[d.jsx("button",{onClick:()=>i(!s),className:"w-2 h-2 rounded-full hover:scale-125 transition-transform",title:t?"同步中...":n?"同步錯誤":"已同步",children:d.jsx("div",{className:`w-2 h-2 rounded-full ${t?"bg-yellow-500 animate-pulse":n?"bg-red-500":"bg-green-500"}`})}),s&&d.jsxs("div",{className:"absolute top-6 right-0 bg-white rounded-lg shadow-lg border p-3 w-56 z-50",children:[d.jsxs("div",{className:"flex items-center justify-between mb-2",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("div",{className:`w-2 h-2 rounded-full ${t?"bg-yellow-500 animate-pulse":n?"bg-red-500":"bg-green-500"}`}),d.jsx("span",{className:"text-sm font-medium",children:t?"同步中...":n?"同步錯誤":"已同步"})]}),d.jsx("button",{onClick:()=>i(!1),className:"text-text-tertiary hover:text-text-secondary text-sm",children:"✕"})]}),e&&d.jsxs("div",{className:"text-xs text-text-secondary mb-2",children:["最後同步: ",e.toLocaleTimeString()]}),n&&d.jsx("div",{className:"text-xs text-red-600 mb-2 break-words",children:n}),d.jsx("button",{onClick:o,disabled:t,className:`w-full text-xs px-2 py-1 rounded ${t?"bg-background-tertiary text-text-tertiary cursor-not-allowed":"bg-primary text-white hover:bg-primary-dark"}`,children:t?"同步中...":"手動同步"})]})]})}function $4(){const{projects:t,createProject:e,deleteProject:n}=Bt(),[r,s]=L.useState(!1),[i,o]=L.useState(""),[l,c]=L.useState("");console.log("ProjectListView 渲染，專案數量:",t.length);const u=m=>{m.preventDefault(),i.trim()&&(e(i.trim(),l.trim()||void 0),o(""),c(""),s(!1))},f=(m,g)=>{confirm(`確定要刪除專案「${g}」嗎？此操作無法復原。`)&&n(m)};return d.jsxs("div",{className:"min-h-screen bg-background-primary safe-top safe-bottom",children:[d.jsx("div",{className:"bg-background-secondary border-b border-border",children:d.jsx("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-4 sm:py-6",children:d.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[d.jsx("h1",{className:"text-xl sm:text-2xl lg:text-3xl font-bold text-text-primary",children:"編織專案"}),d.jsxs("div",{className:"flex items-center gap-2 sm:gap-4 w-full sm:w-auto justify-between sm:justify-end",children:[d.jsx(z4,{}),d.jsx("button",{onClick:()=>s(!0),className:"btn btn-primary text-xs sm:text-sm",children:"新增專案"}),d.jsx(qi,{})]})]})})}),d.jsx("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-4 sm:py-6",children:t.length===0?d.jsxs("div",{className:"text-center py-8 sm:py-12",children:[d.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-text-primary mb-2",children:"還沒有編織專案"}),d.jsx("p",{className:"text-sm sm:text-base text-text-secondary mb-6",children:"建立你的第一個編織專案開始記錄進度"}),d.jsx("button",{onClick:()=>s(!0),className:"btn btn-primary text-sm sm:text-base",children:"建立新專案"})]}):d.jsx("div",{className:"grid gap-3 sm:gap-4 md:gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:t.map(m=>d.jsxs("div",{className:"card hover:shadow-md transition-shadow",children:[d.jsxs("div",{className:"flex items-start justify-between mb-3",children:[d.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[d.jsx("h3",{className:"text-base sm:text-lg font-semibold text-text-primary truncate",children:m.name}),m.isCompleted&&d.jsx("span",{className:"text-text-secondary text-sm font-medium",children:"完成"})]}),d.jsx("button",{onClick:()=>f(m.id,m.name),className:"text-text-tertiary hover:text-red-500 transition-colors text-sm sm:text-base ml-2",children:"刪除"})]}),d.jsxs("div",{className:"space-y-2 mb-4",children:[d.jsxs("div",{className:"flex justify-between text-xs sm:text-sm",children:[d.jsx("span",{className:"text-text-secondary",children:"進度"}),d.jsxs("span",{className:"text-text-primary",children:[m.isCompleted?"100":Math.round(Gd(m)*100),"%"]})]}),d.jsx("div",{className:"w-full bg-background-tertiary rounded-full h-1.5 sm:h-2",children:d.jsx("div",{className:"h-1.5 sm:h-2 rounded-full transition-all duration-300 bg-primary",style:{width:`${m.isCompleted?100:Gd(m)*100}%`}})})]}),d.jsxs("div",{className:"space-y-1 mb-4 text-xs sm:text-sm text-text-secondary",children:[d.jsxs("div",{children:["圈數: ",m.currentRound,"/",jc(m)]}),d.jsxs("div",{children:["針數: ",vp(m),"/",ga(m)]}),d.jsxs("div",{children:["更新: ",$d(m.lastModified)]})]}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx(It,{to:`/project/${m.id}/progress`,className:"btn btn-primary flex-1",children:"開始編織"}),d.jsx(It,{to:`/project/${m.id}`,className:"btn btn-secondary",children:"詳情"})]})]},m.id))})}),r&&d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:d.jsxs("div",{className:"bg-background-secondary rounded-xl p-6 w-full max-w-md",children:[d.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-4",children:"建立新專案"}),d.jsxs("form",{onSubmit:u,className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"專案名稱 *"}),d.jsx("input",{type:"text",value:i,onChange:m=>o(m.target.value),className:"input",placeholder:"輸入專案名稱",required:!0,autoFocus:!0})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"來源網址（選填）"}),d.jsx("input",{type:"url",value:l,onChange:m=>c(m.target.value),className:"input",placeholder:"https://..."})]}),d.jsxs("div",{className:"flex gap-3 pt-4",children:[d.jsx("button",{type:"button",onClick:()=>s(!1),className:"btn btn-secondary flex-1",children:"取消"}),d.jsx("button",{type:"submit",className:"btn btn-primary flex-1",children:"建立"})]})]})]})})]})}var tx={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},t_=xn.createContext&&xn.createContext(tx),G4=["attr","size","title"];function H4(t,e){if(t==null)return{};var n=W4(t,e),r,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function W4(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function eu(){return eu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},eu.apply(this,arguments)}function n_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function tu(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?n_(Object(n),!0).forEach(function(r){q4(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):n_(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function q4(t,e,n){return e=K4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function K4(t){var e=Q4(t,"string");return typeof e=="symbol"?e:e+""}function Q4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nx(t){return t&&t.map((e,n)=>xn.createElement(e.tag,tu({key:n},e.attr),nx(e.child)))}function Yr(t){return e=>xn.createElement(Y4,eu({attr:tu({},t.attr)},e),nx(t.child))}function Y4(t){var e=n=>{var{attr:r,size:s,title:i}=t,o=H4(t,G4),l=s||n.size||"1em",c;return n.className&&(c=n.className),t.className&&(c=(c?c+" ":"")+t.className),xn.createElement("svg",eu({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,o,{className:c,style:tu(tu({color:t.color||n.color},n.style),t.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),i&&xn.createElement("title",null,i),t.children)};return t_!==void 0?xn.createElement(t_.Consumer,null,n=>e(n)):e(tx)}function J4(t){return Yr({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",strokeMiterlimit:"10",strokeWidth:"32",d:"M448 256c0-106-86-192-192-192S64 150 64 256s86 192 192 192 192-86 192-192z"},child:[]},{tag:"path",attr:{d:"m216.32 334.44 114.45-69.14a10.89 10.89 0 0 0 0-18.6l-114.45-69.14a10.78 10.78 0 0 0-16.32 9.31v138.26a10.78 10.78 0 0 0 16.32 9.31z"},child:[]}]})(t)}function _f(t){return Yr({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M402.3 344.9l32-32c5-5 13.7-1.5 13.7 5.7V464c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h273.5c7.1 0 10.7 8.6 5.7 13.7l-32 32c-1.5 1.5-3.5 2.3-5.7 2.3H48v352h352V350.5c0-2.1.8-4.1 2.3-5.6zm156.6-201.8L296.3 405.7l-90.4 10c-26.2 2.9-48.5-19.2-45.6-45.6l10-90.4L432.9 17.1c22.9-22.9 59.9-22.9 82.7 0l43.2 43.2c22.9 22.9 22.9 60 .1 82.8zM460.1 174L402 115.9 216.2 301.8l-7.3 65.3 65.3-7.3L460.1 174zm64.8-79.7l-43.2-43.2c-4.1-4.1-10.8-4.1-14.8 0L436 82l58.1 58.1 30.9-30.9c4-4.2 4-10.8-.1-14.9z"},child:[]}]})(t)}function r_(t){return Yr({tag:"svg",attr:{viewBox:"0 0 32 32"},child:[{tag:"path",attr:{d:"M 16 3 C 8.855469 3 3 8.855469 3 16 C 3 23.144531 8.855469 29 16 29 C 23.144531 29 29 23.144531 29 16 C 29 8.855469 23.144531 3 16 3 Z M 16 5 C 18.355469 5 20.550781 5.757813 22.34375 7.03125 C 20.171875 6.496094 18.125 6.410156 16.40625 6.53125 C 15.101563 6.625 13.976563 6.820313 13.125 7.03125 C 12.851563 7.097656 12.675781 7.15625 12.46875 7.21875 C 12.347656 6.539063 12.3125 5.980469 12.3125 5.65625 C 13.46875 5.242188 14.703125 5 16 5 Z M 10.375 6.59375 C 10.429688 7.132813 10.542969 7.777344 10.71875 8.5 C 10.714844 8.699219 10.769531 8.894531 10.875 9.0625 C 11.203125 10.222656 11.703125 11.535156 12.5 12.90625 C 12.519531 12.9375 12.539063 12.96875 12.5625 13 C 13.175781 14.039063 13.933594 15.109375 14.90625 16.15625 C 14.652344 17.019531 14.339844 17.816406 14 18.53125 C 13.421875 18.003906 12.691406 17.226563 11.90625 16.09375 C 10.578125 14.179688 9.3125 11.421875 9.25 7.71875 C 9.25 7.601563 9.226563 7.484375 9.1875 7.375 C 9.554688 7.085938 9.972656 6.835938 10.375 6.59375 Z M 17.4375 8.46875 C 19.625 8.421875 22.261719 8.761719 24.90625 10.03125 C 25.027344 10.113281 25.167969 10.164063 25.3125 10.1875 C 25.632813 10.695313 25.921875 11.21875 26.15625 11.78125 C 23.042969 10.386719 20.15625 10.117188 17.875 10.28125 C 16.050781 10.410156 14.6875 10.808594 13.8125 11.125 C 13.46875 10.4375 13.207031 9.773438 13 9.15625 C 13.195313 9.097656 13.375 9.03125 13.625 8.96875 C 14.375 8.78125 15.359375 8.582031 16.53125 8.5 C 16.824219 8.480469 17.125 8.476563 17.4375 8.46875 Z M 7.34375 9.25 C 7.683594 12.660156 8.933594 15.320313 10.25 17.21875 C 11.277344 18.703125 12.328125 19.730469 13 20.3125 C 12.546875 21 12.058594 21.578125 11.59375 22.09375 C 10.976563 21.480469 10.101563 20.503906 9.25 19.1875 C 7.894531 17.089844 6.660156 14.195313 6.78125 10.71875 C 6.800781 10.535156 6.765625 10.351563 6.6875 10.1875 C 6.890625 9.867188 7.109375 9.546875 7.34375 9.25 Z M 18.9375 12.25 C 21.113281 12.222656 23.78125 12.652344 26.65625 14.25 C 26.714844 14.289063 26.777344 14.320313 26.84375 14.34375 C 26.917969 14.835938 26.992188 15.335938 27 15.84375 C 25.691406 15.257813 23.589844 14.554688 20.84375 14.5 C 20.65625 14.417969 20.449219 14.398438 20.25 14.4375 C 20.1875 14.453125 20.121094 14.472656 20.0625 14.5 C 20.042969 14.5 20.019531 14.5 20 14.5 C 18.921875 14.53125 17.753906 14.6875 16.53125 14.96875 C 15.871094 14.277344 15.316406 13.574219 14.84375 12.875 C 15.589844 12.640625 16.675781 12.378906 18.03125 12.28125 C 18.320313 12.261719 18.625 12.253906 18.9375 12.25 Z M 5.125 14.40625 C 5.617188 16.714844 6.5625 18.699219 7.5625 20.25 C 8.527344 21.746094 9.480469 22.808594 10.1875 23.5 C 9.699219 23.914063 9.289063 24.210938 8.96875 24.4375 C 6.542969 22.417969 5 19.390625 5 16 C 5 15.460938 5.050781 14.925781 5.125 14.40625 Z M 21.34375 16.53125 C 22.128906 16.574219 22.851563 16.648438 23.5 16.78125 C 23.476563 16.984375 23.453125 17.171875 23.40625 17.4375 C 23.269531 18.195313 23.023438 19.195313 22.59375 20.28125 C 21.734375 22.449219 20.171875 24.957031 17.25 26.6875 C 17.152344 26.753906 17.066406 26.839844 17 26.9375 C 16.671875 26.96875 16.335938 27 16 27 C 15.523438 27 15.054688 26.964844 14.59375 26.90625 C 17.382813 24.933594 19.066406 22.519531 20.0625 20.4375 C 20.636719 19.238281 20.980469 18.148438 21.1875 17.28125 C 21.257813 16.984375 21.300781 16.765625 21.34375 16.53125 Z M 19.1875 16.5625 C 19.230469 16.558594 19.273438 16.566406 19.3125 16.5625 C 19.292969 16.65625 19.273438 16.710938 19.25 16.8125 C 19.074219 17.554688 18.753906 18.507813 18.25 19.5625 C 17.242188 21.667969 15.46875 24.148438 12.25 26.03125 C 12.144531 26.078125 12.050781 26.140625 11.96875 26.21875 C 11.519531 26.039063 11.105469 25.828125 10.6875 25.59375 C 11.011719 25.34375 11.40625 25.023438 11.8125 24.65625 C 12.082031 24.664063 12.34375 24.5625 12.539063 24.375 C 12.734375 24.1875 12.84375 23.925781 12.84375 23.65625 C 13.578125 22.871094 14.332031 21.925781 15.03125 20.75 C 15.117188 20.648438 15.179688 20.53125 15.21875 20.40625 C 15.785156 19.40625 16.285156 18.261719 16.6875 16.96875 C 17.566406 16.75 18.390625 16.632813 19.1875 16.5625 Z M 25.4375 17.34375 C 26.03125 17.558594 26.488281 17.769531 26.8125 17.9375 C 26.269531 20.960938 24.507813 23.554688 22.03125 25.1875 C 23.160156 23.816406 23.945313 22.355469 24.46875 21.03125 C 24.957031 19.800781 25.21875 18.679688 25.375 17.8125 C 25.410156 17.621094 25.414063 17.503906 25.4375 17.34375 Z"},child:[]}]})(t)}function X4(t){return Yr({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"16 16 12 12 8 16"},child:[]},{tag:"line",attr:{x1:"12",y1:"12",x2:"12",y2:"21"},child:[]},{tag:"path",attr:{d:"M20.39 18.39A5 5 0 0 0 18 9h-1.26A8 8 0 1 0 3 16.3"},child:[]},{tag:"polyline",attr:{points:"16 16 12 12 8 16"},child:[]}]})(t)}function Z4(){const{projectId:t}=Da(),e=Li(),{currentProject:n,setCurrentProject:r,projects:s}=Bt();return L.useEffect(()=>{t&&(s.find(o=>o.id===t)?r(t):e("/404"))},[t,r,s,e]),n?d.jsxs("div",{className:"min-h-screen bg-background-primary safe-top safe-bottom",children:[d.jsx("div",{className:"bg-background-secondary border-b border-border",children:d.jsx("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-3 sm:py-4",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-3 sm:gap-4",children:[d.jsx(It,{to:"/",className:"text-text-secondary hover:text-text-primary transition-colors text-sm sm:text-base",children:"← 返回"}),d.jsx("h1",{className:"text-lg sm:text-xl font-semibold text-text-primary truncate",children:n.name})]}),d.jsx(qi,{})]})})}),d.jsxs("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-4 sm:py-6 space-y-4 sm:space-y-6",children:[d.jsxs("div",{className:"card",children:[d.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-4",children:"專案資訊"}),d.jsxs("div",{className:"space-y-4",children:[n.source&&d.jsxs("div",{children:[d.jsx("div",{className:"text-sm text-text-secondary mb-1",children:"來源"}),d.jsx("a",{href:n.source,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline break-all text-sm",children:n.source})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("div",{className:"text-sm text-text-secondary mb-1",children:"建立日期"}),d.jsx("div",{className:"text-text-primary text-sm",children:$d(n.createdDate)})]}),d.jsxs("div",{children:[d.jsx("div",{className:"text-sm text-text-secondary mb-1",children:"最後修改"}),d.jsx("div",{className:"text-text-primary text-sm",children:$d(n.lastModified)})]})]}),d.jsxs("div",{className:"grid grid-cols-3 gap-4 pt-2 border-t border-border",children:[d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"text-sm text-text-secondary",children:"使用毛線"}),d.jsx("div",{className:"text-lg font-semibold text-text-primary",children:n.yarns.length})]}),d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"text-sm text-text-secondary",children:"織圖圈數"}),d.jsx("div",{className:"text-lg font-semibold text-text-primary",children:n.pattern.length})]}),d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"text-sm text-text-secondary",children:"總針數"}),d.jsx("div",{className:"text-lg font-semibold text-text-primary",children:ga(n)})]})]})]})]}),d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:[d.jsx(It,{to:`/project/${n.id}/progress`,className:"card hover:shadow-md transition-shadow cursor-pointer",children:d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("div",{className:"w-12 h-12 flex items-center justify-center",children:d.jsx(J4,{className:"w-8 h-8 text-text-secondary"})}),d.jsxs("div",{children:[d.jsx("h3",{className:"font-semibold text-text-primary",children:"開始編織"}),d.jsx("p",{className:"text-sm text-text-secondary",children:"追蹤編織進度"})]})]})}),d.jsx(It,{to:`/project/${n.id}/pattern`,className:"card hover:shadow-md transition-shadow cursor-pointer",children:d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("div",{className:"w-12 h-12 flex items-center justify-center",children:d.jsx(_f,{className:"w-8 h-8 text-text-secondary"})}),d.jsxs("div",{children:[d.jsx("h3",{className:"font-semibold text-text-primary",children:"編輯織圖"}),d.jsx("p",{className:"text-sm text-text-secondary",children:"管理圈數和針法"})]})]})}),d.jsx(It,{to:`/project/${n.id}/yarns`,className:"card hover:shadow-md transition-shadow cursor-pointer",children:d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("div",{className:"w-12 h-12 flex items-center justify-center",children:d.jsx(r_,{className:"w-8 h-8 text-text-secondary"})}),d.jsxs("div",{children:[d.jsx("h3",{className:"font-semibold text-text-primary",children:"毛線管理"}),d.jsx("p",{className:"text-sm text-text-secondary",children:"管理專案毛線"})]})]})}),d.jsx(It,{to:`/project/${n.id}/import-export`,className:"card hover:shadow-md transition-shadow cursor-pointer",children:d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("div",{className:"w-12 h-12 flex items-center justify-center",children:d.jsx(X4,{className:"w-8 h-8 text-text-secondary"})}),d.jsxs("div",{children:[d.jsx("h3",{className:"font-semibold text-text-primary",children:"匯入匯出"}),d.jsx("p",{className:"text-sm text-text-secondary",children:"備份和分享"})]})]})})]}),d.jsxs("div",{className:"card",children:[d.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-4",children:"使用的毛線"}),n.yarns.length===0?d.jsxs("div",{className:"text-center py-8",children:[d.jsx("div",{className:"mb-3 flex justify-center",children:d.jsx(r_,{className:"w-8 h-8 text-text-tertiary"})}),d.jsx("p",{className:"text-text-tertiary mb-3",children:"尚未添加毛線"}),d.jsx(It,{to:`/project/${n.id}/yarns`,className:"text-primary hover:underline text-sm",children:"點擊這裡管理毛線"})]}):d.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:n.yarns.map(i=>d.jsxs("div",{className:"flex items-center gap-3 p-3 bg-background-secondary rounded-lg",children:[d.jsx("div",{className:"w-8 h-8 rounded-full border-2 border-white shadow-sm flex-shrink-0",style:{backgroundColor:i.color.hex}}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("h3",{className:"font-medium text-text-primary truncate",children:i.name}),i.brand&&d.jsx("p",{className:"text-sm text-text-secondary truncate",children:i.brand}),d.jsx("p",{className:"text-xs text-text-tertiary",children:i.color.name})]})]},i.id))})]}),d.jsxs("div",{className:"card",children:[d.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-4",children:"織圖"}),n.pattern.length===0?d.jsxs("div",{className:"text-center py-8",children:[d.jsx("div",{className:"mb-3 flex justify-center",children:d.jsx(_f,{className:"w-8 h-8 text-text-tertiary"})}),d.jsx("p",{className:"text-text-tertiary mb-3",children:"尚未建立織圖"}),d.jsx(It,{to:`/project/${n.id}/pattern`,className:"text-primary hover:underline text-sm",children:"點擊這裡開始編輯織圖"})]}):d.jsxs("div",{className:"space-y-4",children:[d.jsx("div",{className:"space-y-3",children:n.pattern.slice(0,5).map(i=>{const o=zt(i),l=j2(i,n.yarns);return d.jsxs("div",{className:"flex gap-3 p-3 bg-background-secondary rounded-lg",children:[d.jsxs("div",{className:"text-sm font-semibold flex-shrink-0 leading-relaxed",style:{color:"#d96699"},children:["R",i.roundNumber]}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("p",{className:"text-text-primary font-medium text-sm leading-relaxed m-0",children:l}),i.notes&&d.jsx("p",{className:"text-xs text-text-tertiary mt-1",children:i.notes})]}),d.jsx("div",{className:"text-right flex-shrink-0",children:d.jsxs("p",{className:"text-sm font-semibold text-text-primary leading-relaxed m-0",children:[o," 針"]})})]},i.id)})}),d.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-border",children:[d.jsxs("div",{className:"text-sm font-medium text-text-secondary",children:["總圈數: ",jc(n)]}),d.jsxs("div",{className:"text-sm font-medium text-text-secondary",children:["總針數: ",ga(n)]})]}),n.pattern.length>5&&d.jsx("div",{className:"text-center pt-2",children:d.jsxs(It,{to:`/project/${n.id}/pattern`,className:"text-primary hover:underline text-sm",children:["查看全部 ",n.pattern.length," 圈織圖"]})})]})]})]})]}):d.jsx("div",{className:"min-h-screen bg-background-primary flex items-center justify-center",children:d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),d.jsx("p",{className:"text-text-secondary",children:"載入中..."})]})})}function Gh(t){return Yr({tag:"svg",attr:{viewBox:"0 0 16 16",fill:"currentColor"},child:[{tag:"path",attr:{d:"M13.23 1h-1.46L3.52 9.25l-.16.22L1 13.59 2.41 15l4.12-2.36.22-.16L15 4.23V2.77L13.23 1zM2.41 13.59l1.51-3 1.45 1.45-2.96 1.55zm3.83-2.06L4.47 9.76l8-8 1.77 1.77-8 8z"},child:[]}]})(t)}function So(t){return Yr({tag:"svg",attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z"},child:[]},{tag:"path",attr:{d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z"},child:[]}]})(t)}function Hh(t){return Yr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"g",attr:{id:"Circle_Check"},child:[{tag:"g",attr:{},child:[{tag:"path",attr:{d:"M15.81,10.4a.5.5,0,0,0-.71-.71l-3.56,3.56L9.81,11.52a.5.5,0,0,0-.71.71l2.08,2.08a.513.513,0,0,0,.71,0Z"},child:[]},{tag:"path",attr:{d:"M12,21.934A9.934,9.934,0,1,1,21.933,12,9.945,9.945,0,0,1,12,21.934ZM12,3.067A8.934,8.934,0,1,0,20.933,12,8.944,8.944,0,0,0,12,3.067Z"},child:[]}]}]}]})(t)}function Wh(t){return Yr({tag:"svg",attr:{viewBox:"0 0 15 15",fill:"none"},child:[{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M0.877075 7.49988C0.877075 3.84219 3.84222 0.877045 7.49991 0.877045C11.1576 0.877045 14.1227 3.84219 14.1227 7.49988C14.1227 11.1575 11.1576 14.1227 7.49991 14.1227C3.84222 14.1227 0.877075 11.1575 0.877075 7.49988ZM7.49991 1.82704C4.36689 1.82704 1.82708 4.36686 1.82708 7.49988C1.82708 10.6329 4.36689 13.1727 7.49991 13.1727C10.6329 13.1727 13.1727 10.6329 13.1727 7.49988C13.1727 4.36686 10.6329 1.82704 7.49991 1.82704ZM9.85358 5.14644C10.0488 5.3417 10.0488 5.65829 9.85358 5.85355L8.20713 7.49999L9.85358 9.14644C10.0488 9.3417 10.0488 9.65829 9.85358 9.85355C9.65832 10.0488 9.34173 10.0488 9.14647 9.85355L7.50002 8.2071L5.85358 9.85355C5.65832 10.0488 5.34173 10.0488 5.14647 9.85355C4.95121 9.65829 4.95121 9.3417 5.14647 9.14644L6.79292 7.49999L5.14647 5.85355C4.95121 5.65829 4.95121 5.3417 5.14647 5.14644C5.34173 4.95118 5.65832 4.95118 5.85358 5.14644L7.50002 6.79289L9.14647 5.14644C9.34173 4.95118 9.65832 4.95118 9.85358 5.14644Z",fill:"currentColor"},child:[]}]})(t)}function eb(){const{projectId:t}=Da(),e=Li(),{currentProject:n,setCurrentProject:r,projects:s,addRound:i,updateRound:o,deleteRound:l,addStitchToRound:c,addStitchGroupToRound:u,updateStitchInRound:f,deleteStitchFromRound:m,reorderStitchesInRound:g,updateStitchGroupInRound:w,updateStitchInGroup:R,deleteStitchGroupFromRound:N,reorderStitchGroupsInRound:P}=Bt(),[x,v]=L.useState(!1),[I,D]=L.useState(null),[F,z]=L.useState(null),[T,_]=L.useState(null),[S,E]=L.useState(null),[A,b]=L.useState(null),[C,qe]=L.useState(null),[Ke,Mt]=L.useState(!1),[xt,W]=L.useState(""),[$,q]=L.useState(vr.SINGLE),[re,se]=L.useState(1),[ce,ke]=L.useState(""),[$e,be]=L.useState(1),[De,gn]=L.useState([]),[Ha,Jr]=L.useState(vr.SINGLE),[Xr,Ps]=L.useState(1),[ks,bs]=L.useState(""),[Ds,Ki]=L.useState(1),[Qi,Wa]=L.useState(vr.SINGLE),[Yi,Ji]=L.useState(1),[js,Xi]=L.useState(null),[qa,Vs]=L.useState(null);if(L.useEffect(()=>{t&&(s.find(O=>O.id===t)?r(t):e("/404"))},[t,s,e]),!n)return d.jsx("div",{className:"min-h-screen bg-background-primary flex items-center justify-center",children:d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),d.jsx("p",{className:"text-text-secondary",children:"載入中..."})]})});const Zi=async()=>{var B;if(!Ke){Mt(!0);try{if(!n){console.error("No current project");return}const O=((B=n.pattern)==null?void 0:B.map(rt=>rt.roundNumber))||[],ne=Math.max(0,...O)+1,Z={id:Ze(),roundNumber:ne,stitches:[],stitchGroups:[],notes:xt.trim()||void 0};await i(Z),W(""),v(!1)}catch(O){console.error("Error adding round:",O),alert("新增圈數時發生錯誤，請查看控制台了解詳情")}finally{Mt(!1)}}},eo=async B=>{confirm(`確定要刪除第 ${B} 圈嗎？`)&&await l(B)},Qe=async B=>{var O;if(!Ke){Mt(!0);try{if(!n){console.error("No current project");return}const ne={id:Ze(),type:$,yarnId:((O=n.yarns[0])==null?void 0:O.id)||"",count:re};await c(B,ne),se(1),D(null)}catch(ne){console.error("Error adding stitch:",ne),alert("新增針法時發生錯誤，請查看控制台了解詳情")}finally{Mt(!1)}}},nt=async B=>{if(De.length===0){alert("請先新增群組中的針法");return}const O={id:Ze(),name:ce.trim()||"針目群組",stitches:[...De],repeatCount:$e};await u(B,O),ke(""),be(1),gn([]),z(null)},Os=()=>{var O;const B={id:Ze(),type:$,yarnId:((O=n.yarns[0])==null?void 0:O.id)||"",count:re};gn([...De,B]),se(1)},Ka=B=>{gn(De.filter(O=>O.id!==B))},to=async(B,O)=>{const ne={...B,notes:O.trim()||void 0};await o(ne),_(null)},Uu=(B,O)=>{E({roundNumber:B,stitchId:O.id}),Jr(O.type),Ps(O.count)},Zr=async(B,O)=>{var Z;const ne={id:O,type:Ha,yarnId:((Z=n.yarns[0])==null?void 0:Z.id)||"",count:Xr};await f(B,O,ne),E(null)},Qa=async(B,O)=>{confirm("確定要刪除這個針法嗎？")&&await m(B,O)},Ya=(B,O)=>{b({roundNumber:B,groupId:O.id}),bs(O.name),Ki(O.repeatCount)},no=async(B,O,ne)=>{const Z={...ne,name:ks.trim()||"針目群組",repeatCount:Ds};await w(B,O,Z),b(null)},Bu=async(B,O)=>{confirm("確定要刪除這個針目群組嗎？")&&await N(B,O)},zu=(B,O,ne)=>{qe({roundNumber:B,groupId:O,stitchId:ne.id}),Wa(ne.type),Ji(ne.count)},ro=async(B,O,ne)=>{var rt;const Z={id:ne,type:Qi,yarnId:((rt=n.yarns[0])==null?void 0:rt.id)||"",count:Yi};await R(B,O,ne,Z),qe(null)},Ja=async(B,O,ne)=>{if(confirm("確定要刪除這個針法嗎？")){const Z=n==null?void 0:n.pattern.find(_e=>_e.roundNumber===B),rt=Z==null?void 0:Z.stitchGroups.find(_e=>_e.id===O);if(rt){const _e={...rt,stitches:rt.stitches.filter(At=>At.id!==ne)};await w(B,O,_e)}}},so=(B,O,ne,Z)=>{Z==="stitch"?Xi({index:ne,stitch:O}):Vs({index:ne,group:O})},nr=B=>{B.preventDefault()},Ls=async(B,O,ne,Z)=>{B.preventDefault(),Z==="stitch"&&js?(await g(ne,js.index,O),Xi(null)):Z==="group"&&qa&&(await P(ne,qa.index,O),Vs(null))};return d.jsxs("div",{className:"min-h-screen bg-background-primary safe-top safe-bottom",children:[d.jsx("div",{className:"bg-background-secondary border-b border-border sticky top-0 z-10",children:d.jsx("div",{className:"w-full px-3 sm:px-4 lg:px-6 py-3 sm:py-4",children:d.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[d.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[d.jsx(It,{to:`/project/${t}`,className:"text-text-secondary hover:text-text-primary transition-colors text-sm sm:text-base",children:"← 返回"}),d.jsx("h1",{className:"text-base sm:text-xl font-semibold text-text-primary",children:"織圖編輯"})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("button",{onClick:()=>v(!0),className:"btn btn-primary w-full sm:w-auto",disabled:Ke,children:Ke?"處理中...":"新增圈數"}),d.jsx(qi,{})]})]})})}),d.jsxs("div",{className:"w-full px-3 sm:px-4 lg:px-6 py-4 sm:py-6 space-y-4 sm:space-y-6",children:[d.jsxs("div",{className:"card",children:[d.jsx("h2",{className:"text-lg font-semibold text-text-primary mb-4",children:"織圖總覽"}),d.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-4 gap-4 text-sm",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-text-secondary",children:"總圈數："}),d.jsx("span",{className:"font-medium text-text-primary",children:n.pattern.length})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-text-secondary",children:"總針數："}),d.jsx("span",{className:"font-medium text-text-primary",children:n.pattern.reduce((B,O)=>B+zt(O),0)})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-text-secondary",children:"使用毛線："}),d.jsxs("span",{className:"font-medium text-text-primary",children:[n.yarns.length," 種"]})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-text-secondary",children:"當前圈數："}),d.jsxs("span",{className:"font-medium text-text-primary",children:["R",n.currentRound]})]})]})]}),n.pattern.length===0?d.jsxs("div",{className:"card text-center py-12",children:[d.jsx("div",{className:"mb-4 flex justify-center",children:d.jsx(_f,{className:"w-8 h-8 text-text-tertiary"})}),d.jsx("h3",{className:"text-xl font-semibold text-text-primary mb-2",children:"還沒有織圖圈數"}),d.jsx("p",{className:"text-text-secondary mb-6",children:"開始建立你的第一個圈數"}),d.jsx("button",{onClick:()=>v(!0),className:"btn btn-primary",children:"新增第一圈"})]}):d.jsx("div",{className:"space-y-4",children:n.pattern.sort((B,O)=>B.roundNumber-O.roundNumber).map(B=>d.jsxs("div",{className:"card",children:[d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsxs("h3",{className:"text-lg font-semibold text-text-primary",children:["第 ",B.roundNumber," 圈"]}),d.jsxs("div",{className:"text-sm text-text-secondary",children:[zt(B)," 針"]}),B.roundNumber===n.currentRound&&d.jsx("div",{className:"px-2 py-1 bg-primary text-white text-xs rounded-full",children:"目前"})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("button",{onClick:()=>D(B.roundNumber),className:"btn btn-ghost text-sm",children:"新增針法"}),d.jsx("button",{onClick:()=>z(B.roundNumber),className:"btn btn-ghost text-sm",children:"新增群組"}),d.jsx("button",{onClick:()=>eo(B.roundNumber),className:"text-text-tertiary hover:text-red-500 transition-colors p-2",children:d.jsx(So,{className:"w-5 h-5"})})]})]}),(T==null?void 0:T.id)===B.id?d.jsx("div",{className:"mb-4",children:d.jsx("input",{type:"text",defaultValue:B.notes||"",className:"input text-sm",placeholder:"輸入備註...",onBlur:O=>to(B,O.target.value),onKeyDown:O=>{O.key==="Enter"&&to(B,O.currentTarget.value),O.key==="Escape"&&_(null)},autoFocus:!0})}):d.jsx("div",{className:"mb-4",children:B.notes?d.jsxs("div",{className:"text-sm text-text-secondary cursor-pointer hover:text-text-primary",onClick:()=>_(B),children:["備註: ",B.notes]}):d.jsx("div",{className:"text-sm text-text-tertiary cursor-pointer hover:text-text-secondary",onClick:()=>_(B),children:"點擊新增備註..."})}),B.stitches.length>0&&d.jsx("div",{className:"mb-4",children:d.jsx("div",{className:"space-y-2",children:B.stitches.map((O,ne)=>{var Z,rt;return d.jsxs("div",{className:"flex items-center gap-3 p-2 bg-background-tertiary rounded cursor-move",draggable:!0,onDragStart:_e=>so(_e,O,ne,"stitch"),onDragOver:nr,onDrop:_e=>Ls(_e,ne,B.roundNumber,"stitch"),children:[d.jsx("div",{className:"text-lg",children:((Z=Pt[O.type])==null?void 0:Z.symbol)||"○"}),d.jsx("div",{className:"flex-1",children:(S==null?void 0:S.stitchId)===O.id?d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("select",{value:Ha,onChange:_e=>Jr(_e.target.value),className:"input text-sm",children:Object.entries(Pt).map(([_e,At])=>d.jsxs("option",{value:_e,children:[At.symbol," ",At.rawValue]},_e))}),d.jsx("input",{type:"number",min:"1",value:Xr,onChange:_e=>Ps(parseInt(_e.target.value)||1),className:"input text-sm w-16"}),d.jsx("button",{onClick:()=>Zr(B.roundNumber,O.id),className:"text-green-500 hover:text-green-600 p-2",children:d.jsx(Hh,{className:"w-5 h-5"})}),d.jsx("button",{onClick:()=>E(null),className:"text-text-tertiary hover:text-text-secondary p-2",children:d.jsx(Wh,{className:"w-5 h-5"})})]}):d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"font-medium text-text-primary",children:((rt=Pt[O.type])==null?void 0:rt.rawValue)||O.type}),d.jsxs("span",{className:"text-sm text-text-secondary",children:["×",O.count]}),d.jsxs("div",{className:"flex items-center gap-1 ml-auto",children:[d.jsx("button",{onClick:()=>Uu(B.roundNumber,O),className:"text-text-tertiary hover:text-primary p-2",children:d.jsx(Gh,{className:"w-5 h-5"})}),d.jsx("button",{onClick:()=>Qa(B.roundNumber,O.id),className:"text-text-tertiary hover:text-red-500 p-2",children:d.jsx(So,{className:"w-5 h-5"})})]})]})})]},O.id)})})}),B.stitchGroups.length>0&&d.jsx("div",{className:"mb-4",children:d.jsx("div",{className:"space-y-3",children:B.stitchGroups.map((O,ne)=>d.jsxs("div",{className:"border border-border rounded-lg p-3 cursor-move",draggable:!0,onDragStart:Z=>so(Z,O,ne,"group"),onDragOver:nr,onDrop:Z=>Ls(Z,ne,B.roundNumber,"group"),children:[d.jsx("div",{className:"flex items-center justify-between mb-2",children:(A==null?void 0:A.groupId)===O.id?d.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[d.jsx("input",{type:"text",value:ks,onChange:Z=>bs(Z.target.value),className:"input text-sm flex-1",placeholder:"群組名稱"}),d.jsx("input",{type:"number",min:"1",value:Ds,onChange:Z=>Ki(parseInt(Z.target.value)||1),className:"input text-sm w-20"}),d.jsx("span",{className:"text-sm text-text-secondary",children:"次"}),d.jsx("button",{onClick:()=>no(B.roundNumber,O.id,O),className:"text-green-500 hover:text-green-600 p-2",children:d.jsx(Hh,{className:"w-5 h-5"})}),d.jsx("button",{onClick:()=>b(null),className:"text-text-tertiary hover:text-text-secondary p-2",children:d.jsx(Wh,{className:"w-5 h-5"})})]}):d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"font-medium text-text-primary",children:O.name}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsxs("div",{className:"text-sm text-text-secondary",children:["重複 ",O.repeatCount," 次 (共 ",b0(O)," 針)"]}),d.jsx("button",{onClick:()=>Ya(B.roundNumber,O),className:"text-text-tertiary hover:text-primary p-2",children:d.jsx(Gh,{className:"w-5 h-5"})}),d.jsx("button",{onClick:()=>Bu(B.roundNumber,O.id),className:"text-text-tertiary hover:text-red-500 p-2",children:d.jsx(So,{className:"w-5 h-5"})})]})]})}),d.jsx("div",{className:"space-y-2",children:O.stitches.map(Z=>{var rt,_e;return d.jsxs("div",{className:"flex items-center gap-3 p-2 bg-background-tertiary rounded ml-4",children:[d.jsx("div",{className:"text-lg",children:((rt=Pt[Z.type])==null?void 0:rt.symbol)||"○"}),d.jsx("div",{className:"flex-1",children:(C==null?void 0:C.stitchId)===Z.id&&(C==null?void 0:C.groupId)===O.id?d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("select",{value:Qi,onChange:At=>Wa(At.target.value),className:"input text-sm",children:Object.entries(Pt).map(([At,Ye])=>d.jsxs("option",{value:At,children:[Ye.symbol," ",Ye.rawValue]},At))}),d.jsx("input",{type:"number",min:"1",value:Yi,onChange:At=>Ji(parseInt(At.target.value)||1),className:"input text-sm w-16"}),d.jsx("button",{onClick:()=>ro(B.roundNumber,O.id,Z.id),className:"text-green-500 hover:text-green-600 p-2",children:d.jsx(Hh,{className:"w-5 h-5"})}),d.jsx("button",{onClick:()=>qe(null),className:"text-text-tertiary hover:text-text-secondary p-2",children:d.jsx(Wh,{className:"w-5 h-5"})})]}):d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"font-medium text-text-primary",children:((_e=Pt[Z.type])==null?void 0:_e.rawValue)||Z.type}),d.jsxs("span",{className:"text-sm text-text-secondary",children:["×",Z.count]}),d.jsxs("div",{className:"flex items-center gap-1 ml-auto",children:[d.jsx("button",{onClick:()=>zu(B.roundNumber,O.id,Z),className:"text-text-tertiary hover:text-primary p-2",children:d.jsx(Gh,{className:"w-5 h-5"})}),d.jsx("button",{onClick:()=>Ja(B.roundNumber,O.id,Z.id),className:"text-text-tertiary hover:text-red-500 p-2",children:d.jsx(So,{className:"w-5 h-5"})})]})]})})]},Z.id)})})]},O.id))})}),I===B.roundNumber&&d.jsxs("div",{className:"bg-background-tertiary rounded-lg p-4 mb-4",children:[d.jsx("h4",{className:"font-medium text-text-primary mb-3",children:"新增針法"}),d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"針法類型"}),d.jsx("select",{value:$,onChange:O=>q(O.target.value),className:"input",children:Object.entries(Pt).map(([O,ne])=>d.jsxs("option",{value:O,children:[ne.symbol," ",ne.rawValue]},O))})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"數量"}),d.jsx("input",{type:"number",min:"1",value:re,onChange:O=>se(parseInt(O.target.value)||1),className:"input"})]})]}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("button",{onClick:()=>Qe(B.roundNumber),className:"btn btn-primary",disabled:Ke,children:Ke?"新增中...":"新增"}),d.jsx("button",{onClick:()=>D(null),className:"btn btn-secondary",children:"取消"})]})]}),F===B.roundNumber&&d.jsxs("div",{className:"bg-background-tertiary rounded-lg p-4 mb-4",children:[d.jsx("h4",{className:"font-medium text-text-primary mb-3",children:"新增針目群組"}),d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"群組名稱"}),d.jsx("input",{type:"text",value:ce,onChange:O=>ke(O.target.value),className:"input",placeholder:"針目群組"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"重複次數"}),d.jsx("input",{type:"number",min:"1",value:$e,onChange:O=>be(parseInt(O.target.value)||1),className:"input"})]})]}),d.jsxs("div",{className:"mb-4",children:[d.jsxs("div",{className:"flex items-center justify-between mb-2",children:[d.jsx("label",{className:"block text-sm font-medium text-text-secondary",children:"群組針法"}),d.jsx("button",{onClick:Os,className:"btn btn-ghost text-sm",children:"新增針法"})]}),d.jsx("div",{className:"space-y-2 mb-4",children:De.map(O=>{var ne,Z;return d.jsxs("div",{className:"flex items-center gap-3 p-2 bg-background-secondary rounded",children:[d.jsx("div",{className:"text-lg",children:((ne=Pt[O.type])==null?void 0:ne.symbol)||"○"}),d.jsxs("div",{className:"flex-1",children:[d.jsx("span",{className:"font-medium text-text-primary",children:((Z=Pt[O.type])==null?void 0:Z.rawValue)||O.type}),d.jsxs("span",{className:"text-sm text-text-secondary ml-2",children:["×",O.count]})]}),d.jsx("button",{onClick:()=>Ka(O.id),className:"text-text-tertiary hover:text-red-500 transition-colors p-2",children:d.jsx(So,{className:"w-5 h-5"})})]},O.id)})}),d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4",children:[d.jsx("select",{value:$,onChange:O=>q(O.target.value),className:"input",children:Object.entries(Pt).map(([O,ne])=>d.jsxs("option",{value:O,children:[ne.symbol," ",ne.rawValue]},O))}),d.jsx("input",{type:"number",min:"1",value:re,onChange:O=>se(parseInt(O.target.value)||1),className:"input",placeholder:"數量"})]})]}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("button",{onClick:()=>nt(B.roundNumber),className:"btn btn-primary",disabled:De.length===0,children:"新增群組"}),d.jsx("button",{onClick:()=>{z(null),gn([]),ke(""),be(1)},className:"btn btn-secondary",children:"取消"})]})]})]},B.id))})]}),x&&d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:d.jsxs("div",{className:"bg-background-secondary rounded-xl p-6 w-full max-w-md",children:[d.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-4",children:"新增圈數"}),d.jsxs("div",{className:"mb-4",children:[d.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"備註（選填）"}),d.jsx("input",{type:"text",value:xt,onChange:B=>W(B.target.value),className:"input",placeholder:"輸入備註..."})]}),d.jsxs("div",{className:"flex gap-3",children:[d.jsx("button",{onClick:()=>v(!1),className:"btn btn-secondary flex-1",children:"取消"}),d.jsx("button",{onClick:Zi,className:"btn btn-primary flex-1",disabled:Ke,children:Ke?"新增中...":"新增"})]})]})})]})}function tb(){const{projectId:t}=Da(),e=Li(),{currentProject:n,setCurrentProject:r,projects:s,nextStitch:i,previousStitch:o,setCurrentRound:l,startSession:c,endSession:u,updateProject:f}=Bt(),[m,g]=L.useState(!1),[w,R]=L.useState(null),[N,P]=L.useState(0),[x,v]=L.useState(null);if(L.useEffect(()=>{t&&(s.find(q=>q.id===t)?r(t):e("/404"))},[t,r,s,e]),L.useEffect(()=>{let $;return m&&w&&($=setInterval(()=>{P(Math.floor((Date.now()-w.getTime())/1e3))},1e3)),()=>clearInterval($)},[m,w]),!n)return d.jsx("div",{className:"min-h-screen bg-background-primary flex items-center justify-center",children:d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),d.jsx("p",{className:"text-text-secondary",children:"載入中..."})]})});const I=x!==null&&x!==n.currentRound,D=x??n.currentRound,F=n.pattern.find($=>$.roundNumber===D),z=Gd(n),T=I?0:n.currentStitch,_=F?zt(F):0,S=()=>{c(),g(!0),R(new Date),P(0)},E=()=>{u(),g(!1),R(null),P(0)},A=()=>{i()},b=()=>{o()},C=$=>{$===n.currentRound?v(null):v($)},qe=()=>{if(!F)return;const $=Math.max(...n.pattern.map(q=>q.roundNumber));if(D>=$){const q={...n,isCompleted:!0,currentStitch:zt(F),lastModified:new Date};f(q)}else{const q=D+1;l(q)}v(null)},Ke=()=>{v(null)},Mt=$=>{const q=n.yarns.find(re=>re.id===$);return(q==null?void 0:q.color.hex)||"#000000"},xt=$=>{const q=$.replace("#",""),re=parseInt(q.substring(0,2),16),se=parseInt(q.substring(2,4),16),ce=parseInt(q.substring(4,6),16);return(re*299+se*587+ce*114)/1e3>200},W=()=>{if(!F||_===0)return d.jsx("div",{className:"text-center py-8",children:d.jsx("p",{className:"text-text-tertiary",children:"當前圈數沒有針法資料"})});const $=[];let q=0;return F.stitches.forEach(re=>{var ce;const se=Mt(re.yarnId);for(let ke=0;ke<re.count;ke++){const $e=q<T,be=q===T;$.push(d.jsxs("div",{className:"flex flex-col items-center justify-center w-16 h-16 transition-all duration-300",children:[d.jsx("div",{className:`text-2xl font-bold transition-colors duration-300 ${$e?"text-text-primary":be?"text-primary":"text-text-tertiary/50"}`,children:((ce=Pt[re.type])==null?void 0:ce.symbol)||"○"}),d.jsx("div",{className:`w-2.5 h-2.5 rounded-full transition-all duration-300 ${($e||be)&&xt(se)?"border border-gray-400":""}`,style:{backgroundColor:$e||be?se:"#f3f4f6"}})]},`${re.id}-${ke}`)),q++}}),F.stitchGroups.forEach(re=>{for(let se=0;se<re.repeatCount;se++)re.stitches.forEach(ce=>{var $e;const ke=Mt(ce.yarnId);for(let be=0;be<ce.count;be++){const De=q<T,gn=q===T;$.push(d.jsxs("div",{className:"flex flex-col items-center justify-center w-16 h-16 transition-all duration-300",children:[d.jsx("div",{className:`text-2xl font-bold transition-colors duration-300 ${De?"text-text-primary":gn?"text-primary":"text-text-tertiary/50"}`,children:(($e=Pt[ce.type])==null?void 0:$e.symbol)||"○"}),d.jsx("div",{className:`w-2.5 h-2.5 rounded-full transition-all duration-300 ${(De||gn)&&xt(ke)?"border border-gray-400":""}`,style:{backgroundColor:De||gn?ke:"#f3f4f6"}})]},`${re.id}-${se}-${ce.id}-${be}`)),q++}})}),d.jsx("div",{className:"grid grid-cols-6 sm:grid-cols-8 md:grid-cols-10 lg:grid-cols-12 gap-2",children:$})};return d.jsxs("div",{className:"min-h-screen bg-background-primary safe-top safe-bottom",children:[d.jsx("div",{className:"bg-background-secondary border-b border-border sticky top-0 z-10",children:d.jsx("div",{className:"w-full px-3 sm:px-4 lg:px-6 py-3 sm:py-4",children:d.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[d.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[d.jsx(It,{to:`/project/${t}`,className:"text-text-secondary hover:text-text-primary transition-colors text-sm sm:text-base",children:"← 返回"}),d.jsx("h1",{className:"text-base sm:text-xl font-semibold text-text-primary truncate",children:n.name})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[m?d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"text-sm text-text-secondary hidden sm:block",children:b2(N)}),d.jsx("button",{onClick:E,className:"btn btn-secondary text-sm",children:"結束"})]}):d.jsxs("button",{onClick:S,className:"btn btn-primary text-sm",children:[d.jsx("span",{className:"hidden sm:inline",children:"開始計時"}),d.jsx("span",{className:"sm:hidden",children:"計時"})]}),d.jsx(qi,{})]})]})})}),d.jsxs("div",{className:"w-full px-3 sm:px-4 lg:px-6 py-4 sm:py-6 space-y-4 sm:space-y-6",children:[d.jsxs("div",{className:"card",children:[d.jsxs("div",{className:"flex items-center justify-between mb-3",children:[d.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:"總體進度"}),d.jsxs("span",{className:"text-sm text-text-secondary font-medium",children:[Math.round(z*100),"%"]})]}),d.jsx("div",{className:"w-full bg-background-tertiary rounded-full h-3 mb-4",children:d.jsx("div",{className:"bg-primary h-3 rounded-full transition-all duration-500",style:{width:`${z*100}%`}})}),d.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[d.jsxs("div",{children:[d.jsx("div",{className:"text-text-secondary",children:"圈數進度"}),d.jsxs("div",{className:"font-semibold text-text-primary",children:[Math.max(0,n.currentRound-1)," / ",jc(n)," 圈"]})]}),d.jsxs("div",{children:[d.jsx("div",{className:"text-text-secondary",children:"針數進度"}),d.jsxs("div",{className:"font-semibold text-text-primary",children:[vp(n)," / ",ga(n)," 針"]})]})]})]}),d.jsxs("div",{className:"card",children:[d.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-3",children:"快速跳轉"}),d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("label",{className:"text-sm text-text-secondary",children:"跳轉到第"}),d.jsx("select",{value:D,onChange:$=>C(parseInt($.target.value)),className:"input w-auto min-w-0 flex-shrink-0",children:Array.from({length:jc(n)},($,q)=>q+1).map($=>d.jsx("option",{value:$,children:$},$))}),d.jsx("label",{className:"text-sm text-text-secondary",children:"圈"}),I&&d.jsx("span",{className:"text-sm",style:{color:"rgb(217, 115, 152)"},children:"查看模式"})]})]}),d.jsxs("div",{className:"card",children:[d.jsxs("div",{className:"mb-6",children:[d.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-3",children:"本圈織圖"}),d.jsx("div",{className:"mb-3",children:d.jsxs("span",{className:"text-base text-text-primary",children:["第 ",D," 圈",I&&d.jsx("span",{className:"text-sm ml-2",style:{color:"rgb(217, 115, 152)"},children:"（查看中）"})]})}),(F==null?void 0:F.notes)&&d.jsxs("div",{className:"text-text-primary mb-4",children:[d.jsx("span",{className:"text-text-secondary",children:"備註："}),F.notes]})]}),d.jsx("div",{className:"mb-6",children:W()}),I?d.jsxs("div",{className:"text-center py-4",children:[d.jsx("p",{className:"mb-4",style:{color:"rgb(217, 115, 152)"},children:"此為查看模式，無法編輯進度"}),d.jsx("button",{onClick:Ke,className:"btn btn-primary",children:"返回編織進度"})]}):n.isCompleted?d.jsxs("div",{className:"text-center py-8",children:[d.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:"編織完成！"}),d.jsxs("p",{className:"text-text-secondary mb-6",children:["恭喜您完成了「",n.name,"」的編織！"]}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[d.jsx("button",{onClick:()=>{const $={...n,isCompleted:!1,currentRound:1,currentStitch:0,lastModified:new Date};f($)},className:"btn btn-secondary",children:"重新編織"}),d.jsx("button",{onClick:()=>{var $;($=navigator.share)==null||$.call(navigator,{title:`我完成了編織作品：${n.name}`,text:`使用編織計數器完成了「${n.name}」的編織！`}).catch(()=>{alert("編織完成！")})},className:"btn btn-primary",children:"分享成果"})]})]}):d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex items-center justify-between gap-4",children:[d.jsxs("button",{onClick:b,disabled:n.currentRound===1&&n.currentStitch===0,className:"btn btn-secondary disabled:opacity-50 disabled:cursor-not-allowed text-lg py-4 flex items-center justify-center gap-2 flex-1",children:[d.jsx("span",{children:"←"}),"上一針"]}),d.jsxs("div",{className:"flex items-baseline px-6",children:[d.jsx("span",{className:"text-4xl font-bold text-primary",children:T}),d.jsxs("span",{className:"text-xl text-text-secondary",children:["/",_]})]}),d.jsxs("button",{onClick:A,className:"btn btn-primary text-lg py-4 flex items-center justify-center gap-2 flex-1",children:["下一針",d.jsx("span",{children:"→"})]})]}),D===n.currentRound&&d.jsxs("button",{onClick:qe,className:"w-full bg-gray-500 hover:bg-gray-600 text-white font-medium py-3 px-4 rounded-lg transition-colors",children:["完成第 ",D," 圈"]})]})]})]})]})}const Co=[{name:"白色",hex:"#FFFFFF"},{name:"黑色",hex:"#000000"},{name:"紅色",hex:"#FF0000"},{name:"藍色",hex:"#0066CC"},{name:"綠色",hex:"#00AA00"},{name:"黃色",hex:"#FFD700"},{name:"紫色",hex:"#8A2BE2"},{name:"橙色",hex:"#FF8C00"},{name:"粉紅色",hex:"#FF69B4"},{name:"棕色",hex:"#A0522D"},{name:"灰色",hex:"#808080"},{name:"米色",hex:"#F5F5DC"}];function nb(){const{projectId:t}=Da(),e=Li(),{currentProject:n,setCurrentProject:r,projects:s,addYarn:i,updateYarn:o,deleteYarn:l}=Bt(),[c,u]=L.useState(!1),[f,m]=L.useState(null),[g,w]=L.useState(""),[R,N]=L.useState(""),[P,x]=L.useState(Co[0]),[v,I]=L.useState("");if(L.useEffect(()=>{t&&(s.find(A=>A.id===t)?r(t):e("/404"))},[t,r,s,e]),!n)return d.jsx("div",{className:"min-h-screen bg-background-primary flex items-center justify-center",children:d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),d.jsx("p",{className:"text-text-secondary",children:"載入中..."})]})});const D=()=>{m(null),w(Co[0].name+"毛線"),N(""),x(Co[0]),I(""),u(!0)},F=E=>{m(E),w(E.name),N(E.brand||""),x(E.color),I(E.color.hex),u(!0)},z=()=>{if(!g.trim())return;const E=v?{name:"自定義",hex:v}:P,A={id:(f==null?void 0:f.id)||Ze(),name:g.trim(),brand:R.trim()||void 0,color:E};f?o(A):i(A),u(!1),_()},T=E=>{confirm("確定要刪除這個毛線嗎？")&&l(E)},_=()=>{w(""),N(""),x(Co[0]),I(""),m(null)},S=()=>{u(!1),_()};return d.jsxs("div",{className:"min-h-screen bg-background-primary safe-top safe-bottom",children:[d.jsx("div",{className:"bg-background-secondary border-b border-border",children:d.jsx("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-3 sm:py-4",children:d.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[d.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[d.jsx(It,{to:`/project/${t}`,className:"text-text-secondary hover:text-text-primary transition-colors text-sm sm:text-base",children:"← 返回"}),d.jsx("h1",{className:"text-base sm:text-xl font-semibold text-text-primary",children:"毛線管理"})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("button",{onClick:D,className:"btn btn-primary w-full sm:w-auto",children:"+ 新增毛線"}),d.jsx(qi,{})]})]})})}),d.jsxs("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-4 sm:py-6 space-y-4 sm:space-y-6",children:[n.yarns.length===0?d.jsxs("div",{className:"text-center py-12",children:[d.jsx("div",{className:"text-6xl mb-4",children:"🧶"}),d.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-2",children:"還沒有毛線"}),d.jsx("p",{className:"text-text-secondary mb-4",children:"點擊上方「新增毛線」按鈕來添加第一個毛線"}),d.jsx("button",{onClick:D,className:"btn btn-primary",children:"新增毛線"})]}):d.jsx("div",{className:"grid gap-4",children:n.yarns.map(E=>d.jsx("div",{className:"card",children:d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("div",{className:"w-12 h-12 rounded-full border-2 border-border flex-shrink-0",style:{backgroundColor:E.color.hex}}),d.jsxs("div",{className:"flex-1",children:[d.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:E.name}),E.brand&&d.jsx("p",{className:"text-text-secondary",children:E.brand}),d.jsxs("p",{className:"text-sm text-text-tertiary",children:[E.color.name," (",E.color.hex,")"]})]}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("button",{onClick:()=>F(E),className:"btn btn-secondary text-sm",children:"編輯"}),d.jsx("button",{onClick:()=>T(E.id),className:"btn bg-red-500 hover:bg-red-600 text-white text-sm",children:"刪除"})]})]})},E.id))}),c&&d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:d.jsx("div",{className:"bg-background-primary rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:d.jsxs("div",{className:"p-6",children:[d.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-4",children:f?"編輯毛線":"新增毛線"}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"毛線名稱 *"}),d.jsx("input",{type:"text",value:g,onChange:E=>w(E.target.value),className:"w-full p-3 border border-border rounded-lg bg-background-secondary text-text-primary",placeholder:"例如：4號線"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"品牌（選填）"}),d.jsx("input",{type:"text",value:R,onChange:E=>N(E.target.value),className:"w-full p-3 border border-border rounded-lg bg-background-secondary text-text-primary",placeholder:"例如：台灣製"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"顏色"}),d.jsx("div",{className:"grid grid-cols-6 gap-2 mb-3",children:Co.map(E=>d.jsx("button",{onClick:()=>{x(E),I(""),!f&&(g===""||g.endsWith("毛線"))&&w(E.name+"毛線")},className:`w-10 h-10 rounded-full border-2 ${P.hex===E.hex&&!v?"border-primary ring-2 ring-primary/20":"border-border"}`,style:{backgroundColor:E.hex},title:E.name},E.hex))}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs text-text-secondary mb-1",children:"或輸入自定義顏色"}),d.jsx("input",{type:"color",value:v||P.hex,onChange:E=>{I(E.target.value),!f&&(g===""||g.endsWith("毛線"))&&w("自定義毛線")},className:"w-full h-10 border border-border rounded cursor-pointer"})]})]}),d.jsxs("div",{className:"border border-border rounded-lg p-3",children:[d.jsx("p",{className:"text-sm text-text-secondary mb-2",children:"預覽"}),d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-8 h-8 rounded-full border border-border",style:{backgroundColor:v||P.hex}}),d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-text-primary",children:g||"毛線名稱"}),R&&d.jsx("p",{className:"text-sm text-text-secondary",children:R})]})]})]})]}),d.jsxs("div",{className:"flex gap-3 mt-6",children:[d.jsx("button",{onClick:S,className:"flex-1 btn btn-secondary",children:"取消"}),d.jsx("button",{onClick:z,disabled:!g.trim(),className:"flex-1 btn btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:f?"更新":"新增"})]})]})})})]})]})}function rb(){const{projectId:t}=Da();return d.jsxs("div",{className:"min-h-screen bg-background-primary safe-top safe-bottom",children:[d.jsx("div",{className:"bg-background-secondary border-b border-border",children:d.jsx("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-3 sm:py-4",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-3 sm:gap-4",children:[d.jsx(It,{to:`/project/${t}`,className:"text-text-secondary hover:text-text-primary transition-colors text-sm sm:text-base",children:"← 返回"}),d.jsx("h1",{className:"text-lg sm:text-xl font-semibold text-text-primary",children:"匯入匯出"})]}),d.jsx(qi,{})]})})}),d.jsx("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-4 sm:py-6",children:d.jsxs("div",{className:"text-center py-12",children:[d.jsx("div",{className:"text-6xl mb-4",children:"🚧"}),d.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-2",children:"匯入匯出"}),d.jsx("p",{className:"text-text-secondary",children:"此功能正在開發中..."})]})})]})}function sb(){return d.jsx("div",{className:"min-h-screen bg-background-primary flex items-center justify-center px-4",children:d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"text-6xl mb-6",children:"🧶"}),d.jsx("h1",{className:"text-4xl font-bold text-text-primary mb-4",children:"404"}),d.jsx("h2",{className:"text-xl font-semibold text-text-secondary mb-6",children:"找不到頁面"}),d.jsx("p",{className:"text-text-tertiary mb-8",children:"您要查找的頁面不存在或已被移動"}),d.jsx(It,{to:"/",className:"btn btn-primary",children:"回到首頁"})]})})}function ib(){const{signInWithGoogle:t,isLoading:e,error:n}=ot();return d.jsx("div",{className:"min-h-screen bg-background-primary flex items-center justify-center px-4",children:d.jsxs("div",{className:"card max-w-sm sm:max-w-md w-full",children:[d.jsxs("div",{className:"text-center mb-6",children:[d.jsx("div",{className:"text-3xl sm:text-4xl mb-3",children:"🧶"}),d.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-text-primary mb-2",children:"編織計數器"}),d.jsx("p",{className:"text-sm sm:text-base text-text-secondary",children:"使用 Google 帳戶登入以同步您的編織專案"})]}),n&&d.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:n}),d.jsx("button",{onClick:t,disabled:e,className:"w-full flex items-center justify-center gap-3 px-4 py-3 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:e?d.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-gray-600"}):d.jsxs(d.Fragment,{children:[d.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[d.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),d.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),d.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),d.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"使用 Google 登入"]})}),d.jsx("div",{className:"mt-4 text-center",children:d.jsx("p",{className:"text-xs text-text-tertiary",children:"登入即表示您同意我們的服務條款和隱私政策"})})]})})}function ob(){const{setError:t,error:e,isSyncing:n,isLoading:r}=Bt(),{user:s,isLoading:i,initialize:o}=ot();return L.useEffect(()=>{const l=o(),c=ac.setupAuthStateListener();return s&&(U4(),B4()),()=>{l(),c&&c()}},[o]),L.useEffect(()=>{s?(console.log(`使用者已登入 (${s.uid})，開始同步...`),ac.handleUserLogin(s).catch(l=>{console.error("處理用戶登入錯誤:",l),t("登入處理失敗")})):(console.log("使用者已登出，清空數據..."),ac.handleUserLogout())},[s,t]),i||r?d.jsx("div",{className:"min-h-screen bg-background-primary flex items-center justify-center",children:d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),d.jsx("p",{className:"text-text-secondary",children:i?"驗證中...":"載入數據中..."}),n&&d.jsx("p",{className:"text-text-secondary text-sm mt-2",children:"正在同步跨裝置數據..."})]})}):s?d.jsxs("div",{className:"min-h-screen bg-background-primary",children:[e&&d.jsx("div",{className:"fixed top-4 left-4 right-4 z-50 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{children:e}),d.jsx("button",{onClick:()=>t(null),className:"text-red-500 hover:text-red-700 ml-4",children:"✕"})]})}),d.jsxs(WS,{children:[d.jsx(Vn,{path:"/",element:d.jsx($4,{})}),d.jsx(Vn,{path:"/project/:projectId",element:d.jsx(Z4,{})}),d.jsx(Vn,{path:"/project/:projectId/pattern",element:d.jsx(eb,{})}),d.jsx(Vn,{path:"/project/:projectId/progress",element:d.jsx(tb,{})}),d.jsx(Vn,{path:"/project/:projectId/yarns",element:d.jsx(nb,{})}),d.jsx(Vn,{path:"/project/:projectId/import-export",element:d.jsx(rb,{})}),d.jsx(Vn,{path:"/404",element:d.jsx(sb,{})}),d.jsx(Vn,{path:"*",element:d.jsx(GS,{to:"/404",replace:!0})})]})]}):d.jsx(ib,{})}qh.createRoot(document.getElementById("root")).render(d.jsx(xn.StrictMode,{children:d.jsx(ZS,{children:d.jsx(ob,{})})}));
